<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r1953 - in /trunk: bin/iris2.exe lua/filter/filter.granny.lua lua/gui/gui.paperdoll.lua lua/lib.gumpparser.lua lua/lib.mousepick.lua lua/lib.securetrade.lua lua/lib.skill.lua lua/obj/obj.player.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1953%20-%20in%20/trunk%3A%20bin/iris2.exe%0A%20lua/filter/filter.granny.lua%20lua/gui/gui.paperdoll.lua%0A%20lua/lib.gumpparser.lua%20lua/lib.mousepick.lua%20lua/lib.securetrade.lua%0A%20lua/lib.skill.lua%20lua/obj/obj.player.lua&In-Reply-To=%3C20080311190003.52D611C18033%40zwischenwelt.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000764.html">
   <LINK REL="Next"  HREF="000766.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r1953 - in /trunk: bin/iris2.exe lua/filter/filter.granny.lua lua/gui/gui.paperdoll.lua lua/lib.gumpparser.lua lua/lib.mousepick.lua lua/lib.securetrade.lua lua/lib.skill.lua lua/obj/obj.player.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1953%20-%20in%20/trunk%3A%20bin/iris2.exe%0A%20lua/filter/filter.granny.lua%20lua/gui/gui.paperdoll.lua%0A%20lua/lib.gumpparser.lua%20lua/lib.mousepick.lua%20lua/lib.securetrade.lua%0A%20lua/lib.skill.lua%20lua/obj/obj.player.lua&In-Reply-To=%3C20080311190003.52D611C18033%40zwischenwelt.org%3E"
       TITLE="[Iris-commit] [IRIS] r1953 - in /trunk: bin/iris2.exe lua/filter/filter.granny.lua lua/gui/gui.paperdoll.lua lua/lib.gumpparser.lua lua/lib.mousepick.lua lua/lib.securetrade.lua lua/lib.skill.lua lua/obj/obj.player.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Tue Mar 11 19:05:54 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000764.html">[Iris-commit] [IRIS] r1952 - in /trunk/lua: lib.loading.lua	lib.unifont.lua
</A></li>
        <LI>Next message: <A HREF="000766.html">[Iris-commit] [IRIS] r1954 - in /trunk: lua/lib.unifont.lua	ravenal_terrain.php
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#765">[ date ]</a>
              <a href="thread.html#765">[ thread ]</a>
              <a href="subject.html#765">[ subject ]</a>
              <a href="author.html#765">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sience
Date: Tue Mar 11 19:05:53 2008
New Revision: 1953

Log:
-gump are now coded in the specific gumpfiles (no *.gfm's anymore) - use gu=
mpstudio plugin to create
-new win32 binary
-some comments added

Modified:
    trunk/bin/iris2.exe
    trunk/lua/filter/filter.granny.lua
    trunk/lua/gui/gui.paperdoll.lua
    trunk/lua/lib.gumpparser.lua
    trunk/lua/lib.mousepick.lua
    trunk/lua/lib.securetrade.lua
    trunk/lua/lib.skill.lua
    trunk/lua/obj/obj.player.lua

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/filter/filter.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.granny.lua (original)
+++ trunk/lua/filter/filter.granny.lua Tue Mar 11 19:05:53 2008
@@ -36,6 +36,7 @@
 =

 -- custom models can be applyed instead to grannys, just tell the meshname
 --gGrannyFilter[220]	=3D{meshname=3D&quot;Lich.mesh&quot;}
+--gGrannyFilter[207]	=3D{meshname=3D&quot;mummy.mesh&quot;}
 =

 gGrannyFilter[987]	=3D{grannyid=3D400}
 gGrannyFilter[1987]	=3D{grannyid=3D401}

Modified: trunk/lua/gui/gui.paperdoll.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.paperdoll.lua (original)
+++ trunk/lua/gui/gui.paperdoll.lua Tue Mar 11 19:05:53 2008
@@ -307,17 +307,17 @@
 			-- request Warmode and change the Peace/Warmode Button visual
 			dialog.controls[&quot;btnpeace&quot;].onMouseDown =3D function (widget,mousebutto=
n)
 															if (gActWarmode=3D=3DgWarmode_Normal) then
+																Send_CombatMode(gWarmode_Combat)
 																widget.mat_normal 	=3D GetGumpMat(hex2num(&quot;0x7E8&quot;))
 																widget.mat_pressed 	=3D GetGumpMat(hex2num(&quot;0x7E9&quot;))
 																widget.mat_over 	=3D GetGumpMat(hex2num(&quot;0x7EA&quot;))
 																widget.gfx:SetMaterial(widget.mat_pressed)
-																Send_CombatMode(gWarmode_Combat)
 															else
+																Send_CombatMode(gWarmode_Normal)
 																widget.mat_normal 	=3D GetGumpMat(hex2num(&quot;0x7E5&quot;))
 																widget.mat_pressed 	=3D GetGumpMat(hex2num(&quot;0x7E6&quot;))
 																widget.mat_over 	=3D GetGumpMat(hex2num(&quot;0x7E7&quot;))
 																widget.gfx:SetMaterial(widget.mat_pressed)
-																Send_CombatMode(gWarmode_Normal)
 															end
 														end
 			-- request HelpGump (must be supported by Serversidegumps)

Modified: trunk/lua/lib.gumpparser.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gumpparser.lua (original)
+++ trunk/lua/lib.gumpparser.lua Tue Mar 11 19:05:53 2008
@@ -489,6 +489,8 @@
 												printdebug(&quot;gump&quot;,&quot;Checkbox changed : id=3D&quot;..widget.returnmsg=
..&quot; state=3D&quot;..widget.state)
 											end
 										  end
+				else
+					if (bToken[7]) then dialog.controls[bToken[7]] =3D widget end
 				end
 			--HtmlGump &lt;x&gt; &lt;y&gt; &lt;width&gt; &lt;height&gt; &lt;text-id&gt; &lt;background&gt; &lt;scrollbar&gt;
 			--Description:  Defines a text-area where Html-commands are allowed.

Modified: trunk/lua/lib.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mousepick.lua (original)
+++ trunk/lua/lib.mousepick.lua Tue Mar 11 19:05:53 2008
@@ -31,13 +31,13 @@
 		local pm =3D GetPlayerMobile()
 		if (gActWarmode =3D=3D gWarmode_Normal or (pm and iSerial =3D=3D pm.seri=
al) ) then
 			if (iSerial and iSerial ~=3D 0) then
-				printdebug(&quot;UO&quot;,sprintf(&quot;IrisDoubleClick: serial=3D0x%08x\n&quot;,iSerial))
+				printdebug(&quot;net&quot;,sprintf(&quot;IrisDoubleClick: serial=3D0x%08x\n&quot;,iSerial))
 				Send_DoubleClick(iSerial)
 			end
 		end
 		if (gActWarmode =3D=3D gWarmode_Combat) then
 			if (iSerial and iSerial ~=3D 0) then
-				printdebug(&quot;UO&quot;,sprintf(&quot;IrisDoubleClickAttack: serial=3D0x%08x\n&quot;,iSe=
rial))
+				printdebug(&quot;net&quot;,sprintf(&quot;IrisDoubleClickAttack: serial=3D0x%08x\n&quot;,iS=
erial))
 				Send_AttackReq(iSerial)
 			end
 		end
@@ -53,7 +53,7 @@
 	else
 		local iSerial =3D gCurrentRenderer:GetMouseHitSerial()
 		if (iSerial and iSerial ~=3D 0) then =

-			printdebug(&quot;UO&quot;,sprintf(&quot;IrisSingleClick: serial=3D0x%08x\n&quot;,iSerial))
+			printdebug(&quot;net&quot;,sprintf(&quot;IrisSingleClick: serial=3D0x%08x\n&quot;,iSerial))
 			Send_SingleClick(iSerial)
 			gCurrentRenderer:SelectMobile(iSerial)
 		else
@@ -67,7 +67,7 @@
 	local iSerial =3D gCurrentRenderer:GetMouseHitSerial()
 	gLastRightClickSerial =3D nil
 	if (iSerial and iSerial ~=3D 0) then =

-		printdebug(&quot;UO&quot;,sprintf(&quot;IrisRightClick: serial=3D0x%08x\n&quot;,iSerial))
+		printdebug(&quot;net&quot;,sprintf(&quot;IrisRightClick: serial=3D0x%08x\n&quot;,iSerial))
 		Send_PopupRequest(iSerial) =

 		gLastRightClickSerial =3D iSerial
 	end

Modified: trunk/lua/lib.securetrade.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.securetrade.lua (original)
+++ trunk/lua/lib.securetrade.lua Tue Mar 11 19:05:53 2008
@@ -4,6 +4,25 @@
 -- see also kPacket_Open_Container (exchange is done using containers)
 -- see also old iris trade.csl or so  callback_OnTradeCheck callback_OnTra=
deStart
 -- secure trade is started by dragdrop onto player .. server sends start w=
ith two containers
+
+-- Created 11.03.2008 16:55:39, with GumpStudio &amp; Iris2 Lua Export Plugin
+-- Exported Iris2 GumpExporter ver 1.0.
+local securetrading =3D {}
+securetrading.dialogId =3D 34567
+securetrading.x =3D 0
+securetrading.y =3D 0
+securetrading.Data =3D
+	 &quot;{ page 0 }&quot; ..
+	 &quot;{ gumppic 0 0 2150 }&quot; ..
+	 &quot;{ checkbox 52 30 2151 2153 0 cbmy }&quot; ..
+	 &quot;{ checkbox 268 162 2151 2153 0 cbtheir }&quot; ..
+	 &quot;{ text 85 36 0 0 }&quot; ..
+	 &quot;{ text 70 166 0 1 }&quot; ..
+	 &quot;&quot; =

+securetrading.textline =3D {
+	[0] =3D &quot;namemy&quot;,
+	[1] =3D &quot;nametheir&quot;,
+}
 =

 kSecTradeAction_Start =3D 0
 kSecTradeAction_Cancel =3D 1
@@ -137,7 +156,9 @@
 		gSecureTrades[mysectrade.id] =3D mysectrade
 		=

 		-- show dialog
-		local dialog =3D CreateGumpDlgFromGfm(datapath..&quot;gfm/secure_trade.gfm&quot;)
+		--local dialog =3D CreateGumpDlgFromGfm(datapath..&quot;gfm/secure_trade.gfm&quot;)
+		local dialog =3D GumpParser( securetrading, true )
+
 		for k,v in pairs(dialog.childs) do v.mbIgnoreMouseOver =3D false end
 		mysectrade.dialog =3D dialog =

 		dialog.uoSecureTrade =3D mysectrade =

@@ -148,12 +169,12 @@
 		end
 		=

 		-- update name display name
-		dialog.controls[&quot;name_my&quot;].gfx:SetText(GetPlayerName() or &quot;me&quot;)
-		dialog.controls[&quot;name_their&quot;].gfx:SetText(sectrade.name or &quot;unknown&quot;)
+		dialog.controls[&quot;namemy&quot;].gfx:SetText(GetPlayerName() or &quot;me&quot;)
+		dialog.controls[&quot;nametheir&quot;].gfx:SetText(sectrade.name or &quot;unknown&quot;)
 		-- ./net.paperdoll.lua:55:	dialog =3D CreateGumpDlgFromGfm(...)
 		-- cb_my cb_their  normal=3D'0x867' checked=3D'0x869' -- todo :  $209 $2=
08 gumpids ?
 		=

-		dialog.controls[&quot;cb_my&quot;].onChange =3D function (widget,bChecked) =

+		dialog.controls[&quot;cbmy&quot;].onChange =3D function (widget,bChecked) =

 			--print(&quot;Send_SecureTrade_ChangeAgree&quot;,widget.dialog.uoSecureTrade.id,b=
Checked)
 			Send_SecureTrade_ChangeAgree(widget.dialog.uoSecureTrade.id,bChecked an=
d 1 or 0)
 		end
@@ -172,8 +193,8 @@
 				mysectrade:Close()
 			else =

 				-- change checkboxes
-				mysectrade.dialog.controls[&quot;cb_my&quot;]:SetChecked(myOK)
-				mysectrade.dialog.controls[&quot;cb_their&quot;]:SetChecked(theirOK)
+				mysectrade.dialog.controls[&quot;cbmy&quot;]:SetChecked(myOK)
+				mysectrade.dialog.controls[&quot;cbtheir&quot;]:SetChecked(theirOK)
 			end
 		end
 	end

Modified: trunk/lua/lib.skill.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.skill.lua (original)
+++ trunk/lua/lib.skill.lua Tue Mar 11 19:05:53 2008
@@ -1,3 +1,38 @@
+-- Created 11.03.2008 16:09:57, with GumpStudio &amp; Iris2 Lua Export Plugin
+-- Exported Iris2 GumpExporter ver 1.0.
+local skillGump =3D {}
+skillGump.dialogId =3D 1234
+skillGump.x =3D 0
+skillGump.y =3D 0
+skillGump.Data =3D
+	 &quot;{ page 0 }&quot; ..
+	 &quot;{ gumppic 23 311 2083 }&quot; ..
+	 &quot;{ gumppic 21 241 2082 }&quot; ..
+	 &quot;{ gumppic 42 273 2102 }&quot; ..
+	 &quot;{ gumppictiled 21 64 263 177 2081 }&quot; ..
+	 &quot;{ gumppic 4 27 2080 }&quot; ..
+	 &quot;{ gumppic 120 37 2100 }&quot; ..
+	 &quot;{ button 139 342 2094 2095 1 0 0 }&quot; ..
+	 &quot;{ gumppic 44 62 2091 }&quot; ..
+	 &quot;{ button 255 61 2084 2084 1 0 skillscrollup }&quot; ..
+	 &quot;{ button 255 291 2085 2085 1 0 skillscrolldown }&quot; ..
+	 &quot;{ button 139 4 2093 2093 1 0 skillclose }&quot; ..
+	 &quot;{ button 259 76 2088 2088 1 0 skillscroll }&quot;
+skillGump.textline =3D {
+}
+-- Created 11.03.2008 15:41:19, with GumpStudio &amp; Iris2 Lua Export Plugin
+-- Exported Iris2 GumpExporter ver 1.0.
+local quickskillGump =3D {}
+quickskillGump.dialogId =3D 234567
+quickskillGump.x =3D 0
+quickskillGump.y =3D 0
+quickskillGump.Data =3D
+	 &quot;{ page 0 }&quot; ..
+	 &quot;{ gumppic 0 0 2445 }&quot; ..
+	 &quot;{ gumppic 5 5 2362 }&quot;
+quickskillGump.textline =3D {
+}
+
 -- global player skill stuff list, see SkillUpdate for details
 gPlayerSkills =3D nil
 =

@@ -20,7 +55,7 @@
 		for k,skill in pairs(gSkillDialog.lSkill) do
 			if skill.skillid =3D=3D skillid then
 				-- skill found, so update
-				print(&quot;skillupdate&quot;,k,skillid,skill.skillid,value,base_value,lockstate)
+				--print(&quot;skillupdate&quot;,k,skillid,skill.skillid,value,base_value,locksta=
te)
 				skill.button_lock.gfx:SetVisible(lockstate =3D=3D 2)
 				skill.button_up.gfx:SetVisible(lockstate =3D=3D 0)
 				skill.button_down.gfx:SetVisible(lockstate =3D=3D 1)
@@ -47,7 +82,8 @@
 		=

 		local scrollbar_h =3D scrollbar_y_end - scrollbar_y_start
 	=

-		gSkillDialog =3D CreateGumpDlgFromGfm(datapath..&quot;gfm/skill.gfm&quot;)
+		-- gSkillDialog =3D CreateGumpDlgFromGfm(datapath..&quot;gfm/skill.gfm&quot;)
+		gSkillDialog =3D GumpParser( skillGump, true )
 		=

 		-- restore last positoin if available
 		if gSkillDialog_LastPositionX and gSkillDialog_LastPositionY then gSkill=
Dialog.rootwidget.gfx:SetPos(gSkillDialog_LastPositionX, gSkillDialog_LastP=
ositionY) end
@@ -71,7 +107,7 @@
 		end
 		=

 		-- close button
-		local widget =3D dialog.controls[&quot;skill_close&quot;]
+		local widget =3D dialog.controls[&quot;skillclose&quot;]
 		widget.onMouseDown 		=3D function (widget,mousebutton) if (mousebutton =
=3D=3D 1) then =

 			widget.gfx:SetMaterial(widget.mat_pressed)
 			-- TODO: toggle to gump-id 0x839 on upper right corner (moveable) ... o=
n doubleclick open skills again
@@ -79,7 +115,7 @@
 		end end
 		=

 		-- scrollbar middle button
-		local widget =3D dialog.controls[&quot;skill_scroll&quot;]
+		local widget =3D dialog.controls[&quot;skillscroll&quot;]
 		widget.onMouseDown 		=3D function (widget,mousebutton)
 			if (mousebutton =3D=3D 1) then widget.dialog:BringToFront() gui.StartMo=
veDialog(widget) end
 		end
@@ -100,10 +136,10 @@
 		end
 		=

 		-- scroll buttons
-		local widget =3D dialog.controls[&quot;skill_scroll_up&quot;]
+		local widget =3D dialog.controls[&quot;skillscrollup&quot;]
 		widget.onMouseDown 		=3D function (widget,mousebutton) if (mousebutton =
=3D=3D 1) then dialog:Scroll(-3) end end
 =

-		local widget =3D dialog.controls[&quot;skill_scroll_down&quot;]
+		local widget =3D dialog.controls[&quot;skillscrolldown&quot;]
 		widget.onMouseDown 		=3D function (widget,mousebutton) if (mousebutton =
=3D=3D 1) then dialog:Scroll(3) end end
 =

 		-- functions handling the up/down/lock switch
@@ -150,7 +186,7 @@
 				dialog.miScrollPosition =3D index
 				=

 				-- position the scroll position thing
-				dialog.controls[&quot;skill_scroll&quot;].gfx:SetPos(scrollbar_x,scrollbar_y_sta=
rt + scrollbar_h*(index / maxindex))
+				dialog.controls[&quot;skillscroll&quot;].gfx:SetPos(scrollbar_x,scrollbar_y_star=
t + scrollbar_h*(index / maxindex))
 				=

 				for k,skill in pairs(dialog.lSkill) do
 					if (skill.index &gt;=3D index) and (skill.index &lt; index + h) then
@@ -244,7 +280,7 @@
 					skill.button_use_drag.onMouseDown =3D function (widget,mousebutton)
 						if (mousebutton =3D=3D 1) then =

 							skill.button_use_drag.mStartX,skill.button_use_drag.mStartY =3D ski=
ll.button_use_drag.gfx:GetPos()
-							print(&quot;start&quot;,skill.button_use_drag.mStartX,skill.button_use_drag.m=
StartY)
+							--print(&quot;start&quot;,skill.button_use_drag.mStartX,skill.button_use_drag=
.mStartY)
 							skill.button_use_drag.dialog:BringToFront() =

 							gui.StartMoveDialog(skill.button_use_drag) =

 						end
@@ -329,7 +365,8 @@
 glQuickCastDialog =3D {}
 -- creates a quickcast button at the given position
 function CreateQuickCastButton (x,y,name,fun)
-	local dialog =3D CreateGumpDlgFromGfm(datapath..&quot;gfm/quickcast.gfm&quot;)
+	-- local dialog =3D CreateGumpDlgFromGfm(datapath..&quot;gfm/quickcast.gfm&quot;)
+	local dialog =3D GumpParser( quickskillGump, true )
 =

 	-- handle mouse events
 	for k,v in pairs(dialog.childs) do v.mbIgnoreMouseOver =3D false end
@@ -355,7 +392,7 @@
 	=

 	local text =3D guimaker.MakeText(root, 20, 5, name, gFontGumpSize, {1.0,1=
.0,1.0,1.0}, gFontNameDefault)
 	local w,h =3D text.gfx:GetDimensions()
-	print(&quot;size&quot;,text,w,h)
+	--print(&quot;size&quot;,text,w,h)
 	=

 	-- cast text button
 	local b =3D 2
@@ -364,7 +401,7 @@
 	button.mbIgnoreMouseOver =3D false
 	=

 	button.onLeftClick =3D function (widget)
-		print(&quot;click&quot;)
+		--print(&quot;click&quot;)
 		fun()
 	end
 	=


Modified: trunk/lua/obj/obj.player.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/obj/obj.player.lua (original)
+++ trunk/lua/obj/obj.player.lua Tue Mar 11 19:05:53 2008
@@ -73,8 +73,8 @@
 function NotifyWarmode	(flag)
 	if (flag =3D=3D gWarmode_Normal) then
 		gActWarmode=3DgWarmode_Normal
-		AddFadeLines(&quot;Be the peace with you!&quot;)
-		JournalAddText(&quot;&quot;,&quot;Be the peace with you!&quot;)
+		AddFadeLines(&quot;Peace be with you!&quot;)
+		JournalAddText(&quot;&quot;,&quot;Peace be with you!&quot;)
 		--printf(&quot;NET: kPacket_SetPlayerWarmode id: 0x%02x gWarmode: normal\n&quot;,i=
d)
 	end
 	if (flag =3D=3D gWarmode_Combat) then


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000764.html">[Iris-commit] [IRIS] r1952 - in /trunk/lua: lib.loading.lua	lib.unifont.lua
</A></li>
	<LI>Next message: <A HREF="000766.html">[Iris-commit] [IRIS] r1954 - in /trunk: lua/lib.unifont.lua	ravenal_terrain.php
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#765">[ date ]</a>
              <a href="thread.html#765">[ thread ]</a>
              <a href="subject.html#765">[ subject ]</a>
              <a href="author.html#765">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
