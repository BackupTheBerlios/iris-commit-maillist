<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r1872 - in /trunk: bin/iris2.exe data/config.lua.dist data/grannys/materials/grannybase.material data/models/materials/textures.material data/terrain/materials/terrain.material lua/lib.3d.renderer.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1872%20-%20in%20/trunk%3A%20bin/iris2.exe%0A%20data/config.lua.dist%20data/grannys/materials/grannybase.material%0A%20data/models/materials/textures.material%0A%20data/terrain/materials/terrain.material%20lua/lib.3d.renderer.lua&In-Reply-To=%3C20080202154804.DDE9A1C1868A%40zwischenwelt.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000684.html">
   <LINK REL="Next"  HREF="000686.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r1872 - in /trunk: bin/iris2.exe data/config.lua.dist data/grannys/materials/grannybase.material data/models/materials/textures.material data/terrain/materials/terrain.material lua/lib.3d.renderer.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1872%20-%20in%20/trunk%3A%20bin/iris2.exe%0A%20data/config.lua.dist%20data/grannys/materials/grannybase.material%0A%20data/models/materials/textures.material%0A%20data/terrain/materials/terrain.material%20lua/lib.3d.renderer.lua&In-Reply-To=%3C20080202154804.DDE9A1C1868A%40zwischenwelt.org%3E"
       TITLE="[Iris-commit] [IRIS] r1872 - in /trunk: bin/iris2.exe data/config.lua.dist data/grannys/materials/grannybase.material data/models/materials/textures.material data/terrain/materials/terrain.material lua/lib.3d.renderer.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Sat Feb  2 16:48:04 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000684.html">[Iris-commit] [IRIS] r1871 - /trunk/lua/lib.devtool.lua
</A></li>
        <LI>Next message: <A HREF="000686.html">[Iris-commit] [IRIS] r1873 - in /trunk/lua: lib.3d.map.lua	lib.devtool.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#685">[ date ]</a>
              <a href="thread.html#685">[ thread ]</a>
              <a href="subject.html#685">[ subject ]</a>
              <a href="author.html#685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sience
Date: Sat Feb  2 16:48:04 2008
New Revision: 1872

Log:
-graphicprofile &quot;none&quot; added for custom graphicsettings
-specular lightning set for grannys
-new binary
-setup shadows and worldlightning moved into 2 functions

Modified:
    trunk/bin/iris2.exe
    trunk/data/config.lua.dist
    trunk/data/grannys/materials/grannybase.material
    trunk/data/models/materials/textures.material
    trunk/data/terrain/materials/terrain.material
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Sat Feb  2 16:48:04 2008
@@ -455,5 +455,5 @@
 -- shaderbased characterrendering (beta)
 gUseHumanSkinShader =3D false
 =

--- &quot;ultralow&quot;, &quot;low&quot;, &quot;med&quot;, &quot;high&quot;, &quot;ultrahigh&quot;
+-- &quot;ultralow&quot;, &quot;low&quot;, &quot;med&quot;, &quot;high&quot;, &quot;ultrahigh&quot;, &quot;none&quot;
 gGraphicProfile =3D &quot;med&quot;

Modified: trunk/data/grannys/materials/grannybase.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/grannys/materials/grannybase.material (original)
+++ trunk/data/grannys/materials/grannybase.material Sat Feb  2 16:48:04 20=
08
@@ -16,6 +16,11 @@
 =

 		pass
 		{
+			lighting on
+			ambient 0.5 0.5 0.5 1.0
+			diffuse 1.0 1.0 1.0 1.0
+			specular 0.7 0.7 0.75 30.0
+						 =

 			scene_blend alpha_blend
 			alpha_rejection greater_equal 50
 			texture_unit
@@ -70,6 +75,11 @@
 =

 		pass
 		{
+			lighting on
+			ambient 0.5 0.5 0.5 1.0
+			diffuse 1.0 1.0 1.0 1.0
+			specular 0.7 0.7 0.75 30.0
+
 			scene_blend alpha_blend
 			alpha_rejection greater_equal 50
 			texture_unit

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Feb  2 16:48:04 2008
@@ -23,12 +23,22 @@
 =

 			ambient vertexcolour
 			diffuse vertexcolour
-			=

+
+			//this is just a test for Normal Mapping
+//			fragment_program_ref Effect_Workspace.NormalMapFilter.Single_Pass.Pix=
el_Shader
+//			{
+				//Shader Constant: TextureSize
+//				param_indexed 1 float4 512.000000 0.0 0.0 0.0
+				//Shader Constant: lightness
+//				param_indexed 0 float4 0.300000 0.590000 0.110000 0.000000
+//			}
+
 			texture_unit DecalTexture
 			{
-				filtering anisotropic =

+				filtering anisotropic
 				max_anisotropy 8
 				texture checker.png
+				tex_address_mode clamp
 			}
 		}
 	}
@@ -39,13 +49,9 @@
 {
 	technique
 	{
-//		pass Ambient
-//		{
-//			alpha_rejection greater_equal 200
-//		}
 		pass Decal
 		{
-//			scene_blend alpha_blend
+			//scene_blend alpha_blend
 			alpha_rejection greater_equal 200
 		}
 	}

Modified: trunk/data/terrain/materials/terrain.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/terrain/materials/terrain.material (original)
+++ trunk/data/terrain/materials/terrain.material Sat Feb  2 16:48:04 2008
@@ -3,6 +3,7 @@
 //###########################################
 =

 // simple material without transitions
+// should not receive or cast shadows!
 material terrain_multitex_far
 {
 	receive_shadows off
@@ -22,6 +23,7 @@
 // simple material without transitions
 material terrain_multitex_simple_mat
 {
+	receive_shadows on
 	technique
 	{
 		pass
@@ -41,6 +43,7 @@
 =

 material terrain_multitex_mat
 {
+	receive_shadows on
 	technique
 	{
 		pass
@@ -96,6 +99,7 @@
 =

 material water
 {
+	receive_shadows on
 	technique
 	{
 		pass

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sat Feb  2 16:48:04 2008
@@ -59,14 +59,39 @@
 	end
 end
 =

+function Renderer3D:SetupWorldlight ()
+	Client_ClearLights()
+
+	-- Sun Light
+	gDirectionalLightSun =3D Client_AddDirectionalLight(
+								gSunLightDirection.x,
+								gSunLightDirection.y,
+								gSunLightDirection.z)
+	=

+	Client_SetLightDiffuseColor(gDirectionalLightSun,
+								gSunLightDiffuse.r,
+								gSunLightDiffuse.g,
+								gSunLightDiffuse.b)
+
+	Client_SetLightSpecularColor(gDirectionalLightSun,
+								gSunLightSpecular.r,
+								gSunLightSpecular.g,
+								gSunLightSpecular.b)
+
+	-- Ambient Light
+	Client_SetAmbientLight( gAmbientLight.r,
+							gAmbientLight.g,
+							gAmbientLight.b, 1.0)
+end
+
 gBuildStencilShadowEdgeList =3D false
-function Renderer3D:SetupShadows()
+function Renderer3D:SetupShadows ()
 	local shadowfardist=3D5*gSightRange+gFogValue
 =

 	if ((gShadowTechnique =3D=3D &quot;stencil_modulative&quot;) or (gShadowTechnique =
=3D=3D &quot;stencil_additive&quot;)) then
 		----- currently doesn't work with Fastbatch
+		--OgreSetShadowFarDistance(shadowfardist)
 		--OgreShadowTechnique(gShadowTechnique)
-		--OgreSetShadowFarDistance(shadowfardist)
 		--gBuildStencilShadowEdgeList=3Dtrue
 	elseif ((gShadowTechnique =3D=3D &quot;texture_modulative&quot;) or (gShadowTechniq=
ue =3D=3D &quot;texture_additive&quot;)) then
 		OgreSetShadowFarDistance(shadowfardist)
@@ -81,7 +106,7 @@
 		OgreSetShadowTextureSelfShadow(true)		-- disable this or write in materi=
al &quot;receive_shadows off&quot;
 		OgreSetShadowCasterRenderBackFaces(false)
 		OgreSetShadowTextureSize(2048)
-		OgreSetShadowTextureCount(3)
+		--OgreSetShadowTextureCount(3)
 =

 		OgreShadowTechnique(gShadowTechnique)
 	elseif ((gShadowTechnique =3D=3D &quot;texture_additive_integrated&quot;) or (gShad=
owTechnique =3D=3D &quot;texture_modulative_integrated&quot;)) then
@@ -122,38 +147,18 @@
 	cam:SetNearClipDistance(0.5) -- old : 1
 	cam:SetFarClipDistance(2000) -- ogre defaul : 100000
 	cam:SetProjectionType(0) -- perspective
-	Client_ClearLights()
-
-	-- Sun Light
-	gDirectionalLightSun =3D Client_AddDirectionalLight(
-								gSunLightDirection.x,
-								gSunLightDirection.y,
-								gSunLightDirection.z)
-	=

-	Client_SetLightDiffuseColor(gDirectionalLightSun,
-								gSunLightDiffuse.r,
-								gSunLightDiffuse.g,
-								gSunLightDiffuse.b)
-
-	Client_SetLightSpecularColor(gDirectionalLightSun,
-								gSunLightSpecular.r,
-								gSunLightSpecular.g,
-								gSunLightSpecular.b)
-
-	-- Ambient Light
-	Client_SetAmbientLight( gAmbientLight.r,
-							gAmbientLight.g,
-							gAmbientLight.b, 1)
+
+	self.SetupWorldlight()
 	=

 	self.gbActive =3D true
 	self:SetMapEnvironment()
-	=

+
+	-- Initialize Shadowsystem
+	self:SetupShadows()
+
 	self.gbCamRotChanged =3D true
 	for k,dynamic in pairs(GetDynamicList()) do if (DynamicIsInWorld(dynamic)=
) then self:AddDynamicItem(dynamic) end end
 	for k,mobile in pairs(GetMobileList()) do self:CreateMobileGfx(mobile) end
-	=

-	-- Initialize Shadowsystem
-	self:SetupShadows()
 end
 =

 function Renderer3D:DeInit()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000684.html">[Iris-commit] [IRIS] r1871 - /trunk/lua/lib.devtool.lua
</A></li>
	<LI>Next message: <A HREF="000686.html">[Iris-commit] [IRIS] r1873 - in /trunk/lua: lib.3d.map.lua	lib.devtool.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#685">[ date ]</a>
              <a href="thread.html#685">[ thread ]</a>
              <a href="subject.html#685">[ subject ]</a>
              <a href="author.html#685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
