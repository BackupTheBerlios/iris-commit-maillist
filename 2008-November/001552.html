<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r2748 - /trunk/lua/lib.book.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r2748%20-%20/trunk/lua/lib.book.lua&In-Reply-To=%3C20081123143847.809CC1C187E4%40zwischenwelt.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001551.html">
   <LINK REL="Next"  HREF="001553.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r2748 - /trunk/lua/lib.book.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r2748%20-%20/trunk/lua/lib.book.lua&In-Reply-To=%3C20081123143847.809CC1C187E4%40zwischenwelt.org%3E"
       TITLE="[Iris-commit] [IRIS] r2748 - /trunk/lua/lib.book.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Sun Nov 23 15:38:47 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001551.html">[Iris-commit] [IRIS] r2747 - in /trunk/lua: lib.2d.dynamic.lua	lib.book.lua main.lua
</A></li>
        <LI>Next message: <A HREF="001553.html">[Iris-commit] [IRIS] r2749 - in /trunk: lua/gui/gui.healthbar.lua lua/lib.macrolist.lua lua/lib.mousepick.lua lua/lib.namegumps.lua lua/lib.uotooltip.lua lua/main.lua lua/widgets/widget.uotooltip.lua plugins/itemcounter.lua plugins/moblist.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1552">[ date ]</a>
              <a href="thread.html#1552">[ thread ]</a>
              <a href="subject.html#1552">[ subject ]</a>
              <a href="author.html#1552">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ghoulsblade
Date: Sun Nov 23 15:38:47 2008
New Revision: 2748

Log:
simple book dialog

Modified:
    trunk/lua/lib.book.lua

Modified: trunk/lua/lib.book.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.book.lua (original)
+++ trunk/lua/lib.book.lua Sun Nov 23 15:38:47 2008
@@ -17,9 +17,6 @@
 	=

 	=

 =

-### kPacket_Book_Info header:   {author=3D&quot;Staff of Vetus-Mundus&quot;,authorle=
n=3D22=3D0x16,title=3D&quot;a small introduction&quot;,unknown=3D1,numpages=3D15=3D0x=
0f,writable=3D0,serial=3D0x4040c1ce,titlelen=3D21=3D0x15,}
-### kPacket_Book_Contents pages:        0       {numpages=3D15=3D0x0f,seri=
al=3D0x4040c1ce,pages=3D{1=3D{numlines=3D8,pagenum=3D1,lines=3D{1=3D&quot;We wel=
come thee&quot;,2=3D&quot;traveler&quot;,3=3D&quot;&quot;,4=3D&quot;we're glad to see&quot;,5=3D&quot;thy journey l=
ed&quot;,6=3D&quot;thee to Vetus Mundus&quot;,7=3D&quot;The gods of this&quot;,8=3D&quot;&quot;,},},2=3D{numli=
nes=3D8,pagenum=3D2,lines=3D{1=3D&quot;world will not bother&quot;,2=3D&quot;with much rul=
es,&quot;,3=3D&quot;nonetheless&quot;,4=3D&quot;there's something to&quot;,5=3D&quot;follow here.&quot;,6=3D&quot;R=
ules are as listened:&quot;,7=3D&quot;'One can do whatever&quot;,8=3D&quot;&quot;,},},3=3D{numlines=
=3D8,pagenum=3D3,lines=3D{1=3D&quot;provides fun. Note,&quot;,2=3D&quot;that PvP is only&quot;,=
3=3D&quot;possible on the facette&quot;,4=3D&quot;called felucca.&quot;,5=3D&quot;The second rule is=
:<i>&quot;,6=3D&quot;'We all treat each other&quot;,7=3D&quot;with respect', the gods&quot;,8=3D&quot;&quot;,},},=
</I>4=3D{numlines=3D8,pagenum=3D4,lines=3D{1=3D&quot;don't wish to hear&quot;,2=3D&quot;excess=
ive slang, nor&quot;,3=3D&quot;any indignities&quot;,4=3D&quot;from the mortal&quot;,5=3D&quot;or speakin=
g to&quot;,6=3D&quot;oneself. Dost you wish&quot;,7=3D&quot;to live peacefully&quot;,8=3D&quot;&quot;,},},5=3D=
{numlines=3D8,pagenum=3D5,lines=3D{1=3D&quot;here on Vetus Mundus, &quot;,2=3D&quot;it's i=
ndispensable&quot;,3=3D&quot;to follow this rule.&quot;,4=3D&quot;&quot;,5=3D&quot;To make thy beginning&quot;=
,6=3D&quot;as comfortable as possible,&quot;,7=3D&quot;we will grant thee some&quot;,8=3D&quot;&quot;,},}=
,6=3D{numlines=3D8,pagenum=3D6,lines=3D{1=3D&quot;commands. Listen carefully.&quot;,2=
=3D&quot;To communicate with other&quot;,3=3D&quot;mortal in the public&quot;,4=3D&quot;Channel, one=
 has to use&quot;,5=3D&quot;the following&quot;,6=3D&quot;Combination:&quot;,7=3D&quot;.c (thy message)&quot;,=
8=3D&quot;&quot;,},},7=3D{numlines=3D8,pagenum=3D7,lines=3D{1=3D&quot;This will refer thy&quot;=
,2=3D&quot;message to the&quot;,3=3D&quot;public channel.&quot;,4=3D&quot;One can use:&quot;,5=3D&quot;.pm (na=
me)(message)&quot;,6=3D&quot;to send a&quot;,7=3D&quot;private message to&quot;,8=3D&quot;&quot;,},},8=3D{numl=
ines=3D8,pagenum=3D8,lines=3D{1=3D&quot;another mortal,&quot;,2=3D&quot;which only can be =
read&quot;,3=3D&quot;by him or her. It&quot;,4=3D&quot;will arrive him or her&quot;,5=3D&quot;even if he =
or she is&quot;,6=3D&quot;not in our world&quot;,7=3D&quot;at the moment. It will&quot;,8=3D&quot;&quot;,},},9=
=3D{numlines=3D8,pagenum=3D9=3D0x09,lines=3D{1=3D&quot;be sent to him or her&quot;,2=
=3D&quot;as soon as he visits&quot;,3=3D&quot;our world the next time.&quot;,4=3D&quot;If thee can g=
ather the&quot;,5=3D&quot;pleasure to join a guild&quot;,6=3D&quot;someday, thee can send &quot;,7=
=3D&quot;them a message with the&quot;,8=3D&quot;&quot;,},},10=3D{numlines=3D8,pagenum=3D10=3D0=
x0a,lines=3D{1=3D&quot;following command:&quot;,2=3D&quot;.g (message).&quot;,3=3D&quot;This message=
 can only&quot;,4=3D&quot;be read by thy&quot;,5=3D&quot;guildmates.&quot;,6=3D&quot;There are several ot=
her&quot;,7=3D&quot;commands availabe,&quot;,8=3D&quot;&quot;,},},11=3D{numlines=3D8,pagenum=3D11=3D=
0x0b,lines=3D{1=3D&quot;which can be shown by&quot;,2=3D&quot;typing .help.&quot;,3=3D&quot;If thee =
has any further.&quot;,4=3D&quot;questions, don't hesitate&quot;,5=3D&quot;to ask our gods,&quot;,6=
=3D&quot;as they surely will&quot;,7=3D&quot;grant you as much help&quot;,8=3D&quot;&quot;,},},12=3D{numl=
ines=3D8,pagenum=3D12=3D0x0c,lines=3D{1=3D&quot;they can give.&quot;,2=3D&quot;&quot;,3=3D&quot;Last=
 we want to add&quot;,4=3D&quot;the following rules:&quot;,5=3D&quot;Bugusing is not allowed&quot;,6=
=3D&quot;and won't be tolerated.&quot;,7=3D&quot;If thy find a bug,&quot;,8=3D&quot;&quot;,},},13=3D{numl=
ines=3D8,pagenum=3D13=3D0x0d,lines=3D{1=3D&quot;make sure to report&quot;,2=3D&quot;it as =
soon as possible&quot;,3=3D&quot;to us. Bugusing will be&quot;,4=3D&quot;punished with a ban.&quot;,=
5=3D&quot;We'd like to add something&quot;,6=3D&quot;to the choice of your name:&quot;,7=3D&quot;dis=
criminatory or&quot;,8=3D&quot;&quot;,},},14=3D{numlines=3D8,pagenum=3D14=3D0x0e,lines=3D{=
1=3D&quot;racialist names,&quot;,2=3D&quot;as well as names &quot;,3=3D&quot;from the third reich &quot;,=
4=3D&quot;will be deleted immediately&quot;,5=3D&quot;and be banned.&quot;,6=3D&quot;&quot;,7=3D&quot;&quot;,8=3D&quot;&quot;=
,},},15=3D{numlines=3D8,pagenum=3D15=3D0x0f,lines=3D{1=3D&quot;&quot;,2=3D&quot;&quot;,3=3D&quot;&quot;,4=
=3D&quot;&quot;,5=3D&quot;Signed:&quot;,6=3D&quot;The staff of&quot;,7=3D&quot;Vetus Mundus&quot;,8=3D&quot;&quot;,},},},}
-	=

 	=

 	=

 	=

@@ -93,9 +90,63 @@
 	end
 	=

 	if (book.dialog and book.dialog:IsAlive()) then book.dialog:Destroy() end
-	print(&quot;#### book : &quot;,text)
-	--~ book.dialog =3D  TODOOOOO
+	--~ print(&quot;#### book : &quot;,text)
+	book.plaintext =3D text
+	book.dialog =3D GetDesktopWidget():CreateChild(&quot;UOBookDialog&quot;,book)
 end
 =

--- UOBookDialog
+-- ***** ***** ***** ***** ***** UOBookDialog widget
 =

+function UOBookTest ()
+	Load_Font() -- iris specific
+	local book =3D {}
+	book.header =3D {author=3D&quot;Staff of Vetus-Mundus&quot;,authorlen=3D22,title=3D=
&quot;a small introduction&quot;,unknown=3D1,numpages=3D15,writable=3D0,serial=3D0x40=
40c1ce,titlelen=3D21,}
+	book.pagedata =3D {numpages=3D15,serial=3D0x4040c1ce,pages=3D{
+		{numlines=3D8,pagenum=3D1,lines=3D{&quot;We welcome thee&quot;,&quot;traveler&quot;,&quot;&quot;,&quot;we'r=
e glad to see&quot;,&quot;thy journey led&quot;,&quot;thee to Vetus Mundus&quot;,&quot;The gods of this&quot;,=
&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D2,lines=3D{&quot;world will not bother&quot;,&quot;with much ru=
les,&quot;,&quot;nonetheless&quot;,&quot;there's something to&quot;,&quot;follow here.&quot;,&quot;Rules are as lis=
tened:&quot;,&quot;'One can do whatever&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D3,lines=3D{&quot;provides fun. Note,&quot;,&quot;that PvP is on=
ly&quot;,&quot;possible on the facette&quot;,&quot;called felucca.&quot;,&quot;The second rule is:&quot;,&quot;'We =
all treat each other&quot;,&quot;with respect', the gods&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D4,lines=3D{&quot;don't wish to hear&quot;,&quot;excessive slang=
, nor&quot;,&quot;any indignities&quot;,&quot;from the mortal&quot;,&quot;or speaking to&quot;,&quot;oneself. Dost =
you wish&quot;,&quot;to live peacefully&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D5,lines=3D{&quot;here on Vetus Mundus, &quot;,&quot;it's indisp=
ensable&quot;,&quot;to follow this rule.&quot;,&quot;&quot;,&quot;To make thy beginning&quot;,&quot;as comfortable =
as possible,&quot;,&quot;we will grant thee some&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D6,lines=3D{&quot;commands. Listen carefully.&quot;,&quot;To com=
municate with other&quot;,&quot;mortal in the public&quot;,&quot;Channel, one has to use&quot;,&quot;the =
following&quot;,&quot;Combination:&quot;,&quot;.c (thy message)&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D7,lines=3D{&quot;This will refer thy&quot;,&quot;message to the=
&quot;,&quot;public channel.&quot;,&quot;One can use:&quot;,&quot;.pm (name)(message)&quot;,&quot;to send a&quot;,&quot;priva=
te message to&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D8,lines=3D{&quot;another mortal,&quot;,&quot;which only can be =
read&quot;,&quot;by him or her. It&quot;,&quot;will arrive him or her&quot;,&quot;even if he or she is&quot;,&quot;=
not in our world&quot;,&quot;at the moment. It will&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D9,lines=3D{&quot;be sent to him or her&quot;,&quot;as soon as h=
e visits&quot;,&quot;our world the next time.&quot;,&quot;If thee can gather the&quot;,&quot;pleasure to =
join a guild&quot;,&quot;someday, thee can send &quot;,&quot;them a message with the&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D10,lines=3D{&quot;following command:&quot;,&quot;.g (message).&quot;=
,&quot;This message can only&quot;,&quot;be read by thy&quot;,&quot;guildmates.&quot;,&quot;There are several =
other&quot;,&quot;commands availabe,&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D11,lines=3D{&quot;which can be shown by&quot;,&quot;typing .hel=
p.&quot;,&quot;If thee has any further.&quot;,&quot;questions, don't hesitate&quot;,&quot;to ask our gods=
,&quot;,&quot;as they surely will&quot;,&quot;grant you as much help&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D12,lines=3D{&quot;they can give.&quot;,&quot;&quot;,&quot;Last we want to=
 add&quot;,&quot;the following rules:&quot;,&quot;Bugusing is not allowed&quot;,&quot;and won't be tolera=
ted.&quot;,&quot;If thy find a bug,&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D13,lines=3D{&quot;make sure to report&quot;,&quot;it as soon as=
 possible&quot;,&quot;to us. Bugusing will be&quot;,&quot;punished with a ban.&quot;,&quot;We'd like to a=
dd something&quot;,&quot;to the choice of your name:&quot;,&quot;discriminatory or&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D14,lines=3D{&quot;racialist names,&quot;,&quot;as well as names=
 &quot;,&quot;from the third reich &quot;,&quot;will be deleted immediately&quot;,&quot;and be banned.&quot;,&quot;=
&quot;,&quot;&quot;,&quot;&quot;,},},
+		{numlines=3D8,pagenum=3D15,lines=3D{&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;Signed:&quot;,&quot;The staff of&quot;=
,&quot;Vetus Mundus&quot;,&quot;&quot;,},},
+		},}                                   =

+	--~ print(&quot;######&quot;,SmartDump(book,4))
+	UpdateBookDialog(book) =

+end
+										=

+function gWidgetPrototype.UOBookDialog:Init (parentwidget,params)
+	local bVertexBufferDynamic,bVertexCol =3D false,true
+	=

+	local bw,bh =3D 200,100
+	local texname,w,h,xoff,yoff =3D &quot;simplebutton.png&quot;,bw,bh,0,0
+	local u0,v0,w0,w1,w2,h0,h1,h2, tcx,tcy =3D 0,0, 4,8,4, 4,8,4, 32,32
+	params.gfxparam_init =3D MakeSpritePanelParam_BorderPartMatrix(GetPlainTe=
xtureGUIMat(texname),w,h,xoff,yoff, u0,v0,w0,w1,w2,h0,h1,h2, tcx,tcy, 1,1, =
false, false)
+
+	self:InitAsSpritePanel(parentwidget,params,bVertexBufferDynamic,bVertexCo=
l)
+	=

+	--~ local txt =3D self:CreateChild(&quot;UOHuePickerButton&quot;,{x=3Dx*10,y=3Dy*10=
,hue=3Dhue,gfxparam_init=3Dgfxparam_init})
+	=

+	self.maintext =3D self:CreateChild(&quot;UOText&quot;,{x=3D0,y=3D0,text=3Dparams.pl=
aintext,col=3D{r=3D0,g=3D0,b=3D0},bold=3Dfalse})
+	--~ self.gfx_maintarget_line =3D gRootWidget.tooltip:CreateChild(&quot;LineLis=
t&quot;,{matname=3D&quot;BaseWhiteNoLighting&quot;,bDynamic=3Dtrue,r=3D1,g=3D0,b=3D0})
+	=

+	local e =3D 4
+	local l,t,r,b =3D self.maintext:GetRelBounds()
+	params.gfxparam_init.w =3D e+e+r-l
+	params.gfxparam_init.h =3D e+e+b-t
+	params.gfxparam_init.xoff =3D l-e
+	params.gfxparam_init.yoff =3D t-e
+	self.spritepanel:Update(params.gfxparam_init) -- adjust base geometry
+	=

+	self:SetPos(200,100)
+end
+
+function gWidgetPrototype.UOBookDialog:on_mouse_left_down	() self:BringToF=
ront() self:StartMouseMove() end
+function gWidgetPrototype.UOBookDialog:on_mouse_right_down	() self:Destroy=
() end


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001551.html">[Iris-commit] [IRIS] r2747 - in /trunk/lua: lib.2d.dynamic.lua	lib.book.lua main.lua
</A></li>
	<LI>Next message: <A HREF="001553.html">[Iris-commit] [IRIS] r2749 - in /trunk: lua/gui/gui.healthbar.lua lua/lib.macrolist.lua lua/lib.mousepick.lua lua/lib.namegumps.lua lua/lib.uotooltip.lua lua/main.lua lua/widgets/widget.uotooltip.lua plugins/itemcounter.lua plugins/moblist.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1552">[ date ]</a>
              <a href="thread.html#1552">[ thread ]</a>
              <a href="subject.html#1552">[ subject ]</a>
              <a href="author.html#1552">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
