<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r2410 - in /trunk/lua: gui/gui.gumpparser.lua lib.gump.samples.lua widgets/widget.uotext.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2008-August/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r2410%20-%20in%20/trunk/lua%3A%20gui/gui.gumpparser.lua%0A%20lib.gump.samples.lua%20widgets/widget.uotext.lua&In-Reply-To=%3C20080826220009.81D7D1C1863F%40zwischenwelt.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001214.html">
   <LINK REL="Next"  HREF="001216.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r2410 - in /trunk/lua: gui/gui.gumpparser.lua lib.gump.samples.lua widgets/widget.uotext.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r2410%20-%20in%20/trunk/lua%3A%20gui/gui.gumpparser.lua%0A%20lib.gump.samples.lua%20widgets/widget.uotext.lua&In-Reply-To=%3C20080826220009.81D7D1C1863F%40zwischenwelt.org%3E"
       TITLE="[Iris-commit] [IRIS] r2410 - in /trunk/lua: gui/gui.gumpparser.lua lib.gump.samples.lua widgets/widget.uotext.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Tue Aug 26 23:45:08 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001214.html">[Iris-commit] [IRIS] r2409 - in /trunk: lua/ lua/widgets/ widgets/
</A></li>
        <LI>Next message: <A HREF="001216.html">[Iris-commit] [IRIS] r2411 - in /trunk/lua: gui/gui.gumpparser.lua	net/net.partysystem.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1215">[ date ]</a>
              <a href="thread.html#1215">[ thread ]</a>
              <a href="subject.html#1215">[ subject ]</a>
              <a href="author.html#1215">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ghoulsblade
Date: Tue Aug 26 23:45:08 2008
New Revision: 2410

Log:
gumps:croppedtext : bold off when hue=3D0.  uotext : fixed clipping

Modified:
    trunk/lua/gui/gui.gumpparser.lua
    trunk/lua/lib.gump.samples.lua
    trunk/lua/widgets/widget.uotext.lua

Modified: trunk/lua/gui/gui.gumpparser.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.gumpparser.lua (original)
+++ trunk/lua/gui/gui.gumpparser.lua Tue Aug 26 23:45:08 2008
@@ -15,7 +15,7 @@
 	return GumpParser_Old(Gumpdata, Clientsidemode)
 end
 =

-kGumpParser_DebugDump =3D false
+kGumpParser_DebugDump =3D true
 =

 function GumpParserTest ()
 	Client_RenderOneFrame() -- first frame rendered with ogre, needed for ini=
t of viewport size
@@ -41,11 +41,12 @@
 	]]--
 	--~ local testgump,x,y,kDebugName =3D kGumpSample_ChangeLog,400,00.&quot;kGump=
Sample_ChangeLog&quot;
 	--~ local testgump,x,y,kDebugName =3D kGumpSample_ChangeLog_Text,400,0,&quot;k=
GumpSample_ChangeLog_Text&quot;
-	--~ local testgump,x,y,kDebugName =3D kGumpSample_RuneBook,0,240,&quot;kGumpSa=
mple_RuneBook&quot;
+	local testgump,x,y,kDebugName =3D kGumpSample_RuneBook,0,240,&quot;kGumpSample=
_RuneBook&quot;
+	--~ local testgump,x,y,kDebugName =3D kGumpSample_RuneBook3,0,240,&quot;kGumpS=
ample_RuneBook&quot;
 	--~ local testgump,x,y,kDebugName =3D kGumpSample_Reward,0,140,&quot;kGumpSamp=
le_Reward&quot;
-	local testgump,x,y,kDebugName =3D kGumpSample_MoongateMenu,0,140,&quot;kGumpSa=
mple_MoongateMenu&quot;
+	--~ local testgump,x,y,kDebugName =3D kGumpSample_MoongateMenu,0,140,&quot;kGu=
mpSample_MoongateMenu&quot;
 	local profiler =3D MakeProfiler(&quot;gumpparser&quot;)
-	if (1 =3D=3D 2) then
+	if (1 =3D=3D 1) then
 		profiler:StartSection(&quot;font:preload&quot;)
 		GetUOFont(gUniFontLoaderList[1],true):PreLoad()
 		GetUOFont(gUniFontLoaderList[1],false):PreLoad()
@@ -71,20 +72,22 @@
 		HealthBarSetWarMode()
 	end
 	=

-	local testgump,x,y,kDebugName =3D kGumpSample_PM,0,300,&quot;bla&quot;
-	local d2 =3D GumpParser_New(testgump,false) -- d2:SetPos(x,y) d2.sDebugNa=
me =3D kDebugName
-	=

-	local container =3D {serial=3D1234,gumpid=3D60,content=3D{
-			{serial=3D1001,artid=3D9625,xloc=3D61,yloc=3D104,hue=3D0,amount=3D1,use=
gump=3Dfalse},
-			{serial=3D1002,artid=3D3982,xloc=3D51,yloc=3D65,hue=3D0,amount=3D38,use=
gump=3Dfalse},
-			{serial=3D1003,artid=3D3965,xloc=3D135,yloc=3D87,hue=3D0,amount=3D22,us=
egump=3Dfalse},
-			{serial=3D1004,artid=3D3965,xloc=3D87,yloc=3D75,hue=3D0,amount=3D16,use=
gump=3Dfalse},
-			{serial=3D1005,artid=3D8901,xloc=3D83,yloc=3D102,hue=3D1121,amount=3D1,=
usegump=3Dfalse},
-			{serial=3D1006,artid=3D3983,xloc=3D86,yloc=3D102,hue=3D0,amount=3D38,us=
egump=3Dfalse},
-			{serial=3D1007,artid=3D8787,xloc=3D110,yloc=3D95,hue=3D2406,amount=3D1,=
usegump=3Dfalse},
-		},GetContent=3Dfunction (self) return self.content end}
-
-	local containerdialog =3D CreateUOContainerDialog(container)
+	if (2 =3D=3D 1) then
+		local testgump,x,y,kDebugName =3D kGumpSample_PM,0,300,&quot;bla&quot;
+		local d2 =3D GumpParser_New(testgump,false) -- d2:SetPos(x,y) d2.sDebugN=
ame =3D kDebugName
+		=

+		local container =3D {serial=3D1234,gumpid=3D60,content=3D{
+				{serial=3D1001,artid=3D9625,xloc=3D61,yloc=3D104,hue=3D0,amount=3D1,us=
egump=3Dfalse},
+				{serial=3D1002,artid=3D3982,xloc=3D51,yloc=3D65,hue=3D0,amount=3D38,us=
egump=3Dfalse},
+				{serial=3D1003,artid=3D3965,xloc=3D135,yloc=3D87,hue=3D0,amount=3D22,u=
segump=3Dfalse},
+				{serial=3D1004,artid=3D3965,xloc=3D87,yloc=3D75,hue=3D0,amount=3D16,us=
egump=3Dfalse},
+				{serial=3D1005,artid=3D8901,xloc=3D83,yloc=3D102,hue=3D1121,amount=3D1=
,usegump=3Dfalse},
+				{serial=3D1006,artid=3D3983,xloc=3D86,yloc=3D102,hue=3D0,amount=3D38,u=
segump=3Dfalse},
+				{serial=3D1007,artid=3D8787,xloc=3D110,yloc=3D95,hue=3D2406,amount=3D1=
,usegump=3Dfalse},
+			},GetContent=3Dfunction (self) return self.content end}
+
+		local containerdialog =3D CreateUOContainerDialog(container)
+	end
 	=

 	--~ local dialog =3D GumpParser_New(kClientSideGump_Paperdoll_Own,true) d=
ialog:SetLeftTop(400,100)
 	--~ GumpParser(kClientSideGump_Paperdoll_Own,true)
@@ -188,7 +191,7 @@
 kGumpParser_CommandTypes[&quot;page&quot;]				=3D {paramformat=3D&quot;pagenum&quot;}
 kGumpParser_CommandTypes[&quot;xmfhtmlgump&quot;]			=3D {paramformat=3D&quot;x,y,width,he=
ight,cliloc_id,background,scrollbar,[ctrlname]&quot;,paramadd=3D{default_black=
=3Dtrue,html=3Dtrue}} =

 kGumpParser_CommandTypes[&quot;xmfhtmlgumpcolor&quot;]	=3D {paramformat=3D&quot;x,y,width=
,height,cliloc_id,background,scrollbar,hue,[ctrlname]&quot;,paramadd=3D{html=3Dt=
rue}}
-kGumpParser_CommandTypes[&quot;croppedtext&quot;]			=3D {paramformat=3D&quot;x,y,width,he=
ight,hue,textline_id,[ctrlname]&quot;,paramadd=3D{bold=3Dtrue,crop=3Dtrue}}
+kGumpParser_CommandTypes[&quot;croppedtext&quot;]			=3D {paramformat=3D&quot;x,y,width,he=
ight,hue,textline_id,[ctrlname]&quot;,paramadd=3D{crop=3Dtrue}}
 kGumpParser_CommandTypes[&quot;htmlgump&quot;]			=3D {paramformat=3D&quot;x,y,width,heigh=
t,textline_id,background,scrollbar,[ctrlname]&quot;,paramadd=3D{default_black=3D=
true,html=3Dtrue}} =

 kGumpParser_CommandTypes[&quot;text&quot;]				=3D {paramformat=3D&quot;x,y,hue,textline_i=
d,[ctrlname]&quot;,paramadd=3D{bold=3Dfalse,default_black=3Dtrue}}
 kGumpParser_CommandTypes[&quot;tooltip&quot;]				=3D {paramformat=3D&quot;cliloc_id,[ctrl=
name]&quot;}
@@ -302,8 +305,9 @@
 		-- croppedtext &lt;x&gt; &lt;y&gt; &lt;width&gt; &lt;height&gt; &lt;hue&gt; &lt;textline_id&gt;
 		-- Description:  Adds a text field to the gump. This is similar to the t=
ext command,
 		-- but the text is cropped to the defined area.
-		-- text is automatically bold/outlined
+		-- text is automatically bold/outlined  if hue &gt; 0 (runebook)
 		elseif (command =3D=3D &quot;croppedtext&quot;) then
+			if (param.hue &gt; 0) then param.bold =3D true end
 			widget =3D parent:CreateChild(&quot;UOText&quot;,param,Gumpdata.textline_unicode =
or Gumpdata.textline)
 			=

 		--HtmlGump &lt;x&gt; &lt;y&gt; &lt;width&gt; &lt;height&gt; &lt;textline_id&gt; &lt;background&gt; &lt;scrollba=
r&gt;

Modified: trunk/lua/lib.gump.samples.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gump.samples.lua (original)
+++ trunk/lua/lib.gump.samples.lua Tue Aug 26 23:45:08 2008
@@ -149,6 +149,24 @@
 		[0]=3D{48,},
 		},
 }
+
+
+kGumpSample_RuneBook3 =3D {
+	Data=3D&quot;{ page 0 }{ gumppic 100 10 2201 }{ gumppic 125 50 57 }{ gumppic 1=
45 50 58 }{ gumppic 160 50 58 }{ gumppic 175 50 58 }{ gumppic 190 50 58 }{ =
gumppic 205 50 58 }{ gumppic 220 50 58 }{ gumppic 230 50 59 }{ gumppic 290 =
50 57 }{ gumppic 310 50 58 }{ gumppic 325 50 58 }{ gumppic 340 50 58 }{ gum=
ppic 355 50 58 }{ gumppic 370 50 58 }{ gumppic 385 50 58 }{ gumppic 395 50 =
59 }{ button 130 187 2225 2225 0 2 0 }{ button 165 187 2226 2226 0 3 0 }{ b=
utton 200 187 2227 2227 0 4 0 }{ button 235 187 2228 2228 0 5 0 }{ button 3=
00 187 2229 2229 0 6 0 }{ button 335 187 2230 2230 0 7 0 }{ button 370 187 =
2231 2231 0 8 0 }{ button 405 187 2232 2232 0 9 0 }{ xmfhtmlgump 140 40 80 =
18 1011296 0 0 }{ htmlgump 220 40 30 18 0 0 0 }{ xmfhtmlgump 300 40 100 18 =
1011297 0 0 }{ htmlgump 400 40 30 18 1 0 0 }{ page 1 }{ button 125 15 2472 =
2473 1 0 1 }{ xmfhtmlgump 158 22 100 18 1011299 0 0 }{ button 130 65 2103 2=
104 1 0 2 }{ croppedtext 145 60 115 17 0 2 }{ button 130 80 2103 2104 1 0 8=
 }{ croppedtext 145 75 115 17 0 2 }{ button 130 95 2103 2104 1 0 14 }{ crop=
pedtext 145 90 115 17 0 2 }{ button 130 110 2103 2104 1 0 20 }{ croppedtext=
 145 105 115 17 0 2 }{ button 130 125 2103 2104 1 0 26 }{ croppedtext 145 1=
20 115 17 0 2 }{ button 130 140 2103 2104 1 0 32 }{ croppedtext 145 135 115=
 17 0 2 }{ button 130 155 2103 2104 1 0 38 }{ croppedtext 145 150 115 17 0 =
2 }{ button 130 170 2103 2104 1 0 44 }{ croppedtext 145 165 115 17 0 2 }{ b=
utton 290 65 2103 2104 1 0 50 }{ croppedtext 305 60 115 17 0 2 }{ button 29=
0 80 2103 2104 1 0 56 }{ croppedtext 305 75 115 17 0 2 }{ button 290 95 210=
3 2104 1 0 62 }{ croppedtext 305 90 115 17 0 2 }{ button 290 110 2103 2104 =
1 0 68 }{ croppedtext 305 105 115 17 0 2 }{ button 290 125 2103 2104 1 0 74=
 }{ croppedtext 305 120 115 17 0 2 }{ button 290 140 2103 2104 1 0 80 }{ cr=
oppedtext 305 135 115 17 0 2 }{ button 290 155 2103 2104 1 0 86 }{ croppedt=
ext 305 150 115 17 0 2 }{ button 290 170 2103 2104 1 0 92 }{ croppedtext 30=
5 165 115 17 0 2 }{ button 393 14 2206 2206 0 2 0 }{ page 2 }{ button 125 1=
4 2205 2205 0 1 0 }{ button 393 14 2206 2206 0 3 0 }{ button 130 65 2103 21=
04 1 0 2 }{ croppedtext 145 60 115 17 0 2 }{ button 290 65 2103 2104 1 0 8 =
}{ croppedtext 305 60 115 17 0 2 }{ page 3 }{ button 125 14 2205 2205 0 2 0=
 }{ button 393 14 2206 2206 0 4 0 }{ button 130 65 2103 2104 1 0 14 }{ crop=
pedtext 145 60 115 17 0 2 }{ button 290 65 2103 2104 1 0 20 }{ croppedtext =
305 60 115 17 0 2 }{ page 4 }{ button 125 14 2205 2205 0 3 0 }{ button 393 =
14 2206 2206 0 5 0 }{ button 130 65 2103 2104 1 0 26 }{ croppedtext 145 60 =
115 17 0 2 }{ button 290 65 2103 2104 1 0 32 }{ croppedtext 305 60 115 17 0=
 2 }{ page 5 }{ button 125 14 2205 2205 0 4 0 }{ button 393 14 2206 2206 0 =
6 0 }{ button 130 65 2103 2104 1 0 38 }{ croppedtext 145 60 115 17 0 2 }{ b=
utton 290 65 2103 2104 1 0 44 }{ croppedtext 305 60 115 17 0 2 }{ page 6 }{=
 button 125 14 2205 2205 0 5 0 }{ button 393 14 2206 2206 0 7 0 }{ button 1=
30 65 2103 2104 1 0 50 }{ croppedtext 145 60 115 17 0 2 }{ button 290 65 21=
03 2104 1 0 56 }{ croppedtext 305 60 115 17 0 2 }{ page 7 }{ button 125 14 =
2205 2205 0 6 0 }{ button 393 14 2206 2206 0 8 0 }{ button 130 65 2103 2104=
 1 0 62 }{ croppedtext 145 60 115 17 0 2 }{ button 290 65 2103 2104 1 0 68 =
}{ croppedtext 305 60 115 17 0 2 }{ page 8 }{ button 125 14 2205 2205 0 7 0=
 }{ button 393 14 2206 2206 0 9 0 }{ button 130 65 2103 2104 1 0 74 }{ crop=
pedtext 145 60 115 17 0 2 }{ button 290 65 2103 2104 1 0 80 }{ croppedtext =
305 60 115 17 0 2 }{ page 9 }{ button 125 14 2205 2205 0 8 0 }{ button 130 =
65 2103 2104 1 0 86 }{ croppedtext 145 60 115 17 0 2 }{ button 290 65 2103 =
2104 1 0 92 }{ croppedtext 305 60 115 17 0 2 }&quot;,
+
+	textline=3D{
+	[1]=3D&quot;10&quot;,
+	[2]=3D&quot;Empty&quot;,
+	[0]=3D&quot;0&quot;,
+	},
+	textline_unicode=3D{
+	[1]=3D{49,48,},
+	[2]=3D{69,109,112,116,121,},
+	[0]=3D{48,},
+	},
+}
+	=

+	=

 	=

 	=

 kGumpSample_Reward =3D {

Modified: trunk/lua/widgets/widget.uotext.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/widgets/widget.uotext.lua (original)
+++ trunk/lua/widgets/widget.uotext.lua Tue Aug 26 23:45:08 2008
@@ -35,7 +35,7 @@
 	--~ if (params.width) then local l,t,r,b =3D self:GetRelBounds() self:Set=
Clip(0,0,params.width,params.height) end
 	=

 	local w,h =3D params.width,params.height
-	if (w) then local l,t,r,b =3D self:GetRelBounds() self:SetClip(l-xoff,t-y=
off,l-xoff+w,t-yoff+h) end
+	if (w) then local l,t,r,b =3D self:GetRelBounds() self:SetClip(l,t,l+w,t+=
h) end
 end
 =

 -- TODO : uohtml might be an array of ints for unicode (textline) instead =
of text (no html then)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001214.html">[Iris-commit] [IRIS] r2409 - in /trunk: lua/ lua/widgets/ widgets/
</A></li>
	<LI>Next message: <A HREF="001216.html">[Iris-commit] [IRIS] r2411 - in /trunk/lua: gui/gui.gumpparser.lua	net/net.partysystem.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1215">[ date ]</a>
              <a href="thread.html#1215">[ thread ]</a>
              <a href="subject.html#1215">[ subject ]</a>
              <a href="author.html#1215">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
