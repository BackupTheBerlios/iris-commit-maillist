<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r3414 - in /trunk/lua: ./ profiles/
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2011-November/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3414%20-%20in%20/trunk/lua%3A%20./%20profiles/&In-Reply-To=%3C20111128131932.9E1227A9855F%40simon%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002152.html">
   <LINK REL="Next"  HREF="002154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r3414 - in /trunk/lua: ./ profiles/</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3414%20-%20in%20/trunk/lua%3A%20./%20profiles/&In-Reply-To=%3C20111128131932.9E1227A9855F%40simon%3E"
       TITLE="[Iris-commit] [IRIS] r3414 - in /trunk/lua: ./ profiles/">no-reply at zwischenwelt.org
       </A><BR>
    <I>Mon Nov 28 14:19:30 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002152.html">[Iris-commit] [IRIS] r3413 - in /trunk: data/custom/ data/customchars/ data/grannys/ data/mobiles/ data/mobiles_custom/ data/models/ data/tiles/ data/tiles_custom/ lua/ lua/profiles/
</A></li>
        <LI>Next message: <A HREF="002154.html">[Iris-commit] [IRIS] r3415 - in /trunk/lua: lib.debugmenu.lua	lib.mainmenu.charcreate.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2153">[ date ]</a>
              <a href="thread.html#2153">[ thread ]</a>
              <a href="subject.html#2153">[ subject ]</a>
              <a href="author.html#2153">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sience
Date: Mon Nov 28 14:19:27 2011
New Revision: 3414

Log:
-all Folders consolidated in main.lua
-from now on please use this gobal variables and if you add an new folder, =
please add it in main.lua
-gfx ultra setting, shadows fixed

Modified:
    trunk/lua/config_declarations.lua
    trunk/lua/lib.compass.lua
    trunk/lua/lib.configdialog.lua
    trunk/lua/lib.debugmenu.lua
    trunk/lua/lib.desktop.lua
    trunk/lua/lib.devtool.lua
    trunk/lua/lib.fallback.lua
    trunk/lua/lib.loading.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/lib.packetvideo.lua
    trunk/lua/lib.static.lua
    trunk/lua/main.lua
    trunk/lua/profiles/gfx_ultrahigh.lua

Modified: trunk/lua/config_declarations.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/config_declarations.lua (original)
+++ trunk/lua/config_declarations.lua Mon Nov 28 14:19:27 2011
@@ -250,7 +250,7 @@
 =

 gConfig:DeclareString(&quot;gLanguage&quot;, &quot;client&quot;, &quot;language&quot;, 'used for client =
localization', &quot;ENU&quot;)
 =

-gConfig:DeclareBoolean(&quot;gDumpMissingModels&quot;, &quot;debug&quot;, &quot;dump missing models=
&quot;, 'used to dump images of the missing models into a missing folder in the =
bin directory, you need to create the directory manually', false)
+gConfig:DeclareBoolean(&quot;gDumpMissingModels&quot;, &quot;debug&quot;, &quot;dump missing models=
&quot;, 'used to dump images of the missing meshes/models into a missing folder =
in the bin directory, you need to create the directory manually', false)
 =

 ------------------------------ UO Files --------------------------
 gHuesFile		=3D &quot;hues.mul&quot;

Modified: trunk/lua/lib.compass.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.compass.lua (original)
+++ trunk/lua/lib.compass.lua Mon Nov 28 14:19:27 2011
@@ -73,10 +73,10 @@
         end
     end
     gPositionMarkers =3D {}
-    LoadUOAutomapFiles(gUOAMDir, gPositionMarkers)
-end
-
-LoadUOAutomapFiles(gUOAMDir, gPositionMarkers)
+    LoadUOAutomapFiles(gUoamPath, gPositionMarkers)
+end
+
+LoadUOAutomapFiles(gUoamPath, gPositionMarkers)
 =

 function SetPositionMarker(mapindex,name,xloc,yloc,r,g,b,a)
     if not mapindex or not name or not xloc or not yloc then return end

Modified: trunk/lua/lib.configdialog.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.configdialog.lua (original)
+++ trunk/lua/lib.configdialog.lua Mon Nov 28 14:19:27 2011
@@ -214,7 +214,7 @@
 =

 function ConfigDialogPage_PacketVideo(page)
     page:AddChild(&quot;Button&quot;,{label=3D&quot;Play Iris PacketVideo (*.ipv)&quot;,on_but=
ton_click=3Dfunction ()  =

-            if (PacketVideo_Load(FileOpenDialog(gPacketVideoFileName_folde=
rpath,&quot;*.ipv&quot;,&quot;select iris packetvideo&quot;))) then PacketVideo_Playback() end
+            if (PacketVideo_Load(FileOpenDialog(gPacketVideoPath,&quot;*.ipv&quot;,&quot;=
select iris packetvideo&quot;))) then PacketVideo_Playback() end
         end})
     page:AddChild(&quot;Button&quot;,{label=3D&quot;Play Razor PacketVideo (*.rpv)&quot;,on_bu=
tton_click=3Dfunction ()  =

             if (PacketVideo_LoadRarzorPV(FileOpenDialog(&quot;.&quot;,&quot;*.rpv&quot;,&quot;selec=
t razor packetvideo&quot;))) then PacketVideo_Playback() end

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Mon Nov 28 14:19:27 2011
@@ -927,8 +927,8 @@
         if (gCurDebugMode =3D=3D kDebugMode_Static) then
             if (gEnableSVNRemoveInStaticDebug) then -- BE CAREFUL WITH THA=
T !!!!  gEnableSVNRemoveInStaticDebug
                 local i =3D gDebugMenuModelIndex
-                os.execute(&quot;svn rm &quot; .. GetModelPath(i))
-                GuiAddChatLine(sprintf(&quot;SVN REMOVE 0x%04x(=3D%d) %s&quot;,i,i,G=
etModelPath(i)))
+                os.execute(&quot;svn rm &quot; .. GetMeshPath(i))
+                GuiAddChatLine(sprintf(&quot;SVN REMOVE 0x%04x(=3D%d) %s&quot;,i,i,G=
etMeshPath(i)))
             end =

         end =

         end end end)
@@ -947,7 +947,7 @@
         if (gCurDebugMode =3D=3D kDebugMode_Static) then
             local i =3D gDebugMenuModelIndex
             local notepath =3D &quot;debugstatic.txt&quot;
-            local text =3D sprintf(&quot;DebugStaticNOTE 0x%04x(=3D%d) %s %s&quot;,i=
,i,GetModelPath(i),GetStaticTileTypeName(i) or &quot;&quot;)
+            local text =3D sprintf(&quot;DebugStaticNOTE 0x%04x(=3D%d) %s %s&quot;,i=
,i,GetMeshPath(i),GetStaticTileTypeName(i) or &quot;&quot;)
             GuiAddChatLine(notepath..&quot;:&quot;..text)
             local f =3D io.open(notepath,&quot;a&quot;)
             f:write(text..&quot;\n&quot;)
@@ -967,9 +967,9 @@
 =

 function DebugDeleteModel   (id)
     local base =3D id - math.mod(id,1000) + 1000
-    local relpath  =3D sprintf(&quot;models/to_%06d/&quot;,base)
-    local mdlname =3D GetModelName(id)
-    local mdl =3D datapath..&quot;models/&quot;..relpath..mdlname
+    local relpath  =3D sprintf(&quot;to_%06d/&quot;,base)
+    local mdlname =3D GetMeshFileName(id)
+    local mdl =3D gDataTilesMeshesPath..relpath..mdlname
     =

     print(&quot;removing model: &quot;..mdl)
     =

@@ -985,9 +985,9 @@
     end
     =

     local base =3D id - math.mod(id,1000) + 1000
-    local relpath  =3D sprintf(&quot;models/to_%06d/&quot;,base)
-    local mdlname =3D GetModelName(id)
-    local mdl =3D datapath..&quot;models/&quot;..relpath..mdlname
+    local relpath  =3D sprintf(&quot;to_%06d/&quot;,base)
+    local mdlname =3D GetMeshFileName(id)
+    local mdl =3D gDataTilesMeshesPath..relpath..mdlname
     =

     if not file_exists(mdl) then
         print(&quot;model file not found&quot;)
@@ -1003,19 +1003,18 @@
     print(&quot;export model and textures&quot;,artid,&quot;to data/export&quot;)
 =

     local base =3D id - math.mod(id,1000) + 1000
-    local relpath  =3D sprintf(&quot;models/to_%06d/&quot;,base)
-    local mdlname =3D GetModelName(id)
-    local mdl =3D datapath..&quot;models/&quot;..relpath..mdlname
-    local export =3D datapath..&quot;export/&quot;
-    =

-    local xmlfile =3D export..mdlname..&quot;.xml&quot;
+    local relpath  =3D sprintf(&quot;to_%06d/&quot;,base)
+    local mdlname =3D GetMeshFileName(id)
+    local mdl =3D gDataTilesMeshesPath..relpath..mdlname
+    =

+    local xmlfile =3D gDataExportPath..mdlname..&quot;.xml&quot;
 =

     if not file_exists(mdl) then
         print(&quot;model file not found&quot;)
         return
     end
     =

-    local expmdl =3D export..mdlname
+    local expmdl =3D gDataExportPath..mdlname
 =

     -- try to rotate and adjust blender like, only possible if meshmagick =
is installed (unix)
     os.execute(&quot;cp '&quot;..mdl..&quot;' '&quot;..expmdl..&quot;'&quot;)
@@ -1033,16 +1032,16 @@
     end
 =

     -- copy material file
-    os.execute(&quot;cp '&quot;..datapath..&quot;models/materials/textures.material' '&quot;..=
datapath..&quot;export'&quot;)
+    os.execute(&quot;cp '&quot;..gDataTilesMaterialsPath..&quot;textures.material' '&quot;..gD=
ataPath..&quot;export'&quot;)
 =

     -- try to find used textures
     if file_exists(xmlfile) then
         for line in io.lines(xmlfile) do
             for name in string.gmatch(line, 'material=3D&quot;([^&quot;]+)&quot;') do
-                local texfile =3D datapath..&quot;models/textures/&quot;..name..&quot;.pn=
g&quot;
+                local texfile =3D gDataTilesTexturesPath .. name .. &quot;.png&quot;
                 if file_exists(texfile) then
-                    print(&quot;cp '&quot;..texfile..&quot;' '&quot;..export..&quot;'&quot;)
-                    os.execute(&quot;cp '&quot;..texfile..&quot;' '&quot;..export..&quot;'&quot;)
+                    print(&quot;cp '&quot;..texfile..&quot;' '&quot;..gDataExportPath..&quot;'&quot;)
+                    os.execute(&quot;cp '&quot;..texfile..&quot;' '&quot;..gDataExportPath..&quot;'=
&quot;)
                 end
             end
         end

Modified: trunk/lua/lib.desktop.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.desktop.lua (original)
+++ trunk/lua/lib.desktop.lua Mon Nov 28 14:19:27 2011
@@ -215,7 +215,7 @@
     gDesktop =3D {}
     gDesktopPositions =3D {}
     if file then
-        local path =3D gDesktopDir..file
+        local path =3D gDesktopPath..file
         if file_exists(path) then
             dofile(path)
             ReopenDesktop()
@@ -228,7 +228,7 @@
 	--~ print(&quot;#####SaveDesktop&quot;,debug.traceback())
     file =3D file or gDesktopFile
     if file then
-        local path =3D gDesktopDir..file
+        local path =3D gDesktopPath..file
         -- write to file
         local fp =3D io.open(path,&quot;w&quot;)
         if (fp) then

Modified: trunk/lua/lib.devtool.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.devtool.lua (original)
+++ trunk/lua/lib.devtool.lua Mon Nov 28 14:19:27 2011
@@ -2,8 +2,6 @@
 --[[ \brief
         contains some tools useful for development and debug
 ]]--
-
-gMeshTextureUsageFilePath =3D datapath..&quot;meshtextureusage.lua&quot;
 =

 function ShowDevTool ()
     MainMousePick()
@@ -71,7 +69,7 @@
             local gTileTypeEndID =3D gTileTypeLoader:GetEndID()
             print(&quot;gTileTypeEndID&quot;,gTileTypeEndID)
             for i =3D 0,gTileTypeEndID-1 do
-                local meshpath =3D GetModelPath(i)
+                local meshpath =3D GetMeshPath(i)
                 local texlist =3D meshpath and file_exists(meshpath) and O=
greMeshTextures(meshpath)
                 if (texlist) then for k,v in pairs(texlist) do
                     if (not gDevToolTexCache[v]) then gDevToolTexCache[v] =
=3D {} end
@@ -272,7 +270,7 @@
     local statics =3D ListStaticsNearPos(x,y,z,1)
     for k,entity in pairs(statics) do =

         local i =3D entity.iTileTypeID
-        local meshpath =3D GetModelPath(i)
+        local meshpath =3D GetMeshPath(i)
         local name =3D GetStaticTileTypeName(i) or &quot;unknown&quot;
         table.insert(rows,{ =

             {type=3D&quot;Button&quot;,text=3D&quot;#&quot;..i..&quot;: &quot;..name,onMouseDown=3Dfunct=
ion(widget) widget.dialog:Destroy() AdjustArtPositionControlDialog(i) end},
@@ -286,7 +284,7 @@
     for k,item in pairs(dynamics) do =

         print(&quot;DEBUG&quot;,k,item)
         local i =3D item.artid
-        local meshpath =3D GetModelPath(i)
+        local meshpath =3D GetMeshPath(i)
         local name =3D GetStaticTileTypeName(i) or &quot;unknown&quot;
         table.insert(rows,{ =

             {type=3D&quot;Button&quot;,text=3D&quot;#&quot;..i..&quot;: &quot;..name,onMouseDown=3Dfunct=
ion(widget) widget.dialog:Destroy() AdjustArtPositionControlDialog(i) end},
@@ -325,7 +323,7 @@
     local statics =3D ListStaticsNearPos(x,y,z,radius)
     for k,entity in pairs(statics) do =

         local i =3D entity.iTileTypeID
-        local meshpath =3D GetModelPath(i)
+        local meshpath =3D GetMeshPath(i)
         local texlist =3D meshpath and OgreMeshTextures(meshpath)
         local texlist =3D texlist and strjoin(&quot;\n&quot;,texlist) or &quot;&quot;
         table.insert(rows[2]    ,MakeUOArtImageForDialog(i,0,48,48))
@@ -336,7 +334,7 @@
     local dynamics =3D ListDynamicsNearPos(x,y,z,radius)
     for k,item in pairs(dynamics) do =

         local i =3D item.artid
-        local meshpath =3D GetModelPath(i)
+        local meshpath =3D GetMeshPath(i)
         local texlist =3D meshpath and OgreMeshTextures(meshpath)
         local texlist =3D texlist and strjoin(&quot;\n&quot;,texlist) or &quot;&quot;
         table.insert(rows[4]    ,MakeUOArtImageForDialog(i,0,48,48))
@@ -386,7 +384,7 @@
 end
 =

 function GetStaticMeshTextureListString (iTileTypeID) =

-    local path =3D GetModelPath(iTileTypeID)
+    local path =3D GetMeshPath(iTileTypeID)
     local t =3D path and OgreMeshTextures(path) -- datapath..&quot;models/model=
s/mesh/&quot;..meshname)
     return t and strjoin(&quot;,&quot;,t) or &quot;&quot;
 end

Modified: trunk/lua/lib.fallback.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.fallback.lua (original)
+++ trunk/lua/lib.fallback.lua Mon Nov 28 14:19:27 2011
@@ -1,6 +1,5 @@
 -- manages skiplists for fallbacks and the fallback tool
 =

-gSkippedFallBackFilePath =3D datapath..&quot;skippedfallbacks.lua&quot;
 gSkippedArtBillboardFallBacks =3D {}
 =

 function InitFallBacks  ()

Modified: trunk/lua/lib.loading.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.loading.lua (original)
+++ trunk/lua/lib.loading.lua Mon Nov 28 14:19:27 2011
@@ -59,18 +59,18 @@
     -- TODO move to config or automatic best choosing
     if gAtlasRes =3D=3D &quot;med&quot; then
         ---- med res
-        dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_med.lua&quot;)
-        dofile(datapath .. &quot;models/atlas/tex_atlas_med.lua&quot;)
+        dofile(gDataTilesAtlasPath .. &quot;tex_atlas_alpha_med.lua&quot;)
+        dofile(gDataTilesAtlasPath .. &quot;tex_atlas_med.lua&quot;)
         gUseTexAtlas =3D true     -- Lugre setting, only used if fastbatch=
 is active
     elseif gAtlasRes =3D=3D &quot;low&quot; then
         ---- low res
-        dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_low.lua&quot;)
-        dofile(datapath .. &quot;models/atlas/tex_atlas_low.lua&quot;)
+        dofile(gDataTilesAtlasPath .. &quot;tex_atlas_alpha_low.lua&quot;)
+        dofile(gDataTilesAtlasPath .. &quot;tex_atlas_low.lua&quot;)
         gUseTexAtlas =3D true     -- Lugre setting, only used if fastbatch=
 is active
     elseif gAtlasRes =3D=3D &quot;ultralow&quot; then
         ---- ultralow res
-        dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_ultralow.lua&quot;)
-        dofile(datapath .. &quot;models/atlas/tex_atlas_ultralow.lua&quot;)
+        dofile(gDataTilesAtlasPath .. &quot;tex_atlas_alpha_ultralow.lua&quot;)
+        dofile(gDataTilesAtlasPath .. &quot;tex_atlas_ultralow.lua&quot;)
         gUseTexAtlas =3D true     -- Lugre setting, only used if fastbatch=
 is active
     end
 end

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Mon Nov 28 14:19:27 2011
@@ -521,11 +521,11 @@
 function MacroCmd_ZoomCompass           (zoomfactor)    if (gInGameStarted=
) then ZoomCompass(zoomfactor) end end
 function MacroCmd_ActivateNextRenderer  ()              if (gInGameStarted=
) then ActivateNextRenderer() end end
 function MacroCmd_CamChangeZoom         (zoomadd)       if (gInGameStarted=
) then gCurrentRenderer:CamChangeZoom(zoomadd) end end
-function MacroCmd_Screenshot            ()              Client_TakeScreens=
hot(gScreenshotDir) end
+function MacroCmd_Screenshot            ()              Client_TakeScreens=
hot(gScreenshotPath) end
 function MacroCmd_GridScreenshot        ()          =

     if (not gInGameStarted) then return end
     ToggleCompass()
-    Client_TakeGridScreenshot(gScreenshotDir)
+    Client_TakeGridScreenshot(gScreenshotPath)
     ToggleCompass()
 end
 =


Modified: trunk/lua/lib.packetvideo.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.packetvideo.lua (original)
+++ trunk/lua/lib.packetvideo.lua Mon Nov 28 14:19:27 2011
@@ -29,7 +29,7 @@
 gPacketVideoNoPlaybackPackets[kPacket_Logout] =3D true -- logout
 --~ gPacketVideoNoPlaybackPackets[kPacket_Open_Container] =3D true  (if sk=
ipped, no containers won't be seen)
 =

-gPacketVideoFileName_prefix		=3D gPacketVideoFileName_folderpath..&quot;myvid.&quot;
+gPacketVideoFileName_prefix		=3D gPacketVideoPath..&quot;myvid.&quot;
 gPacketVideoFileName_postfix	=3D &quot;.ipv&quot;
 =

 =

@@ -230,7 +230,7 @@
 =

 function PacketVideo_Load	(filename)
 	if (not filename) then return false end
-	local filename2 =3D gPacketVideoFileName_folderpath .. filename
+	local filename2 =3D gPacketVideoPath .. filename
 	local filename3 =3D &quot;../&quot; .. filename
 	if (file_exists(filename2)) then filename =3D filename2 end
 	if (file_exists(filename3)) then filename =3D filename3 end

Modified: trunk/lua/lib.static.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.static.lua (original)
+++ trunk/lua/lib.static.lua Mon Nov 28 14:19:27 2011
@@ -1,48 +1,48 @@
--- used by lib.map.lua
--- handles static models (walls, trees...)
-
-
-gStaticFallbackAtlasBaseMaterial =3D &quot;staticfallbackatlas&quot;
-
-
-
--- returns the model name with the given id
+--[[ ***** see Iris2 COPYING for license info ***** ]]--
+--[[ \brief
+		handles static meshes (walls, trees...)
+		used by lib.map.lua
+]]--
+
+local staticFallbackAtlasBaseMaterial =3D &quot;staticfallbackatlas&quot;
+
+-- returns the mesh-filename with the given id
 -- TODO handle custom stuff?
-function GetModelName(id)
+local function GetMeshFileName(id)
 	return sprintf(&quot;mdl_%06d.mesh&quot;,id)
 end
 =

--- returns path to the model file, for importing
-gCustomModelCache =3D {}
-function GetModelPath(id) =

-	local cached =3D gCustomModelCache[id]
-	if (cached ~=3D nil) then print(&quot;Model already in gCustomModelCache&quot;) ret=
urn cached end
-
-	local custompath =3D datapath..&quot;custom/models/&quot;..GetModelName(id)
+-- returns path to the mesh-filename, for importing
+gCustomMeshCache =3D {}
+function GetMeshPath(id) =

+	local cached =3D gCustomMeshCache[id]
+	if (cached ~=3D nil) then print(&quot;Mesh already in gCustomMeshCache&quot;) retur=
n cached end
+
+	local custompath =3D gDataCustomTilesMeshesPath..GetMeshFileName(id)
 	if file_exists(custompath) then
-		gCustomModelCache[id] =3D custompath
+		gCustomMeshCache[id] =3D custompath
 		return custompath
 	end
 =

 	local base =3D id - math.mod(id,1000) + 1000
-	local relpath  =3D sprintf(&quot;models/to_%06d/&quot;,base)
-
-	local meshpath =3D datapath..&quot;models/&quot;..relpath..GetModelName(id)
+	local relpath  =3D sprintf(&quot;to_%06d/&quot;,base)
+
+	local meshpath =3D gDataTilesMeshesPath..relpath..GetMeshFileName(id)
 	if file_exists(meshpath) then
-		gCustomModelCache[id] =3D meshpath
+		gCustomMeshCache[id] =3D meshpath
 	else
-		gCustomModelCache[id] =3D false
+		gCustomMeshCache[id] =3D false
 		meshpath =3D nil
 	end
 	return meshpath
 end
 =

--- generates or retrieves meshname for static model
--- TODO : not flexible enough, what if model should be skipped, or multipl=
e models set ? or model depending on surrounding ?
+-- generates or retrieves meshname for a static
+-- TODO : not flexible enough, what if mesh should be skipped, or multiple=
 meshes set ? or mesh depending on surrounding ?
 -- TODO: remove hueing from her, not needed for fastbatch here
--- bDontGenerateFallback is used during preload to not generate uo art fal=
lback models
-gLegacyModelCache =3D {}
-gbModelIsFallback =3D {}
+-- bDontGenerateFallback is used during preload to not generate uo-art fal=
lback meshes
+gLegacyMeshCache =3D {}
+gbMeshIsFallback =3D {}
 function GetMeshName (iTileTypeID, iHue, bDontGenerateFallback)
 	--1st: Seasonal Translation
 	local iTranslatedTileTypeID =3D SeasonalStaticTranslation(iTileTypeID, gS=
easonSetting)
@@ -51,32 +51,32 @@
 	iTranslatedTileTypeID =3D FilterMesh(iTranslatedTileTypeID)
 =

 	local meshname =3D nil
-	meshname =3D gLegacyModelCache[iTranslatedTileTypeID]
+	meshname =3D gLegacyMeshCache[iTranslatedTileTypeID]
 	if (meshname =3D=3D nil) then
-		local modellocation =3D GetModelPath(iTranslatedTileTypeID) -- returns p=
ath including subfolders, also checks if custom model is available
-
-		if ( modellocation ~=3D nil ) then
-
-			meshname =3D GetModelName(iTranslatedTileTypeID) -- &quot;mdl_%06d.mesh&quot;, ju=
st number-to-string, no translation : =

+		local meshlocation =3D GetMeshPath(iTranslatedTileTypeID) -- returns pat=
h including subfolders, also checks if custom mesh is available
+
+		if ( meshlocation ~=3D nil ) then
+
+			meshname =3D GetMeshFileName(iTranslatedTileTypeID) -- &quot;mdl_%06d.mesh&quot;,=
 just number-to-string, no translation : =

 			-- load Mesh here
 			if ( OgreMeshAvailable(meshname) ) then
-				printdebug(&quot;static&quot;,&quot;Meshloader:&quot;,iTranslatedTileTypeID,meshname)
+				printdebug(&quot;static&quot;,&quot;Meshloader:&quot;, iTranslatedTileTypeID, meshlocation)
 				=

 				-- apply overrides, like cloning the mesh to change material (2011-11 =
floortiles+walls)
 				meshname =3D FilterApplyMeshOverrides(meshname,iSeasonedButNotRemapped=
TileTypeID)
 			else
 				meshname =3D false
-				printdebug(&quot;static&quot;,&quot;mesh cannot be loaded -&gt; temp. disabled (false) &quot;=
,meshname, iTranslatedTileTypeID)
+				printdebug(&quot;static&quot;,&quot;mesh cannot be loaded -&gt; temp. disabled (false) &quot;=
, iTranslatedTileTypeID, meshlocation)
 			end
 =

 		else
 			meshname =3D false
-			printdebug(&quot;static&quot;,&quot;mesh not available -&gt; temp. disabled (false) &quot;,mes=
hname, iTranslatedTileTypeID)
+			printdebug(&quot;static&quot;,&quot;mesh not available -&gt; temp. disabled (false) &quot;, iT=
ranslatedTileTypeID, meshlocation)
 		end
-		gLegacyModelCache[iTranslatedTileTypeID] =3D meshname
-	end
-	=

-	-- dump missing models as images
+		gLegacyMeshCache[iTranslatedTileTypeID] =3D meshname
+	end
+	=

+	-- dump missing meshes as images
 	if gDumpMissingModels and not bDontGenerateFallback then
 		local skip =3D gSkippedArtBillboardFallBacks[iTranslatedTileTypeID] or I=
sGroundPlate(iTranslatedTileTypeID)
 		local filename =3D &quot;missing/&quot;..iTranslatedTileTypeID..&quot;.png&quot;
@@ -96,15 +96,15 @@
 				end
 			end
 			img:Destroy()
-		elseif (meshname or skip) and not gbModelIsFallback[iTranslatedTileTypeI=
D] then
+		elseif (meshname or skip) and not gbMeshIsFallback[iTranslatedTileTypeID=
] then
 			if file_exists(filename) then
 				-- remove existing missing images
-				print(&quot;remove missing art image because there is now a model&quot;,iTransla=
tedTileTypeID,filename)
+				print(&quot;remove missing art image because there is now a mesh&quot;,iTranslat=
edTileTypeID,filename)
 				remove_file(filename)
 			end
 			if file_exists(filename_unmapped) then
 				-- remove existing missing images
-				print(&quot;remove missing art image because there is now a model&quot;,iTileTyp=
eID,filename_unmapped)
+				print(&quot;remove missing art image because there is now a mesh&quot;,iTileType=
ID,filename_unmapped)
 				remove_file(filename_unmapped)
 			end
 		end
@@ -119,8 +119,8 @@
 	if not meshname and gUseStaticFallbacks and not bDontGenerateFallback then
 		meshname =3D GetFallbackMeshName(iTranslatedTileTypeID)
 		if meshname then
-			gLegacyModelCache[iTranslatedTileTypeID] =3D meshname
-			gbModelIsFallback[iTranslatedTileTypeID] =3D true
+			gLegacyMeshCache[iTranslatedTileTypeID] =3D meshname
+			gbMeshIsFallback[iTranslatedTileTypeID] =3D true
 			--~ giStaticFallbackCount =3D (giStaticFallbackCount or 0) + 1
 			--~ print(&quot;giStaticFallbackCount&quot;,giStaticFallbackCount)
 		end
@@ -129,29 +129,24 @@
 	return meshname
 end
 =

-
---~ gFallbackModelCache =3D {}
 -- returns the name of a static generated mesh that can be used instead of=
 classic billboards
 function GetFallbackMeshName	(iTileTypeID)
-	--~ local name =3D gFallbackModelCache[iTileTypeID]
-	--~ if name then return name end
-	=

 	if IsArtBillboardFallBackSkipped(iTileTypeID) then return nil end
 	=

-	-- generate the model
-	if not gFallbackModelCacheGfx then =

-		gFallbackModelCacheGfx =3D CreateRootGfx3D()
-		gFallbackModelCacheGfx:SetVisible(false)
+	-- generate the fallback mesh
+	if not gFallbackMeshCacheGfx then =

+		gFallbackMeshCacheGfx =3D CreateRootGfx3D()
+		gFallbackMeshCacheGfx:SetVisible(false)
 	end
 	=

 	-- TODO currently just ignores the art atlas lockkeeper
-	local sMatName,iWidth,iHeight,iCenterX,iCenterY,u0,v0,u1,v1 =3D ArtAtlasL=
oadAndLockDirect(iTileTypeID+0x4000,0,nil,gStaticFallbackAtlasBaseMaterial)
+	local sMatName,iWidth,iHeight,iCenterX,iCenterY,u0,v0,u1,v1 =3D ArtAtlasL=
oadAndLockDirect(iTileTypeID+0x4000,0,nil,staticFallbackAtlasBaseMaterial)
 	--~ print(&quot;###&quot;, iTileTypeID, sMatName,iWidth,iHeight,iCenterX,iCenterY,u=
0,v0,u1,v1)
 	=

 	if not sMatName then return nil end
 	=

-	gFallbackModelCacheGfx:SetSimpleRenderable()
-	gFallbackModelCacheGfx:SetMaterial(sMatName)
+	gFallbackMeshCacheGfx:SetSimpleRenderable()
+	gFallbackMeshCacheGfx:SetMaterial(sMatName)
 	=

 	local t =3D GetStaticTileType(iTileTypeID)
 	=

@@ -172,43 +167,43 @@
 		local ny =3D 0
 		local nz =3D 1
 		=

-		gFallbackModelCacheGfx:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
-		=

-		gFallbackModelCacheGfx:RenderableVertex( -0+dx,0+dy,dz, nx,ny,nz, tw,v0)
-		gFallbackModelCacheGfx:RenderableVertex( -0+dx,1+dy,dz, nx,ny,nz, u0,th)
-		gFallbackModelCacheGfx:RenderableVertex( -1+dx,0+dy,dz, nx,ny,nz, u1,th)
-		gFallbackModelCacheGfx:RenderableVertex( -1+dx,1+dy,dz, nx,ny,nz, tw,v1)
-		gFallbackModelCacheGfx:RenderableIndex3(0,1,2)
-		gFallbackModelCacheGfx:RenderableIndex3(1,3,2)
-		=

-		gFallbackModelCacheGfx:RenderableEnd()
+		gFallbackMeshCacheGfx:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
+		=

+		gFallbackMeshCacheGfx:RenderableVertex( -0+dx,0+dy,dz, nx,ny,nz, tw,v0)
+		gFallbackMeshCacheGfx:RenderableVertex( -0+dx,1+dy,dz, nx,ny,nz, u0,th)
+		gFallbackMeshCacheGfx:RenderableVertex( -1+dx,0+dy,dz, nx,ny,nz, u1,th)
+		gFallbackMeshCacheGfx:RenderableVertex( -1+dx,1+dy,dz, nx,ny,nz, tw,v1)
+		gFallbackMeshCacheGfx:RenderableIndex3(0,1,2)
+		gFallbackMeshCacheGfx:RenderableIndex3(1,3,2)
+		=

+		gFallbackMeshCacheGfx:RenderableEnd()
 	else
 		-- crossed
 		local dz =3D 0
 		local dx =3D 0
 		local dy =3D 0
 		=

-		gFallbackModelCacheGfx:RenderableBegin(4*2,6*2,false,false,OT_TRIANGLE_L=
IST)
+		gFallbackMeshCacheGfx:RenderableBegin(4*2,6*2,false,false,OT_TRIANGLE_LI=
ST)
 		=

 		local nx,ny,nz =3D calculate_triangle_normal(-0+dx,0.5+dy,0+dz, 1+dx,0.5=
+dy,0+dz, 1+dx,0.5+dy,h+dz)
 		=

-		gFallbackModelCacheGfx:RenderableVertex( -0+dx,0.5+dy,0+dz, nx,ny,nz, u1=
,v1)
-		gFallbackModelCacheGfx:RenderableVertex( -1+dx,0.5+dy,0+dz, nx,ny,nz, u0=
,v1)
-		gFallbackModelCacheGfx:RenderableVertex( -1+dx,0.5+dy,h+dz, nx,ny,nz, u0=
,v0)
-		gFallbackModelCacheGfx:RenderableVertex( -0+dx,0.5+dy,h+dz, nx,ny,nz, u1=
,v0)
-		gFallbackModelCacheGfx:RenderableIndex3(2,1,0)
-		gFallbackModelCacheGfx:RenderableIndex3(0,3,2)
+		gFallbackMeshCacheGfx:RenderableVertex( -0+dx,0.5+dy,0+dz, nx,ny,nz, u1,=
v1)
+		gFallbackMeshCacheGfx:RenderableVertex( -1+dx,0.5+dy,0+dz, nx,ny,nz, u0,=
v1)
+		gFallbackMeshCacheGfx:RenderableVertex( -1+dx,0.5+dy,h+dz, nx,ny,nz, u0,=
v0)
+		gFallbackMeshCacheGfx:RenderableVertex( -0+dx,0.5+dy,h+dz, nx,ny,nz, u1,=
v0)
+		gFallbackMeshCacheGfx:RenderableIndex3(2,1,0)
+		gFallbackMeshCacheGfx:RenderableIndex3(0,3,2)
 =

 		local nx,ny,nz =3D calculate_triangle_normal(-0.5+dx,0+dy,0+dz, 0.5+dx,1=
+dy,0+dz, 0.5+dx,1+dy,h+dz)
 		=

-		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,0+dy,0+dz, nx,ny,nz, u1=
,v1)
-		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,1+dy,0+dz, nx,ny,nz, u0=
,v1)
-		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,1+dy,h+dz, nx,ny,nz, u0=
,v0)
-		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,0+dy,h+dz, nx,ny,nz, u1=
,v0)
-		gFallbackModelCacheGfx:RenderableIndex3(4+2,4+1,4+0)
-		gFallbackModelCacheGfx:RenderableIndex3(4+0,4+3,4+2)
-
-		gFallbackModelCacheGfx:RenderableEnd()
+		gFallbackMeshCacheGfx:RenderableVertex( -0.5+dx,0+dy,0+dz, nx,ny,nz, u1,=
v1)
+		gFallbackMeshCacheGfx:RenderableVertex( -0.5+dx,1+dy,0+dz, nx,ny,nz, u0,=
v1)
+		gFallbackMeshCacheGfx:RenderableVertex( -0.5+dx,1+dy,h+dz, nx,ny,nz, u0,=
v0)
+		gFallbackMeshCacheGfx:RenderableVertex( -0.5+dx,0+dy,h+dz, nx,ny,nz, u1,=
v0)
+		gFallbackMeshCacheGfx:RenderableIndex3(4+2,4+1,4+0)
+		gFallbackMeshCacheGfx:RenderableIndex3(4+0,4+3,4+2)
+
+		gFallbackMeshCacheGfx:RenderableEnd()
 	--[[
 	else
 		-- flat
@@ -216,24 +211,22 @@
 		local dx =3D 0
 		local dy =3D 0
 =

-		gFallbackModelCacheGfx:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
-		=

-		gFallbackModelCacheGfx:RenderableVertex( 0+dx,0+dy,dz, u0,v0)
-		gFallbackModelCacheGfx:RenderableVertex( 1+dx,0+dy,dz, u1,v0)
-		gFallbackModelCacheGfx:RenderableVertex( 1+dx,1+dy,dz, u1,v1)
-		gFallbackModelCacheGfx:RenderableVertex( 0+dx,1+dy,dz, u0,v1)
-		gFallbackModelCacheGfx:RenderableIndex3(2,1,0)
-		gFallbackModelCacheGfx:RenderableIndex3(0,3,2)
-
-		gFallbackModelCacheGfx:RenderableEnd()
+		gFallbackMeshCacheGfx:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
+		=

+		gFallbackMeshCacheGfx:RenderableVertex( 0+dx,0+dy,dz, u0,v0)
+		gFallbackMeshCacheGfx:RenderableVertex( 1+dx,0+dy,dz, u1,v0)
+		gFallbackMeshCacheGfx:RenderableVertex( 1+dx,1+dy,dz, u1,v1)
+		gFallbackMeshCacheGfx:RenderableVertex( 0+dx,1+dy,dz, u0,v1)
+		gFallbackMeshCacheGfx:RenderableIndex3(2,1,0)
+		gFallbackMeshCacheGfx:RenderableIndex3(0,3,2)
+
+		gFallbackMeshCacheGfx:RenderableEnd()
 	]]--
 	end
 	=

-	local name =3D gFallbackModelCacheGfx:RenderableConvertToMesh()
+	local name =3D gFallbackMeshCacheGfx:RenderableConvertToMesh()
 	=

 	-- name =3D &quot;mdl_000405.mesh&quot;
-	=

-	--~ gFallbackModelCache[iTileTypeID] =3D name
 	=

 	return name
 end

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Mon Nov 28 14:19:27 2011
@@ -1,38 +1,97 @@
+--[[ ***** see Iris2 COPYING for license info ***** ]]--
+--[[ \brief
+		main.lua
+]]--
+
 --###############################
 --###        CONSTANTS        ###
 --###############################
 =

+-- -----------------------------------------------------------------------=
-----
 -- Iris2 Directories/Files
+-- -----------------------------------------------------------------------=
-----
 gMainWorkingDir     =3D GetMainWorkingDir and GetMainWorkingDir() or &quot;&quot;
+-- Data-Path
 gBinPath			=3D gMainWorkingDir..&quot;bin/&quot;  -- bin folder with config etc
-datapath            =3D gMainWorkingDir..&quot;data/&quot;
-libpath             =3D gMainWorkingDir..&quot;lua/&quot;
-gMacroPathFallback  =3D gMainWorkingDir..&quot;lua/config_macros_declarations.l=
ua&quot;
+-- Data-Path
+gDataPath           =3D gMainWorkingDir..&quot;data/&quot;	-- former datapath
+-- Plugin-Path
 gMainPluginDir      =3D gMainWorkingDir..&quot;plugins/&quot;
+-- Screenshot-Path
+local configScreenName	=3D &quot;screenshots/&quot;
+gScreenshotPath 	=3D gMainWorkingDir..configScreenName
+-- Temporary-Path
+local configTempName	=3D &quot;tmp/&quot;
+gTempPath           =3D gMainWorkingDir..configTempName
+-- VideoRecording-Path
+local configVideoName	=3D &quot;video/&quot;
+gPacketVideoPath	=3D gMainWorkingDir..configVideoName
+
+-- Tiles Folders
+gDataTilesPath      	=3D gDataPath..&quot;models/&quot;
+gDataTilesAtlasPath		=3D gDataPath..&quot;models/atlas/&quot;
+gDataTilesMaterialsPath	=3D gDataPath..&quot;models/materials/&quot;
+gDataTilesMeshesPath	=3D gDataPath..&quot;models/models/&quot;
+gDataTilesTexturesPath	=3D gDataPath..&quot;models/textures/&quot;
+gDataCustomTilesMeshesPath=3DgDataPath..&quot;custom/models/&quot;
+
+-- Tile export Folder (Debugmenu)
+gDataExportPath     	=3D gDataPath..&quot;export/&quot;
+
+-- Tiles support files
+gMeshTextureUsageFilePath=3D gDataPath..&quot;meshtextureusage.lua&quot;
+gSkippedFallBackFilePath =3D gDataPath..&quot;skippedfallbacks.lua&quot;
+
+-- Scripts Subdir
+libpath				=3D gMainWorkingDir..&quot;lua/&quot;	-- TODO: change to &quot;gScriptPath&quot;
+gMacroPathFallback  =3D libpath..&quot;config_macros_declarations.lua&quot;
 gIrisWidgetDir      =3D libpath..&quot;widgets/&quot;
 =

+-- Scripts-Lugre Subdir
 lugreluapath        =3D (file_exists(gMainWorkingDir..&quot;mylugre&quot;) and gMain=
WorkingDir..&quot;mylugre/lua/&quot; or GetLugreLuaPath()) -- this is should also in =
USERHOME dir
 =

--- User Directories/Files
-gTempPath           =3D gMainWorkingDir..&quot;tmp/&quot;
-gScreenshotDir		=3D gMainWorkingDir..&quot;screenshots/&quot;
-gConfigPath         =3D gMainWorkingDir..&quot;config/&quot;
-gConfigFile         =3D &quot;config.lua&quot;
-gConfigPathFile     =3D gConfigPath..gConfigFile
-gConfigPathFile_old =3D datapath..gConfigFile         -- only as Fallback =
for old users
-gMacroFile          =3D &quot;mymacros.lua&quot;
-gMacroPathFile      =3D gConfigPath..gMacroFile
-gMacroPathFile_old  =3D datapath..gMacroFile          -- only as Fallback =
for old users
-gDesktopDir			=3D gConfigPath..&quot;desktop/&quot; -- old was data/desktop/
-gPacketVideoFileName_folderpath	=3D gMainWorkingDir..&quot;videos/&quot;
-gUOAMDir			=3D gConfigPath..&quot;uoam/&quot;
-gUoamMarkFile		=3D &quot;mark.uoam&quot;
-gUoamMarkPathFile	=3D gUOAMDir..gUoamMarkFile
-
+-- -----------------------------------------------------------------------=
-----
+-- Iris2 Config Dir/Files
+-- -----------------------------------------------------------------------=
-----
+
+-- Config filename defines
+local configFile		=3D &quot;config.lua&quot;
+local macroFile			=3D &quot;mymacros.lua&quot;
+local filterFile		=3D &quot;iris.filter.lua&quot;
+local uoamMarkFile		=3D &quot;mark.uoam&quot;
+
+-- Config sub-directories
+local configFolderName	=3D &quot;/.iris/&quot;
+local configDesktopName	=3D &quot;desktop/&quot;
+local configUoamName	=3D &quot;uoam/&quot;
+
+-- Config-Path
+local configConfigName	=3D &quot;config/&quot;
+gConfigPath         =3D gMainWorkingDir..configConfigName
+gConfigPathOrig     =3D gConfigPath					-- Path to original config template
+
+-- Config-Path Files
+gConfigPathFile     =3D gConfigPath..configFile
+gConfigPathFile_old =3D gDataPath..configFile         -- only as Fallback =
for old users
+gMacroPathFile      =3D gConfigPath..macroFile
+gMacroPathFile_old  =3D gDataPath..macroFile          -- only as Fallback =
for old users
+gFilterFile			=3D gConfigPath..filterFile
+
+-- Config-Path SubDirs
+-- Config-Path Desktop Subdir
+gDesktopPath		=3D gConfigPath..configDesktopName	-- old was data/desktop/
+-- Config-Path UOAM Subdir
+gUoamPath			=3D gConfigPath..configUoamName
+-- Config-Path UOAM Subdir File
+gUoamMarkPathFile	=3D gUoamPath..uoamMarkFile
+
+
+-- -----------------------------------------------------------------------=
-----
+-- Global Variables
+-- -----------------------------------------------------------------------=
-----
 gSecondsSinceLastFrame =3D 0
 gInGameStarted =3D false
 gNet_State =3D false
-
 gFrameCounter =3D 0
 =

 function GetStackTrace () return _TRACEBACK() end
@@ -49,35 +108,36 @@
 		=

 		local function MyInitCheckHomeDir (home)
 			print(&quot;trying to init from home path:&quot;,home)
-			gHomeIrisPath 		=3D home..&quot;/.iris/&quot;
-			gTempPath 			=3D gHomeIrisPath..&quot;tmp/&quot;
-			gScreenshotDir		=3D gHomeIrisPath..&quot;screenshots/&quot;
-			gConfigPath 		=3D gHomeIrisPath..&quot;config/&quot;
-			gConfigPathFile     =3D gConfigPath..gConfigFile
-			gMacroPathFile      =3D gConfigPath..gMacroFile
-			gDesktopDir			=3D gConfigPath..&quot;desktop/&quot;
-			gPacketVideoFileName_folderpath	=3D gHomeIrisPath..&quot;videos/&quot; -- todo : =
text=3D'will be saved as .ipv files in iris/videos/'
-			gUOAMDir			=3D gConfigPath..&quot;uoam/&quot;
-			gUoamMarkPathFile	=3D gUOAMDir..gUoamMarkFile
+			local irisHomePath 		=3D home..configFolderName
+			gConfigPath 		=3D irisHomePath..configConfigName
+			gScreenshotPath		=3D irisHomePath..configScreenName
+			gTempPath 			=3D irisHomePath..configTempName
+			gPacketVideoPath	=3D irisHomePath..configVideoName -- todo : text=3D'wi=
ll be saved as .ipv files in ~/.iris/videos/'
+
+			gConfigPathFile     =3D gConfigPath..configFile
+			gMacroPathFile      =3D gConfigPath..macroFile
+			gDesktopPath		=3D gConfigPath..configDesktopName
+			gUoamPath			=3D gConfigPath..configUoamName
+			gUoamMarkPathFile	=3D gUoamPath..uoamMarkFile
 			=

 			-- check if config.lua is already copied
 			if (not file_exists(gConfigPathFile)) then
-				print(&quot;initializing &quot;..gHomeIrisPath)
-				mkdir(gHomeIrisPath)
+				print(&quot;initializing &quot;..irisHomePath)
+				mkdir(irisHomePath)
 				mkdir(gTempPath)
-				mkdir(gScreenshotDir)
+				mkdir(gScreenshotPath)
 				mkdir(gConfigPath)
-				mkdir(gDesktopDir)
-				mkdir(gPacketVideoFileName_folderpath)
-				mkdir(gUOAMDir)
-
-				print(&quot;Copy config from: &quot; .. gMainWorkingDir..&quot;config/&quot; .. &quot; to: &quot; ..=
 gConfigPath)
+				mkdir(gDesktopPath)
+				mkdir(gPacketVideoPath)
+				mkdir(gUoamPath)
+
+				print(&quot;Copy config from: &quot; .. gConfigPathOrig .. &quot; to: &quot; .. gConfigPat=
h)
 				-- test if config dir is writable, probably unicode filepath problem i=
f not (e.g /Data aplikaci/ with accent on i or unicode username or somethin=
g)
 				local config_write_test_path =3D gConfigPath..&quot;config-write-test.txt&quot;
 				local fp =3D io.open(config_write_test_path,&quot;wb&quot;)
 				if (fp) then =

 					fp:close()
-					CopyDir(gMainWorkingDir..&quot;config/&quot;,gConfigPath)
+					CopyDir(gConfigPathOrig,gConfigPath)
 					return true
 				else
 					print(&quot;path not writable:&quot;,config_write_test_path)
@@ -134,6 +194,7 @@
 -- utils first
 print(&quot;MainWorkingDir&quot;,gMainWorkingDir)
 print(&quot;lugreluapath&quot;,lugreluapath)
+
 dofile(lugreluapath .. &quot;lugre.lua&quot;)
 lugre_include_libs(lugreluapath)
 dofile(libpath .. &quot;lib.sound.iris.lua&quot;)
@@ -353,40 +414,38 @@
     OgreAddResLoc(mydatapath..&quot;particles/particles&quot;         ,&quot;FileSystem&quot;,=
&quot;General&quot;)
     OgreAddResLoc(mydatapath..&quot;particles/textures&quot;          ,&quot;FileSystem&quot;,=
&quot;General&quot;)
     OgreAddResLoc(mydatapath..&quot;compositors&quot;                 ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-	=

-    --~ # custom materials
-    OgreAddResLoc(mydatapath..&quot;custom/materials&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-	=

-    --~ # distributet models
-    OgreAddResLoc(mydatapath..&quot;models/materials&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;models/meta&quot;                 ,&quot;FileSystem&quot;,=
&quot;General&quot;)
+
+    --~ # distributet Tiles
+    OgreAddResLoc(mydatapath..&quot;models/materials&quot;             ,&quot;FileSystem&quot;=
,&quot;General&quot;)
+    OgreAddResLoc(mydatapath..&quot;models/meta&quot;                  ,&quot;FileSystem&quot;=
,&quot;General&quot;)
     for i=3D1,20 do OgreAddResLoc(mydatapath..&quot;models/models/&quot;..sprintf(&quot;t=
o_%03d000&quot;,i)   ,&quot;FileSystem&quot;,&quot;General&quot;) end
-    OgreAddResLoc(mydatapath..&quot;models/textures/&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;models/atlas&quot;                ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;models/programs&quot;             ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-
-    --~ # custom models
-    OgreAddResLoc(mydatapath..&quot;custom/models&quot;               ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;custom/textures&quot;             ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-
-    --~ # new Terrain Shaderengine
+    OgreAddResLoc(mydatapath..&quot;models/textures/&quot;             ,&quot;FileSystem&quot;=
,&quot;General&quot;)
+    OgreAddResLoc(mydatapath..&quot;models/atlas&quot;                 ,&quot;FileSystem&quot;=
,&quot;General&quot;)
+    OgreAddResLoc(mydatapath..&quot;models/programs&quot;              ,&quot;FileSystem&quot;=
,&quot;General&quot;)
+
+    --~ # custom usercreated Tiles (Folder for Mods)
+    OgreAddResLoc(mydatapath..&quot;custom/materials&quot;      ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
+    OgreAddResLoc(mydatapath..&quot;custom/models&quot;         ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
+    OgreAddResLoc(mydatapath..&quot;custom/textures&quot;       ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
+
+    --~ # distributet Terrain Shaderengine
     OgreAddResLoc(mydatapath..&quot;terrain/materials&quot;           ,&quot;FileSystem&quot;,=
&quot;General&quot;)
     OgreAddResLoc(mydatapath..&quot;terrain/programs&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
     OgreAddResLoc(mydatapath..&quot;terrain/textures&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
     OgreAddResLoc(mydatapath..&quot;terrain/multitex&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
     OgreAddResLoc(mydatapath..&quot;terrain/multitex/parts&quot;      ,&quot;FileSystem&quot;,=
&quot;General&quot;)
 =

-    --~ # new Grannys
-    OgreAddResLoc(mydatapath..&quot;grannys/materials&quot;           ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;grannys/programs&quot;            ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-
-    --~ # custom Grannys (Ogre.mesh + Ogre.skeleton)
-    OgreAddResLoc(mydatapath..&quot;customchars/materials&quot;       ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;customchars/models&quot;          ,&quot;FileSystem&quot;,=
&quot;General&quot;)
-    OgreAddResLoc(mydatapath..&quot;customchars/textures&quot;        ,&quot;FileSystem&quot;,=
&quot;General&quot;)
+    --~ # Ultima Online-Mobiles (Chars./Monster/Animals) - also called Gra=
nnys
+    OgreAddResLoc(mydatapath..&quot;grannys/materials&quot;        ,&quot;FileSystem&quot;,&quot;Ge=
neral&quot;)
+    OgreAddResLoc(mydatapath..&quot;grannys/programs&quot;         ,&quot;FileSystem&quot;,&quot;Ge=
neral&quot;)
+
+    --~ # custom usercreated Chars/Monster/Animals (Grannys) (Ogre.mesh + =
Ogre.skeleton)
+    OgreAddResLoc(mydatapath..&quot;customchars/materials&quot; ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
+    OgreAddResLoc(mydatapath..&quot;customchars/models&quot;    ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
+    OgreAddResLoc(mydatapath..&quot;customchars/textures&quot;  ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
     =

 	if (gUOPath) then =

-		OgreAddResLoc(gUOPath..CorrectPath(&quot;Models/Maps&quot;)               ,&quot;FileSy=
stem&quot;,&quot;General&quot;)
+		OgreAddResLoc(gUOPath..CorrectPath(&quot;Models/Maps&quot;)   ,&quot;FileSystem&quot;,&quot;Gener=
al&quot;)
 	end
 =

     OgreAddResLoc(gMainWorkingDir..CorrectPath(&quot;lugre/lib/caelum/resources=
&quot;),&quot;FileSystem&quot;,&quot;Caelum&quot;)
@@ -394,12 +453,12 @@
 	if (gDebugModeTestSkeletalAnimShader or gEnableBloomShader) then =

 		local myOgreSampleMedia =3D mydatapath..&quot;ogreSampleMedia/&quot;
 		=

-		OgreAddResLoc(myOgreSampleMedia..&quot;/packs/OgreCore.zip&quot;			,&quot;Zip&quot;,&quot;Bootstr=
ap&quot;)
+		OgreAddResLoc(myOgreSampleMedia..&quot;/packs/OgreCore.zip&quot; ,&quot;Zip&quot;,&quot;Bootstrap=
&quot;)
 		=

-		OgreAddResLoc(myOgreSampleMedia..&quot;/materials/programs&quot;          ,&quot;FileSy=
stem&quot;,&quot;General&quot;)
-		OgreAddResLoc(myOgreSampleMedia..&quot;/materials/scripts&quot;           ,&quot;FileSy=
stem&quot;,&quot;General&quot;)
-		OgreAddResLoc(myOgreSampleMedia..&quot;/materials/textures&quot;          ,&quot;FileSy=
stem&quot;,&quot;General&quot;)
-		OgreAddResLoc(myOgreSampleMedia..&quot;/models&quot;                      ,&quot;FileSy=
stem&quot;,&quot;General&quot;)
+		OgreAddResLoc(myOgreSampleMedia..&quot;/materials/programs&quot; ,&quot;FileSystem&quot;,&quot;Ge=
neral&quot;)
+		OgreAddResLoc(myOgreSampleMedia..&quot;/materials/scripts&quot;  ,&quot;FileSystem&quot;,&quot;Ge=
neral&quot;)
+		OgreAddResLoc(myOgreSampleMedia..&quot;/materials/textures&quot; ,&quot;FileSystem&quot;,&quot;Ge=
neral&quot;)
+		OgreAddResLoc(myOgreSampleMedia..&quot;/models&quot;             ,&quot;FileSystem&quot;,&quot;Ge=
neral&quot;)
 	end
 =

     if gUseCaduneTree then =


Modified: trunk/lua/profiles/gfx_ultrahigh.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/profiles/gfx_ultrahigh.lua (original)
+++ trunk/lua/profiles/gfx_ultrahigh.lua Mon Nov 28 14:19:27 2011
@@ -3,7 +3,7 @@
 =

 gConfig:Set(&quot;gAtlasRes&quot;,&quot;none&quot;)
 =

-gConfig:Set(&quot;gShadowTechnique&quot;,&quot;texture_additive_integrated&quot;)
+gConfig:Set(&quot;gShadowTechnique&quot;,&quot;texture_additive&quot;)
 gConfig:Set(&quot;gStaticsCastShadows&quot;,true)
 gConfig:Set(&quot;gDynamicsCastShadows&quot;,true)
 gConfig:Set(&quot;gMobileCastShadows&quot;,true)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002152.html">[Iris-commit] [IRIS] r3413 - in /trunk: data/custom/ data/customchars/ data/grannys/ data/mobiles/ data/mobiles_custom/ data/models/ data/tiles/ data/tiles_custom/ lua/ lua/profiles/
</A></li>
	<LI>Next message: <A HREF="002154.html">[Iris-commit] [IRIS] r3415 - in /trunk/lua: lib.debugmenu.lua	lib.mainmenu.charcreate.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2153">[ date ]</a>
              <a href="thread.html#2153">[ thread ]</a>
              <a href="subject.html#2153">[ subject ]</a>
              <a href="author.html#2153">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
