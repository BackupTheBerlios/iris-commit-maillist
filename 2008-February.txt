From no-reply at zwischenwelt.org  Fri Feb  1 00:12:44 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Thu, 31 Jan 2008 23:12:44 -0000
Subject: [Iris-commit] [IRIS] r1868 - /trunk/lua/lib.3d.cam.lua
Message-ID: <20080131231249.5DF661C1844D@zwischenwelt.org>

Author: sience
Date: Fri Feb  1 00:12:43 2008
New Revision: 1868

Log:
-max cam distance decreased for standard settings

Modified:
    trunk/lua/lib.3d.cam.lua

Modified: trunk/lua/lib.3d.cam.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.cam.lua (original)
+++ trunk/lua/lib.3d.cam.lua Fri Feb  1 00:12:43 2008
@@ -89,7 +89,7 @@
 	if (add < 0) then factor =3D 1.0 / base end
 	=

 	gMinZoom =3D gMinZoom or 3
-	gMaxZoom =3D gMaxZoom or 30
+	gMaxZoom =3D gMaxZoom or 20
 	local factor =3D math.max(gMinZoom,math.min(gMaxZoom,self.gThirdPersonDis=
t * factor)) / self.gThirdPersonDist =

 	self.gThirdPersonDist =3D self.gThirdPersonDist * factor
 	self.gCamLookAheadDist =3D self.gCamLookAheadDist * factor



From no-reply at zwischenwelt.org  Sat Feb  2 04:57:56 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 03:57:56 -0000
Subject: [Iris-commit] [IRIS] r1869 - /trunk/lua/lib.mount.lua
Message-ID: <20080202035756.B58C01C18384@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Feb  2 04:57:55 2008
New Revision: 1869

Log:
added hiryu mount entry

Modified:
    trunk/lua/lib.mount.lua

Modified: trunk/lua/lib.mount.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mount.lua (original)
+++ trunk/lua/lib.mount.lua Sat Feb  2 04:57:55 2008
@@ -46,6 +46,7 @@
 gMountTranslate[hex2num("0x3EBD")] =3D hex2num("0x31A") -- // swampdragon
 gMountTranslate[hex2num("0x3EBE")] =3D hex2num("0x31F") -- // armored swam=
p dragon
 gMountTranslate[hex2num("0x3E92")] =3D hex2num("0x11C") -- // mondain steed
+gMountTranslate[hex2num("0x3E94")] =3D hex2num("0xF3") -- // hiryu
 =

 gMountTranslate2D =3D {}
 for k,v in pairs(gMountTranslate) do gMountTranslate2D[k] =3D v end -- a c=
opy of the original data without granny overrides for varan



From no-reply at zwischenwelt.org  Sat Feb  2 12:10:19 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 11:10:19 -0000
Subject: [Iris-commit] [IRIS] r1870 - /trunk/data/config.lua.dist
Message-ID: <20080202120015.CD3261C18073@zwischenwelt.org>

Author: sience
Date: Sat Feb  2 12:10:18 2008
New Revision: 1870

Log:
-ventus-mundus added to preconfig

Modified:
    trunk/data/config.lua.dist

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Sat Feb  2 12:10:18 2008
@@ -123,6 +123,15 @@
 		gPassword =3D "admin",	-- Password
 		gLoginServerIP =3D "localhost",
 		gLoginServerPort =3D 2593,
+		gServerSeed =3D hex2num("0xFFFFFFFF"),
+		gPolServer =3D false
+	}
+
+gShardList["vetus-mundus"] =3D {
+		gLoginname =3D "",	-- Loginname
+		gPassword =3D "",		-- Password
+		gLoginServerIP =3D "shard.vetus-mundus.de",
+		gLoginServerPort =3D 2594,
 		gServerSeed =3D hex2num("0xFFFFFFFF"),
 		gPolServer =3D false
 	}



From no-reply at zwischenwelt.org  Sat Feb  2 16:39:19 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 15:39:19 -0000
Subject: [Iris-commit] [IRIS] r1871 - /trunk/lua/lib.devtool.lua
Message-ID: <20080202153919.78FAC1C1868A@zwischenwelt.org>

Author: hagish
Date: Sat Feb  2 16:39:18 2008
New Revision: 1871

Log:
added missing close buttons in dev tools

Modified:
    trunk/lua/lib.devtool.lua

Modified: trunk/lua/lib.devtool.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.devtool.lua (original)
+++ trunk/lua/lib.devtool.lua Sat Feb  2 16:39:18 2008
@@ -134,6 +134,10 @@
 			{type=3D"Label",		text=3Dsprintf(" %6.2fMB\n",OgreMemoryUsage(v)/1024/1=
024)}, })
 	end
 =

+	table.insert(rows,{ =

+		{type=3D"Button",text=3D"close",onMouseDown=3Dfunction(widget) widget.di=
alog:Destroy() end},
+	})
+
 	guimaker.MakeTableDlg(rows,100,10,true,true,gGuiDefaultStyleSet,"window") =

 end
 =

@@ -177,6 +181,10 @@
 		table.insert(rows[5]	,{type=3D"Label",	text=3Dsprintf("%s\n0x%04x(=3D%d)=
\n%s",GetStaticTileTypeName(i) or "unknown",i,i,texlist)})
 	end
 =

+	table.insert(rows,{ =

+		{type=3D"Button",text=3D"close",onMouseDown=3Dfunction(widget) widget.di=
alog:Destroy() end},
+	})
+	=

 	guimaker.MakeTableDlg(rows,100,10,true,true,gGuiDefaultStyleSet,"window") =

 end
 =




From no-reply at zwischenwelt.org  Sat Feb  2 16:48:04 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 15:48:04 -0000
Subject: [Iris-commit] [IRIS] r1872 - in /trunk: bin/iris2.exe
 data/config.lua.dist data/grannys/materials/grannybase.material
 data/models/materials/textures.material
 data/terrain/materials/terrain.material lua/lib.3d.renderer.lua
Message-ID: <20080202154804.DDE9A1C1868A@zwischenwelt.org>

Author: sience
Date: Sat Feb  2 16:48:04 2008
New Revision: 1872

Log:
-graphicprofile "none" added for custom graphicsettings
-specular lightning set for grannys
-new binary
-setup shadows and worldlightning moved into 2 functions

Modified:
    trunk/bin/iris2.exe
    trunk/data/config.lua.dist
    trunk/data/grannys/materials/grannybase.material
    trunk/data/models/materials/textures.material
    trunk/data/terrain/materials/terrain.material
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Sat Feb  2 16:48:04 2008
@@ -455,5 +455,5 @@
 -- shaderbased characterrendering (beta)
 gUseHumanSkinShader =3D false
 =

--- "ultralow", "low", "med", "high", "ultrahigh"
+-- "ultralow", "low", "med", "high", "ultrahigh", "none"
 gGraphicProfile =3D "med"

Modified: trunk/data/grannys/materials/grannybase.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/grannys/materials/grannybase.material (original)
+++ trunk/data/grannys/materials/grannybase.material Sat Feb  2 16:48:04 20=
08
@@ -16,6 +16,11 @@
 =

 		pass
 		{
+			lighting on
+			ambient 0.5 0.5 0.5 1.0
+			diffuse 1.0 1.0 1.0 1.0
+			specular 0.7 0.7 0.75 30.0
+						 =

 			scene_blend alpha_blend
 			alpha_rejection greater_equal 50
 			texture_unit
@@ -70,6 +75,11 @@
 =

 		pass
 		{
+			lighting on
+			ambient 0.5 0.5 0.5 1.0
+			diffuse 1.0 1.0 1.0 1.0
+			specular 0.7 0.7 0.75 30.0
+
 			scene_blend alpha_blend
 			alpha_rejection greater_equal 50
 			texture_unit

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Feb  2 16:48:04 2008
@@ -23,12 +23,22 @@
 =

 			ambient vertexcolour
 			diffuse vertexcolour
-			=

+
+			//this is just a test for Normal Mapping
+//			fragment_program_ref Effect_Workspace.NormalMapFilter.Single_Pass.Pix=
el_Shader
+//			{
+				//Shader Constant: TextureSize
+//				param_indexed 1 float4 512.000000 0.0 0.0 0.0
+				//Shader Constant: lightness
+//				param_indexed 0 float4 0.300000 0.590000 0.110000 0.000000
+//			}
+
 			texture_unit DecalTexture
 			{
-				filtering anisotropic =

+				filtering anisotropic
 				max_anisotropy 8
 				texture checker.png
+				tex_address_mode clamp
 			}
 		}
 	}
@@ -39,13 +49,9 @@
 {
 	technique
 	{
-//		pass Ambient
-//		{
-//			alpha_rejection greater_equal 200
-//		}
 		pass Decal
 		{
-//			scene_blend alpha_blend
+			//scene_blend alpha_blend
 			alpha_rejection greater_equal 200
 		}
 	}

Modified: trunk/data/terrain/materials/terrain.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/terrain/materials/terrain.material (original)
+++ trunk/data/terrain/materials/terrain.material Sat Feb  2 16:48:04 2008
@@ -3,6 +3,7 @@
 //###########################################
 =

 // simple material without transitions
+// should not receive or cast shadows!
 material terrain_multitex_far
 {
 	receive_shadows off
@@ -22,6 +23,7 @@
 // simple material without transitions
 material terrain_multitex_simple_mat
 {
+	receive_shadows on
 	technique
 	{
 		pass
@@ -41,6 +43,7 @@
 =

 material terrain_multitex_mat
 {
+	receive_shadows on
 	technique
 	{
 		pass
@@ -96,6 +99,7 @@
 =

 material water
 {
+	receive_shadows on
 	technique
 	{
 		pass

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sat Feb  2 16:48:04 2008
@@ -59,14 +59,39 @@
 	end
 end
 =

+function Renderer3D:SetupWorldlight ()
+	Client_ClearLights()
+
+	-- Sun Light
+	gDirectionalLightSun =3D Client_AddDirectionalLight(
+								gSunLightDirection.x,
+								gSunLightDirection.y,
+								gSunLightDirection.z)
+	=

+	Client_SetLightDiffuseColor(gDirectionalLightSun,
+								gSunLightDiffuse.r,
+								gSunLightDiffuse.g,
+								gSunLightDiffuse.b)
+
+	Client_SetLightSpecularColor(gDirectionalLightSun,
+								gSunLightSpecular.r,
+								gSunLightSpecular.g,
+								gSunLightSpecular.b)
+
+	-- Ambient Light
+	Client_SetAmbientLight( gAmbientLight.r,
+							gAmbientLight.g,
+							gAmbientLight.b, 1.0)
+end
+
 gBuildStencilShadowEdgeList =3D false
-function Renderer3D:SetupShadows()
+function Renderer3D:SetupShadows ()
 	local shadowfardist=3D5*gSightRange+gFogValue
 =

 	if ((gShadowTechnique =3D=3D "stencil_modulative") or (gShadowTechnique =
=3D=3D "stencil_additive")) then
 		----- currently doesn't work with Fastbatch
+		--OgreSetShadowFarDistance(shadowfardist)
 		--OgreShadowTechnique(gShadowTechnique)
-		--OgreSetShadowFarDistance(shadowfardist)
 		--gBuildStencilShadowEdgeList=3Dtrue
 	elseif ((gShadowTechnique =3D=3D "texture_modulative") or (gShadowTechniq=
ue =3D=3D "texture_additive")) then
 		OgreSetShadowFarDistance(shadowfardist)
@@ -81,7 +106,7 @@
 		OgreSetShadowTextureSelfShadow(true)		-- disable this or write in materi=
al "receive_shadows off"
 		OgreSetShadowCasterRenderBackFaces(false)
 		OgreSetShadowTextureSize(2048)
-		OgreSetShadowTextureCount(3)
+		--OgreSetShadowTextureCount(3)
 =

 		OgreShadowTechnique(gShadowTechnique)
 	elseif ((gShadowTechnique =3D=3D "texture_additive_integrated") or (gShad=
owTechnique =3D=3D "texture_modulative_integrated")) then
@@ -122,38 +147,18 @@
 	cam:SetNearClipDistance(0.5) -- old : 1
 	cam:SetFarClipDistance(2000) -- ogre defaul : 100000
 	cam:SetProjectionType(0) -- perspective
-	Client_ClearLights()
-
-	-- Sun Light
-	gDirectionalLightSun =3D Client_AddDirectionalLight(
-								gSunLightDirection.x,
-								gSunLightDirection.y,
-								gSunLightDirection.z)
-	=

-	Client_SetLightDiffuseColor(gDirectionalLightSun,
-								gSunLightDiffuse.r,
-								gSunLightDiffuse.g,
-								gSunLightDiffuse.b)
-
-	Client_SetLightSpecularColor(gDirectionalLightSun,
-								gSunLightSpecular.r,
-								gSunLightSpecular.g,
-								gSunLightSpecular.b)
-
-	-- Ambient Light
-	Client_SetAmbientLight( gAmbientLight.r,
-							gAmbientLight.g,
-							gAmbientLight.b, 1)
+
+	self.SetupWorldlight()
 	=

 	self.gbActive =3D true
 	self:SetMapEnvironment()
-	=

+
+	-- Initialize Shadowsystem
+	self:SetupShadows()
+
 	self.gbCamRotChanged =3D true
 	for k,dynamic in pairs(GetDynamicList()) do if (DynamicIsInWorld(dynamic)=
) then self:AddDynamicItem(dynamic) end end
 	for k,mobile in pairs(GetMobileList()) do self:CreateMobileGfx(mobile) end
-	=

-	-- Initialize Shadowsystem
-	self:SetupShadows()
 end
 =

 function Renderer3D:DeInit()



From no-reply at zwischenwelt.org  Sat Feb  2 18:15:00 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 17:15:00 -0000
Subject: [Iris-commit] [IRIS] r1873 - in /trunk/lua: lib.3d.map.lua
	lib.devtool.lua
Message-ID: <20080202171502.AB5621C1868D@zwischenwelt.org>

Author: hagish
Date: Sat Feb  2 18:14:57 2008
New Revision: 1873

Log:
first ingame position adjust tool

Modified:
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.devtool.lua

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sat Feb  2 18:14:57 2008
@@ -232,6 +232,18 @@
 	return true
 end
 =

+-- rebuilds the map. this is slow!!!! so dont do this during normal gamepl=
ay
+function Renderer3D:RebuildMap ()
+	-- Renderer3D:ClearMapCache()
+	-- Renderer3D:UpdateMap()
+
+	for y,row in pairs(self.gMapChunks) do
+		for x,chunk in pairs(row) do
+			chunk.mbRebuild =3D true
+		end
+	end
+end
+
 function Renderer3D:ClearMapCache ()
 	--print("ClearMapCache")
 	local y,row,x,chunk

Modified: trunk/lua/lib.devtool.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.devtool.lua (original)
+++ trunk/lua/lib.devtool.lua Sat Feb  2 18:14:57 2008
@@ -13,6 +13,12 @@
 		-- ListStuffUnderMouse
 		{	{type=3D"Button",text=3D"ListStuffUnderMouse",onMouseDown=3Dfunction (=
widget) =

 				DevToolListStuffUnderMouse(x,y,z,radius)
+				widget.dialog:Destroy()
+				end}, },
+				=

+		-- Adjust Art Position
+		{	{type=3D"Button",text=3D"AdjustArtPosition",onMouseDown=3Dfunction (wi=
dget) =

+				AdjustArtPosition(x,y,z)
 				widget.dialog:Destroy()
 				end}, },
 				=

@@ -122,6 +128,21 @@
 	GetMainCam():SetPos(x,y,z+1)
 end
 =

+function AdjustArtPositionSplitRotationStringToXYZ(txt)
+	local arr =3D strsplit(",",txt)
+	local x,y,z =3D 0,0,0
+	for k,axis_ang in pairs(arr) do
+		local axis,ang =3D unpack(strsplit(":",axis_ang))
+
+			if (axis =3D=3D "x") then x =3D ang
+		elseif (axis =3D=3D "y") then y =3D ang
+		elseif (axis =3D=3D "z") then z =3D ang
+		end
+	end
+	=

+	return x,y,z
+end
+
 -- shows memory usage in a nice dialog
 function ShowMemoryUsage ()
 	local rows =3D { =

@@ -140,6 +161,127 @@
 =

 	guimaker.MakeTableDlg(rows,100,10,true,true,gGuiDefaultStyleSet,"window") =

 end
+
+function AdjustArtPositionInfoString(xadd,yadd,zadd,xrot,yrot,zrot)
+	return "xadd=3D"..xadd..", yadd=3D"..yadd..", zadd=3D"..zadd..", rot=3Dx:=
"..xrot..",y:"..yrot..",z:"..zrot
+end
+
+function AdjustArtPositionAdjustButtonHandler(dialog, xadd,yadd,zadd,xrot,=
yrot,zrot)
+	-- update values
+	dialog.xadd =3D dialog.xadd + xadd
+	dialog.yadd =3D dialog.yadd + yadd
+	dialog.zadd =3D dialog.zadd + zadd
+	dialog.xrot =3D dialog.xrot + xrot
+	dialog.yrot =3D dialog.yrot + yrot
+	dialog.zrot =3D dialog.zrot + zrot
+	-- update art filter map
+	local otherid =3D dialog.tileid
+	if gArtFilter[dialog.tileid] and gArtFilter[dialog.tileid]["maptoid"] then
+		otherid =3D gArtFilter[dialog.tileid]["maptoid"]
+	end
+	gArtFilter[dialog.tileid] =3D {
+		maptoid=3Dotherid,
+		rotation=3D"x:"..dialog.xrot..",y:"..dialog.yrot..",z:"..dialog.zrot,
+		xadd=3Ddialog.xadd,yadd=3Ddialog.yadd,zadd=3Ddialog.zadd,
+	}
+	print("filter.art.lua","gArtFilter["..dialog.tileid.."]=3D{maptoid=3D"..o=
therid..",rotation=3D\"x:"..dialog.xrot..",y:"..dialog.yrot..",z:"..dialog.=
zrot.."\",xadd=3D"..dialog.xadd..",yadd=3D"..dialog.yadd..",zadd=3D"..dialo=
g.zadd.."}")
+	-- update geometry
+	Renderer3D:RebuildMap()
+end
+
+function AdjustArtPositionControlDialog(tileid)
+	print("AdjustArtPositionControlDialog",tileid)
+	=

+	local xadd,yadd,zadd,xrot,yrot,zrot =3D 0,0,0, 0,0,0
+	=

+	-- read out start values
+	if gArtFilter[tileid] then
+		-- rotation=3D"x:0,y:0,z:90",xadd=3D0,yadd=3D1.85,zadd=3D0}
+		xadd =3D gArtFilter[tileid]["xadd"] or 0
+		yadd =3D gArtFilter[tileid]["yadd"] or 0
+		zadd =3D gArtFilter[tileid]["zadd"] or 0
+		local rot =3D gArtFilter[tileid]["rotation"] or "x:0,y:0,z:0"
+		xrot,yrot,zrot =3D AdjustArtPositionSplitRotationStringToXYZ(rot)
+	end
+	=

+	print("DEBUG",xadd,yadd,zadd,xrot,yrot,zrot)
+	=

+	local name =3D GetStaticTileTypeName(tileid) or "unknown"
+	local rows =3D { =

+		{{ type=3D"Label",		text=3D"adjust position of #"..tileid..": "..name }},
+		-- {{ type=3D"EditText",	w=3D300,h=3D16,text=3DAdjustArtPositionInfoStri=
ng(xadd,yadd,zadd,xrot,yrot,zrot),controlname=3D"info" }},
+		=

+		{{ type=3D"Label",		text=3D"move" }},
+		{{ type=3D"Button",text=3D"x + 0.1",onMouseDown=3Dfunction(widget) Adjus=
tArtPositionAdjustButtonHandler(widget.dialog, 0.1,0,0, 0,0,0) end }},
+		{{ type=3D"Button",text=3D"x - 0.1",onMouseDown=3Dfunction(widget) Adjus=
tArtPositionAdjustButtonHandler(widget.dialog, -0.1,0,0, 0,0,0) end }},
+		{{ type=3D"Button",text=3D"y + 0.1",onMouseDown=3Dfunction(widget) Adjus=
tArtPositionAdjustButtonHandler(widget.dialog, 0,0.1,0, 0,0,0) end }},
+		{{ type=3D"Button",text=3D"y - 0.1",onMouseDown=3Dfunction(widget) Adjus=
tArtPositionAdjustButtonHandler(widget.dialog, 0,-0.1,0, 0,0,0) end }},
+		{{ type=3D"Button",text=3D"z + 0.1",onMouseDown=3Dfunction(widget) Adjus=
tArtPositionAdjustButtonHandler(widget.dialog, 0,0,0.1, 0,0,0) end }},
+		{{ type=3D"Button",text=3D"z - 0.1",onMouseDown=3Dfunction(widget) Adjus=
tArtPositionAdjustButtonHandler(widget.dialog, 0,0,-0.1, 0,0,0) end }},
+		=

+		{{ type=3D"Label",		text=3D"rotate" }},
+		{{ type=3D"Button",text=3D"x + 45",onMouseDown=3Dfunction(widget) Adjust=
ArtPositionAdjustButtonHandler(widget.dialog, 0,0,0, 45,0,0) end }},
+		{{ type=3D"Button",text=3D"x - 45",onMouseDown=3Dfunction(widget) Adjust=
ArtPositionAdjustButtonHandler(widget.dialog, 0,0,0, -45,0,0) end }},
+		{{ type=3D"Button",text=3D"y + 45",onMouseDown=3Dfunction(widget) Adjust=
ArtPositionAdjustButtonHandler(widget.dialog, 0,0,0, 0,45,0) end }},
+		{{ type=3D"Button",text=3D"y - 45",onMouseDown=3Dfunction(widget) Adjust=
ArtPositionAdjustButtonHandler(widget.dialog, 0,0,0, 0,-45,0) end }},
+		{{ type=3D"Button",text=3D"z + 45",onMouseDown=3Dfunction(widget) Adjust=
ArtPositionAdjustButtonHandler(widget.dialog, 0,0,0, 0,0,45) end }},
+		{{ type=3D"Button",text=3D"z - 45",onMouseDown=3Dfunction(widget) Adjust=
ArtPositionAdjustButtonHandler(widget.dialog, 0,0,0, 0,0,-45) end }},
+
+		{{ type=3D"Button",text=3D"close",onMouseDown=3Dfunction(widget) widget.=
dialog:Destroy() end }},
+	}
+
+	local d =3D guimaker.MakeTableDlg(rows,100,10,true,true,gGuiDefaultStyleS=
et,"window") =

+	=

+	-- store current values in dialog
+	d.xadd,d.yadd,d.zadd,d.xrot,d.yrot,d.zrot =3D xadd,yadd,zadd,xrot,yrot,zr=
ot
+	d.tileid =3D tileid
+end
+
+function AdjustArtPosition (x,y,z)
+	print("AdjustArtPosition",x,y,z)
+	if (not x) then =

+		-- default params : read current mousepos
+		gCurrentRenderer:MousePick()
+		if (not gMousePickFoundHit) then return end
+		x,y,z =3D gCurrentRenderer:GetMouseHitTileCoords() =

+	end
+	print("AdjustArtPosition2",x,y,z)
+	=

+	=

+	local rows =3D { =

+		{ {type=3D"Label",		text=3D"AdjustArtPosition"}, },
+		{},{},{},{},
+	}
+	=

+	-- statics
+	local statics =3D ListStaticsNearPos(x,y,z,0)
+	for k,entity in pairs(statics) do =

+		local i =3D entity.iTileTypeID
+		local meshpath =3D GetModelPath(i)
+		local name =3D GetStaticTileTypeName(i) or "unknown"
+		table.insert(rows,{ =

+			{type=3D"Button",text=3D"#"..i..": "..name,onMouseDown=3Dfunction(widge=
t) widget.dialog:Destroy() AdjustArtPositionControlDialog(i) end},
+		})
+
+		print("DEBUG","static",i,meshpath)
+	end
+	=

+	-- dynamics
+	local dynamics =3D ListDynamicsNearPos(x,y,z,0)
+	for k,item in pairs(dynamics) do =

+		local i =3D item.artid
+		local meshpath =3D GetModelPath(i)
+		local texlist =3D meshpath and OgreMeshTextures(meshpath)
+		print("DEBUG","dynamic",i,meshpath)
+	end
+
+	table.insert(rows,{ =

+		{type=3D"Button",text=3D"close",onMouseDown=3Dfunction(widget) widget.di=
alog:Destroy() end},
+	})
+	=

+	guimaker.MakeTableDlg(rows,100,10,true,true,gGuiDefaultStyleSet,"window") =

+end
+
 =

 =

 function DevToolListStuffUnderMouse (x,y,z,radius)



From no-reply at zwischenwelt.org  Sat Feb  2 20:27:35 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 19:27:35 -0000
Subject: [Iris-commit] [IRIS] r1874 - in /trunk:
 data/grannys/materials/grannybase.material data/profiles/gfx_high.lua
 lua/lib.granny.lua
Message-ID: <20080202200007.1900B1C18071@zwischenwelt.org>

Author: sience
Date: Sat Feb  2 20:27:32 2008
New Revision: 1874

Log:
-specular lightning limited to (weapons, armor and shields)

Modified:
    trunk/data/grannys/materials/grannybase.material
    trunk/data/profiles/gfx_high.lua
    trunk/lua/lib.granny.lua

Modified: trunk/data/grannys/materials/grannybase.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/grannys/materials/grannybase.material (original)
+++ trunk/data/grannys/materials/grannybase.material Sat Feb  2 20:27:32 20=
08
@@ -16,11 +16,6 @@
 =

 		pass
 		{
-			lighting on
-			ambient 0.5 0.5 0.5 1.0
-			diffuse 1.0 1.0 1.0 1.0
-			specular 0.7 0.7 0.75 30.0
-						 =

 			scene_blend alpha_blend
 			alpha_rejection greater_equal 50
 			texture_unit
@@ -31,7 +26,25 @@
 	}
 }
 =

-material grannybase_human
+material grannybase_equipment : grannybase
+{
+	technique Plain
+	{
+		pass
+		{
+			lighting on
+			ambient 0.5 0.5 0.5 1.0
+			diffuse 1.0 1.0 1.0 1.0
+			specular 0.7 0.7 0.75 30.0
+		}
+	}
+}
+
+material grannybase_human : grannybase
+{
+}
+
+material grannybase_humanshader
 {
 	receive_shadows off
 =

@@ -75,11 +88,6 @@
 =

 		pass
 		{
-			lighting on
-			ambient 0.5 0.5 0.5 1.0
-			diffuse 1.0 1.0 1.0 1.0
-			specular 0.7 0.7 0.75 30.0
-
 			scene_blend alpha_blend
 			alpha_rejection greater_equal 50
 			texture_unit

Modified: trunk/data/profiles/gfx_high.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_high.lua (original)
+++ trunk/data/profiles/gfx_high.lua Sat Feb  2 20:27:32 2008
@@ -7,4 +7,4 @@
 =

 gSightRange	=3D 5
 =

-gPreloadStaticMesh =3D true
+--gPreloadStaticMesh =3D true

Modified: trunk/lua/lib.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.granny.lua (original)
+++ trunk/lua/lib.granny.lua Sat Feb  2 20:27:32 2008
@@ -212,11 +212,27 @@
 		-- texturepath will usually be an absolute path such as "/cavern/uostuff=
/uo/Models/Maps/UT256_Armor_Ring_V2.tga"
 =

 		--use skinshader for characters male/female, all other stuff uses granny=
base plain
-		if (IsBodyIDHuman(modelid) and gUseHumanSkinShader) then
-			matname =3D CloneMaterial("grannybase_human")
-		else
-			matname =3D CloneMaterial("grannybase")
-		end
+		local modelinfo =3D GetGrannyModelInfo(modelid)
+		if (modelinfo) then
+			local armor =3D string.find(string.lower(modelinfo.modelname),"armor")
+			local weapon =3D string.find(string.lower(modelinfo.modelname),"weapon")
+			local shield =3D string.find(string.lower(modelinfo.modelname),"shield")
+			if (modelinfo.typeid=3D=3D4 and (armor or weapon or shield)) then
+				matname =3D CloneMaterial("grannybase_equipment")
+			else
+				if (IsBodyIDHuman(modelid) and gUseHumanSkinShader) then
+					matname =3D CloneMaterial("grannybase_humanshader")
+				else
+					matname =3D CloneMaterial("grannybase")
+				end
+			end
+		end
+
+--		if (IsBodyIDHuman(modelid)) then
+--			if not(gUseHumanSkinShader) then matname =3D CloneMaterial("grannybas=
e_human") else matname =3D CloneMaterial("grannybase_humanshader") end
+--		else
+--			matname =3D CloneMaterial("grannybase_equipment")
+--		end
 =

 		if (gGrannyUseCompleteHuePalette) then
 			SetTexture(matname,CreateGrannyHuedTexture(GrannyTextureHook(texturepat=
h),GrannyTextureHook(texturemaskpath),gHueLoader,hue))
@@ -233,7 +249,7 @@
 		=

 		-- uses defaulthue=3Ddefhue from models.txt (FFFFFFFF : alpha-r-g-b)
 		if (hue =3D=3D 0) then
-			local modelinfo =3D GetGrannyModelInfo(modelid) =

+--			local modelinfo =3D GetGrannyModelInfo(modelid) =

 			if (modelinfo) then
 				local r =3D tonumber(string.sub(modelinfo.defhue,3,3 + 1),16) / 255.0
 				local g =3D tonumber(string.sub(modelinfo.defhue,5,5 + 1),16) / 255.0
@@ -319,7 +335,7 @@
 	if (not mygranny) then gGrannyMeshCache[modelid] =3D false return end
 	--~ CheckGrannyModel(mygranny)
 	local matname =3D GetGrannyMat(modelid,hue,mygranny)
-	local modelinfo =3D GetGrannyModelInfo(modelid)
+--	local modelinfo =3D GetGrannyModelInfo(modelid)
 	local meshname =3D mygranny:CreateOgreMesh(matname,skeletonname)
 	gGrannyMeshCache[cachename] =3D meshname
 	return meshname



From no-reply at zwischenwelt.org  Sat Feb  2 21:12:19 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 02 Feb 2008 20:12:19 -0000
Subject: [Iris-commit] [IRIS] r1875 - /trunk/lua/lib.granny.lua
Message-ID: <20080202201219.5C5301C182BB@zwischenwelt.org>

Author: sience
Date: Sat Feb  2 21:12:17 2008
New Revision: 1875

Log:
-specular lightning improved

Modified:
    trunk/lua/lib.granny.lua

Modified: trunk/lua/lib.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.granny.lua (original)
+++ trunk/lua/lib.granny.lua Sat Feb  2 21:12:17 2008
@@ -214,11 +214,14 @@
 		--use skinshader for characters male/female, all other stuff uses granny=
base plain
 		local modelinfo =3D GetGrannyModelInfo(modelid)
 		if (modelinfo) then
-			local armor =3D string.find(string.lower(modelinfo.modelname),"armor")
-			local weapon =3D string.find(string.lower(modelinfo.modelname),"weapon")
-			local shield =3D string.find(string.lower(modelinfo.modelname),"shield")
-			if (modelinfo.typeid=3D=3D4 and (armor or weapon or shield)) then
-				matname =3D CloneMaterial("grannybase_equipment")
+			if (modelinfo.typeid=3D=3D4) then
+				if (string.find(string.lower(modelinfo.modelname),"armor")) or
+				   (string.find(string.lower(modelinfo.modelname),"weapon")) or
+				   (string.find(string.lower(modelinfo.modelname),"shield")) then
+					matname =3D CloneMaterial("grannybase_equipment")
+				else
+					matname =3D CloneMaterial("grannybase")
+				end
 			else
 				if (IsBodyIDHuman(modelid) and gUseHumanSkinShader) then
 					matname =3D CloneMaterial("grannybase_humanshader")
@@ -227,12 +230,6 @@
 				end
 			end
 		end
-
---		if (IsBodyIDHuman(modelid)) then
---			if not(gUseHumanSkinShader) then matname =3D CloneMaterial("grannybas=
e_human") else matname =3D CloneMaterial("grannybase_humanshader") end
---		else
---			matname =3D CloneMaterial("grannybase_equipment")
---		end
 =

 		if (gGrannyUseCompleteHuePalette) then
 			SetTexture(matname,CreateGrannyHuedTexture(GrannyTextureHook(texturepat=
h),GrannyTextureHook(texturemaskpath),gHueLoader,hue))



From no-reply at zwischenwelt.org  Sun Feb  3 01:04:53 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 03 Feb 2008 00:04:53 -0000
Subject: [Iris-commit] [IRIS] r1876 - /trunk/lua/lib.3d.map.lua
Message-ID: <20080203000453.3DA291C1868A@zwischenwelt.org>

Author: sience
Date: Sun Feb  3 01:04:52 2008
New Revision: 1876

Log:
-some small improvements (local vars. moved out of for statements)

Modified:
    trunk/lua/lib.3d.map.lua

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sun Feb  3 01:04:52 2008
@@ -108,24 +108,33 @@
 	=

 	-- generate geometry
 	local vertexnum =3D 0
+	local bx0,by0
+	local x,y
+	local tiletype00,z00
+	local tiletype01,z01
+	local tiletype10,z10
+	local tiletype11,z11
+	local e =3D 4/512
+	local u1,v1 =3D 0,0
+
 	for k,low in pairs(lowlist) do
-		local bx0 =3D low.x * cs
-		local by0 =3D low.y * cs
+		bx0 =3D low.x * cs
+		by0 =3D low.y * cs
 		for bx =3D bx0,bx0 + cs-1 do -- iBlockUO_X
 		for by =3D by0,by0 + cs-1 do
 			for px=3D0,1 do
 			for py=3D0,1 do
-				local x =3D 8*bx+4*px
-				local y =3D 8*by+4*py
-				local tiletype00,z00 =3D GetGroundAtAbsPos(x+0,y+0)
-				local tiletype01,z01 =3D GetGroundAtAbsPos(x+0,y+4)
-				local tiletype10,z10 =3D GetGroundAtAbsPos(x+4,y+0)
-				local tiletype11,z11 =3D GetGroundAtAbsPos(x+4,y+4)
+				x =3D 8*bx+4*px
+				y =3D 8*by+4*py
+				tiletype00,z00 =3D GetGroundAtAbsPos(x+0,y+0)
+				tiletype01,z01 =3D GetGroundAtAbsPos(x+0,y+4)
+				tiletype10,z10 =3D GetGroundAtAbsPos(x+4,y+0)
+				tiletype11,z11 =3D GetGroundAtAbsPos(x+4,y+4)
 				=

 				local u0,v0,w,h =3D MultiTexGetTexCoordsForTiletype(tiletype00)
-				local e =3D 4/512
+
 				if (not u0) then u0,v0,w,h =3D e,e,1/16-e,1/16-e end
-				local u1,v1 =3D u0+w*4,v0+h*4
+				u1,v1 =3D u0+w*4,v0+h*4
 				gfx:RenderableVertex(-x  ,y  ,(z00 or 0)*0.1, 0,0,1, u0,v0)
 				gfx:RenderableVertex(-x-4,y  ,(z10 or 0)*0.1, 0,0,1, u1,v0)
 				gfx:RenderableVertex(-x  ,y+4,(z01 or 0)*0.1, 0,0,1, u0,v1)
@@ -143,12 +152,10 @@
 	=

 	-- finish renderable
 	gfx:RenderableEnd()
-	--~ if (bGfxInit) then
-		gfx:SetMaterial("terrain_multitex_far")
-		gfx:SetCastShadows(false)
-		local x,y,z =3D self:UOPosToLocal(0,0,0)
-		gfx:SetPosition(x, y, z)
-	--~ end
+	gfx:SetMaterial("terrain_multitex_far")
+	gfx:SetCastShadows(false)
+	local x,y,z =3D self:UOPosToLocal(0,0,0)
+	gfx:SetPosition(x, y, z)
 end
 =

 =

@@ -442,12 +449,14 @@
 	-- water analysis
 	if (not gDisableWater) then
 		if (gGroundBlockLoader) then
+			local tiletype,z
+			local tx,ty
 			for bx =3D 0,self.ROBMAP_CHUNK_SIZE-1 do
 				for by =3D 0,self.ROBMAP_CHUNK_SIZE-1 do
 					for lx =3D 0,7 do
 						for ly =3D 0,7 do
-							local tiletype,z =3D gGroundBlockLoader:GetTile(iBlockUO_X+bx,iBloc=
kUO_Y+by,lx,ly)
-							local tx,ty =3D lx + (bx*8), ly + (by*8)
+							tiletype,z =3D gGroundBlockLoader:GetTile(iBlockUO_X+bx,iBlockUO_Y+=
by,lx,ly)
+							tx,ty =3D lx + (bx*8), ly + (by*8)
 							=

 							if tiletype and FilterIsMapWater(tiletype) then
 								chunk:SetWaterZ(tx,ty,z)
@@ -573,9 +582,10 @@
 			=

 			-- print("DEBUG","WATERSTART",count,vc,ic)
 			local index =3D 0
+			local x,y,z
 			for k,v in pairs(chunk.mWaterZMap) do
-				local x,y =3D unpack(strsplit("_",k))
-				local z =3D chunk.mWaterZMap[x.."_"..y] * 0.1
+				x,y =3D unpack(strsplit("_",k))
+				z =3D chunk.mWaterZMap[x.."_"..y] * 0.1
 =

 				-- print("DEBUG","water tile",x,y,z,k,v)
 =

@@ -595,7 +605,7 @@
 			gfx:SetMaterial("water")
 			gfx:SetCastShadows(false)
 			=

-			local x,y,z =3D self:UOPosToLocal(chunk.miX * self.ROBMAP_CHUNK_SIZE * =
8, chunk.miY * self.ROBMAP_CHUNK_SIZE * 8, 0.1)
+			x,y,z =3D self:UOPosToLocal(chunk.miX * self.ROBMAP_CHUNK_SIZE * 8, chu=
nk.miY * self.ROBMAP_CHUNK_SIZE * 8, 0.1)
 =

 			gfx:SetPosition(x, y, z)
 			=

@@ -669,12 +679,13 @@
 =

 		-- check multis
 		if (not playerIsInside) then
+			local iTileTypeID,iX,iY,iZ,iHue
+			local multi
 			for k,v in pairs(gMultis) do
-				local multi =3D k
+				multi =3D k
 				if multi.lparts then
 					for k,v in pairs(multi.lparts) do
-
-						local iTileTypeID,iX,iY,iZ,iHue =3D unpack(v)
+						iTileTypeID,iX,iY,iZ,iHue =3D unpack(v)
 						if	iX =3D=3D x and iY =3D=3D y  and iZ >=3D playerheadpos then
 							playerIsInside =3D true
 							if ((not zloc_roof) or (zloc_roof > iZ)) then zloc_roof =3D iZ end
@@ -686,11 +697,12 @@
 =

 		-- check dynamics to detect dynamic houseroofs and other stuff above the=
 head
 		if (not playerIsInside) then
+			local iZ
 			for k,dynamic in pairs(GetDynamicList()) do
 				if (DynamicIsInWorld(dynamic)) then
 					if (x =3D=3D dynamic.xloc and y =3D=3D dynamic.yloc and dynamic.zloc =
>=3D playerheadpos) then
 						playerIsInside =3D true
-						local iZ =3D dynamic.zloc
+						iZ =3D dynamic.zloc
 						if ((not zloc_roof) or (zloc_roof > iZ)) then zloc_roof =3D iZ end
 					end
 				end
@@ -767,7 +779,7 @@
 		--print("DestroyMapChunk",x,y)
 		chunk.bIsDead =3D true
 		if (chunk.mWaterGfx) then chunk.mWaterGfx:Destroy() chunk.mWaterGfx =3D =
nil end
-		if (chunk.fastbatch) then chunk.fastbatch:Destroy() end
+		if (chunk.fastbatch) then chunk.fastbatch:Destroy() chunk.fastbatch =3D =
nil end
 		if (chunk.pStaticGeometryTerrain) then chunk.pStaticGeometryTerrain:Dest=
roy() chunk.pStaticGeometryTerrain =3D nil end
 		if (chunk.terraingfx) then chunk.terraingfx:Destroy() chunk.terraingfx =
=3D nil end
 		if (chunk.terrain_multitex_gfx) then chunk.terrain_multitex_gfx:Destroy(=
) chunk.terrain_multitex_gfx =3D nil end



From no-reply at zwischenwelt.org  Sun Feb  3 14:02:46 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 03 Feb 2008 13:02:46 -0000
Subject: [Iris-commit] [IRIS] r1877 - in /trunk: bin/iris2.exe
 lua/lib.3d.combat.lua lua/lib.data.lua lua/lib.fallback.lua
 lua/lib.tilefreewalk.lua lua/lib.uoids.lua lua/lib.walking2.lua
 lua/main.lua vs8/iris.sln vs8/iris.vcproj
Message-ID: <20080203140006.9331E1C182F9@zwischenwelt.org>

Author: sience
Date: Sun Feb  3 14:02:45 2008
New Revision: 1877

Log:
-pagedgeometry linked into win32 binary (currently doesn't work right)
-combattext shadows disabled (also some other shadows)
-project updated
-some local moved out of for statements (speed)

Modified:
    trunk/bin/iris2.exe
    trunk/lua/lib.3d.combat.lua
    trunk/lua/lib.data.lua
    trunk/lua/lib.fallback.lua
    trunk/lua/lib.tilefreewalk.lua
    trunk/lua/lib.uoids.lua
    trunk/lua/lib.walking2.lua
    trunk/lua/main.lua
    trunk/vs8/iris.sln
    trunk/vs8/iris.vcproj

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/lib.3d.combat.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.combat.lua (original)
+++ trunk/lua/lib.3d.combat.lua Sun Feb  3 14:02:45 2008
@@ -33,6 +33,7 @@
 	o.gfx:SetForceRotCam(GetMainCam())
 	o.gfx:SetText(text, size, r, g, b, a)
 	o.gfx:SetPosition(x,y,z)
+	o.gfx:SetCastShadows(false)
 						 =

 	table.insert(self.gCombatFadeDamageText,o)
 end

Modified: trunk/lua/lib.data.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.data.lua (original)
+++ trunk/lua/lib.data.lua Sun Feb  3 14:02:45 2008
@@ -225,6 +225,7 @@
 	local gfx =3D CreateRootGfx3D(name_scenemanager)
 	gfx:SetMesh(meshname)
 	gfx:SetPosition(0.5,-1,-dist);
+	gfx:SetCastShadows(false)
 	local qw,qx,qy,qz =3D Quaternion.fromAngleAxis(angv,1,0,0)
 	gfx:SetOrientation(Quaternion.Mul(qw,qx,qy,qz,Quaternion.fromAngleAxis(an=
gh + 180*gfDeg2Rad,0,1,0)))
 	tex:Update()

Modified: trunk/lua/lib.fallback.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.fallback.lua (original)
+++ trunk/lua/lib.fallback.lua Sun Feb  3 14:02:45 2008
@@ -117,6 +117,7 @@
 =

 		GfxSetBox(gfx,1,1,1,nil,nil,0,0,0)
 		gfx:SetMaterial("fallbackbox")
+		gfx:SetCastShadows(false)
 		=

 		gFallBackBoxMesh =3D gfx:RenderableConvertToMesh()
 		gfx:Destroy()

Modified: trunk/lua/lib.tilefreewalk.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.tilefreewalk.lua (original)
+++ trunk/lua/lib.tilefreewalk.lua Sun Feb  3 14:02:45 2008
@@ -218,7 +218,7 @@
 				end
 			end
 		end
-		=

+
 		self:SetPos_ClientSide(x,y,z)
 		self:UpdateClientPosMarker()
 	end
@@ -557,6 +557,8 @@
 function gTileFreeWalk:Impl_CalcWalkStep (xloc,yloc,zloc,iDir)
 	-- if (xloc =3D=3D 1670 and yloc =3D=3D 283) then return false end
 	local bIsWalkable,iNewZ	=3D GetNearestGroundLevel(xloc,yloc,zloc,iDir)
+-- SiENcE
+--print(xloc,yloc,zloc,iDir,iNewZ,bIsWalkable)
 	return bIsWalkable and iNewZ
 end
 =

@@ -695,6 +697,7 @@
 function gTileFreeWalk:DebugMarkerGroup_AddSphere (groupname,x,y,z,fRad,r,=
g,b)
 	local gfx =3D CreateRootGfx3D()
 	gfx:SetMesh(MakeSphereMesh(11,11,fRad,fRad,fRad,r,g,b))	=

+	gfx:SetCastShadows(false)
 	gfx:SetPosition(x,y,z)
 	self:DebugMarkerGroup_AddGfx(groupname,gfx)
 end
@@ -703,6 +706,7 @@
 	local gfx =3D CreateRootGfx3D()
 	GfxSetCylinderZ(gfx,fRad,fHeight)
 	gfx:SetMaterial(GetPlainColourMat(r,g,b))
+	gfx:SetCastShadows(false)
 	gfx:SetPosition(x,y,z)
 	self:DebugMarkerGroup_AddGfx(groupname,gfx)
 end
@@ -717,6 +721,7 @@
 	vc =3D DrawQuad(gfx,vc, x1,y1,z1+h, x2,y2,z2+h, x1,y1,z1, x2,y2,z2, 0,0, =
1,0, 0,1, 1,1)
 	gfx:RenderableEnd()
 	gfx:SetMaterial(GetPlainColourMat(r,g,b))
+	gfx:SetCastShadows(false)
 	self:DebugMarkerGroup_AddGfx(groupname,gfx)
 end
 =


Modified: trunk/lua/lib.uoids.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.uoids.lua (original)
+++ trunk/lua/lib.uoids.lua Sun Feb  3 14:02:45 2008
@@ -39,7 +39,7 @@
 --Walk Limits
 --gPersonHeight =3D 16
 gMaxZ_Climb	=3D 7		--3 is to low for ladders
-gMaxZ_Fall	=3D 20	--19 is maybe too much
+gMaxZ_Fall	=3D 7		-- TODO: char falls through hauslayers; 20 is maybe too =
much
 gIllegalZ	=3D 127
 gMaxZ_Blocks =3D 14
 =


Modified: trunk/lua/lib.walking2.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.walking2.lua (original)
+++ trunk/lua/lib.walking2.lua Sun Feb  3 14:02:45 2008
@@ -238,8 +238,10 @@
 function CheckZSpace(flaglist, zloc, diagonalCheck, height)  =

 	diagonalCheck =3D diagonalCheck or false =

 	height =3D height or 15
+	=

+	local myflaglist
 	for i=3D1, height, 1 do
-		local myflaglist =3D flaglist[zloc+i]
+		myflaglist =3D flaglist[zloc+i]
 		if (myflaglist ~=3D nil) then
 			if (diagonalCheck) then
 				if (myflaglist.bImpassable
@@ -385,11 +387,13 @@
 	-- find closest surface (z + 0, -1, +1, -2, +2 etc)
 	-- check for maxfall and maxclimb
 	-- if surface is maptile +5 climbing bonus
-	=

+
 	local iCur
+	local myflaglist
 	for i=3D0, math.max((gMaxZ_Climb + 5), gMaxZ_Fall), 1 do
 		iCur =3D iStartZ + i
-		local myflaglist =3D flaglist[iCur] =

+		myflaglist =3D flaglist[iCur]
+
 		if (i ~=3D 0 and myflaglist ~=3D nil) then
 			--~ printwalkdebug("-----iCur=3D" .. iCur)
 			if (i < gMaxZ_Climb or (i < (gMaxZ_Climb + 5) and (myflaglist.bMaptile =
or myflaglist.bBridge))) then
@@ -413,8 +417,7 @@
 				end
 			end
 		end
-		=

-		=

+
 		iCur =3D iStartZ - i
 		if (flaglist[iCur] ~=3D nil) then
 			--~ printwalkdebug("-----iCur=3D" .. iCur)
@@ -422,6 +425,8 @@
 				if ((not flaglist[iCur].bImpassable) and flaglist[iCur].bSurface) then
 					--~ printwalkdebug("------found Surface");
 					if (CheckZSpace(flaglist, iCur)) then
+-- SiENcE
+--					if (CheckZSpace(flaglist, iCur,false,gMaxZ_Fall)) then
 						--~ printwalkdebug("------ checkSpace successful")
 						=

 						local bAdjacent =3D CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
@@ -431,6 +436,7 @@
 						--~ printwalkdebug()
 						--~ printdebug("walking",sprintf( "Walking calculations took %d msec=
.\n", Client_GetTicks() - Walking_Start ))
 						if (bAdjacent) then
+							--~ printwalkdebug("walking",sprintf( "return true, %d\n",iCur))
 							return true, iCur
 						else
 							return false, 255

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Feb  3 14:02:45 2008
@@ -321,7 +321,6 @@
 	InvokeExporters()
 	=

 	------------------------------------------ obsolete, just for testing ---=
--------------------------------
-	--[[
 	if (false) then -- texture-atlas test
 		local w =3D 1024
 		local iArtMapIDList =3D {65,129,321,449,513}
@@ -345,7 +344,6 @@
 		img:Destroy()
 		os.exit(0)
 	end
-	]]--
 	-------------------------------------------------------------------------=
---------------------------------
 	=

 	gCurrentRenderer:PreInit()

Modified: trunk/vs8/iris.sln
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.sln (original)
+++ trunk/vs8/iris.sln Sun Feb  3 14:02:45 2008
@@ -3,10 +3,16 @@
 # Visual C++ Express 2005
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "iris", "iris.vcproj=
", "{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}"
 	ProjectSection(ProjectDependencies) =3D postProject
+		{5A02700F-C389-4E19-AF35-C4C893E72A64} =3D {5A02700F-C389-4E19-AF35-C4C8=
93E72A64}
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB} =3D {74FA3830-CC5D-E24F-AFEA-740C=
C2710DFB}
 		{FF3B6490-D65F-7B41-982B-8D8339958224} =3D {FF3B6490-D65F-7B41-982B-8D83=
39958224}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "lua50_lib", "..\lug=
re\lib\lua-5.0.3\mak.vs2005\lua50_lib.vcproj", "{FF3B6490-D65F-7B41-982B-8D=
8339958224}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "pagedgeometry_lib",=
 "..\lugre\lib\paged_geometry\vs2005\pagedgeometry_lib\pagedgeometry_lib.vc=
proj", "{5A02700F-C389-4E19-AF35-C4C893E72A64}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "Caelum", "..\lugre\=
lib\caelum\Caelum.vcproj", "{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}"
 EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) =3D preSolution
@@ -27,6 +33,18 @@
 		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
 		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
 		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release|Win32.Build.0 =3D Release=
|Win32
+		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
+		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Debug|Win32.Build.0 =3D Debug|Win=
32
+		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release - boost-threads_enabled|W=
in32.ActiveCfg =3D Release|Win32
+		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
+		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
+		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release|Win32.Build.0 =3D Release=
|Win32
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Debug|Win32.Build.0 =3D Debug|Win=
32
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release - boost-threads_enabled|W=
in32.ActiveCfg =3D Release|Win32
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
+		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release|Win32.Build.0 =3D Release=
|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) =3D preSolution
 		HideSolutionNode =3D FALSE

Modified: trunk/vs8/iris.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.vcproj (original)
+++ trunk/vs8/iris.vcproj Sun Feb  3 14:02:45 2008
@@ -125,8 +125,8 @@
 				OmitFramePointers=3D"true"
 				EnableFiberSafeOptimizations=3D"false"
 				WholeProgramOptimization=3D"true"
-				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;$(OGRE_HO=
ME)\include\&quot;;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\inc=
lude\zlib;..\include\fmodx;&quot;..\lugre\lib\lua-5.0.3\include\&quot;;..\l=
ugre\lib\cadune_tree\include;..\lugre\include;..\lugre\lib\md5\include;&quo=
t;c:\Programme\Microsoft Platform SDK\Include\&quot;"
-				PreprocessorDefinitions=3D"WIN32;USE_FMOD;USE_LUGRE_LIB_CADUNE_TREE;MA=
IN_WORKING_DIR=3D\&quot;../\&quot;;USE_LUGRE_LIB_MD5"
+				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;c:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\include\zlib;..\lugre=
\include;..\include\fmodx;&quot;..\lugre\lib\lua-5.0.3\include\&quot;;..\lu=
gre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\lib\paged_geo=
metry\include;..\lugre\lib\caelum\include"
+				PreprocessorDefinitions=3D"WIN32;USE_FMOD;MAIN_WORKING_DIR=3D\&quot;..=
/\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CADUNE_TREE;USE_LUGRE_LIB_PAGED_GE=
OMETRY"
 				GeneratePreprocessedFile=3D"0"
 				RuntimeLibrary=3D"0"
 				EnableEnhancedInstructionSet=3D"1"
@@ -147,9 +147,9 @@
 			/>
 			<Tool
 				Name=3D"VCLinkerTool"
-				AdditionalDependencies=3D"LIBCMT.lib LIBCPMT.LIB AdvAPI32.Lib User32.L=
ib zlib.lib ws2_32.lib lua50.lib OgreMain.lib OIS.lib fmodex_vc.lib"
+				AdditionalDependencies=3D"LIBCMT.lib LIBCPMT.LIB AdvAPI32.Lib User32.L=
ib zlib.lib ws2_32.lib lua50.lib OgreMain.lib OIS.lib fmodex_vc.lib pagedge=
ometry_lib.lib"
 				OutputFile=3D"$(OutDir)\..\..\bin\iris2.exe"
-				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;"
+				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\p=
aged_geometry\vs2005\lib\static;..\lugre\lib\caelum\lib\static"
 				GenerateManifest=3D"true"
 				IgnoreAllDefaultLibraries=3D"true"
 				IgnoreDefaultLibraryNames=3D""



From no-reply at zwischenwelt.org  Sun Feb  3 15:31:09 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 03 Feb 2008 14:31:09 -0000
Subject: [Iris-commit] [IRIS] r1878 - in /trunk/vs7: iris 7.1.vcproj
	irisvd.vcproj
Message-ID: <20080203143109.A28AD1524004@zwischenwelt.org>

Author: sience
Date: Sun Feb  3 15:31:08 2008
New Revision: 1878

Log:
-vs2003 project updated (works now very well)
-vd project deleted

Removed:
    trunk/vs7/irisvd.vcproj
Modified:
    trunk/vs7/iris 7.1.vcproj

Modified: trunk/vs7/iris 7.1.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs7/iris 7.1.vcproj (original)
+++ trunk/vs7/iris 7.1.vcproj Sun Feb  3 15:31:08 2008
@@ -41,7 +41,7 @@
 				AdditionalOptions=3D"OgreMain.lib OIS.lib liblua.lib liblualib.lib wso=
ck32.lib fmodvc.lib sdl.lib zlib.lib"
 				OutputFile=3D"../bin/Iris_not_opt.exe"
 				LinkIncremental=3D"0"
-				AdditionalLibraryDirectories=3D"&quot;$(OGRE_HOME)\lib\&quot;;..\libs;=
..\libs\lua;..\libs\fmod;..\libs\zlib"
+				AdditionalLibraryDirectories=3D"&quot;$(OGRE_HOME)\lib\&quot;;..\libs;=
..\libs\lua;..\libs\fmod;..\libs\zlib;..\lugre\include"
 				IgnoreAllDefaultLibraries=3D"FALSE"
 				IgnoreDefaultLibraryNames=3D"libcmtd.lib"
 				GenerateDebugInformation=3D"TRUE"
@@ -92,7 +92,7 @@
 				FavorSizeOrSpeed=3D"1"
 				OptimizeForProcessor=3D"3"
 				OptimizeForWindowsApplication=3D"TRUE"
-				AdditionalIncludeDirectories=3D"&quot;$(OGRE_HOME)\include&quot;"
+				AdditionalIncludeDirectories=3D"&quot;$(OGRE_HOME)\include&quot;;..\lu=
gre\include;&quot;..\lugre\lib\lua-5.0.3\include&quot;;..\include\zlib;..\i=
nclude\fmodx"
 				PreprocessorDefinitions=3D"WIN32;NDEBUG;_CONSOLE;ZC_BUILDING_ZBASE;ZC_=
BUILDING_ZCSL"
 				RuntimeLibrary=3D"2"
 				StructMemberAlignment=3D"0"
@@ -107,15 +107,11 @@
 				Name=3D"VCCustomBuildTool"/>
 			<Tool
 				Name=3D"VCLinkerTool"
-				AdditionalOptions=3D"/LIBPATH:../libs
-sdl.lib SDLmain.lib sdl_image.lib
-opengl32.lib glu32.lib wsock32.lib
-ogg.lib vorbis.lib vorbisenc.lib vorbisfile.lib"
-				AdditionalDependencies=3D"$(OGRE_HOME)\lib\OgreMain.lib $(OGRE_HOME)\l=
ib\OgreGUIRenderer.lib liblua.lib liblualib.lib"
-				OutputFile=3D"../bin/Iris_not_opt.exe"
+				AdditionalDependencies=3D"OgreMain.lib wsock32.lib zlib.lib lua50.lib =
OIS.lib fmodex_vc.lib"
+				OutputFile=3D"../bin/Iris_vs2003.exe"
 				LinkIncremental=3D"0"
 				SuppressStartupBanner=3D"TRUE"
-				AdditionalLibraryDirectories=3D"&quot;$(OGRE_HOME)\lib\&quot;;..\libs;=
..\libs\lua;..\libs\fmod"
+				AdditionalLibraryDirectories=3D"&quot;$(OGRE_HOME)\lib\&quot;;..\libs\=
zlib;..\libs\fmodx;&quot;..\lugre\lib\lua-5.0.3\lib\static&quot;"
 				IgnoreAllDefaultLibraries=3D"FALSE"
 				IgnoreDefaultLibraryNames=3D""
 				GenerateDebugInformation=3D"FALSE"
@@ -185,10 +181,10 @@
 				Name=3D"VCLinkerTool"
 				IgnoreImportLibrary=3D"FALSE"
 				AdditionalOptions=3D"OgreMain.lib OIS.lib liblua.lib liblualib.lib wso=
ck32.lib fmodvc.lib sdl.lib zlib.lib"
-				OutputFile=3D"../bin/iris2.exe"
+				OutputFile=3D"../bin/iris__vs2003_notopt.exe"
 				LinkIncremental=3D"0"
-				SuppressStartupBanner=3D"FALSE"
-				AdditionalLibraryDirectories=3D"&quot;$(OGRE_HOME)\lib\&quot;;..\libs;=
..\libs\lua;..\libs\fmod;..\libs\zlib"
+				SuppressStartupBanner=3D"TRUE"
+				AdditionalLibraryDirectories=3D"&quot;$(OGRE_HOME)\lib\&quot;;..\libs\=
zlib;..\libs\fmodx;&quot;..\lugre\lib\lua-5.0.3\lib\static&quot;"
 				IgnoreAllDefaultLibraries=3D"FALSE"
 				IgnoreDefaultLibraryNames=3D"libcmt.lib"
 				GenerateDebugInformation=3D"FALSE"
@@ -230,231 +226,86 @@
 			Name=3D"includes"
 			Filter=3D"">
 			<File
-				RelativePath=3D"..\include\bitmask.h">
-			</File>
-			<File
 				RelativePath=3D"..\include\builder.h">
 			</File>
 			<File
-				RelativePath=3D"..\include\camera.h">
-			</File>
-			<File
 				RelativePath=3D"..\include\data.h">
 			</File>
 			<File
-				RelativePath=3D"..\include\game.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\gfx3D.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\input.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\legacydata.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\listener.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\luabind.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\luaxml.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\meshshape.h">
+				RelativePath=3D"..\include\grannyloader_i2.h">
+			</File>
+			<File
+				RelativePath=3D"..\include\grannyogreloader.h">
+			</File>
+			<File
+				RelativePath=3D"..\include\grannyparser.h">
+			</File>
+			<File
+				RelativePath=3D"..\include\huffman.h">
 			</File>
 			<File
 				RelativePath=3D"..\include\ogremanualloader.h">
 			</File>
 			<File
-				RelativePath=3D"..\include\ogrewrapper.h">
-			</File>
-			<File
 				RelativePath=3D"..\include\pathsearch.h">
 			</File>
 			<File
-				RelativePath=3D"..\include\prefix.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\profile.h">
-			</File>
-			<File
 				RelativePath=3D"..\include\radar.h">
 			</File>
 			<File
-				RelativePath=3D"..\include\rendertexture.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\robrenderable.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\robstring1.2.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\scripting.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\shell.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\smartptr.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\sound.h">
-			</File>
-			<File
 				RelativePath=3D"..\include\spritemanager.h">
 			</File>
 			<File
 				RelativePath=3D"..\include\terrain.h">
 			</File>
-			<File
-				RelativePath=3D"..\include\timer.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\tinystr.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\tinyxml.h">
-			</File>
-			<File
-				RelativePath=3D"..\include\viewport.h">
-			</File>
-			<Filter
-				Name=3D"network"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\include\fifo.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\huffman.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\net.h">
-				</File>
-			</Filter>
-			<Filter
-				Name=3D"gui"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\include\BorderColourClipPaneOverlay.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\ColourClipPaneOverlay.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\ColourClipTextOverlay.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\CompassOverlay.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\gfx2D.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\RobRenderableOverlay.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\SortedOverlayContainer.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\widget.h">
-				</File>
-			</Filter>
-			<Filter
-				Name=3D"grany_new"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\include\grannyloader_i2.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\grannyogreloader.h">
-				</File>
-				<File
-					RelativePath=3D"..\include\grannyparser.h">
-				</File>
-			</Filter>
-			<Filter
-				Name=3D"2DRenderer"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\include\spritemanager.h">
-				</File>
-			</Filter>
 		</Filter>
 		<Filter
 			Name=3D"sources"
 			Filter=3D"">
 			<File
-				RelativePath=3D"..\src\bitmask.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\bitmask_L.cpp">
-			</File>
-			<File
 				RelativePath=3D"..\src\builder.cpp">
 			</File>
 			<File
 				RelativePath=3D"..\src\builder_L.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\camera.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\camera_L.cpp">
-			</File>
-			<File
 				RelativePath=3D"..\src\data.cpp">
 			</File>
 			<File
 				RelativePath=3D"..\src\data_L.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\game.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\gfx3D.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\gfx3D_L.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\input.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\legacydata.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\listener.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\luaxml.cpp">
+				RelativePath=3D"..\src\granny_L.cpp">
+			</File>
+			<File
+				RelativePath=3D"..\src\grannydump.cpp">
+			</File>
+			<File
+				RelativePath=3D"..\src\grannyloader_i2.cpp">
+			</File>
+			<File
+				RelativePath=3D"..\src\grannyogreloader.cpp">
+			</File>
+			<File
+				RelativePath=3D"..\src\grannyparser.cpp">
+			</File>
+			<File
+				RelativePath=3D"..\src\huffman.cpp">
 			</File>
 			<File
 				RelativePath=3D"..\src\main.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\material_L.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\meshshape.cpp">
-			</File>
-			<File
 				RelativePath=3D"..\src\ogremanualloader.cpp">
 			</File>
 			<File
 				RelativePath=3D"..\src\ogremanualloader_L.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\ogrewrapper.cpp">
-			</File>
-			<File
 				RelativePath=3D"..\src\pathsearch.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\profile.cpp">
+				RelativePath=3D"..\src\prefix.cpp">
 			</File>
 			<File
 				RelativePath=3D"..\src\radar.cpp">
@@ -463,22 +314,7 @@
 				RelativePath=3D"..\src\radar_L.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\rendertexture.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\rendertexture_L.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\robrenderable.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\robstring1.2.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\scripting.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\shell.cpp">
+				RelativePath=3D"..\src\scripting.iris.cpp">
 			</File>
 			<File
 				RelativePath=3D"..\src\spritemanager.cpp">
@@ -490,116 +326,357 @@
 				RelativePath=3D"..\src\terrain.cpp">
 			</File>
 			<File
-				RelativePath=3D"..\src\timer.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\tinystr.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\tinyxml.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\tinyxmlerror.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\tinyxmlparser.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\viewport.cpp">
-			</File>
-			<File
-				RelativePath=3D"..\src\viewport_L.cpp">
-			</File>
+				RelativePath=3D"..\src\terrain_multitex.cpp">
+			</File>
+		</Filter>
+		<Filter
+			Name=3D"lugre"
+			Filter=3D"">
 			<Filter
-				Name=3D"network"
+				Name=3D"src"
 				Filter=3D"">
 				<File
-					RelativePath=3D"..\src\fifo_L.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\huffman.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\net.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\net_L.cpp">
+					RelativePath=3D"..\lugre\src\lugre_beam.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_beam_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_bitmask.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_bitmask_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_BorderColourClipPaneOverlay.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_cadune_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_caelum_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_camera_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_ColourClipPaneOverlay.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_ColourClipTextOverlay.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_CompassOverlay.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_fastbatch.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_fifo_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_game.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_gfx2D.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_gfx2D_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_gfx3D.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_gfx3D_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_image_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_input.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_listener.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_luaxml.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_main.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_material_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_md5_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_meshbuffer.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_meshbuffer_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_meshloader.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_meshshape.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_net.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_net_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_ode.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_ode_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_ogrewrapper.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_paged_geometry_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_profile.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_random.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_random_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_rendertexture_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_robrenderable.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_RobRenderableOverlay.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_robstring.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_scripting.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_scripting.general.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_scripting.ogre.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_shell.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_SortedOverlayContainer.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_sound.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_sound_fmod.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_sound_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_sound_openal.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_sound_openal2.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_texatlas.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_texatlas_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_thread.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_thread_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_timer.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_transform_mesh.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_viewport_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_widget.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\lugre_widget_L.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\tinystr.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\tinyxml.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\tinyxmlerror.cpp">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\src\tinyxmlparser.cpp">
 				</File>
 			</Filter>
 			<Filter
-				Name=3D"gui"
+				Name=3D"include"
 				Filter=3D"">
 				<File
-					RelativePath=3D"..\src\BorderColourClipPaneOverlay.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\ColourClipPaneOverlay.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\ColourClipTextOverlay.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\CompassOverlay.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\gfx2D.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\gfx2D_L.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\RobRenderableOverlay.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\SortedOverlayContainer.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\widget.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\widget_L.cpp">
-				</File>
-			</Filter>
-			<Filter
-				Name=3D"granny_new"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\src\granny_L.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\grannydump.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\grannyloader_i2.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\grannyogreloader.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\grannyparser.cpp">
-				</File>
-			</Filter>
-			<Filter
-				Name=3D"2DRenderer"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\src\spritemanager.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\spritemanager_L.cpp">
-				</File>
-			</Filter>
-			<Filter
-				Name=3D"sound"
-				Filter=3D"">
-				<File
-					RelativePath=3D"..\src\sound.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\sound_fmod.cpp">
-				</File>
-				<File
-					RelativePath=3D"..\src\sound_L.cpp">
+					RelativePath=3D"..\lugre\include\lugre_beam.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_bitmask.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_BorderColourClipPaneOverlay.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_cadune.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_caelum.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_camera.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_ColourClipPaneOverlay.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_ColourClipTextOverlay.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_CompassOverlay.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_fastbatch.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_fifo.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_game.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_gfx2D.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_gfx3D.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_image.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_input.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_listener.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_luabind.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_luaxml.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_main.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_md5.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_meshbuffer.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_meshloader.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_meshshape.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_net.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_ode.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_ogrefonthelper.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_ogrewrapper.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_paged_geometry.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_prefix.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_profile.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_random.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_rendertexture.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_robrenderable.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_RobRenderableOverlay.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_robstring.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_scripting.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_shell.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_smartptr.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_SortedOverlayContainer.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_sound.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_texatlas.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_thread.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_timer.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_viewport.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\lugre_widget.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\tinystr.h">
+				</File>
+				<File
+					RelativePath=3D"..\lugre\include\tinyxml.h">
 				</File>
 			</Filter>
 		</Filter>



From no-reply at zwischenwelt.org  Sun Feb  3 19:16:52 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 03 Feb 2008 18:16:52 -0000
Subject: [Iris-commit] [IRIS] r1879 - in /trunk: bin/iris2.exe
 lua/lib.3d.renderer.lua lua/lib.loading.lua lua/lib.mainmenu.lua
 vs8/iris.sln vs8/iris.vcproj
Message-ID: <20080203181652.894F51524004@zwischenwelt.org>

Author: sience
Date: Sun Feb  3 19:16:51 2008
New Revision: 1879

Log:
-dynamic Caelum Skysystem integrated
-SetEnvironment is now called only from function LoadMap() from lib.loading=
.lua
-new win32 binary

Modified:
    trunk/bin/iris2.exe
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.loading.lua
    trunk/lua/lib.mainmenu.lua
    trunk/vs8/iris.sln
    trunk/vs8/iris.vcproj

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sun Feb  3 19:16:51 2008
@@ -37,29 +37,10 @@
 	return x - camangdeg + 5*45
 end
 =

-function Renderer3D:SetMapEnvironment (bUnderGround)
-	if (not self.gbActive) then return end
-	if (not gMapIndex) then return end
-	=

-	local skyboxmaterial	=3D gMaps[gMapIndex].skybox
-	gFogcolorred			=3D gMaps[gMapIndex].fog_r
-	gFogcolorgreen			=3D gMaps[gMapIndex].fog_g
-	gFogcolorblue			=3D gMaps[gMapIndex].fog_b
-	=

-	-- black background when underground
-	if (bUnderGround) then
-		GetMainViewport():SetBackCol(0,0,0)
-		Client_SetSkybox()
-	else
-		Client_SetSkybox(skyboxmaterial)
-	end
-	=

-	if (gUseDistanceFog) then
-		Client_SetFog(3, gFogcolorred/255, gFogcolorgreen/255, gFogcolorblue/255=
, 1.0, 0, 10*gSightRange, 10*gSightRange+gFogValue)
-	end
-end
-
+-- initializes Worldlight for normal SkyBox
 function Renderer3D:SetupWorldlight ()
+	if (gUseCaelumSkysystem) then return end
+
 	Client_ClearLights()
 =

 	-- Sun Light
@@ -82,6 +63,80 @@
 	Client_SetAmbientLight( gAmbientLight.r,
 							gAmbientLight.g,
 							gAmbientLight.b, 1.0)
+end
+
+function Renderer3D:SetMapEnvironment (bUnderGround)
+	if (not self.gbActive) then return end
+	if (not gMapIndex) then return end
+
+	if (gUseCaelumSkysystem) then
+		-- disable any normal SkyBox
+		GetMainViewport():SetBackCol(0,0,0)
+		Client_SetSkybox()
+
+		if not(bUnderGround) then
+			-- check if already a caelum skysystem is there
+			if (gCaelumSystem) then return end
+
+			-- if not create a new Skysystem
+			gCaelumSystem=3DCreateCaelumSystem()
+			gSunPositionmodel=3DCreateCaelumSimpleSunPositionModel(13)
+	=

+			-- Setup sun options.
+			local sun =3D gCaelumSystem:GetSun()
+			if (sun) then
+				sun:SetAmbientMultiplier(0.5, 0.5, 0.5, 1.0);
+				sun:SetDiffuseMultiplier(3.0, 3.0, 2.7, 1.0);
+				--For green terrain:
+				--sun:setDiffuseMultiplier(0.1, 3, 0.1);
+				sun:SetSpecularMultiplier(5.0, 5.0, 5.0, 1.0);
+				sun:SetSunPositionModel(gSunPositionmodel);
+				sun:SetManageAmbientLight (true);
+			end
+	=

+			-- Setup fog options.
+			gCaelumSystem:SetManageSceneFog(true)
+			gCaelumSystem:SetSceneFogDensityMultiplier(0.02)
+	=

+			-- Setup cloud options.
+			-- Tweak these settings to make the demo look pretty.
+			--local clouds=3DgCaelumSystem:GetClouds()
+			if (clouds) then
+				clouds:SetCloudSpeed(0.000005, -0.000009);
+				clouds:SetCloudBlendTime(3600 * 24);
+				clouds:SetCloudCover(0.3);
+			end
+	=

+			local starfield =3D gCaelumSystem:GetStarfield()
+			-- Setup starfield options
+			if (starfield) then
+				starfield:SetInclination(13);
+			end
+	=

+			local universalclock =3D gCaelumSystem:GetUniversalClock ()
+			if (universalclock) then
+				universalclock:SetTimeScale (512);
+				universalclock:SetCurrentTime (18000);	--Jan 1st, 5am
+			end
+
+			gCaelumSystem:AddAsListener()
+		end
+	else
+		-- black background when underground
+		if (bUnderGround) then
+			GetMainViewport():SetBackCol(0,0,0)
+			Client_SetSkybox()
+		else
+			Client_SetSkybox(gMaps[gMapIndex].skybox)
+		end
+		=

+		if (gUseDistanceFog) then
+			gFogcolorred			=3D gMaps[gMapIndex].fog_r
+			gFogcolorgreen			=3D gMaps[gMapIndex].fog_g
+			gFogcolorblue			=3D gMaps[gMapIndex].fog_b
+			Client_SetFog(3, gFogcolorred/255, gFogcolorgreen/255, gFogcolorblue/25=
5, 1.0, 0, 10*gSightRange, 10*gSightRange+gFogValue)
+		end
+	end
 end
 =

 gBuildStencilShadowEdgeList =3D false
@@ -138,8 +193,6 @@
 	GetMainCam():SetAspectRatio(vp:GetActualWidth() / vp:GetActualHeight())
 end
 =

-
-
 function Renderer3D:Init()
 	--print("activating Renderer3D")
 	local cam =3D GetMainCam()
@@ -148,12 +201,13 @@
 	cam:SetFarClipDistance(2000) -- ogre defaul : 100000
 	cam:SetProjectionType(0) -- perspective
 =

+	-- initialize Worldlight for normal SkyBox
 	self.SetupWorldlight()
-	=

+
+	-- for 2D/3D renderer switching
 	self.gbActive =3D true
-	self:SetMapEnvironment()
-
-	-- Initialize Shadowsystem
+
+	-- initialize Shadowsystem
 	self:SetupShadows()
 =

 	self.gbCamRotChanged =3D true

Modified: trunk/lua/lib.loading.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.loading.lua (original)
+++ trunk/lua/lib.loading.lua Sun Feb  3 19:16:51 2008
@@ -304,6 +304,8 @@
 =

 	-- update renderer
 	profile:StartSection("mapenv")
+	=

+	-- initialize Mapenvironment
 	gCurrentRenderer:SetMapEnvironment()
 	=

 	profile:StartSection("compass")

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Sun Feb  3 19:16:51 2008
@@ -359,7 +359,7 @@
 	cam:SetNearClipDistance(0.5) -- old : 1
 	cam:SetFarClipDistance(2000) -- ogre defaul : 100000
 	cam:SetProjectionType(0) -- perspective
-	Client_SetSkybox("sunset") -- cleansky skybox sunset darksun =

+	Client_SetSkybox("sunset") -- cleansky skybox sunset darksun
 	SetMainMenuCam(0,gfDeg2Rad)
 end
 =


Modified: trunk/vs8/iris.sln
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.sln (original)
+++ trunk/vs8/iris.sln Sun Feb  3 19:16:51 2008
@@ -4,15 +4,12 @@
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "iris", "iris.vcproj=
", "{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}"
 	ProjectSection(ProjectDependencies) =3D postProject
 		{5A02700F-C389-4E19-AF35-C4C893E72A64} =3D {5A02700F-C389-4E19-AF35-C4C8=
93E72A64}
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB} =3D {74FA3830-CC5D-E24F-AFEA-740C=
C2710DFB}
 		{FF3B6490-D65F-7B41-982B-8D8339958224} =3D {FF3B6490-D65F-7B41-982B-8D83=
39958224}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "lua50_lib", "..\lug=
re\lib\lua-5.0.3\mak.vs2005\lua50_lib.vcproj", "{FF3B6490-D65F-7B41-982B-8D=
8339958224}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "pagedgeometry_lib",=
 "..\lugre\lib\paged_geometry\vs2005\pagedgeometry_lib\pagedgeometry_lib.vc=
proj", "{5A02700F-C389-4E19-AF35-C4C893E72A64}"
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "Caelum", "..\lugre\=
lib\caelum\Caelum.vcproj", "{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}"
 EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) =3D preSolution
@@ -39,12 +36,6 @@
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release|Win32.Build.0 =3D Release=
|Win32
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Debug|Win32.Build.0 =3D Debug|Win=
32
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release - boost-threads_enabled|W=
in32.ActiveCfg =3D Release|Win32
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
-		{74FA3830-CC5D-E24F-AFEA-740CC2710DFB}.Release|Win32.Build.0 =3D Release=
|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) =3D preSolution
 		HideSolutionNode =3D FALSE

Modified: trunk/vs8/iris.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.vcproj (original)
+++ trunk/vs8/iris.vcproj Sun Feb  3 19:16:51 2008
@@ -126,7 +126,7 @@
 				EnableFiberSafeOptimizations=3D"false"
 				WholeProgramOptimization=3D"true"
 				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;c:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\include\zlib;..\lugre=
\include;..\include\fmodx;&quot;..\lugre\lib\lua-5.0.3\include\&quot;;..\lu=
gre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\lib\paged_geo=
metry\include;..\lugre\lib\caelum\include"
-				PreprocessorDefinitions=3D"WIN32;USE_FMOD;MAIN_WORKING_DIR=3D\&quot;..=
/\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CADUNE_TREE;USE_LUGRE_LIB_PAGED_GE=
OMETRY"
+				PreprocessorDefinitions=3D"WIN32;USE_FMOD;MAIN_WORKING_DIR=3D\&quot;..=
/\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CADUNE_TREE;USE_LUGRE_LIB_PAGED_GE=
OMETRY;USE_LUGRE_LIB_CAELUM"
 				GeneratePreprocessedFile=3D"0"
 				RuntimeLibrary=3D"0"
 				EnableEnhancedInstructionSet=3D"1"
@@ -875,6 +875,146 @@
 					</File>
 				</Filter>
 			</Filter>
+			<Filter
+				Name=3D"caelum"
+				>
+				<Filter
+					Name=3D"src"
+					>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\CaelumSystem.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\CameraBoundElement.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\EarthSunPositionModel.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\GeometryFactory.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\GroundFog.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\ImageHelper.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\LayeredClouds.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\SimpleSunPositionModel.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\SkyColourModel.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\SkyDome.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\Starfield.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\Sun.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\UniversalClock.cpp"
+						>
+					</File>
+				</Filter>
+				<Filter
+					Name=3D"include"
+					>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\Caelum.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumExceptions.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumListener.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumPrecompiled.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumPrerequisites.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumSystem.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CameraBoundElement.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\EarthSunPositionModel.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\GeometryFactory.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\GroundFog.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\ImageHelper.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\LayeredClouds.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\SimpleSunPositionModel.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\SkyColourModel.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\SkyDome.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\Starfield.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\Sun.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\SunPositionModel.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\UniversalClock.h"
+						>
+					</File>
+				</Filter>
+			</Filter>
 		</Filter>
 	</Files>
 	<Globals>



From no-reply at zwischenwelt.org  Sun Feb  3 22:46:36 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 03 Feb 2008 21:46:36 -0000
Subject: [Iris-commit] [IRIS] r1880 - /trunk/vs8/iris.sln
Message-ID: <20080203214636.D07531524004@zwischenwelt.org>

Author: sience
Date: Sun Feb  3 22:46:36 2008
New Revision: 1880

Log:
-small update

Modified:
    trunk/vs8/iris.sln

Modified: trunk/vs8/iris.sln
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.sln (original)
+++ trunk/vs8/iris.sln Sun Feb  3 22:46:36 2008
@@ -9,7 +9,7 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "lua50_lib", "..\lug=
re\lib\lua-5.0.3\mak.vs2005\lua50_lib.vcproj", "{FF3B6490-D65F-7B41-982B-8D=
8339958224}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "pagedgeometry_lib",=
 "..\lugre\lib\paged_geometry\vs2005\pagedgeometry_lib\pagedgeometry_lib.vc=
proj", "{5A02700F-C389-4E19-AF35-C4C893E72A64}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "pagedgeometry_lib",=
 "..\lugre\lib\paged_geometry\vs2005\pagedgeometry_lib.vcproj", "{5A02700F-=
C389-4E19-AF35-C4C893E72A64}"
 EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) =3D preSolution



From no-reply at zwischenwelt.org  Sun Feb  3 23:54:46 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 03 Feb 2008 22:54:46 -0000
Subject: [Iris-commit] [IRIS] r1881 - /trunk/vs8/iris.vcproj
Message-ID: <20080203230021.E8A111C182A7@zwischenwelt.org>

Author: sience
Date: Sun Feb  3 23:54:40 2008
New Revision: 1881

Log:
-vs2005 project updated

Modified:
    trunk/vs8/iris.vcproj

Modified: trunk/vs8/iris.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.vcproj (original)
+++ trunk/vs8/iris.vcproj Sun Feb  3 23:54:40 2008
@@ -149,7 +149,7 @@
 				Name=3D"VCLinkerTool"
 				AdditionalDependencies=3D"LIBCMT.lib LIBCPMT.LIB AdvAPI32.Lib User32.L=
ib zlib.lib ws2_32.lib lua50.lib OgreMain.lib OIS.lib fmodex_vc.lib pagedge=
ometry_lib.lib"
 				OutputFile=3D"$(OutDir)\..\..\bin\iris2.exe"
-				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\p=
aged_geometry\vs2005\lib\static;..\lugre\lib\caelum\lib\static"
+				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\c=
aelum\lib\static;..\lugre\lib\paged_geometry\lib\static"
 				GenerateManifest=3D"true"
 				IgnoreAllDefaultLibraries=3D"true"
 				IgnoreDefaultLibraryNames=3D""



From no-reply at zwischenwelt.org  Mon Feb  4 21:19:46 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 04 Feb 2008 20:19:46 -0000
Subject: [Iris-commit] [IRIS] r1882 - in /trunk: bin/ data/ lua/ lua/net/
	src/ vs8/
Message-ID: <20080204201947.1B7DE1524004@zwischenwelt.org>

Author: sience
Date: Mon Feb  4 21:19:45 2008
New Revision: 1882

Log:
-Lua50 compiled NOT fully optimized, because of wrong bitwise operations wh=
en using VS2005 Express
-new_Region packet added
-several function renames
-VS2005 Express Debugmode works now
-Fallheight set to 7 -> 12
-new Win32 binary

Modified:
    trunk/bin/iris2.exe
    trunk/data/mymacros.lua.dist
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.charcreate.lua
    trunk/lua/lib.loading.lua
    trunk/lua/lib.mainmenu.lua
    trunk/lua/lib.uoids.lua
    trunk/lua/main.lua
    trunk/lua/net/net.login.lua
    trunk/lua/net/net.other.lua
    trunk/lua/net/net.world.lua
    trunk/src/terrain_multitex.cpp
    trunk/vs8/iris.sln
    trunk/vs8/iris.vcproj

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/mymacros.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/mymacros.lua.dist (original)
+++ trunk/data/mymacros.lua.dist Mon Feb  4 21:19:45 2008
@@ -5,6 +5,8 @@
 Here you can define macros, =

 which can be triggered by keycombos like ctrl-shift-a or similar.
 See http://www.iris2.de/index.php/Macros for more infos.
+
+Use qwerty key to make Macros!
 ]]--
 =

 -- uncomment this line to print the current keyname on each keypress :

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Mon Feb  4 21:19:45 2008
@@ -79,7 +79,8 @@
 			if (gCaelumSystem) then return end
 =

 			-- if not create a new Skysystem
-			gCaelumSystem=3DCreateCaelumSystem()
+--			gCaelumSystem=3DCreateCaelumSystem()
+			gCaelumSystem=3DCreateCaelumSystem(CAELUM_COMPONENT_SKY_COLOUR_MODEL + =
CAELUM_COMPONENT_SKY_DOME + CAELUM_COMPONENT_SUN + CAELUM_COMPONENT_STARFIE=
LD)
 			gSunPositionmodel=3DCreateCaelumSimpleSunPositionModel(13)
 	=

 			-- Setup sun options.

Modified: trunk/lua/lib.charcreate.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.charcreate.lua (original)
+++ trunk/lua/lib.charcreate.lua Mon Feb  4 21:19:45 2008
@@ -27,8 +27,8 @@
 	chardata.str =3D template.stats["Str"]
 	chardata.dex =3D template.stats["Dex"]
 	chardata.int =3D template.stats["Int"]
-	--print(vardump2(chardata))
-	SendCharCreate(chardata)
+
+	Send_CharCreate(chardata)
 	return true
 end
 =

@@ -57,39 +57,6 @@
 	return profinfo
 end
 =

--- send characterselect to gameserver
-function SendCharCreate(chardata)
-	local out =3D GetSendFIFO()
-	out:PushNetUint8(kPacket_CharacterCreation)
-	out:PushNetUint32(hex2num("0xedededed"))
-	out:PushNetUint32(hex2num("0xffffffff"))
-	out:PushNetUint8(hex2num("0x00"))
-	out:PushFilledString(chardata.name,30)
-	out:PushFilledString(chardata.pass,30)
-	out:PushNetUint8(chardata.sex) -- (0=3Dmale, 1=3Dfemale, 2=3Dneutral)-- 2=
 =3D male elf ?!?
-	out:PushNetUint8(chardata.str)
-	out:PushNetUint8(chardata.dex)
-	out:PushNetUint8(chardata.int)
-	out:PushNetUint8(chardata.skill1) -- (see list below)
-	out:PushNetUint8(chardata.skill1value)
-	out:PushNetUint8(chardata.skill2) -- (see list below)
-	out:PushNetUint8(chardata.skill2value)
-	out:PushNetUint8(chardata.skill3) -- (see list below)
-	out:PushNetUint8(chardata.skill3value)
-	out:PushNetUint16(chardata.skinColor)
-	out:PushNetUint16(chardata.hairStyle) -- The artwork number for the chara=
cter's hair.
-	out:PushNetUint16(chardata.hairColor)
-	out:PushNetUint16(chardata.facialHair) -- The artwork number for the char=
acter's beard.
-	out:PushNetUint16(chardata.facialHairColor)
-	out:PushNetUint16(chardata.location) --  The character's starting city (a=
s listed in the character list).
-	out:PushNetUint16(hex2num("0x0000"))
-	out:PushNetUint16(chardata.slot) -- is this really 16 bit ?  The characte=
r slot number.
-	out:PushNetUint32(gServerSeed) -- The user's gameplay encryption key ? cl=
ientIP ?
-	out:PushNetUint16(chardata.shirtColor)
-	out:PushNetUint16(chardata.pantsColor)
-	out:SendPacket()
-end
-
 function CreateSampleCharData () =

 	local chardata =3D {}
 	chardata.name =3D "test"
@@ -110,9 +77,7 @@
 	chardata.facialHair		=3D hex2num("0x0000")
 	chardata.facialHairColor=3D hex2num("0x0000")
 	chardata.location		=3D hex2num("0x0000")
-	--out:PushNetUint16(hex2num("0x0000"))
 	chardata.slot			=3D hex2num("0x0003")
-	--	out:PushNetUint32(gServerSeed) -- The user's gameplay encryption key ?=
 clientIP ?
 	chardata.shirtColor		=3D hex2num("0x036F") --hex2num("0x0083")
 	chardata.pantsColor		=3D hex2num("0x0111") --hex2num("0x01AC")
 	return chardata

Modified: trunk/lua/lib.loading.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.loading.lua (original)
+++ trunk/lua/lib.loading.lua Mon Feb  4 21:19:45 2008
@@ -246,6 +246,8 @@
 	print("gMapIndex",gMapIndex)
 =

 	if (not gInitialMapLoaded) then LoadingProfile("load MapInfo") end
+	if (gMaps[index] =3D=3D nil) then print("Map"..index..".mul not found. Pl=
ease look into your UO directory to verify this.") Crash() end
+
 	local name				=3D gMaps[index].name
 	local mapheight			=3D gMaps[index].mapheight
 	local mapfilename		=3D gMaps[index].mapfilename

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Mon Feb  4 21:19:45 2008
@@ -54,7 +54,7 @@
 		return
 	end
 	=

-	ProtocolSend_Account_Login_Request(gLoginname,gPassword) -- 0x80 kPacket_=
Account_Login_Request
+	Send_Account_Login_Request(gLoginname,gPassword) -- 0x80 kPacket_Account_=
Login_Request
 	-- answered by 0xA8 kPacket_Server_List which calls MainMenuShowServerList
 end
 =

@@ -63,11 +63,11 @@
 	local MySelectServer =3D function(server) =

 		AddFadeLines(sprintf("connecting to server %s[%d]",server.name or "???",=
server.index or 0))
 		=

---		ProtocolSend_SystemSpecs()
-		=

-		ProtocolSend_GameServer_Select(server.index or 0) -- 0xA0 kPacket_Server=
_Select =

+--		Send_SystemSpecs()
+		=

+		Send_GameServer_Select(server.index or 0) -- 0xA0 kPacket_Server_Select =

 		-- answered by kPacket_Server_Redirect 0x8C, =

-		-- which calls ProtocolSend_GameServer_PostLogin kPacket_Post_Login 0x91 =

+		-- which calls Send_GameServer_PostLogin kPacket_Post_Login 0x91 =

 		-- answered by kPacket_Features 0xB9 and  kPacket_Character_List 0xA9 wh=
ich calls MainMenuShowCharList
 	end
 	=

@@ -116,7 +116,7 @@
 	--check first, if the choose slot is available!
 	=

 	local MySelectChar =3D function(widget) =

-		ProtocolSend_Character_Select(widget.iCharNum,gGameServerAccount)
+		Send_Character_Select(widget.iCharNum,gGameServerAccount)
 		widget.dialog:Destroy()
 	end
 	local MyCreateCharTemplatePicker =3D function(widget) =


Modified: trunk/lua/lib.uoids.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.uoids.lua (original)
+++ trunk/lua/lib.uoids.lua Mon Feb  4 21:19:45 2008
@@ -39,7 +39,7 @@
 --Walk Limits
 --gPersonHeight =3D 16
 gMaxZ_Climb	=3D 7		--3 is to low for ladders
-gMaxZ_Fall	=3D 7		-- TODO: char falls through hauslayers; 20 is maybe too =
much
+gMaxZ_Fall	=3D 12	-- TODO: char falls through hauslayers; 20 is maybe too =
much
 gIllegalZ	=3D 127
 gMaxZ_Blocks =3D 14
 =


Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Mon Feb  4 21:19:45 2008
@@ -281,24 +281,23 @@
 	=

 	CheckUODir()
 	=

-	-- if (gHuffmanCompression) then LuaHuffmanTest() end
-	-- if (false) then LuaBitwiseTest() end
+	gMyTicks =3D Client_GetTicks()
+	=

+	LoadingProfile("initializing Ogre",true)
+	gPreOgreTime =3D gLoadingProfileLastTime
+	if (not InitOgre("Iris2",lugre_detect_ogre_plugin_path(),"../bin/")) then=
 Exit() end
+	CollectOgreResLocs()
+	SetCursorBaseOffset(0,0)
+
+	-- Lua test because Lua50 should not be compiled full-optimized with VS20=
05 Express (maybe also other compilers)
+	if (true) then LuaBitwiseTest() end
+	if (gHuffmanCompression) then LuaHuffmanTest() end
 	---if (false) then AnalyseStatics(0) end
 	-- if (false) then ExpressionTest() end
 	-- if (false) then TestSound() end
 	-- if (false) then TestMultiLoader() end
 	-- if (false) then TestZLib() end
 	-- if (false) then TestUniFontLoader() end
-	-- if (false) then TestUOP() end
-	=

-	=

-	gMyTicks =3D Client_GetTicks()
-	=

-	LoadingProfile("initializing Ogre",true)
-	gPreOgreTime =3D gLoadingProfileLastTime
-	if (not InitOgre("Iris2",lugre_detect_ogre_plugin_path(),"../bin/")) then=
 Exit() end
-	CollectOgreResLocs()
-	SetCursorBaseOffset(0,0)
 =

 	-- maybe we should check here if in offline or online mode!?
 	InitNet()

Modified: trunk/lua/net/net.login.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.login.lua (original)
+++ trunk/lua/net/net.login.lua Mon Feb  4 21:19:45 2008
@@ -33,7 +33,7 @@
 end
 =

 -- len: 0x10C
-function ProtocolSend_SystemSpecs()
+function Send_SystemSpecs()
 	printdebug("login","NET: Send_SystemSpecs:")
 	local out =3D GetSendFIFO()
 	out:PushNetUint8(kPacket_Metrics)
@@ -98,7 +98,7 @@
 	if (gHuffmanCompression) then
 		NetStartHuffman()
 	end
-	ProtocolSend_GameServer_PostLogin(gLoginname,gPassword,gameserveraccount)
+	Send_GameServer_PostLogin(gLoginname,gPassword,gameserveraccount)
 end
 =

 -- Receive Client Features - this enabled several Features in Client   kPa=
cket_Features 0xB9
@@ -287,7 +287,7 @@
 =

 -- send login server request 0x80
 -- answered by 0xA8 kPacket_Server_List which calls MainMenuShowServerList
-function ProtocolSend_Account_Login_Request	(sName,sPassword,iSeed)
+function Send_Account_Login_Request	(sName,sPassword,iSeed)
 	printdebug("login",sprintf("NET: Account_Login_Request: Name: %s Password=
: %s\n",sName,sPassword))
 	local out =3D GetSendFIFO()
 	out:PushNetUint8(kPacket_Account_Login_Request)
@@ -299,8 +299,8 @@
 =

 -- send gameserverselect to loginserver : kPacket_Server_Select 0xA0
 -- answered by kPacket_Server_Redirect 0x8C
--- which calls ProtocolSend_GameServer_PostLogin kPacket_Post_Login 0x91 =

-function ProtocolSend_GameServer_Select(iGameServerID)
+-- which calls Send_GameServer_PostLogin kPacket_Post_Login 0x91 =

+function Send_GameServer_Select(iGameServerID)
 	printdebug("login",sprintf("NET: GameServer_Select: %i\n",iGameServerID))
 	local out =3D GetSendFIFO()
 	out:PushNetUint8(kPacket_Server_Select)
@@ -311,7 +311,7 @@
 -- send postlogin to gameserver  kPacket_Post_Login 0x91
 -- something is wrong...runuo & wolfpack detects invalid client
 -- answered by kPacket_Features 0xB9 and  kPacket_Character_List 0xA9
-function ProtocolSend_GameServer_PostLogin(sName,sPassword,iAccount)
+function Send_GameServer_PostLogin(sName,sPassword,iAccount)
 	printdebug("login",sprintf("NET: GameServer_PostLogin: Name: %s Password:=
 %s AccountNr.: 0x%08x\n",sName,sPassword,iAccount))
 	local out =3D GetSendFIFO()
 	out:PushNetUint8(kPacket_Post_Login)
@@ -322,7 +322,40 @@
 end
 =

 -- send characterselect to gameserver
-function ProtocolSend_Character_Select(iCharacterID,iAccount)
+function Send_CharCreate(chardata)
+	local out =3D GetSendFIFO()
+	out:PushNetUint8(kPacket_CharacterCreation)
+	out:PushNetUint32(hex2num("0xedededed"))
+	out:PushNetUint32(hex2num("0xffffffff"))
+	out:PushNetUint8(hex2num("0x00"))
+	out:PushFilledString(chardata.name,30)
+	out:PushFilledString(chardata.pass,30)
+	out:PushNetUint8(chardata.sex) -- (0=3Dmale, 1=3Dfemale, 2=3Delf male, 3=
=3Delf female)
+	out:PushNetUint8(chardata.str)
+	out:PushNetUint8(chardata.dex)
+	out:PushNetUint8(chardata.int)
+	out:PushNetUint8(chardata.skill1) -- (see list below)
+	out:PushNetUint8(chardata.skill1value)
+	out:PushNetUint8(chardata.skill2) -- (see list below)
+	out:PushNetUint8(chardata.skill2value)
+	out:PushNetUint8(chardata.skill3) -- (see list below)
+	out:PushNetUint8(chardata.skill3value)
+	out:PushNetUint16(chardata.skinColor)
+	out:PushNetUint16(chardata.hairStyle) -- The artwork number for the chara=
cter's hair.
+	out:PushNetUint16(chardata.hairColor)
+	out:PushNetUint16(chardata.facialHair) -- The artwork number for the char=
acter's beard.
+	out:PushNetUint16(chardata.facialHairColor)
+	out:PushNetUint16(chardata.location) --  The character's starting city (a=
s listed in the character list).
+	out:PushNetUint16(hex2num("0x0000"))
+	out:PushNetUint16(chardata.slot) -- is this really 16 bit ?  The characte=
r slot number.
+	out:PushNetUint32(gServerSeed) -- The user's gameplay encryption key ? cl=
ientIP ?
+	out:PushNetUint16(chardata.shirtColor)
+	out:PushNetUint16(chardata.pantsColor)
+	out:SendPacket()
+end
+
+-- send characterselect to gameserver
+function Send_Character_Select(iCharacterID,iAccount)
 	printdebug("login",sprintf("NET: Character_Select: %i Name: %s Password: =
%s AccountNr.:%x\n",
 			iCharacterID,gCharacterList[iCharacterID].name,gCharacterList[iCharacte=
rID].pw,iAccount))
 	local out =3D GetSendFIFO()

Modified: trunk/lua/net/net.other.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.other.lua (original)
+++ trunk/lua/net/net.other.lua Mon Feb  4 21:19:45 2008
@@ -544,7 +544,7 @@
 ]]--
 --TODO : readout checkboxes,radiobuttons and edit text fields
 function GumpReturnMsg(playerserial, gumpserial, ret_value, params, switch=
count, textcount)	-- len 0x17
-	local packetlen =3D 1 + 2 + 4*5 -- size for empty params
+	local packetlen =3D 23	--(1 + 2 + 4*5) size for empty params
 	if (params) then
 		packetlen =3D packetlen + 4 * table.getn(params.switches)
 		for k,v in pairs(params.texts) do =


Modified: trunk/lua/net/net.world.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.world.lua (original)
+++ trunk/lua/net/net.world.lua Mon Feb  4 21:19:45 2008
@@ -8,7 +8,7 @@
 	local id =3D input:PopNetUint8()
 	local season =3D input:PopNetUint8()
 	local seasonchange =3D input:PopNetUint8()
-	printf("NET: Game_Season id: %i season: %i seasonchange: %i\n",id,season,=
seasonchange)
+	printdebug("net",sprintf("NET: Game_Season id: %i season: %i seasonchange=
: %i\n",id,season,seasonchange))
 =

 	if (seasonchange =3D=3D 1) then
 		gSeasonSetting =3D season
@@ -23,7 +23,7 @@
 	local id =3D input:PopNetUint8()
 	local creature_id =3D input:PopNetUint32()
 	local creature_light =3D input:PopNetUint8()
-	printf("NET (todo): Light_Change id: %i creature_id: %i creature_light: %=
i\n",id,creature_id,creature_light)
+	printdebug("net",sprintf("NET (todo): Light_Change id: %i creature_id: %i=
 creature_light: %i\n",id,creature_id,creature_light))
 end
 =

 -- Overall light level  - 0 is brightest (day), 9 is OSI night, max is 31 =
(black)
@@ -31,7 +31,7 @@
 	local input =3D GetRecvFIFO()
 	local id =3D input:PopNetUint8()
 	local sunlight =3D input:PopNetUint8()
-	printf("NET (todo): Sunlight id: %i sunlight: %i\n",id,sunlight)
+	printdebug("net",sprintf("NET (todo): Sunlight id: %i sunlight: %i\n",id,=
sunlight))
 end
 =

 -- Submits Server GameTime to Client (4 bytes)
@@ -41,7 +41,7 @@
 	local hour =3D input:PopNetUint8()
 	local minute =3D input:PopNetUint8()
 	local second =3D input:PopNetUint8()
-	printf("NET (todo): Game_Time id: %i Hour: %i Min: %i Sec: %i\n",id, hour=
, minute, second)
+	printdebug("net",sprintf("NET (todo): Game_Time id: %i Hour: %i Min: %i S=
ec: %i\n",id, hour, minute, second))
 end
 =

 function gPacketHandler.kPacket_Logout()
@@ -51,3 +51,45 @@
 	print("FATAL ! kPacket_Logout -> forced Crash")
 	Crash()
 end
+
+--[[
+58 - New Region
+Create a new region
+0x6A bytes
+byte	ID (58)	   =

+char[40]	Area Name
+dword	0	   =

+word	X	   =

+word	Y	   =

+word	Width	   =

+Word	Height	   =

+Word	Z1	   =

+Word	Z2	   =

+char[40]	Description
+Word	Sound FX	   =

+Word	Music
+Word	Night Sound FX
+Byte	Dungeon
+Word	Light
+]]--
+function gPacketHandler.kPacket_New_Region()
+	local input =3D GetRecvFIFO()
+	local id =3D input:PopNetUint8()
+	local areaname =3D input:PopFilledString(40)
+	local unknown =3D input:PopNetUint32()
+	local xloc =3D input:PopNetUint16()
+	local yloc =3D input:PopNetUint16()
+	local width =3D input:PopNetUint16()
+	local height =3D input:PopNetUint16()
+	local z1 =3D input:PopNetUint16()
+	local z2 =3D input:PopNetUint16()
+	local description =3D input:PopFilledString(40)
+
+	local soundfx =3D input:PopNetUint16()
+	local music =3D input:PopNetUint16()
+	local nightsoundfx =3D input:PopNetUint16()
+	local dungeon =3D input:PopNetUint8()
+	local light =3D input:PopNetUint8()
+	print("kPacket_New_Region packet !! checkout what emu is used.")
+	printdebug("net",sprintf("NET (todo): Areaname: %s Description: %s Music:=
 %i Dungeon: %i Light: %i\n",areaname, description, music, dungeon, light))
+end

Modified: trunk/src/terrain_multitex.cpp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/src/terrain_multitex.cpp (original)
+++ trunk/src/terrain_multitex.cpp Mon Feb  4 21:19:45 2008
@@ -280,7 +280,7 @@
 		} else {
 			// group loading doesn't work, so we'll have to copy
 			static bool bPrintWarning =3D true; // only print the warning once
-			if (bPrintWarning) { printf("warning : terrain : groundblock loader doe=
sn support group loading, falling back to copy, but it's a bit slower (grou=
p loading not implemented yet)\n"); bPrintWarning =3D false; }
+			if (bPrintWarning) { printf("warning : terrain : groundblock loader doe=
sn't support group loading, falling back to copy, but it's a bit slower (gr=
oup loading not implemented yet)\n"); bPrintWarning =3D false; }
 			static RawGroundBlock myCopyBlocks[3*3];
 			for (y=3D0;y<3;++y)
 			for (x=3D0;x<3;++x) {

Modified: trunk/vs8/iris.sln
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.sln (original)
+++ trunk/vs8/iris.sln Mon Feb  4 21:19:45 2008
@@ -3,7 +3,6 @@
 # Visual C++ Express 2005
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "iris", "iris.vcproj=
", "{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}"
 	ProjectSection(ProjectDependencies) =3D postProject
-		{5A02700F-C389-4E19-AF35-C4C893E72A64} =3D {5A02700F-C389-4E19-AF35-C4C8=
93E72A64}
 		{FF3B6490-D65F-7B41-982B-8D8339958224} =3D {FF3B6490-D65F-7B41-982B-8D83=
39958224}
 	EndProjectSection
 EndProject

Modified: trunk/vs8/iris.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.vcproj (original)
+++ trunk/vs8/iris.vcproj Mon Feb  4 21:19:45 2008
@@ -38,8 +38,8 @@
 			<Tool
 				Name=3D"VCCLCompilerTool"
 				Optimization=3D"0"
-				AdditionalIncludeDirectories=3D"&quot;C:\Programme\Microsoft Platform =
SDK\Include\&quot;;&quot;$(INCLUDE)&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS&quot;;..\include;..\include\boost;..\includ=
e\fmodx;..\include\lua;..\include\sdl;..\include\zlib"
-				PreprocessorDefinitions=3D"WIN32"
+				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;C:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS&quot;;..\include;..\include\lua;..\include\=
zlib;..\include\fmodx;..\lugre\include;&quot;..\lugre\lib\lua-5.0.3\include=
&quot;;..\lugre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\l=
ib\caelum\include;E:\_Iris\_Iris_Ogre\lugre\lib\paged_geometry\include\;..\=
lugre\lib\paged_geometry\include"
+				PreprocessorDefinitions=3D"WIN32;_DEBUG;USE_FMOD;MAIN_WORKING_DIR=3D\&=
quot;../\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CAELUM"
 				RuntimeLibrary=3D"1"
 				RuntimeTypeInfo=3D"false"
 				AssemblerOutput=3D"2"
@@ -57,11 +57,11 @@
 			/>
 			<Tool
 				Name=3D"VCLinkerTool"
-				AdditionalDependencies=3D"AdvAPI32.Lib User32.Lib zlibd.lib ws2_32.lib=
 LibLua.lib LibLuaLib.lib OgreMain_d.lib SDL.lib OIS_d.lib fmodex_vc.lib"
+				AdditionalDependencies=3D"AdvAPI32.Lib User32.Lib ws2_32.lib zlibd.lib=
 lua50.lib OgreMain_d.lib OIS_d.lib fmodex_vc.lib"
 				OutputFile=3D"$(OutDir)\..\..\bin\$(ProjectName)_d.exe"
-				AdditionalLibraryDirectories=3D"&quot;C:\Programme\Microsoft Platform =
SDK\Lib\&quot;;&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\lib\&quot;;..\libs\fmo=
dx;..\libs\lua;..\libs\sdl;..\libs\zlib"
+				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;C:\Programme\=
Microsoft Platform SDK\Lib\&quot;;&quot;$(OGRE_HOME)\lib\&quot;;&quot;..\lu=
gre\lib\lua-5.0.3\lib\static&quot;;..\libs\fmodx;..\libs\lua;..\libs\zlib"
 				IgnoreAllDefaultLibraries=3D"false"
-				IgnoreDefaultLibraryNames=3D"LIBCMT.lib;LIBCMTD.lib"
+				IgnoreDefaultLibraryNames=3D"LIBCMTD.lib"
 				GenerateDebugInformation=3D"true"
 				AssemblyDebug=3D"0"
 				GenerateMapFile=3D"false"



From no-reply at zwischenwelt.org  Mon Feb  4 21:25:05 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 04 Feb 2008 20:25:05 -0000
Subject: [Iris-commit] [IRIS] r1883 - in /rawdata/sd_pd: houseparts.blend
 items.blend tex_slidingdoor.png
Message-ID: <20080204202505.A3D0B1C18752@zwischenwelt.org>

Author: hagish
Date: Mon Feb  4 21:25:05 2008
New Revision: 1883

Log:
added new raw models

Added:
    rawdata/sd_pd/houseparts.blend   (with props)
    rawdata/sd_pd/tex_slidingdoor.png   (with props)
Modified:
    rawdata/sd_pd/items.blend

Modified: rawdata/sd_pd/items.blend
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Tue Feb  5 14:45:12 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 05 Feb 2008 13:45:12 -0000
Subject: [Iris-commit] [IRIS] r1884 - /trunk/lua/net/net.login.lua
Message-ID: <20080205134514.C75361C18731@zwischenwelt.org>

Author: sience
Date: Tue Feb  5 14:45:11 2008
New Revision: 1884

Log:
-Flag added to Char Select packet (RunUO detect this way the clientversion)

Modified:
    trunk/lua/net/net.login.lua

Modified: trunk/lua/net/net.login.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.login.lua (original)
+++ trunk/lua/net/net.login.lua Tue Feb  5 14:45:11 2008
@@ -362,7 +362,16 @@
 	out:PushNetUint8(kPacket_Pre_Login)
 	out:PushNetUint32(hex2num("0xedededed"))
 	out:PushFilledString(gCharacterList[iCharacterID].name,30)
-	out:PushFilledString(gCharacterList[iCharacterID].pw,30)
+
+--	out:PushFilledString(gCharacterList[iCharacterID].pw,30)
+
+	out:PushNetUint16(0)
+	out:PushNetUint32(hex2num("0x0000001F"))	-- RunUO uses this unknown flags=
 (maybe for map 3,4 support)
+
+	out:PushFilledString("",6)					-- obsolete for RunUO
+	out:PushNetUint16(hex2num("0x004B"))		-- obsolete for RunUO - 0x4A (2D_V.=
5.0.8.2_ML) 0x4B (2D_V.5.0.9.1_ML)
+	out:PushFilledString("",16)					-- obsolete for RunUO
+
 	out:PushNetUint32(iCharacterID)
 	out:PushNetUint32(hex2num("0xC0A83016"))	--TODO: check: iAccount or GameS=
erverIP
 	out:SendPacket()



From no-reply at zwischenwelt.org  Tue Feb  5 20:08:16 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 05 Feb 2008 19:08:16 -0000
Subject: [Iris-commit] [IRIS] r1885 - in /trunk: data/profiles/gfx_high.lua
 data/profiles/gfx_med.lua data/profiles/gfx_ultrahigh.lua
 data/skippedfallbacks.lua lua/filter/filter.granny.lua
Message-ID: <20080205190817.133821C1872C@zwischenwelt.org>

Author: sience
Date: Tue Feb  5 20:08:16 2008
New Revision: 1885

Log:
-graphicprofile medium has now no shadows
-graphicprofile high has shadows and is now similar to former medium
-fallbacks added

Modified:
    trunk/data/profiles/gfx_high.lua
    trunk/data/profiles/gfx_med.lua
    trunk/data/profiles/gfx_ultrahigh.lua
    trunk/data/skippedfallbacks.lua
    trunk/lua/filter/filter.granny.lua

Modified: trunk/data/profiles/gfx_high.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_high.lua (original)
+++ trunk/data/profiles/gfx_high.lua Tue Feb  5 20:08:16 2008
@@ -6,5 +6,3 @@
 gMobileCastShadows =3D true
 =

 gSightRange	=3D 5
-
---gPreloadStaticMesh =3D true

Modified: trunk/data/profiles/gfx_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_med.lua (original)
+++ trunk/data/profiles/gfx_med.lua Tue Feb  5 20:08:16 2008
@@ -1,8 +1,3 @@
 gAtlasRes =3D "med"
 =

-gShadowTechnique =3D "texture_additive"
-gStaticsCastShadows =3D true
-gDynamicsCastShadows =3D true
-gMobileCastShadows =3D true
-
 gSightRange	=3D 4

Modified: trunk/data/profiles/gfx_ultrahigh.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_ultrahigh.lua (original)
+++ trunk/data/profiles/gfx_ultrahigh.lua Tue Feb  5 20:08:16 2008
@@ -7,7 +7,7 @@
 =

 gUseHumanSkinShader =3D true
 =

-gSightRange	=3D 8
+gSightRange	=3D 6
 gEnableLowDetailTerrainFarSight =3D true
 gEnableLowDetailTerrainFarSightRangeAdd =3D 4
 =


Modified: trunk/data/skippedfallbacks.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/skippedfallbacks.lua (original)
+++ trunk/data/skippedfallbacks.lua Tue Feb  5 20:08:16 2008
@@ -421,3 +421,5 @@
 RegisterSkippedArtBillboardFallBack(5954) -- 0x1742 name=3Dfountain
 RegisterSkippedArtBillboardFallBack(2267) -- 0x08db name=3Dfireplace
 RegisterSkippedArtBillboardFallBack(3443) -- 0x0d73 name=3Dleaves
+RegisterSkippedArtBillboardFallBack(3694) -- 0x0e6e name=3Dcannon
+RegisterSkippedArtBillboardFallBack(3691) -- 0x0e6b name=3Dcannon

Modified: trunk/lua/filter/filter.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.granny.lua (original)
+++ trunk/lua/filter/filter.granny.lua Tue Feb  5 20:08:16 2008
@@ -1,5 +1,5 @@
--- ID Mapping (ArtID to GrannyID)
--- TODO: add individual Scaling for Grannys
+-- ID Mapping (ArtID to GrannyID, or Ogre *.mesh + *.skeleton)
+-- TODO: add individual Scaling for Grannys and Meshes
 =

 gGrannyFilter =3D {}
 =




From no-reply at zwischenwelt.org  Wed Feb  6 19:45:01 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 06 Feb 2008 18:45:01 -0000
Subject: [Iris-commit] [IRIS] r1886 - in /trunk: data/
 data/models/materials/ data/profiles/ lua/ lua/net/
Message-ID: <20080206184501.60EE21C186E5@zwischenwelt.org>

Author: sience
Date: Wed Feb  6 19:45:00 2008
New Revision: 1886

Log:
-gfx-profiles updated (high is now medium, and medium is now without shadow=
s)
-securetrade seperated into net.securetrade.lua & lib.securetrade.lua
-shadows optimized a bit

Added:
    trunk/lua/lib.securetrade.lua
Removed:
    trunk/lua/net.securetrade.lua
Modified:
    trunk/data/config.lua.dist
    trunk/data/models/materials/textures.material
    trunk/data/profiles/gfx_high.lua
    trunk/data/profiles/gfx_med.lua
    trunk/data/profiles/gfx_ultrahigh.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/main.lua
    trunk/lua/net/net.main.lua

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Wed Feb  6 19:45:00 2008
@@ -283,7 +283,7 @@
 =

 -- shadow settings
 --"none", "stencil_modulative", "stencil_additive", "texture_modulative", =
"texture_additive", "texture_additive_integrated", "texture_modulative_inte=
grated"
-gShadowTechnique =3D "texture_additive"
+gShadowTechnique =3D "none"
 gTerrainCastShadows =3D false
 gStaticsCastShadows =3D true
 gDynamicsCastShadows =3D true
@@ -456,4 +456,4 @@
 gUseHumanSkinShader =3D false
 =

 -- "ultralow", "low", "med", "high", "ultrahigh", "none"
-gGraphicProfile =3D "med"
+-- gGraphicProfile =3D "med"

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Wed Feb  6 19:45:00 2008
@@ -51,7 +51,6 @@
 	{
 		pass Decal
 		{
-			//scene_blend alpha_blend
 			alpha_rejection greater_equal 200
 		}
 	}

Modified: trunk/data/profiles/gfx_high.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_high.lua (original)
+++ trunk/data/profiles/gfx_high.lua Wed Feb  6 19:45:00 2008
@@ -1,4 +1,6 @@
-gAtlasRes =3D "none"
+-- high gfx-profile has medium settings with fixed function shadow techniq=
ue
+
+gAtlasRes =3D "med"
 =

 gShadowTechnique =3D "texture_additive"
 gStaticsCastShadows =3D true

Modified: trunk/data/profiles/gfx_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_med.lua (original)
+++ trunk/data/profiles/gfx_med.lua Wed Feb  6 19:45:00 2008
@@ -1,3 +1,7 @@
+-- medium gfx-profile has always the same settings as config.lua.dist
+
 gAtlasRes =3D "med"
 =

+gShadowTechnique =3D "none"
+
 gSightRange	=3D 4

Modified: trunk/data/profiles/gfx_ultrahigh.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_ultrahigh.lua (original)
+++ trunk/data/profiles/gfx_ultrahigh.lua Wed Feb  6 19:45:00 2008
@@ -1,3 +1,5 @@
+-- ultrahigh gfx-profile uses no textureatlas and has (in future) depthsha=
dowmapping
+
 gAtlasRes =3D "none"
 =

 gShadowTechnique =3D "texture_additive"
@@ -8,8 +10,6 @@
 gUseHumanSkinShader =3D true
 =

 gSightRange	=3D 6
-gEnableLowDetailTerrainFarSight =3D true
-gEnableLowDetailTerrainFarSightRangeAdd =3D 4
 =

 gPreloadStaticMesh =3D true
 =


Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Wed Feb  6 19:45:00 2008
@@ -101,7 +101,7 @@
 	=

 			-- Setup cloud options.
 			-- Tweak these settings to make the demo look pretty.
-			--local clouds=3DgCaelumSystem:GetClouds()
+--			local clouds=3DgCaelumSystem:GetClouds()
 			if (clouds) then
 				clouds:SetCloudSpeed(0.000005, -0.000009);
 				clouds:SetCloudBlendTime(3600 * 24);
@@ -143,7 +143,7 @@
 gBuildStencilShadowEdgeList =3D false
 function Renderer3D:SetupShadows ()
 	local shadowfardist=3D5*gSightRange+gFogValue
-
+	print("ShadowTechnique used: "..gShadowTechnique)
 	if ((gShadowTechnique =3D=3D "stencil_modulative") or (gShadowTechnique =
=3D=3D "stencil_additive")) then
 		----- currently doesn't work with Fastbatch
 		--OgreSetShadowFarDistance(shadowfardist)
@@ -154,12 +154,10 @@
 		OgreSetShadowTextureFadeStart(0.6)
 		OgreSetShadowTextureFadeEnd(0.9)
 =

---		OgreSetShadowTexturePixelFormat(PF_FLOAT32_R)
 --		if ( OgreRenderSystemIsOpenGL() ) then OgreSetShadowTexturePixelFormat=
(PF_FLOAT16_R) end
+--		OgreSetShadowTextureSelfShadow(true)
 --		OgreSetShadowTextureCasterMaterial("Ogre/DepthShadowmap/Caster/Float")
---		OgreSetShadowTextureReceiverMaterial("Ogre/DepthShadowmap/BasicTemplat=
eMaterial")
-
-		OgreSetShadowTextureSelfShadow(true)		-- disable this or write in materi=
al "receive_shadows off"
+--		OgreSetShadowTextureReceiverMaterial("tex_base")
 		OgreSetShadowCasterRenderBackFaces(false)
 		OgreSetShadowTextureSize(2048)
 		--OgreSetShadowTextureCount(3)
@@ -170,11 +168,12 @@
 		OgreSetShadowTextureFadeStart(0.5)
 		OgreSetShadowTextureFadeEnd(0.9)
 =

---		OgreSetShadowTexturePixelFormat(PF_FLOAT32_R)
+		OgreSetShadowTextureSelfShadow(true)
 		OgreSetShadowTextureCasterMaterial("Ogre/DepthShadowmap/Caster/Float")
-		OgreSetShadowTextureSelfShadow(true)		-- disable this or write in tex_ba=
se "receive_shadows off"
+		OgreSetShadowTexturePixelFormat(PF_FLOAT32_R)
+--		OgreSetShadowTextureReceiverMaterial("tex_base")
 		OgreSetShadowCasterRenderBackFaces(false)
-		OgreSetShadowTextureSize(2048)
+		--OgreSetShadowTextureSize(512)
 		--OgreSetShadowTextureCount(3)
 =

  		OgreShadowTechnique(gShadowTechnique)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Wed Feb  6 19:45:00 2008
@@ -95,6 +95,7 @@
 dofile(libpath .. "lib.oldwalk.lua")
 dofile(libpath .. "lib.bugreport.lua")
 dofile(libpath .. "lib.buff.lua")
+dofile(libpath .. "lib.securetrade.lua")
 =

 dofile(libpath .. "gui/gui.main.lua")
 dofile(libpath .. "obj/obj.main.lua")
@@ -118,7 +119,7 @@
 	fp:write("-- this is your local config file, here you can override the de=
fault options\n")
 	fp:write("-- gUOPath =3D \"C:\\\\stuff\\\\iris\\\\uo\\\\\" -- enter the p=
ath to your uo data dir here\n")
 	fp:write("\n")
-	fp:write("-- \"ultralow\", \"low\", \"med\", \"high\", \"ultrahigh\"\n")
+	fp:write("-- \"ultralow\", \"low\", \"med\", \"high\", \"ultrahigh\, \"no=
ne\"\n")
 	fp:write("gGraphicProfile =3D \"med\"\n")
 	fp:write("\n")
 --	for line in io.lines(gConfigPathFallback) do =

@@ -183,6 +184,7 @@
 	OgreAddResLoc(mydatapath.."base/font"					,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."base/hotbar"					,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."skybox/materials"			,"FileSystem","General")
+	OgreAddResLoc(mydatapath.."skybox/programs"				,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."skybox/textures"				,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."particles/materials"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."particles/particles"			,"FileSystem","General")
@@ -191,9 +193,7 @@
 =

 	--~ # custom models
 	OgreAddResLoc(mydatapath.."custom/materials"			,"FileSystem","General")
-	OgreAddResLoc(mydatapath.."custom/meta"					,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."custom/models"				,"FileSystem","General")
-	OgreAddResLoc(mydatapath.."custom/programs"				,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."custom/textures"				,"FileSystem","General")
 =

 	--~ # distributet models
@@ -201,13 +201,10 @@
 	OgreAddResLoc(mydatapath.."models/meta"					,"FileSystem","General")
 	for i=3D1,20 do OgreAddResLoc(mydatapath.."models/models/"..sprintf("to_%=
03d000",i)	,"FileSystem","General") end
 	OgreAddResLoc(mydatapath.."models/textures/"			,"FileSystem","General")
-	OgreAddResLoc(mydatapath.."models/programs"				,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."models/atlas"				,"FileSystem","General")
-	OgreAddResLoc(mydatapath.."models/"						,"FileSystem","General")
 =

 	--~ # new Terrain Shaderengine
 	OgreAddResLoc(mydatapath.."terrain/materials"			,"FileSystem","General")
-	OgreAddResLoc(mydatapath.."terrain/programs"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."terrain/textures"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."terrain/multitex"			,"FileSystem","General")
 =

@@ -291,7 +288,7 @@
 =

 	-- Lua test because Lua50 should not be compiled full-optimized with VS20=
05 Express (maybe also other compilers)
 	if (true) then LuaBitwiseTest() end
-	if (gHuffmanCompression) then LuaHuffmanTest() end
+	-- if (gHuffmanCompression) then LuaHuffmanTest() end
 	---if (false) then AnalyseStatics(0) end
 	-- if (false) then ExpressionTest() end
 	-- if (false) then TestSound() end

Modified: trunk/lua/net/net.main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.main.lua (original)
+++ trunk/lua/net/net.main.lua Wed Feb  6 19:45:00 2008
@@ -13,13 +13,13 @@
 dofile(libpath .. "net/net.aoscommand.lua")
 dofile(libpath .. "net/net.cursor.lua")
 dofile(libpath .. "net/net.other.lua")
+dofile(libpath .. "net/net.securetrade.lua")
 =

 -- only things that have at least 2 packets get its own file, everything e=
lse is handled here:
 dofile(libpath .. "net/net.packethandlers.lua")
 =

 dofile(libpath .. "net.popup.lua")
 dofile(libpath .. "net.trade.lua")
-dofile(libpath .. "net.securetrade.lua")
 dofile(libpath .. "net.walk.lua")
 =

 gLastDoubleClickSerial =3D 0



From no-reply at zwischenwelt.org  Wed Feb  6 19:47:16 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 06 Feb 2008 18:47:16 -0000
Subject: [Iris-commit] [IRIS] r1887 - in /trunk/data: config.lua.dist
	profiles/gfx_med.lua
Message-ID: <20080206184717.381FB1C186F4@zwischenwelt.org>

Author: sience
Date: Wed Feb  6 19:47:13 2008
New Revision: 1887

Log:
-shadows activated again for standard settings

Modified:
    trunk/data/config.lua.dist
    trunk/data/profiles/gfx_med.lua

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Wed Feb  6 19:47:13 2008
@@ -283,7 +283,7 @@
 =

 -- shadow settings
 --"none", "stencil_modulative", "stencil_additive", "texture_modulative", =
"texture_additive", "texture_additive_integrated", "texture_modulative_inte=
grated"
-gShadowTechnique =3D "none"
+gShadowTechnique =3D "texture_additive"
 gTerrainCastShadows =3D false
 gStaticsCastShadows =3D true
 gDynamicsCastShadows =3D true

Modified: trunk/data/profiles/gfx_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_med.lua (original)
+++ trunk/data/profiles/gfx_med.lua Wed Feb  6 19:47:13 2008
@@ -3,5 +3,9 @@
 gAtlasRes =3D "med"
 =

 gShadowTechnique =3D "none"
+gTerrainCastShadows =3D false
+gStaticsCastShadows =3D false
+gDynamicsCastShadows =3D false
+gMobileCastShadows =3D false
 =

 gSightRange	=3D 4



From no-reply at zwischenwelt.org  Wed Feb  6 22:33:42 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 06 Feb 2008 21:33:42 -0000
Subject: [Iris-commit] [IRIS] r1888 - /trunk/lua/net/net.securetrade.lua
Message-ID: <20080206213343.010521C186E5@zwischenwelt.org>

Author: sience
Date: Wed Feb  6 22:33:42 2008
New Revision: 1888

Log:
-ups ... forgot to add net.securetrade.lua

Added:
    trunk/lua/net/net.securetrade.lua



From no-reply at zwischenwelt.org  Sun Feb 10 00:13:51 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 09 Feb 2008 23:13:51 -0000
Subject: [Iris-commit] [IRIS] r1890 - in /trunk/lua: lib.3d.renderer.lua
 lib.granny.lua lib.mainmenu.lua lib.test.lua main.lua
Message-ID: <20080209231351.D4E0C1C1873B@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 00:13:50 2008
New Revision: 1890

Log:
-some functions moved from main.lua to preload
-some functions moved to lib.test.lua
-some comments added

Modified:
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.granny.lua
    trunk/lua/lib.mainmenu.lua
    trunk/lua/lib.test.lua
    trunk/lua/main.lua

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sun Feb 10 00:13:50 2008
@@ -12,7 +12,11 @@
 Renderer3D.gDynamicMaxRenderDist =3D 128 -- 0 means always rendered  -- TO=
DO : make this dependant on bounding sphere size, e.g. in pixel size ?
 Renderer3D.gDynamicZAdd =3D 0.2 -- add a bit to make sure all dynamics can=
 be clicked and none are below the floor, todo : improve this by detecting =
floor height and model bbox
 =

-function Renderer3D:PreInit ()  end
+function Renderer3D:PreInit ()
+	-- load texture atlas
+	LoadTexAtlas()
+	MultiTexTerrainInit()
+end
 =

 -- warning !you still have to do 0.1 z factor seperately
 function Renderer3D:UOPosToLocal (xloc,yloc,z) =


Modified: trunk/lua/lib.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.granny.lua (original)
+++ trunk/lua/lib.granny.lua Sun Feb 10 00:13:50 2008
@@ -204,14 +204,11 @@
 	local texname =3D GetGrannyTextureName(mygranny)
 	local matname =3D gGrannyMaterialCache[texname.."_"..hue]
 	if (not matname) then
-		--printf("hue %04x\n",hue)
-		=

 		local texmaskname =3D GetGrannyTextureMaskName(texname)
 		local texturepath =3D CorrectGrannyPath("Maps/"..texname)
 		local texturemaskpath =3D CorrectGrannyPath("Maps/"..texmaskname)
 		-- texturepath will usually be an absolute path such as "/cavern/uostuff=
/uo/Models/Maps/UT256_Armor_Ring_V2.tga"
 =

-		--use skinshader for characters male/female, all other stuff uses granny=
base plain
 		local modelinfo =3D GetGrannyModelInfo(modelid)
 		if (modelinfo) then
 			if (modelinfo.typeid=3D=3D4) then
@@ -223,6 +220,7 @@
 					matname =3D CloneMaterial("grannybase")
 				end
 			else
+				--use skinshader for characters male/female, all other stuff uses gran=
nybase plain
 				if (IsBodyIDHuman(modelid) and gUseHumanSkinShader) then
 					matname =3D CloneMaterial("grannybase_humanshader")
 				else

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Sun Feb 10 00:13:50 2008
@@ -1,22 +1,6 @@
 -- handles the menu before starting the game
 =

 gMainMenuCamAng =3D 0
-
-function SetLoadingBackground ()
---[[
-	if (not(gLoadingBackground)) then
-		gLoadingBackground=3DCreateGumpDlgFromGfm(datapath.."gfm/loading.gfm")
-		local dialog =3D gLoadingBackground
-		for k,v in pairs(dialog.childs) do v.mbIgnoreMouseOver =3D false end
-		-- TODO: check screensize and center
-		local vw,vh =3D GetViewportSize()
-		dialog.rootwidget.gfx:SetPos(vw/2-320,vh/2-240)
-		dialog.onMouseUp =3D function (widget,mousebutton)
-			if (mousebutton =3D=3D 1) then end
-		end
-	end
-]]--
-end
 =

 function StopLoadingBackground ()
 	if (gLoadingBackground) then
@@ -274,21 +258,6 @@
 	UnBindArr({"u","q","e","tab","r","t","k","j","b","p","g","h","y"})
 end
 =

-function StartMeshLoaderTest ()
-	if (gDialog_IrisLogo) then gDialog_IrisLogo:SetVisible(false) end
-	local mymeshbuffer =3D LoadMeshBufferFromFile("../data/models/models/to_0=
02000/mdl_001909.mesh") -- load directly
-	--~ local mymeshbuffer =3D GetMeshBuffer("../data/models/models/to_002000=
/mdl_001909.mesh") -- load to vram and read back to ram
-	local fastbatch =3D CreateRootGfx3D()
-	fastbatch:SetFastBatch()
-	local x,y,z =3D 0,2,40-0.5 -- +x=3Dright,+y=3Ddepth,+z :top (camz=3D40)
-	local qw,qx,qy,qz =3D 1,0,0,0
-	local sx,sy,sz =3D 1,1,1
-	local r,g,b,a =3D 1,1,1,1
-	local orderval =3D 0 -- not used here
-	fastbatch:FastBatch_AddMeshBuffer(mymeshbuffer, orderval, x,y,z, qw,qx,qy=
,qz, sx,sy,sz, r,g,b,a)
-	fastbatch:FastBatch_Build()
-end
-
 function StartMainMenu ()
 	if (gTestNoMainMenu) then return end
 	if (gCommandLineSwitches["-meshload"]) then StartMeshLoaderTest() end -- =
journaltest

Modified: trunk/lua/lib.test.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.test.lua (original)
+++ trunk/lua/lib.test.lua Sun Feb 10 00:13:50 2008
@@ -325,3 +325,18 @@
 	l:Destroy()
 	Crash()
 end
+
+function StartMeshLoaderTest ()
+	if (gDialog_IrisLogo) then gDialog_IrisLogo:SetVisible(false) end
+	local mymeshbuffer =3D LoadMeshBufferFromFile("../data/models/models/to_0=
02000/mdl_001909.mesh") -- load directly
+	--~ local mymeshbuffer =3D GetMeshBuffer("../data/models/models/to_002000=
/mdl_001909.mesh") -- load to vram and read back to ram
+	local fastbatch =3D CreateRootGfx3D()
+	fastbatch:SetFastBatch()
+	local x,y,z =3D 0,2,40-0.5 -- +x=3Dright,+y=3Ddepth,+z :top (camz=3D40)
+	local qw,qx,qy,qz =3D 1,0,0,0
+	local sx,sy,sz =3D 1,1,1
+	local r,g,b,a =3D 1,1,1,1
+	local orderval =3D 0 -- not used here
+	fastbatch:FastBatch_AddMeshBuffer(mymeshbuffer, orderval, x,y,z, qw,qx,qy=
,qz, sx,sy,sz, r,g,b,a)
+	fastbatch:FastBatch_Build()
+end

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Feb 10 00:13:50 2008
@@ -285,6 +285,7 @@
 	CollectOgreResLocs()
 	SetCursorBaseOffset(0,0)
 =

+	------------------------------------------ obsolete, just for testing ---=
--------------------------------
 	-- Lua test because Lua50 should not be compiled full-optimized with VS20=
05 Express (maybe also other compilers)
 	if (true) then LuaBitwiseTest() end
 	-- if (gHuffmanCompression) then LuaHuffmanTest() end
@@ -294,6 +295,7 @@
 	-- if (false) then TestMultiLoader() end
 	-- if (false) then TestZLib() end
 	-- if (false) then TestUniFontLoader() end
+	-------------------------------------------------------------------------=
---------------------------------
 =

 	-- maybe we should check here if in offline or online mode!?
 	InitNet()
@@ -302,12 +304,7 @@
 	gui.StartLoading()
 =

 	LoadBasicData()
-	=

-	-- only for 3DRenderer
-	LoadTexAtlas()
-	=

-	-- show loading screen
-	SetLoadingBackground()
+
 	Client_RenderOneFrame() -- first frame rendered with ogre, needed for ini=
t of viewport size
 =

 	NotifyListener("Hook_PreLoad")
@@ -347,8 +344,6 @@
 =

 	gCurrentRenderer:Init()
 	=

-	MultiTexTerrainInit()
-	=

 	-- set fadelines font
 	gFadeLinesFont =3D gFontNameDefault
 	gFadeLineTextH =3D gFontChatSize



From no-reply at zwischenwelt.org  Sun Feb 10 03:40:25 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 02:40:25 -0000
Subject: [Iris-commit] [IRIS] r1891 - in /trunk/staticompile: ./ iris
Message-ID: <20080210024029.875391C18747@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Feb 10 03:40:19 2008
New Revision: 1891

Log: (empty)

Added:
    trunk/staticompile/
    trunk/staticompile/iris   (with props)



From no-reply at zwischenwelt.org  Sun Feb 10 04:09:12 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 03:09:12 -0000
Subject: [Iris-commit] [IRIS] r1892 - in /trunk: linuxbin/ staticompile/
Message-ID: <20080210030913.43A691C181BB@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Feb 10 04:09:12 2008
New Revision: 1892

Log:
binary foldername changed

Added:
    trunk/linuxbin/
      - copied from r1891, trunk/staticompile/
Removed:
    trunk/staticompile/



From no-reply at zwischenwelt.org  Sun Feb 10 13:46:18 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 12:46:18 -0000
Subject: [Iris-commit] [IRIS] r1893 - in /trunk/lua: lib.3d.map.lua
	lib.3d.renderer.lua
Message-ID: <20080210124619.5341C1524004@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 13:46:17 2008
New Revision: 1893

Log:
-moved cadunetree generation to lib.3d.renderer.lua

Modified:
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sun Feb 10 13:46:17 2008
@@ -261,44 +261,6 @@
 	self.gMapChunks =3D {}
 end
 =

---[[
---gobal tree params
--- TODO: put them into an array
-Renderer3D.gTreeParameters =3D nil
-Renderer3D.gTreeStemParameters =3D nil
-function drawCaduneTree(iTileTypeID)
-	-- just to test the cadunetree generation code
-	if ((iTileTypeID =3D=3D 3296) or (iTileTypeID =3D=3D 3297)) then
-		if (not self.gTreeParameters) then
-			self.gTreeParameters =3D CreateCaduneTreeParameters()
-			self.gTreeStemParameters =3D CreateCaduneTreeStem(self.gTreeParameters)
-			self.gTreeStemParameters:Grow()
-		end
-
-		if (iTileTypeID =3D=3D 3296) then
-			print("generate tree")
-			entity.gfx =3D self.gTreeStemParameters:CreateGeometry()
-
-			entity.x,entity.y,entity.z =3D self:UOPosToLocal(entity.xloc+1,entity.y=
loc+0.5,entity.zloc*0.1)
-			entity.gfx:SetOrientation( QuaternionFromString("x:90,y:0,z:0") )
-			entity.gfx:SetPosition(entity.x,entity.y,entity.z)
-			entity.gfx:SetScale(0.4,0.4,0.5)
-			entity.gfx:SetNormaliseNormals(true)
-		end
-		if (iTileTypeID =3D=3D 3297) then
-			print("generate leaves")
-			entity.gfx =3D self.gTreeStemParameters:CreateLeaves()
-	=

-			entity.x,entity.y,entity.z =3D self:UOPosToLocal(entity.xloc+1,entity.y=
loc+0.5,entity.zloc*0.1)
-			entity.gfx:SetOrientation( QuaternionFromString("x:90,y:0,z:0") )
-			entity.gfx:SetPosition(entity.x,entity.y,entity.z)
-			entity.gfx:SetScale(0.4,0.4,0.5)
-			entity.gfx:SetNormaliseNormals(true)
-		end
-	end
-end
-]]--
-
 -- handles the entity creation for CreateMapChunk and adds it to chunk.lSt=
aticEntities
 function Renderer3D:CreateMapChunkEntity (chunk,iTileTypeID,iXLoc,iYLoc,iZ=
Loc,iHue)
 	local entity =3D {}
@@ -316,8 +278,7 @@
 	=

 	entity.iBlockX =3D math.floor(entity.xloc / 8)
 	entity.iBlockY =3D math.floor(entity.yloc / 8)
-	-- TODO not needed?
-	-- entity.id =3D i
+
 	entity.iTileTypeID =3D iTileTypeID
 	entity.iHue =3D iHue
 	=

@@ -334,9 +295,12 @@
 		staticwatertile =3D not gEnableMultiTexTerrain		--on multitexturing filt=
er static water
 	end
 =

+	-- has to be called before GetMeshName because of Art-Filters
+	--if (true) then self:GenerateCaduneTree(entity) return end
+
 	local meshname =3D (not gForceFallBackBillboards_Statics) and staticwater=
tile and GetMeshName(iTileTypeID, (gFastBatchStatics and 0) or entity.iHue)
 =

-	-- build Edgelist for Stencil Shadows
+	-- TODO: does it really work? 	--build Edgelist for Stencil Shadows
 	if (meshname and gBuildStencilShadowEdgeList) then print("edges generated=
") MeshBuildEdgeList(meshname) end
 =

 	-- create Mesh

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sun Feb 10 13:46:17 2008
@@ -541,3 +541,45 @@
 		end
 	end
 end
+
+--gobal tree params
+-- TODO: put them into an array
+Renderer3D.gTreeParameters =3D nil
+Renderer3D.gTreeStemParameters =3D nil
+function Renderer3D:GenerateCaduneTree(entity,iTileTypeID)
+	local iTileTypeID =3D entity.iTileTypeID
+	-- just to test the cadunetree generation code
+	if ((iTileTypeID =3D=3D 3296) or (iTileTypeID =3D=3D 3297)) then
+		print(iTileTypeID)
+		if (not self.gTreeParameters) then
+			self.gTreeParameters =3D CreateCaduneTreeParameters()
+			self.gTreeStemParameters =3D CreateCaduneTreeStem(self.gTreeParameters)
+			self.gTreeStemParameters:Grow()
+		end
+
+		if (iTileTypeID =3D=3D 3296) then
+			print("generate tree")
+			entity.gfx =3D self.gTreeStemParameters:CreateGeometry()
+
+			entity.x,entity.y,entity.z =3D self:UOPosToLocal(entity.xloc+1,entity.y=
loc+0.5,entity.zloc*0.1)
+			entity.gfx:SetOrientation( QuaternionFromString("x:90,y:0,z:0") )
+			entity.gfx:SetPosition(entity.x,entity.y,entity.z)
+			entity.gfx:SetScale(0.4,0.4,0.5)
+			entity.gfx:SetNormaliseNormals(true)
+			print("export tree bark")
+			--ExportMesh(entity.gfx ,"tree_"..iTileTypeID..".mesh")
+			--entity.gfx:Destroy()
+			--entity.gfx =3D nil
+		end
+		if (iTileTypeID =3D=3D 3297) then
+			print("generate leaves")
+			entity.gfx =3D self.gTreeStemParameters:CreateLeaves()
+	=

+			entity.x,entity.y,entity.z =3D self:UOPosToLocal(entity.xloc+1,entity.y=
loc+0.5,entity.zloc*0.1)
+			entity.gfx:SetOrientation( QuaternionFromString("x:90,y:0,z:0") )
+			entity.gfx:SetPosition(entity.x,entity.y,entity.z)
+			entity.gfx:SetScale(0.4,0.4,0.5)
+			entity.gfx:SetNormaliseNormals(true)
+		end
+	end
+end



From no-reply at zwischenwelt.org  Sun Feb 10 18:53:11 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 17:53:11 -0000
Subject: [Iris-commit] [IRIS] r1894 - /trunk/data/base/hotbar/
Message-ID: <20080210175311.75F071524004@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 18:53:10 2008
New Revision: 1894

Log:
-deleted.

Removed:
    trunk/data/base/hotbar/



From no-reply at zwischenwelt.org  Sun Feb 10 18:55:15 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 17:55:15 -0000
Subject: [Iris-commit] [IRIS] r1895 - in /trunk/data/guis: ./ gor/
Message-ID: <20080210175515.BFCA91524004@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 18:55:09 2008
New Revision: 1895

Log:
-first new gui-style added
-all guis goto /data/guis/xxx

Added:
    trunk/data/guis/
    trunk/data/guis/gor/
    trunk/data/guis/gor/gor_iris2_gui_17_bloody_sliced_chat.png   (with pro=
ps)
    trunk/data/guis/gor/gor_iris2_gui_17_bloody_sliced_mainmenu.png   (with=
 props)
    trunk/data/guis/gor/gor_iris2_gui_17_bloody_sliced_radar.png   (with pr=
ops)
    trunk/data/guis/gor/gor_iris2_gui_17_bloody_sliced_spellbar.png   (with=
 props)
    trunk/data/guis/gor/gor_iris2_gui_17_bloody_sliced_status.png   (with p=
rops)
    trunk/data/guis/gor/hotbar.material



From no-reply at zwischenwelt.org  Sun Feb 10 18:58:09 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 17:58:09 -0000
Subject: [Iris-commit] [IRIS] r1896 - in /trunk/lua: gui/gui.hotbar.lua
	gui/gui.status.lua main.lua
Message-ID: <20080210175809.DD6091524004@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 18:58:08 2008
New Revision: 1896

Log:
-lua gui stuff updated

Modified:
    trunk/lua/gui/gui.hotbar.lua
    trunk/lua/gui/gui.status.lua
    trunk/lua/main.lua

Modified: trunk/lua/gui/gui.hotbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.hotbar.lua (original)
+++ trunk/lua/gui/gui.hotbar.lua Sun Feb 10 18:58:08 2008
@@ -1,8 +1,8 @@
-gShowHotbar =3D false
+gGuiShowHotbar =3D false
 =

-function CreateHotbar () =

+function CreateHotbar ()
 	gDialog_Hotbar =3D guimaker.MyCreateDialog()
-	gDialog_Hotbar.widget =3D guimaker.MakePlane(gDialog_Hotbar,"hotbar",0,0,=
493,88)
+	gDialog_Hotbar.widget =3D guimaker.MakePlane(gDialog_Hotbar,"gorgui/hotba=
r",0,0,515,65)
 	local vw,vh =3D GetViewportSize()
 	gDialog_Hotbar.vw =3D vw
 	gDialog_Hotbar.vh =3D vh
@@ -10,15 +10,15 @@
 end
 =

 function ToggleHotbar ()
-	gShowHotbar =3D not gShowHotbar
+	gGuiShowHotbar =3D not gGuiShowHotbar
 	=

 	if not(gDialog_Hotbar) then CreateHotbar () end
-	gDialog_Hotbar:SetVisible(gShowHotbar)
+	gDialog_Hotbar:SetVisible(gGuiShowHotbar)
 end
 =

 -- called every frame
 function UpdateHotbar ()
-	if not(gShowHotbar) then return end
+	if not(gGuiShowHotbar) then return end
 	if not(gDialog_Hotbar) then return end
 =

 	local vw =3D GetMainViewport():GetActualWidth()

Modified: trunk/lua/gui/gui.status.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.status.lua (original)
+++ trunk/lua/gui/gui.status.lua Sun Feb 10 18:58:08 2008
@@ -34,27 +34,8 @@
 			if (mousebutton =3D=3D 2) then widget.dialog:Close() end
 			if (mousebutton =3D=3D 1) then widget.dialog:BringToFront() gui.StartMo=
veDialog(widget.dialog.rootwidget) end
 		end
-	=

-		--[[
-		stats.sex		=3D input:PopNetUint8() -- * 0x00 - Male     * 0x01 - Female
-		stats.gold		=3D input:PopNetUint32()
-		stats.armor		=3D input:PopNetUint16() -- resistPhysical (old clients: AC=
).
-		stats.curWeight=3D input:PopNetUint16()
-		stats.maxWeight =3D input:PopNetUint16()
-		stats.race		 =3D input:PopNetUint8()
-		stats.statcap	=3D input:PopNetUint16()		-- The character's total allowab=
le sum of Strength, Intelligence, and Dexterity
-		stats.curPet	=3D input:PopNetUint8()			=

-		stats.maxPet	=3D input:PopNetUint8()
-		stats.fireresist	=3D input:PopNetUint16()			=

-		stats.coldresist	=3D input:PopNetUint16()			=

-		stats.poisonresist	=3D input:PopNetUint16()			=

-		stats.energyresist	=3D input:PopNetUint16()			=

-		stats.minDamage	=3D input:PopNetUint16()			=

-		stats.maxDamage	=3D input:PopNetUint16()			=

-		stats.tithing		=3D input:PopNetUint32()		=

-		]]--		=

 =

-				-- stats update function
+		-- stats update function
 		dialog.UpdateStats =3D function (dialog)
 			if gPlayerBodySerial then
 				local m =3D GetMobile(gPlayerBodySerial)
@@ -120,11 +101,7 @@
 		=

 		-- handle mouse events
 		for k,v in pairs(dialog.childs) do v.mbIgnoreMouseOver =3D false end
-
--- SiENcE: ??? for what ??? commented out
---		local curparent =3D dialog.rootwidget
---		local x,y =3D 40,80
-		=

+	=

 		-- set stats
 		dialog:UpdateStats()
 		=


Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Feb 10 18:58:08 2008
@@ -181,7 +181,6 @@
 	OgreAddResLoc(mydatapath.."tmp"							,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."base/ui"						,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."base/font"					,"FileSystem","General")
-	OgreAddResLoc(mydatapath.."base/hotbar"					,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."skybox/materials"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."skybox/programs"				,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."skybox/textures"				,"FileSystem","General")
@@ -189,6 +188,9 @@
 	OgreAddResLoc(mydatapath.."particles/particles"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."particles/textures"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."compositors"					,"FileSystem","General")
+
+	--~ # custom guis
+	OgreAddResLoc(mydatapath.."guis/gor"					,"FileSystem","General")
 =

 	--~ # custom models
 	OgreAddResLoc(mydatapath.."custom/materials"			,"FileSystem","General")



From no-reply at zwischenwelt.org  Sun Feb 10 20:24:41 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 19:24:41 -0000
Subject: [Iris-commit] [IRIS] r1897 - in /trunk/lua/gui: gui.hotbar.lua
	gui.status.lua
Message-ID: <20080210192441.5AB9B1C186D8@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 20:24:40 2008
New Revision: 1897

Log:
-obsolete array removed from gui.status.lua
-hotbar updated

Modified:
    trunk/lua/gui/gui.hotbar.lua
    trunk/lua/gui/gui.status.lua

Modified: trunk/lua/gui/gui.hotbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.hotbar.lua (original)
+++ trunk/lua/gui/gui.hotbar.lua Sun Feb 10 20:24:40 2008
@@ -1,32 +1,61 @@
-gGuiShowHotbar =3D false
+gHotbarDialog_LastPositionX =3D nil
+gHotbarDialog_LastPositionY =3D nil
 =

-function CreateHotbar ()
-	gDialog_Hotbar =3D guimaker.MyCreateDialog()
-	gDialog_Hotbar.widget =3D guimaker.MakePlane(gDialog_Hotbar,"gorgui/hotba=
r",0,0,515,65)
-	local vw,vh =3D GetViewportSize()
-	gDialog_Hotbar.vw =3D vw
-	gDialog_Hotbar.vh =3D vh
-	gDialog_Hotbar.widget.gfx:SetPos(vw/2-493/2,vh-90)
-end
-
-function ToggleHotbar ()
-	gGuiShowHotbar =3D not gGuiShowHotbar
-	=

-	if not(gDialog_Hotbar) then CreateHotbar () end
-	gDialog_Hotbar:SetVisible(gGuiShowHotbar)
-end
-
--- called every frame
 function UpdateHotbar ()
-	if not(gGuiShowHotbar) then return end
-	if not(gDialog_Hotbar) then return end
-
-	local vw =3D GetMainViewport():GetActualWidth()
-	local vh =3D GetMainViewport():GetActualHeight()
-
-	if (gDialog_Hotbar.vw ~=3D vw or gDialog_Hotbar.vh ~=3D vh) then
-		gDialog_Hotbar.widget.gfx:SetPos(vw/2-493/2,vh-90)
-		gDialog_Hotbar.vw =3D vw
-		gDialog_Hotbar.vh =3D vh
+	if gHotbarDialog then
+		gHotbarDialog:UpdateHotbar()
 	end
 end
+		=

+function ToggleHotbar ()
+	if (gHotbarDialog) then
+		-- store current positoin
+		gHotbarDialog_LastPositionX, gHotbarDialog_LastPositionY =3D gHotbarDial=
og.rootwidget.gfx:GetPos()
+		-- and close
+		gHotbarDialog:Close()
+	else
+		-- ..........do something before hotbar creation (get spells/items ?!)
+		print("create hotbar")
+		gHotbarDialog =3D guimaker.MyCreateDialog()
+		gHotbarDialog.rootwidget =3D guimaker.MakePlane(gHotbarDialog,gNewGuiSty=
le.."/hotbar",0,0,515,65)
+
+		-- restore last positoin if available
+		if gHotbarDialog_LastPositionX and gHotbarDialog_LastPositionY then
+			gHotbarDialog.rootwidget.gfx:SetPos(gHotbarDialog_LastPositionX, gHotba=
rDialog_LastPositionY)
+		else
+			local vw,vh =3D GetViewportSize()
+--			gHotbarDialog.vw =3D vw
+--			gHotbarDialog.vh =3D vh
+			gHotbarDialog.rootwidget.gfx:SetPos(vw/2-493/2,vh-90)
+		end
+
+		-- init Hotbar dialog
+		local dialog =3D gHotbarDialog
+		dialog.Close =3D function (dialog)
+			gHotbarDialog:Destroy()
+			gHotbarDialog =3D nil
+		end
+
+		dialog.onMouseDown =3D function (widget,mousebutton)
+			--if (mousebutton =3D=3D 2) then widget.dialog:Close() end
+			if (mousebutton =3D=3D 1) then widget.dialog:BringToFront() gui.StartMo=
veDialog(widget.dialog.rootwidget) end
+		end
+
+		-- stats update function
+		dialog.UpdateHotbar =3D function (dialog)
+--			local vw =3D GetMainViewport():GetActualWidth()
+--			local vh =3D GetMainViewport():GetActualHeight()
+
+--			if (gHotbarDialog.vw ~=3D vw or gHotbarDialog.vh ~=3D vh) then
+--				print("update hotbar")
+--				gHotbarDialog.rootwidget.gfx:SetPos(gHotbarDialog_LastPositionX+vw/2=
,gHotbarDialog_LastPositionY+vh)
+--			end
+		end
+		=

+		-- handle mouse events
+		for k,v in pairs(dialog.childs) do v.mbIgnoreMouseOver =3D false end
+	=

+		-- set stats
+		dialog:UpdateHotbar()
+	end
+end

Modified: trunk/lua/gui/gui.status.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.status.lua (original)
+++ trunk/lua/gui/gui.status.lua Sun Feb 10 20:24:40 2008
@@ -104,8 +104,6 @@
 	=

 		-- set stats
 		dialog:UpdateStats()
-		=

-		dialog.lStatusAos =3D {}
 	end
 end
 =




From no-reply at zwischenwelt.org  Sun Feb 10 21:17:51 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 20:17:51 -0000
Subject: [Iris-commit] [IRIS] r1898 - in /trunk: data/config.lua.dist
 data/guis/gor/ data/guis/gorgui/ lua/lib.gui.iris.lua lua/main.lua
Message-ID: <20080210210007.C759D1524005@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 21:17:50 2008
New Revision: 1898

Log:
-small update to hotbar

Added:
    trunk/data/guis/gorgui/
      - copied from r1897, trunk/data/guis/gor/
Removed:
    trunk/data/guis/gor/
Modified:
    trunk/data/config.lua.dist
    trunk/lua/lib.gui.iris.lua
    trunk/lua/main.lua

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Sun Feb 10 21:17:50 2008
@@ -51,6 +51,9 @@
 =

 -- GUI Styles : sience,iris,ray  (see lua\gui\gui.styles.lua)
 gGuiDefaultStyleSet =3D "sience"
+
+-- just for testing the new guistyles
+gNewGuiStyle=3D"gorgui"
 =

 -- loader types, FullFile is faster, but uses more ram, OnDemand is slower=
, but uses almost no ram
 gGroundBlockLoaderType 				=3D "FullFile"

Modified: trunk/lua/lib.gui.iris.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gui.iris.lua (original)
+++ trunk/lua/lib.gui.iris.lua Sun Feb 10 21:17:50 2008
@@ -66,7 +66,6 @@
 -- called every frame
 function gui.Step ()
 	UpdateCompass()
-	UpdateHotbar()
 	DisplayMemoryUsage(OgreMemoryUsage("all"))
 end
 =


Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Feb 10 21:17:50 2008
@@ -190,7 +190,7 @@
 	OgreAddResLoc(mydatapath.."compositors"					,"FileSystem","General")
 =

 	--~ # custom guis
-	OgreAddResLoc(mydatapath.."guis/gor"					,"FileSystem","General")
+	OgreAddResLoc(mydatapath.."guis/gorgui"					,"FileSystem","General")
 =

 	--~ # custom models
 	OgreAddResLoc(mydatapath.."custom/materials"			,"FileSystem","General")



From no-reply at zwischenwelt.org  Sun Feb 10 23:27:06 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 22:27:06 -0000
Subject: [Iris-commit] [IRIS] r1900 -
	/trunk/data/particles/textures/swords.png
Message-ID: <20080210230017.4B8471C18005@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 23:27:06 2008
New Revision: 1900

Log:
-resized

Modified:
    trunk/data/particles/textures/swords.png

Modified: trunk/data/particles/textures/swords.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sun Feb 10 23:24:17 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 10 Feb 2008 22:24:17 -0000
Subject: [Iris-commit] [IRIS] r1899 - /trunk/data/base/questmark.png
Message-ID: <20080210230011.D47BF1C18026@zwischenwelt.org>

Author: sience
Date: Sun Feb 10 23:24:17 2008
New Revision: 1899

Log:
-resized to 256x256

Modified:
    trunk/data/base/questmark.png

Modified: trunk/data/base/questmark.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Mon Feb 11 03:41:30 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 11 Feb 2008 02:41:30 -0000
Subject: [Iris-commit] [IRIS] r1901 - /trunk/data/tmp/
Message-ID: <20080211024131.09A941524004@zwischenwelt.org>

Author: ghoulsblade
Date: Mon Feb 11 03:41:28 2008
New Revision: 1901

Log:
added md5 compass things to svn:ignore list

Modified:
    trunk/data/tmp/   (props changed)



From no-reply at zwischenwelt.org  Tue Feb 12 00:47:55 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 11 Feb 2008 23:47:55 -0000
Subject: [Iris-commit] [IRIS] r1902 - in /trunk/lua:
	filter/filter.granny.lua lib.3d.renderer.lua
Message-ID: <20080211234756.0178C1524004@zwischenwelt.org>

Author: sience
Date: Tue Feb 12 00:47:54 2008
New Revision: 1902

Log:
-broken models added to filter.granny.lua ( only as comment )
-some shadow setting reorganised

Modified:
    trunk/lua/filter/filter.granny.lua
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/lua/filter/filter.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.granny.lua (original)
+++ trunk/lua/filter/filter.granny.lua Tue Feb 12 00:47:54 2008
@@ -31,7 +31,34 @@
 gGrannyFilter[970]	=3D{grannyid=3D402}
 gGrannyFilter[780]	=3D{grannyid=3D779}	-- a bog thing (too big scale)
 gGrannyFilter[311]	=3D{grannyid=3D310}	-- seg fault when loading (first on=
 uodemise/trantor)
+
+--[[
+-- wrong animations - but raw model is displayed correct, so no animation =
should be played
+gGrannyFilter[46]	=3D{animbroken}	--mf_dragon_rust
+gGrannyFilter[122]	=3D{animbroken}	--equines_unicorn
+gGrannyFilter[192]	=3D{animbroken}	--equines_unicorn_ethereal
+gGrannyFilter[791]	=3D{animbroken}	--giant_beetle
+gGrannyFilter[195]	=3D{animbroken}	--giant_beetle_ethereal
+gGrannyFilter[30]	=3D{animbroken}	--harpies_harpy
+gGrannyFilter[73]	=3D{animbroken}	--harpies_harpy_stone
+gGrannyFilter[797]	=3D{animbroken}	--red dragon
+gGrannyFilter[798]	=3D{animbroken}	--blue dragon
+gGrannyFilter[39]	=3D{animbroken}
+gGrannyFilter[194]	=3D{animbroken}	--rideable dragon
+gGrannyFilter[312]	=3D{animbroken}
+gGrannyFilter[313]	=3D{animbroken}
+gGrannyFilter[314]	=3D{animbroken}
+gGrannyFilter[315]	=3D{animbroken}
+gGrannyFilter[316]	=3D{animbroken}
+gGrannyFilter[789]	=3D{animbroken}
+gGrannyFilter[169]	=3D{animbroken}
+
+-- nogfx
+gGrannyFilter[786]	=3D{animbroken}	--chariot (no gfx)
+gGrannyFilter[58]	=3D{animbroken}	--etherals_wisp (no gfx)
+gGrannyFilter[164]	=3D{animbroken}	--etherals_energy_vortex (no gfx)
+gGrannyFilter[165]	=3D{animbroken}	--etherals_wisp (no gfx)
+]]--
+
+-- custom models can be applyed instead to grannys, just tell the meshname
 --gGrannyFilter[220]	=3D{meshname=3D"Lich.mesh"}
---gGrannyFilter[5]	=3D{grannyid=3D220}				--birds_eagle
---gGrannyFilter[39]	=3D{grannyid=3D220}				--mongbats_mongbat
---gGrannyFilter[105]	=3D{grannyid=3D220}				--dragons_wyrm_ancient

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Tue Feb 12 00:47:54 2008
@@ -157,25 +157,28 @@
 		OgreSetShadowFarDistance(shadowfardist)
 		OgreSetShadowTextureFadeStart(0.6)
 		OgreSetShadowTextureFadeEnd(0.9)
+		OgreShadowTechnique(gShadowTechnique)
+		OgreSetShadowTextureSize(2048)
 		OgreSetShadowCasterRenderBackFaces(false)
-		OgreSetShadowTextureSize(2048)
-		--OgreSetShadowTextureCount(3)
-
-		OgreShadowTechnique(gShadowTechnique)
+
+--mLiSPSMSetup =3D new LiSPSMShadowCameraSetup()
+--m_pSceneMgr->setShadowCameraSetup(ShadowCameraSetupPtr(mLiSPSMSetup))
+--		OgreSetShadowTexturePixelFormat(PF_FLOAT32_RGBA)
+--		OgreSetShadowTextureCasterMaterial("VSM/ShadowCaster")
+--		OgreSetShadowTextureReceiverMaterial("VSM/ShadowReceiver")
+--		OgreSetShadowTextureSelfShadow(true)
 	elseif ((gShadowTechnique =3D=3D "texture_additive_integrated") or (gShad=
owTechnique =3D=3D "texture_modulative_integrated")) then
 		OgreSetShadowFarDistance(shadowfardist)
 		OgreSetShadowTextureFadeStart(0.5)
 		OgreSetShadowTextureFadeEnd(0.9)
-
-		OgreSetShadowTextureSelfShadow(true)
+ 		OgreShadowTechnique(gShadowTechnique)
+		OgreSetShadowTextureSize(2048)
+		OgreSetShadowCasterRenderBackFaces(false)
+
 		OgreSetShadowTexturePixelFormat(PF_FLOAT32_R)
 		OgreSetShadowTextureCasterMaterial("Ogre/DepthShadowmap/Caster/Float")
 --		OgreSetShadowTextureReceiverMaterial("Ogre/DepthShadowmap/BasicTemplat=
eMaterial")
-		OgreSetShadowCasterRenderBackFaces(false)
-		OgreSetShadowTextureSize(2048)
-		--OgreSetShadowTextureCount(3)
-
- 		OgreShadowTechnique(gShadowTechnique)
+		OgreSetShadowTextureSelfShadow(true)
 	end
 end
 =




From no-reply at zwischenwelt.org  Wed Feb 13 01:21:10 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 13 Feb 2008 00:21:10 -0000
Subject: [Iris-commit] [IRIS] r1903 - in /trunk: data/config.lua.dist
 lua/lib.3d.map.lua lua/lib.terrain.multitex.lua
Message-ID: <20080213002110.1F45A1C18176@zwischenwelt.org>

Author: sience
Date: Wed Feb 13 01:21:09 2008
New Revision: 1903

Log:
-option DisableWater renamed to more specific DisableMultitexWater
-MultitexWater calculations limited to MultitexTerrain

Modified:
    trunk/data/config.lua.dist
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.terrain.multitex.lua

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Wed Feb 13 01:21:09 2008
@@ -432,6 +432,13 @@
 -- ugly, but faster
 gDisableMultiTexTerrainTransitions =3D false
 =

+-- for debugging
+gDisableMultiTexWater =3D false
+
+-- additional lower quality terrain in the distance
+gEnableLowDetailTerrainFarSight =3D false
+gEnableLowDetailTerrainFarSightRangeAdd =3D 2
+
 -- Fastbatching of Statics/Dynamics (no hueing)
 gFastBatchStatics =3D true
 gFastBatchDynamics =3D true
@@ -448,13 +455,6 @@
 -- the debug display at the bottom of the screen
 gDisableBottomLine =3D false
 =

--- for debugging
-gDisableWater =3D false
-
--- additional lower quality terrain in the distance
-gEnableLowDetailTerrainFarSight =3D false
-gEnableLowDetailTerrainFarSightRangeAdd =3D 2
-
 -- shaderbased characterrendering (beta)
 gUseHumanSkinShader =3D false
 =


Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Wed Feb 13 01:21:09 2008
@@ -284,7 +284,7 @@
 	=

 	local staticwatertile =3D true -- true if not water ?
 	-- add level
-	if (not gDisableWater) and FilterIsStaticWater(iTileTypeID) then
+	if gEnableMultiTexTerrain and (not gDisableMultiTexWater) and FilterIsSta=
ticWater(iTileTypeID) then
 		local z =3D entity.zloc
 		local bx =3D chunk.miX * self.ROBMAP_CHUNK_SIZE * 8
 		local by =3D chunk.miY * self.ROBMAP_CHUNK_SIZE * 8
@@ -301,7 +301,7 @@
 	local meshname =3D (not gForceFallBackBillboards_Statics) and staticwater=
tile and GetMeshName(iTileTypeID, (gFastBatchStatics and 0) or entity.iHue)
 =

 	-- TODO: does it really work? 	--build Edgelist for Stencil Shadows
-	if (meshname and gBuildStencilShadowEdgeList) then print("edges generated=
") MeshBuildEdgeList(meshname) end
+	--if (meshname and gBuildStencilShadowEdgeList) then print("edges generat=
ed") MeshBuildEdgeList(meshname) end
 =

 	-- create Mesh
 	if (meshname and meshname ~=3D false) then
@@ -379,7 +379,7 @@
 	chunk.pStaticGeometryLayers =3D {}
 =

 	-- water stats
-	if (not gDisableWater) then
+	if gEnableMultiTexTerrain and (not gDisableMultiTexWater) then
 		chunk.mWaterZMap =3D {}		-- local z height [x.."_"..y]
 		chunk.SetWaterZWithoutBorder =3D function(self, tx, ty, z)
 			if (tx >=3D 0 and ty >=3D 0 and tx < Renderer3D.ROBMAP_CHUNK_SIZE * 8 a=
nd ty < Renderer3D.ROBMAP_CHUNK_SIZE * 8) then
@@ -411,7 +411,7 @@
 	local iBlockUO_Y =3D y * self.ROBMAP_CHUNK_SIZE
 	=

 	-- water analysis
-	if (not gDisableWater) then
+	if gEnableMultiTexTerrain and (not gDisableMultiTexWater) then
 		if (gGroundBlockLoader) then
 			local tiletype,z
 			local tx,ty
@@ -526,7 +526,7 @@
 	end
 =

 	-- WATER
-	if (not gDisableWater) then
+	if gEnableMultiTexTerrain and (not gDisableMultiTexWater) then
 		local count =3D countarr(chunk.mWaterZMap) -- might be slow
 		=

 		if (gEnableMultiTexTerrain and count and count > 0) then

Modified: trunk/lua/lib.terrain.multitex.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.terrain.multitex.lua (original)
+++ trunk/lua/lib.terrain.multitex.lua Wed Feb 13 01:21:09 2008
@@ -174,7 +174,6 @@
 =

 function MultiTexTerrain_NotifyTeleport ()
 	print("MultiTexTerrain_NotifyTeleport")
-	--~ MultiTexTerrain_NotifyMapChange()
 end
 =

 =




From no-reply at zwischenwelt.org  Thu Feb 14 00:09:31 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 13 Feb 2008 23:09:31 -0000
Subject: [Iris-commit] [IRIS] r1904 - in /trunk: bin/iris2.exe
 lua/filter/filter.granny.lua lua/gui/gui.hotbar.lua lua/lib.gfm.lua
 lua/lib.gumpparser.lua lua/lib.uodragdrop.lua lua/net/net.mobile.lua
 lua/net/net.other.lua
Message-ID: <20080213230931.4DFC51C186F1@zwischenwelt.org>

Author: sience
Date: Thu Feb 14 00:09:30 2008
New Revision: 1904

Log:
-new w32 binary
-gumpparser enhanced (position of gumps is now save)
-some bugfixes
-cougars filter added to filter.granny.lua

Modified:
    trunk/bin/iris2.exe
    trunk/lua/filter/filter.granny.lua
    trunk/lua/gui/gui.hotbar.lua
    trunk/lua/lib.gfm.lua
    trunk/lua/lib.gumpparser.lua
    trunk/lua/lib.uodragdrop.lua
    trunk/lua/net/net.mobile.lua
    trunk/lua/net/net.other.lua

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/filter/filter.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.granny.lua (original)
+++ trunk/lua/filter/filter.granny.lua Thu Feb 14 00:09:30 2008
@@ -24,6 +24,19 @@
 	return nil
 end
 =

+function GrannySkeletonOverride(bodyid)
+	if (gGrannyFilter[bodyid]) then
+		if (gGrannyFilter[bodyid].skeleton) then
+			printdebug("granny","OverrideSkeleton: GrannyID to Skeleton ",bodyid," =
-> ",gGrannyFilter[bodyid].skeleton)
+			return gGrannyFilter[bodyid].skeleton
+		end
+	end
+	return nil
+end
+
+-- custom models can be applyed instead to grannys, just tell the meshname
+--gGrannyFilter[220]	=3D{meshname=3D"Lich.mesh"}
+
 gGrannyFilter[987]	=3D{grannyid=3D400}
 gGrannyFilter[1987]	=3D{grannyid=3D401}
 gGrannyFilter[778]	=3D{grannyid=3D16}
@@ -34,31 +47,78 @@
 =

 --[[
 -- wrong animations - but raw model is displayed correct, so no animation =
should be played
-gGrannyFilter[46]	=3D{animbroken}	--mf_dragon_rust
-gGrannyFilter[122]	=3D{animbroken}	--equines_unicorn
-gGrannyFilter[192]	=3D{animbroken}	--equines_unicorn_ethereal
-gGrannyFilter[791]	=3D{animbroken}	--giant_beetle
-gGrannyFilter[195]	=3D{animbroken}	--giant_beetle_ethereal
-gGrannyFilter[30]	=3D{animbroken}	--harpies_harpy
-gGrannyFilter[73]	=3D{animbroken}	--harpies_harpy_stone
-gGrannyFilter[797]	=3D{animbroken}	--red dragon
-gGrannyFilter[798]	=3D{animbroken}	--blue dragon
-gGrannyFilter[39]	=3D{animbroken}
-gGrannyFilter[194]	=3D{animbroken}	--rideable dragon
-gGrannyFilter[312]	=3D{animbroken}
-gGrannyFilter[313]	=3D{animbroken}
-gGrannyFilter[314]	=3D{animbroken}
-gGrannyFilter[315]	=3D{animbroken}
-gGrannyFilter[316]	=3D{animbroken}
-gGrannyFilter[789]	=3D{animbroken}
-gGrannyFilter[169]	=3D{animbroken}
+gGrannyFilter[46]	=3D{animbroken}	-- mf_dragon_rust ( Completely broken )
+gGrannyFilter[122]	=3D{animbroken}	-- equines_unicorn ( Completely broken )
+gGrannyFilter[192]	=3D{animbroken}	-- equines_unicorn_ethereal ( Completel=
y broken )
+gGrannyFilter[791]	=3D{animbroken}	-- giant_beetle ( Completely broken )
+gGrannyFilter[195]	=3D{animbroken}	-- giant_beetle_ethereal ( Completely b=
roken )
+gGrannyFilter[30]	=3D{animbroken}	-- harpies_harpy ( Completely broken )
+gGrannyFilter[73]	=3D{animbroken}	-- harpies_harpy_stone ( Completely brok=
en )
+gGrannyFilter[797]	=3D{animbroken}	-- red dragon ( Completely broken )
+gGrannyFilter[798]	=3D{animbroken}	-- blue dragon ( Completely broken )
+gGrannyFilter[39]	=3D{animbroken}	-- ?? ( Completely broken )
+gGrannyFilter[194]	=3D{animbroken}	-- rideable dragon
+gGrannyFilter[312]	=3D{animbroken}	-- Completely broken
+gGrannyFilter[313]	=3D{animbroken}	-- Completely broken/Offset
+gGrannyFilter[314]	=3D{animbroken}	-- Completely broken
+gGrannyFilter[315]	=3D{animbroken}	-- Completely broken
+gGrannyFilter[316]	=3D{animbroken}	-- Completely broken
+gGrannyFilter[789]	=3D{animbroken}	-- size/wrong z
+gGrannyFilter[169]	=3D{animbroken}	-- Completely broken
 =

 -- nogfx
-gGrannyFilter[786]	=3D{animbroken}	--chariot (no gfx)
-gGrannyFilter[58]	=3D{animbroken}	--etherals_wisp (no gfx)
-gGrannyFilter[164]	=3D{animbroken}	--etherals_energy_vortex (no gfx)
-gGrannyFilter[165]	=3D{animbroken}	--etherals_wisp (no gfx)
+gGrannyFilter[786]	=3D{animbroken}	-- chariot (no gfx)
+gGrannyFilter[58]	=3D{animbroken}	-- etherals_wisp (no gfx)
+gGrannyFilter[164]	=3D{animbroken}	-- etherals_energy_vortex (no gfx)
+gGrannyFilter[165]	=3D{animbroken}	-- etherals_wisp (no gfx)
 ]]--
 =

--- custom models can be applyed instead to grannys, just tell the meshname
---gGrannyFilter[220]	=3D{meshname=3D"Lich.mesh"}
+--[[
+ArtID:
+221				=

+212
+213
+167
+97
+98
+225
+99
+23
+25
+27
+100
+34
+37
+38 (invisible)
+84
+85
+2
+18
+765
+770
+767 (wrong z)
+769 (wrong z)
+772 (wrong z)
+773
+17
+41
+181
+182
+775
+840 (Invis/Missing)
+841 (Invis/Missing)
+842 (Invis/Missing)
+790 (Invis/Missing)
+152
+70
+71
+72
+319 =

+777
+785 (upside down)
+788 (size)
+247
+261 (Invis/Missing)
+273 (Invis/Missing)
+276
+]]--

Modified: trunk/lua/gui/gui.hotbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.hotbar.lua (original)
+++ trunk/lua/gui/gui.hotbar.lua Thu Feb 14 00:09:30 2008
@@ -9,14 +9,13 @@
 		=

 function ToggleHotbar ()
 	if (gHotbarDialog) then
-		-- store current positoin
+		-- store current position
 		gHotbarDialog_LastPositionX, gHotbarDialog_LastPositionY =3D gHotbarDial=
og.rootwidget.gfx:GetPos()
 		-- and close
 		gHotbarDialog:Close()
 	else
 		-- ..........do something before hotbar creation (get spells/items ?!)
-		print("create hotbar")
-		gHotbarDialog =3D guimaker.MyCreateDialog()
+		gHotbarDialog =3D guimaker.MakeSortedDialog()	--guimaker.MyCreateDialog()
 		gHotbarDialog.rootwidget =3D guimaker.MakePlane(gHotbarDialog,gNewGuiSty=
le.."/hotbar",0,0,515,65)
 =

 		-- restore last positoin if available
@@ -37,7 +36,6 @@
 		end
 =

 		dialog.onMouseDown =3D function (widget,mousebutton)
-			--if (mousebutton =3D=3D 2) then widget.dialog:Close() end
 			if (mousebutton =3D=3D 1) then widget.dialog:BringToFront() gui.StartMo=
veDialog(widget.dialog.rootwidget) end
 		end
 =


Modified: trunk/lua/lib.gfm.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gfm.lua (original)
+++ trunk/lua/lib.gfm.lua Thu Feb 14 00:09:30 2008
@@ -174,13 +174,15 @@
 	return widget
 end
 =

+-- Obsolete, only for testing
+--[[
 gGumpTestIndex =3D (hex2num("0xA28"))
 function GumpTestAdd (i) =

 	gGumpTestIndex =3D gGumpTestIndex + i
 	=

 	if (gGumpTestDlg.widget) then
 		gGumpTestDlg.widget:Destroy()
-		gGumpTestDlg.widget =3D false
+		gGumpTestDlg.widget =3D nil
 	end
 	=

 	local testmat =3D gGumpLoader:CreateMaterial(gGumpTestIndex)
@@ -194,6 +196,7 @@
 		widget.gfx:SetAlignment(kGfx2DAlign_Center,kGfx2DAlign_Center)
 	end
 end
+]]--
 =

 function CreateGumpDlgFromGfm (path) =

 	local dialog =3D guimaker.MakeSortedDialog()
@@ -267,6 +270,8 @@
 	end
 end
 =

+-- Obsolete, only for testing
+--[[
 function GfmDump (path)
 	print("GfmDump",path)
 	local formnode =3D xmlchild(LuaXML_ParseFile(path),"form")
@@ -304,4 +309,4 @@
 		end
 	end end
 end
-
+]]--

Modified: trunk/lua/lib.gumpparser.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gumpparser.lua (original)
+++ trunk/lua/lib.gumpparser.lua Thu Feb 14 00:09:30 2008
@@ -8,12 +8,11 @@
 Description:  Similar to xmfhtmlgumpcolor command, but the parameter order=
 is different and an additionally [argument]
 entry enclosed with @'s can be used. With this you can specify texts that =
will be added to the CliLoc entry.
 ]]--
-gXGumppos=3D0
-gYGumppos=3D0
 =

 gHorizontal_Textcorrection=3D5
 =

 gServerSideGump =3D {}
+gGumpPosition =3D {}
 =

 function ServerSideGump_GetParams (dialogId)
 	local params =3D {}
@@ -34,375 +33,382 @@
 =

 function CloseServerSideGump (playerId, dialogId, buttonId)
 	if (buttonId) then
-		print("CloseServerSideGump dialogId=3D"..dialogId.." buttonId=3D"..butto=
nId)
+		printdebug("gump","CloseServerSideGump dialogId=3D"..dialogId.." buttonI=
d=3D"..buttonId)
 	else
-		print("CloseServerSideGump dialogId=3D"..dialogId.." buttonId=3Dnil")
+		printdebug("gump","CloseServerSideGump dialogId=3D"..dialogId.." buttonI=
d=3Dnil")
 	end
 	=

 	local dialog =3D gServerSideGump[dialogId]
-	if (not dialog) then print("CloseServerSideGump : dialog not found=3D",di=
alogId) return end
+	if (not dialog) then printdebug("gump","CloseServerSideGump : dialog not =
found=3D",dialogId) return end
 	=

 	local params =3D ServerSideGump_GetParams(dialogId)
+	GumpReturnMsg(playerId, dialogId, buttonId, params)
+	=

+	--print("CloseServerSideGump:dialogID=3D"..dialogId)
 	dialog:Close()
-	GumpReturnMsg(playerId, dialogId, buttonId, params)
 end
 =

---gGumpPositions[serial] =3D { x=3Dwidget.gfx:GetDerivedLeft() , y=3Dwidge=
t.gfx:GetDerivedTop() }  z.b.
 function GumpParser(Gumpdata)
+	if (not gGumpLoader) then return end
+
+	-- close already existing dialog with the same id
+	if gServerSideGump[Gumpdata.dialogId] then
+		CloseServerSideGump(Gumpdata.playerid, Gumpdata.dialogId, 0)
+	end
+
+	-- create new Dialog
 	local dialog =3D guimaker.MakeSortedDialog()
+	--print("create gump")
+
+	-- set Dialog ID / Serial
+	dialog.dialogId =3D Gumpdata.dialogId
+	--print("dialogID=3D"..dialog.dialogId)
+
 	dialog.Close =3D function (dialog)
-        -- TODO : close this properly, destroy widgets etc... =

+	--print("Close:dialogID=3D"..dialog.dialogId)
+		gGumpPosition[dialog.dialogId] =3D { x=3Ddialog.rootwidget.gfx:GetDerive=
dLeft() , y=3Ddialog.rootwidget.gfx:GetDerivedTop() }
         dialog:SetVisible(false)
 		gServerSideGump[dialog.dialogId] =3D nil
+		dialog:Destroy()
 		dialog =3D nil
-	end
-	dialog.dialogId =3D Gumpdata.dialogId
-	=

-	-- close already existing dialog with the same id
-	if gServerSideGump[dialog.dialogId] then
-		CloseServerSideGump(Gumpdata.playerid, Gumpdata.dialogId, 0)
-	end
-	=

-	gServerSideGump[dialog.dialogId] =3D dialog
-	=

-	if (gGumpLoader) then
-		dialog.rootwidget.gfx:SetPos(gXGumppos or Gumpdata.x,gYGumppos or Gumpda=
ta.y)
-		dialog.controls =3D {} -- associative list of controlls, key=3Dname of c=
ontroll
-		dialog.childs =3D {} -- all controls, also those without name
-		dialog.uo_radio =3D {}
-		dialog.uo_check =3D {}
-		dialog.uo_text =3D {}
-
-		dialog.onMouseDown =3D function (widget,mousebutton)
-               					if (mousebutton =3D=3D 2) then
-									CloseServerSideGump(Gumpdata.playerid, Gumpdata.dialogId, 0)
-               					end
-               					if (mousebutton =3D=3D 1) then widget.dialog:BringToFr=
ont() gui.StartMoveDialog(widget.dialog.rootwidget) end
-               				end
-        dialog.onMouseUp =3D function (widget,mousebutton)
-									gXGumppos=3Dwidget.gfx:GetDerivedLeft()
-									gYGumppos=3Dwidget.gfx:GetDerivedTop()
-       						end
-		-- hide all except page 0 and pagenum
-		dialog.ShowPage =3D function (dialog,pagenum) =

-			local myc =3D 0
-			for k,widget in pairs(dialog.childs) do if (widget.pagenum =3D=3D pagen=
um) then myc =3D myc + 1 end end
-			print("dialog.ShowPage",pagenum,myc)
+		--print("close / destory gump")
+	end
+
+	dialog.controls =3D {} -- associative list of controlls, key=3Dname of co=
ntroll
+	dialog.childs =3D {} -- all controls, also those without name
+	dialog.uo_radio =3D {}
+	dialog.uo_check =3D {}
+	dialog.uo_text =3D {}
+
+	dialog.onMouseDown =3D function (widget,mousebutton)
+		if (mousebutton =3D=3D 2) then CloseServerSideGump(Gumpdata.playerid, Gu=
mpdata.dialogId, 0) end
+		if (mousebutton =3D=3D 1) then widget.dialog:BringToFront() gui.StartMov=
eDialog(widget.dialog.rootwidget) end
+	end
+
+	-- hide all except page 0 and pagenum
+	dialog.ShowPage =3D function (dialog,pagenum) =

+		local myc =3D 0
+		for k,widget in pairs(dialog.childs) do if (widget.pagenum =3D=3D pagenu=
m) then myc =3D myc + 1 end end
+		printdebug("gump","dialog.ShowPage",pagenum,myc)
 			=

-			for k,widget in pairs(dialog.childs) do =

-				widget.gfx:SetVisible((widget.pagenum =3D=3D 0) or (widget.pagenum =3D=
=3D pagenum))
-			end
-		end
-		local curparent =3D dialog.rootwidget
-
+		for k,widget in pairs(dialog.childs) do =

+			widget.gfx:SetVisible((widget.pagenum =3D=3D 0) or (widget.pagenum =3D=
=3D pagenum))
+		end
+	end
 		=

-		local pages =3D {}
-		dialog.pages =3D pages
+	local pages =3D {}
+	dialog.pages =3D pages
 		=

-		-- Make a Standard Page 0 (like OSI does this)
-		local curpage =3D guimaker.MakePage(0)
-		pages[0] =3D curpage
-
-		-- read out and group all data by page first, as it can be in random ord=
er
-		local aToken=3Dstrsplit("{",Gumpdata.Data)
-		for k,v in pairs(aToken) do
-			local bToken =3D {}
-			for token in string.gfind(v, "%w+") do table.insert(bToken,token) end
-			if (bToken[1]) then
-				local command =3D string.lower(bToken[1])
-				--Description:  Specifies which page to define. Page 0 is already pres=
ent and visible with all other Pages (1,2,3,etc) =

-				if ((command =3D=3D "page") and (table.getn(bToken)>=3D 2)) then
-					local pagenum=3Dtonumber(bToken[2])
-					curpage =3D pages[pagenum]
-					if (not curpage) then
-						curpage =3D guimaker.MakePage(pagenum)
-						pages[pagenum] =3D curpage
-					end
-				else
-					table.insert(curpage.tokenlists,bToken)
-				end
-			end
-		end
+	-- Make a Standard Page 0 (like OSI does this)
+	local curpage =3D guimaker.MakePage(0)
+	pages[0] =3D curpage
+
+	-- read out and group all data by page first, as it can be in random order
+	local aToken=3Dstrsplit("{",Gumpdata.Data)
+	for k,v in pairs(aToken) do
+		local bToken =3D {}
+		for token in string.gfind(v, "%w+") do table.insert(bToken,token) end
+		if (bToken[1]) then
+			local command =3D string.lower(bToken[1])
+			--Description:  Specifies which page to define. Page 0 is already prese=
nt and visible with all other Pages (1,2,3,etc) =

+			if ((command =3D=3D "page") and (table.getn(bToken)>=3D 2)) then
+				local pagenum=3Dtonumber(bToken[2])
+				curpage =3D pages[pagenum]
+				if (not curpage) then
+					curpage =3D guimaker.MakePage(pagenum)
+					pages[pagenum] =3D curpage
+				end
+			else
+				table.insert(curpage.tokenlists,bToken)
+			end
+		end
+	end
+
+	-- set gumpposition
+	local gumpposition =3D gGumpPosition[Gumpdata.dialogId]
+	if (gumpposition) then
+		dialog.rootwidget.gfx:SetPos(gumpposition.x or 0, gumpposition.y or 0)
+	else
+		dialog.rootwidget.gfx:SetPos(Gumpdata.x or 0, Gumpdata.y or 0)
+	end
+
+	-- init pagenum of basic widgets =

+	for k,widget in pairs(dialog.childs) do widget.pagenum =3D 0 end
 		=

-		-- init pagenum of basic widgets =

-		for k,widget in pairs(dialog.childs) do widget.pagenum =3D 0 end
+	-- now construct widgets in an orderly per page fashion
+	local curparent =3D dialog.rootwidget
+	local pageorder =3D {}
+	for iCurPageNum,page in pairs(pages) do table.insert(pageorder,page.pagen=
um) end
+	table.sort(pageorder)
 		=

-		-- now construct widgets in an orderly per page fashion
-		local pageorder =3D {}
-		for iCurPageNum,page in pairs(pages) do table.insert(pageorder,page.page=
num) end
-		table.sort(pageorder)
-		=

-		for k,pagenum in pairs(pageorder) do
-			local page =3D pages[pagenum]
-			for k,bToken in pairs(page.tokenlists) do
-				local command =3D string.lower(bToken[1])
-
-				----------------------------------------------------------------------=
----------------------
-
-				if (command =3D=3D "noclose") then
-					print("todo - Generic Gump Command: noclose")
-				elseif (command =3D=3D "nomove") then
-					print("todo - Generic Gump Command: noclose")
-				elseif (command =3D=3D "nodispose") then
-					print("todo - Generic Gump Command: nodispose")
-				elseif (command =3D=3D "noresize") then
-					print("todo - Generic Gump Command: noresize")
-				--Group <groupnumber>
-				--Description:  Links radio buttons to a group. Group is send before r=
adiobuttons. Seems only to work on page 0 and 1.  =

-				elseif (command =3D=3D "group") then
-					print("todo - Generic Gump Command: group")
-
-				----------------------------------------------------------------------=
----------------------
-
-				--resizepic <x> <y> <gumpid> <width> <height>
-				elseif ((command =3D=3D "resizepic") and (table.getn(bToken)>=3D 6)) t=
hen
---					print("x=3D"..bToken[2].." y=3D"..bToken[3].." gumpid=3D"..bToken[4=
].." width=3D"..bToken[5].." height=3D"..bToken[6])
-					if (tonumber(bToken[4])~=3D0) then
-						local widgetarr =3D MakeBorderGump(curparent,bToken[4],bToken[2],bTo=
ken[3],bToken[5],bToken[6])
-						if (widgetarr) then
-							for k,widget in pairs(widgetarr) do
-								widget.mbIgnoreMouseOver =3D false
-							end
+	for k,pagenum in pairs(pageorder) do
+		local page =3D pages[pagenum]
+		for k,bToken in pairs(page.tokenlists) do
+			local command =3D string.lower(bToken[1])
+
+			-----------------------------------------------------------------------=
---------------------
+			if (command =3D=3D "noclose") then
+				printdebug("gump","todo - Generic Gump Command: noclose")
+			elseif (command =3D=3D "nomove") then
+				printdebug("gump","todo - Generic Gump Command: noclose")
+			elseif (command =3D=3D "nodispose") then
+				printdebug("gump","todo - Generic Gump Command: nodispose")
+			elseif (command =3D=3D "noresize") then
+				printdebug("gump","todo - Generic Gump Command: noresize")
+			--Group <groupnumber>
+			--Description:  Links radio buttons to a group. Group is send before ra=
diobuttons. Seems only to work on page 0 and 1.  =

+			elseif (command =3D=3D "group") then
+				printdebug("gump","todo - Generic Gump Command: group")
+			-----------------------------------------------------------------------=
---------------------
+			--resizepic <x> <y> <gumpid> <width> <height>
+			elseif ((command =3D=3D "resizepic") and (table.getn(bToken)>=3D 6)) th=
en
+				printdebug("gump","x=3D"..bToken[2].." y=3D"..bToken[3].." gumpid=3D".=
.bToken[4].." width=3D"..bToken[5].." height=3D"..bToken[6])
+				if (tonumber(bToken[4])~=3D0) then
+					local widgetarr =3D MakeBorderGump(curparent,bToken[4],bToken[2],bTok=
en[3],bToken[5],bToken[6])
+					if (widgetarr) then
+						for k,widget in pairs(widgetarr) do
+							widget.mbIgnoreMouseOver =3D false
 						end
 					end
-				--xmfhtmlgump <x> <y> <width> <height> <Cliloc Message ID> <background=
> <scrollbar>
-				--Description:	<background> and <scrollbar> can be 0 or 1 and define w=
hether the background is transparent and
-				--				a scrollbar s displayed.
-				-- TODO : width, height, background, scrollbar
-				elseif ((command =3D=3D "xmfhtmlgump") and (table.getn(bToken)>=3D 8))=
 then
-					local msg =3D HtmlParser( gClilocLoader and gClilocLoader:Get(bToken[=
6]) or "no_cliloc" )
---					print("Cliloc Msg ("..bToken[6].."): "..msg.text)
-					local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2=
], bToken[3]+gHorizontal_Textcorrection,
-																	bToken[4], bToken[5], UnicodeFix(msg.text), msg.charh, {1=
.0,1.0,1.0,1.0},
-																	msg.center, msg.div, gFontNameDefault)
-				--xmfhtmlgumpcolor <x> <y> <width> <height> <cliloc-nr> <background> <=
scrollbar> <color>
-				--Description:	<background> and <scrollbar> can be 0 or 1 and define w=
hether the background is transparent and
-				--				a scrollbar s displayed.
-				-- TODO : background, scrollbar, HUE-color
-				elseif ((command =3D=3D "xmfhtmlgumpcolor") and (table.getn(bToken)>=
=3D 9)) then
-					local msg =3D HtmlParser(  gClilocLoader and gClilocLoader:Get(bToken=
[6]) or "no_cliloc" )
---					print("Cliloc Msg ("..bToken[6].."): "..msg.text)
-					local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2=
], bToken[3]+gHorizontal_Textcorrection,
-																	bToken[4], bToken[5], UnicodeFix(msg.text), msg.charh, {1=
.0,1.0,1.0,1.0},
-																	msg.center, msg.div, gFontNameDefault)
-				--gumppic <x> <y> <gumpid> [hue=3D353]
-				--Description:  Adds a graphic to the gump, where <id> ist the graphic=
 id of an item.
-				--				Optionaly there is a color parameter. =

-				-- TODO : HUE
-				elseif ((command =3D=3D "gumppic") and (table.getn(bToken)>=3D 4)) then
-					local huenumber=3DbToken[6] or 0
-					local widget =3D MakeBorderGumpPart( curparent, bToken[4], bToken[2],=
 bToken[3], 0, 0, 0, tonumber(huenumber) )
-					widget.mbIgnoreMouseOver =3D false
-					if (bToken[8]) then print("gumppic class=3D"..bToken[8]) end
-				--gumppictiled <x> <y> <width> <height> <gumpid>
-				--Description:  Similar to GumpPic, but the gumppic is tiled to the gi=
ven <height> and <width>.
-				elseif ((command =3D=3D "gumppictiled") and (table.getn(bToken)>=3D 6)=
) then
-					local widget =3D MakeBorderGumpPart(curparent, bToken[6], bToken[2], =
bToken[3], bToken[4], bToken[5])
-					widget.mbIgnoreMouseOver =3D false
-				--checkertrans <x> <y> <width> <height>
-				--Description:  Creates a transparent rectangle on position <x,y> usin=
g <width> and <height>.
-				elseif ((command =3D=3D "checkertrans") and (table.getn(bToken)>=3D 5)=
) then
-					--print("todo - checkertrans")
-				--text <x> <y> <hue> <textline-id>
-				--Description:  Defines the position and color of a text (data) entry.
-				-- TODO : HUE-color
-				elseif ((command =3D=3D "text") and (table.getn(bToken)>=3D 5)) then
-					local text =3D Gumpdata.textline[tonumber(bToken[5])] or "No text"
-					local widget =3D guimaker.MakeText (curparent, bToken[2], bToken[3]+g=
Horizontal_Textcorrection, UnicodeFix(text),
-														gFontGumpSize, {190/255,237/255,231/255,1.0}, gFontNameDefau=
lt)
-				--Button <x> <y> <released-id> <pressed-id> <quit> <page-id> <return-v=
alue>
-				--Description:  Adds a button to the gump with the specified coordinat=
es and button graphics.
-				--				<released-id> and <pressed-id> specify the buttongraphic. If pre=
ssed check for <return-value>.
-				--				Use <page-id> to switch between pages and <quit>=3D1/0 to close =
the gump.
-				elseif ((command =3D=3D "button") and (table.getn(bToken)>=3D 7)) then=
	-- >=3D7 because pol buttons returns 7 or 8 arguments
-					local widget =3D MakeGumpButton (curparent,bToken[4],bToken[4],bToken=
[5],bToken[2],bToken[3],nil,nil,false)
-					if (bToken[8]) then widget.returnmsg =3D tonumber(bToken[8]) end
-					widget.page			=3D tonumber(bToken[7])
-					widget.onLeftClick =3D function (widget)
-											if (widget.returnmsg) then
-												print("Button pressed -> Send button return_message: "..widget=
.returnmsg)
-												GumpReturnMsg(Gumpdata.playerid, Gumpdata.dialogId, widget.ret=
urnmsg, ServerSideGump_GetParams(Gumpdata.dialogId))
+				end
+			--xmfhtmlgump <x> <y> <width> <height> <Cliloc Message ID> <background>=
 <scrollbar>
+			--Description:	<background> and <scrollbar> can be 0 or 1 and define wh=
ether the background is transparent and
+			--				a scrollbar s displayed.
+			-- TODO : width, height, background, scrollbar
+			elseif ((command =3D=3D "xmfhtmlgump") and (table.getn(bToken)>=3D 8)) =
then
+				local msg =3D HtmlParser( gClilocLoader and gClilocLoader:Get(bToken[6=
]) or "no_cliloc" )
+				printdebug("gump","Cliloc Msg ("..bToken[6].."): "..msg.text)
+				local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2]=
, bToken[3]+gHorizontal_Textcorrection,
+																bToken[4], bToken[5], UnicodeFix(msg.text), msg.charh, {1.=
0,1.0,1.0,1.0},
+																msg.center, msg.div, gFontNameDefault)
+			--xmfhtmlgumpcolor <x> <y> <width> <height> <cliloc-nr> <background> <s=
crollbar> <color>
+			--Description:	<background> and <scrollbar> can be 0 or 1 and define wh=
ether the background is transparent and
+			--				a scrollbar s displayed.
+			-- TODO : background, scrollbar, HUE-color
+			elseif ((command =3D=3D "xmfhtmlgumpcolor") and (table.getn(bToken)>=3D=
 9)) then
+				local msg =3D HtmlParser(  gClilocLoader and gClilocLoader:Get(bToken[=
6]) or "no_cliloc" )
+				printdebug("gump","Cliloc Msg ("..bToken[6].."): "..msg.text)
+				local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2]=
, bToken[3]+gHorizontal_Textcorrection,
+																bToken[4], bToken[5], UnicodeFix(msg.text), msg.charh, {1.=
0,1.0,1.0,1.0},
+																msg.center, msg.div, gFontNameDefault)
+			--gumppic <x> <y> <gumpid> [hue=3D353]
+			--Description:  Adds a graphic to the gump, where <id> ist the graphic =
id of an item.
+			--				Optionaly there is a color parameter. =

+			-- TODO : HUE
+			elseif ((command =3D=3D "gumppic") and (table.getn(bToken)>=3D 4)) then
+				local huenumber=3DbToken[6] or 0
+				local widget =3D MakeBorderGumpPart( curparent, bToken[4], bToken[2], =
bToken[3], 0, 0, 0, tonumber(huenumber) )
+				widget.mbIgnoreMouseOver =3D false
+				if (bToken[8]) then
+					printdebug("gump","gumppic class=3D"..bToken[8])
+				end
+			--gumppictiled <x> <y> <width> <height> <gumpid>
+			--Description:  Similar to GumpPic, but the gumppic is tiled to the giv=
en <height> and <width>.
+			elseif ((command =3D=3D "gumppictiled") and (table.getn(bToken)>=3D 6))=
 then
+				local widget =3D MakeBorderGumpPart(curparent, bToken[6], bToken[2], b=
Token[3], bToken[4], bToken[5])
+				widget.mbIgnoreMouseOver =3D false
+			--checkertrans <x> <y> <width> <height>
+			--Description:  Creates a transparent rectangle on position <x,y> using=
 <width> and <height>.
+			elseif ((command =3D=3D "checkertrans") and (table.getn(bToken)>=3D 5))=
 then
+				printdebug("gump","todo - checkertrans")
+			--text <x> <y> <hue> <textline-id>
+			--Description:  Defines the position and color of a text (data) entry.
+			-- TODO : HUE-color
+			elseif ((command =3D=3D "text") and (table.getn(bToken)>=3D 5)) then
+				local text =3D Gumpdata.textline[tonumber(bToken[5])] or "No text"
+				local widget =3D guimaker.MakeText (curparent, bToken[2], bToken[3]+gH=
orizontal_Textcorrection, UnicodeFix(text),
+													gFontGumpSize, {190/255,237/255,231/255,1.0}, gFontNameDefaul=
t)
+			--Button <x> <y> <released-id> <pressed-id> <quit> <page-id> <return-va=
lue>
+			--Description:  Adds a button to the gump with the specified coordinate=
s and button graphics.
+			--				<released-id> and <pressed-id> specify the buttongraphic. If pres=
sed check for <return-value>.
+			--				Use <page-id> to switch between pages and <quit>=3D1/0 to close t=
he gump.
+			elseif ((command =3D=3D "button") and (table.getn(bToken)>=3D 7)) then	=
-- >=3D7 because pol buttons returns 7 or 8 arguments
+				local widget =3D MakeGumpButton (curparent,bToken[4],bToken[4],bToken[=
5],bToken[2],bToken[3],nil,nil,false)
+				if (bToken[8]) then widget.returnmsg =3D tonumber(bToken[8]) end
+				widget.page			=3D tonumber(bToken[7])
+				widget.onLeftClick =3D function (widget)
+										if (widget.returnmsg) then
+											printdebug("gump","Button pressed -> Send button return_message=
: "..widget.returnmsg)
+											GumpReturnMsg(Gumpdata.playerid, Gumpdata.dialogId, widget.retu=
rnmsg, ServerSideGump_GetParams(Gumpdata.dialogId))
+										end
+										if (widget.page > 0 and not(widget.page > table.getn(pages)) ) t=
hen
+											printdebug("gump","Parsegump Button: Switch to Page "..widget.p=
age.."/"..table.getn(pages))
+											widget.dialog:ShowPage(widget.page)
+										else
+											widget.dialog:Close()
+										end
+									end
+			--buttontileart <x> <y> <released-id> <pressed-id> <quit> <page-id> <re=
turn-value> <tilepic-id> <hue> <tile-x> <tile-y>
+			--Client introduced: between 4.0.4d and 5.0.2b
+			--Description:  Adds a button to the gump with the specified coordinate=
s and tilepic as graphic.
+			--				<tile-x> and <tile-y> define the coordinates of the tile graphic =
and are relative to <x> and <y>.
+			--{ buttontileart 432 248 9010 9010 1 0 33 1352 0 100 20 }
+			elseif ((command =3D=3D "buttontileart") and (table.getn(bToken)>=3D 12=
)) then
+				local widget =3D MakeGumpButton (curparent,bToken[4],bToken[4],bToken[=
5],bToken[2],bToken[3])
+				local widgetart =3D MakeArtGumpPart (curparent,bToken[9],bToken[2]+bTo=
ken[11],bToken[3]+bToken[12],0,0,0,bToken[10])
+				if (bToken[8]) then widget.returnmsg =3D tonumber(bToken[8]) end
+				widget.page			=3D tonumber(bToken[7])
+				widget.onLeftClick =3D function (widget)
+										if (widget.returnmsg) then
+											printdebug("gump","Button pressed -> Send buttontileart return_=
message: "..widget.returnmsg)
+											GumpReturnMsg(Gumpdata.playerid, Gumpdata.dialogId, widget.retu=
rnmsg, ServerSideGump_GetParams(Gumpdata.dialogId))
+										end
+										if (widget.page > 0 and not(widget.page > table.getn(pages)) ) t=
hen
+											printdebug("gump","Parsegump Button: Switch to Page "..widget.p=
age.."/"..table.getn(pages))
+											widget.dialog:ShowPage(widget.page)
+										else
+											widget.dialog:Close()
+										end
+									end
+			--textentry <x> <y> <width> <height> <hue> <return-value> <default-text=
-id>
+			--Description:  Defines an area where the <default-text-id> is displaye=
d.
+			--				The player can modify this data. To get this data check the <retu=
rn-value>.
+			--TODO: HUE
+			elseif ((command =3D=3D "textentry") and (table.getn(bToken)>=3D 8)) th=
en
+				local widget =3D CreatePlainEditText (curparent, bToken[2], bToken[3],=
 bToken[4], bToken[5], {1.0,1.0,1.0,1.0})
+				local text =3D Gumpdata.textline[tonumber(bToken[8])] or "No textentry"
+				widget:SetText(UnicodeFix(text))
+
+				widget.mbIgnoreMouseOver =3D false
+				widget.returnmsg =3D tonumber(bToken[7])
+				widget.returndefid =3D tonumber(bToken[8])
+				widget.onMouseDown =3D function (widget,mousebutton)
+											if (mousebutton =3D=3D 1) then
+												widget:Activate()
 											end
-											if (widget.page > 0 and not(widget.page > table.getn(pages)) ) =
then
-												print("Parsegump Button: Switch to Page "..widget.page.."/"..t=
able.getn(pages))
-												widget.dialog:ShowPage(widget.page)
+									   end
+				widget.onMouseLeave =3D function (widget)
+											widget:Deactivate()
+										end
+				table.insert(dialog.uo_text,widget)
+					=

+			--tilepic <x> <y> <id>
+			--Description:  Adds a Tilepicture to the gump. <id> defines the tile g=
raphic-id.
+			elseif ((command =3D=3D "tilepic") and (table.getn(bToken)>=3D4)) then
+				local widget =3D MakeArtGumpPart (curparent, bToken[4], bToken[2], bTo=
ken[3])
+			--TilePicHue <x> <y> <id> <hue>
+			--Description:  Similar to the tilepic command, but with an additional =
hue parameter.
+			-- TODO : HUE
+			elseif ((command =3D=3D "tilepichue") and (table.getn(bToken)>=3D5)) th=
en
+				local widget =3D MakeArtGumpPart (curparent, bToken[4], bToken[2], bTo=
ken[3], 0, 0, 0, bToken[5])
+			--croppedtext <x> <y> <width> <height> <color> <text-id>
+			--Description:  Adds a text field to the gump. This is similar to the t=
ext command,
+			--but the text is cropped to the defined area.
+			-- TODO : HUE
+			elseif ((command =3D=3D "croppedtext") and (table.getn(bToken)>=3D 7)) =
then
+				local msg =3D HtmlParser( Gumpdata.textline[tonumber(bToken[7])] )
+				local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2]=
, bToken[3]+gHorizontal_Textcorrection,
+																bToken[4], bToken[5], UnicodeFix(msg.text), msg.charh, {92=
/255,92/255,178/255,1.0},
+																msg.center, msg.div, gFontNameDefault)
+			--radio <x> <y> <released gumpid> <pressed gumpid> <status> <return-val=
ue>
+			--Description:  Same as Checkbox, but only one Radiobutton can be press=
ed at the same time, except they are per linked via the 'Group' command.
+			-- TODO : make radio buttons work
+			elseif ((command =3D=3D "radio") and (table.getn(bToken)>=3D 7)) then
+				local radio_x =3D bToken[2]
+				local radio_y =3D bToken[3]
+				local radio_norm =3D bToken[4]
+				local radio_down =3D bToken[5]
+				local radio_state =3D tonumber(bToken[6])
+				local radio_rtn =3D tonumber(bToken[7])
+				local widget
+				if (radio_state=3D=3D0) then
+					widget =3D MakeBorderGumpPart(curparent, radio_norm, radio_x, radio_y)
+				else
+					widget =3D MakeBorderGumpPart(curparent, radio_down, radio_x, radio_y)
+				end
+				widget.state=3Dradio_state
+				widget.returnmsg=3Dradio_rtn
+				widget.mbIgnoreMouseOver =3D false
+				widget.mat_normal 	=3D GetGumpMat(radio_norm)
+				widget.mat_pressed 	=3D GetGumpMat(radio_down)
+
+				table.insert(dialog.uo_radio,widget)
+				widget.onMouseDown	=3D function (widget,mousebutton)
+										if (mousebutton =3D=3D 1) then
+											if (widget.state=3D=3D0) then
+												widget.gfx:SetMaterial(widget.mat_pressed)
+												widget.state=3D1
 											else
-												widget.dialog:Close()
+												widget.gfx:SetMaterial(widget.mat_normal)
+												widget.state=3D0
 											end
-										end
-				--buttontileart <x> <y> <released-id> <pressed-id> <quit> <page-id> <r=
eturn-value> <tilepic-id> <hue> <tile-x> <tile-y>
-				--Client introduced: between 4.0.4d and 5.0.2b
-				--Description:  Adds a button to the gump with the specified coordinat=
es and tilepic as graphic.
-				--				<tile-x> and <tile-y> define the coordinates of the tile graphic=
 and are relative to <x> and <y>.
-				--{ buttontileart 432 248 9010 9010 1 0 33 1352 0 100 20 }
-				elseif ((command =3D=3D "buttontileart") and (table.getn(bToken)>=3D 1=
2)) then
-					local widget =3D MakeGumpButton (curparent,bToken[4],bToken[4],bToken=
[5],bToken[2],bToken[3])
-					local widgetart =3D MakeArtGumpPart (curparent,bToken[9],bToken[2]+bT=
oken[11],bToken[3]+bToken[12],0,0,0,bToken[10])
-					if (bToken[8]) then widget.returnmsg =3D tonumber(bToken[8]) end
-					widget.page			=3D tonumber(bToken[7])
-					widget.onLeftClick =3D function (widget)
-											if (widget.returnmsg) then
-												print("Button pressed -> Send buttontileart return_message: ".=
.widget.returnmsg)
-												GumpReturnMsg(Gumpdata.playerid, Gumpdata.dialogId, widget.ret=
urnmsg, ServerSideGump_GetParams(Gumpdata.dialogId))
+											printdebug("gump","RadioButton changed : id=3D"..widget.returnm=
sg.." state=3D"..widget.state)
+										end
+									  end
+			--checkbox <x> <y> <released-id> <pressed-id> <status> <return-value>
+			--Description:  Adds a CheckBox to the gump. Multiple CheckBoxes can be=
 pressed at the same time.
+			--				Check the <return-value> if you want to know which CheckBoxes wer=
e selected.
+			elseif (command =3D=3D "checkbox" and (table.getn(bToken)>=3D 7)) then
+				local check_x =3D bToken[2]
+				local check_y =3D bToken[3]
+				local check_norm =3D bToken[4]
+				local check_down =3D bToken[5]
+				local check_state =3D tonumber(bToken[6])
+				local check_rtn =3D tonumber(bToken[7])
+				local widget
+				if (check_state=3D=3D0) then
+					widget =3D MakeBorderGumpPart(curparent, check_norm, check_x, check_y)
+				else
+					widget =3D MakeBorderGumpPart(curparent, check_down, check_x, check_y)
+				end
+				widget.state=3Dcheck_state
+				widget.returnmsg=3Dcheck_rtn
+				widget.mbIgnoreMouseOver =3D false
+				widget.mat_normal 	=3D GetGumpMat(check_norm)
+				widget.mat_pressed 	=3D GetGumpMat(check_down)
+				table.insert(dialog.uo_check,widget)
+
+				widget.onMouseDown	=3D function (widget,mousebutton)
+										if (mousebutton =3D=3D 1) then
+											if (widget.state=3D=3D0) then
+												widget.gfx:SetMaterial(widget.mat_pressed)
+												widget.state=3D1
+											else
+												widget.gfx:SetMaterial(widget.mat_normal)
+												widget.state=3D0
 											end
-											if (widget.page > 0 and not(widget.page > table.getn(pages)) ) =
then
-												print("Parsegump Button: Switch to Page "..widget.page.."/"..t=
able.getn(pages))
-												widget.dialog:ShowPage(widget.page)
-											else
-												widget.dialog:Close()
-											end
-										end
-				--textentry <x> <y> <width> <height> <hue> <return-value> <default-tex=
t-id>
-				--Description:  Defines an area where the <default-text-id> is display=
ed.
-				--				The player can modify this data. To get this data check the <ret=
urn-value>.
-				--TODO: HUE
-				elseif ((command =3D=3D "textentry") and (table.getn(bToken)>=3D 8)) t=
hen
-					local widget =3D CreatePlainEditText (curparent, bToken[2], bToken[3]=
, bToken[4], bToken[5], {1.0,1.0,1.0,1.0})
-					local text =3D Gumpdata.textline[tonumber(bToken[8])] or "No textentr=
y"
-					widget:SetText(UnicodeFix(text))
-
-					widget.mbIgnoreMouseOver =3D false
-					widget.returnmsg =3D tonumber(bToken[7])
-					widget.returndefid =3D tonumber(bToken[8])
-					widget.onMouseDown =3D function (widget,mousebutton)
-												if (mousebutton =3D=3D 1) then
-													widget:Activate()
-												end
-										   end
-					widget.onMouseLeave =3D function (widget)
-												widget:Deactivate()
-											end
-					table.insert(dialog.uo_text,widget)
-					=

-				--tilepic <x> <y> <id>
-				--Description:  Adds a Tilepicture to the gump. <id> defines the tile =
graphic-id.
-				elseif ((command =3D=3D "tilepic") and (table.getn(bToken)>=3D4)) then
-					local widget =3D MakeArtGumpPart (curparent, bToken[4], bToken[2], bT=
oken[3])
-				--TilePicHue <x> <y> <id> <hue>
-				--Description:  Similar to the tilepic command, but with an additional=
 hue parameter.
-				-- TODO : HUE
-				elseif ((command =3D=3D "tilepichue") and (table.getn(bToken)>=3D5)) t=
hen
-					local widget =3D MakeArtGumpPart (curparent, bToken[4], bToken[2], bT=
oken[3], 0, 0, 0, bToken[5])
-				--croppedtext <x> <y> <width> <height> <color> <text-id>
-				--Description:  Adds a text field to the gump. This is similar to the =
text command,
-				--but the text is cropped to the defined area.
-				-- TODO : HUE
-				elseif ((command =3D=3D "croppedtext") and (table.getn(bToken)>=3D 7))=
 then
-					local msg =3D HtmlParser( Gumpdata.textline[tonumber(bToken[7])] )
-					local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2=
], bToken[3]+gHorizontal_Textcorrection,
-																	bToken[4], bToken[5], UnicodeFix(msg.text), msg.charh, {9=
2/255,92/255,178/255,1.0},
-																	msg.center, msg.div, gFontNameDefault)
-				--radio <x> <y> <released gumpid> <pressed gumpid> <status> <return-va=
lue>
-				--Description:  Same as Checkbox, but only one Radiobutton can be pres=
sed at the same time, except they are per linked via the 'Group' command.
-				-- TODO : make radio buttons work
-				elseif ((command =3D=3D "radio") and (table.getn(bToken)>=3D 7)) then
-					local radio_x =3D bToken[2]
-					local radio_y =3D bToken[3]
-					local radio_norm =3D bToken[4]
-					local radio_down =3D bToken[5]
-					local radio_state =3D tonumber(bToken[6])
-					local radio_rtn =3D tonumber(bToken[7])
-					local widget
-					if (radio_state=3D=3D0) then
-						widget =3D MakeBorderGumpPart(curparent, radio_norm, radio_x, radio_=
y)
-					else
-						widget =3D MakeBorderGumpPart(curparent, radio_down, radio_x, radio_=
y)
-					end
-					widget.state=3Dradio_state
-					widget.returnmsg=3Dradio_rtn
-					widget.mbIgnoreMouseOver =3D false
-					widget.mat_normal 	=3D GetGumpMat(radio_norm)
-					widget.mat_pressed 	=3D GetGumpMat(radio_down)
-
-					table.insert(dialog.uo_radio,widget)
-					widget.onMouseDown	=3D function (widget,mousebutton)
-											if (mousebutton =3D=3D 1) then
-												if (widget.state=3D=3D0) then
-													widget.gfx:SetMaterial(widget.mat_pressed)
-													widget.state=3D1
-												else
-													widget.gfx:SetMaterial(widget.mat_normal)
-													widget.state=3D0
-												end
-												print("RadioButton changed : id=3D"..widget.returnmsg.." state=
=3D"..widget.state)
-											end
-										  end
-				--checkbox <x> <y> <released-id> <pressed-id> <status> <return-value>
-				--Description:  Adds a CheckBox to the gump. Multiple CheckBoxes can b=
e pressed at the same time.
-				--				Check the <return-value> if you want to know which CheckBoxes we=
re selected.
-				elseif (command =3D=3D "checkbox" and (table.getn(bToken)>=3D 7)) then
-					local check_x =3D bToken[2]
-					local check_y =3D bToken[3]
-					local check_norm =3D bToken[4]
-					local check_down =3D bToken[5]
-					local check_state =3D tonumber(bToken[6])
-					local check_rtn =3D tonumber(bToken[7])
-					local widget
-					if (check_state=3D=3D0) then
-						widget =3D MakeBorderGumpPart(curparent, check_norm, check_x, check_=
y)
-					else
-						widget =3D MakeBorderGumpPart(curparent, check_down, check_x, check_=
y)
-					end
-					widget.state=3Dcheck_state
-					widget.returnmsg=3Dcheck_rtn
-					widget.mbIgnoreMouseOver =3D false
-					widget.mat_normal 	=3D GetGumpMat(check_norm)
-					widget.mat_pressed 	=3D GetGumpMat(check_down)
-					table.insert(dialog.uo_check,widget)
-
-					widget.onMouseDown	=3D function (widget,mousebutton)
-											if (mousebutton =3D=3D 1) then
-												if (widget.state=3D=3D0) then
-													widget.gfx:SetMaterial(widget.mat_pressed)
-													widget.state=3D1
-												else
-													widget.gfx:SetMaterial(widget.mat_normal)
-													widget.state=3D0
-												end
-												print("Checkbox changed : id=3D"..widget.returnmsg.." state=3D=
"..widget.state)
-											end
-										  end
-				--HtmlGump <x> <y> <width> <height> <text-id> <background> <scrollbar>
-				--Description:  Defines a text-area where Html-commands are allowed.
-				--				<background> and <scrollbar> can be 0 or 1 and define whether th=
e background is transparent and a scrollbar is displayed.
-				--{ htmlgump 10 8 100 20 0 0 0 }
-				elseif ((command =3D=3D "htmlgump") and (table.getn(bToken)>=3D 8)) th=
en
-					local msg =3D HtmlParser( Gumpdata.textline[tonumber(bToken[6])] )
-					local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2=
], bToken[3]+gHorizontal_Textcorrection,
-																	bToken[4], bToken[5], msg.text, msg.charh, {1.0,1.0,1.0,1=
.0},
-																	msg.center, msg.div, gFontNameDefault)
-				--tooltip <cliloc-nr>
-				--Description:  Adds to the previous layoutarray entry a Tooltip with =
the in [cliloc-nr] defined Cliloc entry.
-				-- TODO : display tooltip
-				elseif ((command =3D=3D "tooltip") and (table.getn(bToken)>=3D 2)) then
-					local msg =3D HtmlParser( gClilocLoader and gClilocLoader:Get(bToken[=
2]) or "no_cliloc" )
-					AddFadeLines("HtmlGumpparser - tooltip (TODO):"..msg.text)
-				else
-					print("UNKNOWN Generic Gump Command: "..command)
-				end
-
-			end
+											printdebug("gump","Checkbox changed : id=3D"..widget.returnmsg.=
." state=3D"..widget.state)
+										end
+									  end
+			--HtmlGump <x> <y> <width> <height> <text-id> <background> <scrollbar>
+			--Description:  Defines a text-area where Html-commands are allowed.
+			--				<background> and <scrollbar> can be 0 or 1 and define whether the=
 background is transparent and a scrollbar is displayed.
+			--{ htmlgump 10 8 100 20 0 0 0 }
+			elseif ((command =3D=3D "htmlgump") and (table.getn(bToken)>=3D 8)) then
+				local msg =3D HtmlParser( Gumpdata.textline[tonumber(bToken[6])] )
+				local widget =3D guimaker.MakeWrappedClippedText (curparent, bToken[2]=
, bToken[3]+gHorizontal_Textcorrection,
+																bToken[4], bToken[5], msg.text, msg.charh, {1.0,1.0,1.0,1.=
0},
+																msg.center, msg.div, gFontNameDefault)
+			--tooltip <cliloc-nr>
+			--Description:  Adds to the previous layoutarray entry a Tooltip with t=
he in [cliloc-nr] defined Cliloc entry.
+			-- TODO : display tooltip
+			elseif ((command =3D=3D "tooltip") and (table.getn(bToken)>=3D 2)) then
+				local msg =3D HtmlParser( gClilocLoader and gClilocLoader:Get(bToken[2=
]) or "no_cliloc" )
+				AddFadeLines("HtmlGumpparser - tooltip (TODO):"..msg.text)
+			else
+				printdebug("gump","UNKNOWN Generic Gump Command: "..command)
+			end
+		end
 			=

-			-- add all newly created widgets to current page
-			local myc =3D 0
-			for k,widget in pairs(dialog.childs) do =

-				if (not widget.pagenum) then
-					myc =3D myc + 1
-					widget.pagenum =3D page.pagenum
-					table.insert(page.pagewidgets,widget)
-				end
-			end
-			printdebug("gump","ServerSideGump page ",page.pagenum," childs: ",myc)
-		end
-		=

-		-- hide all except page 0 and 1
-		dialog:ShowPage(1)
-		=

-	end -- endif gGumpLoader
+		-- add all newly created widgets to current page
+		local myc =3D 0
+		for k,widget in pairs(dialog.childs) do =

+			if (not widget.pagenum) then
+				myc =3D myc + 1
+				widget.pagenum =3D page.pagenum
+				table.insert(page.pagewidgets,widget)
+			end
+		end
+		printdebug("gump","ServerSideGump page ",page.pagenum," childs: ",myc)
+	end
+
+	gServerSideGump[Gumpdata.dialogId] =3D dialog
+
+	-- hide all except page 0 and 1
+	dialog:ShowPage(1)
 	=

 	-- TODO : set correct Alpha Value
 	--SetDialogAlpha(dialog, 1.0)
-	return dialog
 end
 =

 --[[
@@ -466,21 +472,21 @@
 	--parse tokens
 	for z=3D1, table.getn(bToken) do
 		local command =3D string.lower(bToken[z])
-		--print(command)
+--		printdebug("gump",command)
 =

 		if (command =3D=3D "basefont") then
 			if (table.getn(bToken)>=3D z+2) then
 				if (string.lower(bToken[z+1])=3D=3D"color") then
 					--could be a hex value "msg_hue: 0xFFFFFF" or a colorname like "msg_h=
ue: 0xYELLOW"
 					msg.hue =3D "0x"..bToken[z+2]
---					print("basefont msg.hue=3D"..msg.hue)
+--					printdebug("gump","basefont msg.hue=3D"..msg.hue)
 					z=3Dz+2
 				end
 			end
 			if (table.getn(bToken)>=3D z+2) then
 				if (string.lower(bToken[z+1])=3D=3D"size") then
 					msg.charh =3D msg.charh+bToken[z+2]
---					print("basefont msg.charh=3D"..msg.charh)
+--					printdebug("gump","basefont msg.charh=3D"..msg.charh)
 					z=3Dz+2
 				end
 			end
@@ -526,6 +532,6 @@
 		end
 	end
 =

---	print("formated-html-string: "..msg.text)
+--	printdebug("gump","formated-html-string: "..msg.text)
 	return msg
 end

Modified: trunk/lua/lib.uodragdrop.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.uodragdrop.lua (original)
+++ trunk/lua/lib.uodragdrop.lua Thu Feb 14 00:09:30 2008
@@ -257,7 +257,7 @@
 function DestroyDragDropItemBySerial (serial)
 	if (gDragDrop and gDragDrop.item.serial =3D=3D serial) then
 		gDragDrop.bItemDestroyed =3D true
-		gDragDrop.widget =3D false		=

+		gDragDrop.widget =3D nil		=

 		-- item is kept "on the cursor" even if it was removed from inventory af=
ter Send_Take_Object()
 	end
 end

Modified: trunk/lua/net/net.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.mobile.lua (original)
+++ trunk/lua/net/net.mobile.lua Thu Feb 14 00:09:30 2008
@@ -292,5 +292,9 @@
 	local input =3D GetRecvFIFO()
 	local id =3D input:PopNetUint8()
 	local action =3D input:PopNetUint8()
+
+	-- > BandagePacket ( BandagePacket.cs ) ??????	=

+	--local item_serial =3D input:PopNetUint32()		-- use item on target mobile
+	--local mobile_target =3D input:PopNetUint32()
 	printdebug("mobile",sprintf("NET: kPacket_Death: player is now (2=3Dghost=
, 1=3Dresurrect, 0=3Dfrom server)=3D%i\n",action))
 end

Modified: trunk/lua/net/net.other.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.other.lua (original)
+++ trunk/lua/net/net.other.lua Thu Feb 14 00:09:30 2008
@@ -633,16 +633,17 @@
 =

 	for k,v in pairs(newgump) do printdebug("gump",sprintf("newgump.%s =3D ",=
k),v) end
 	=

-	local totaltext =3D ""
+--	local totaltext =3D ""
+	local textlen =3D 0
 	newgump.textline =3D {}
 	--Index 0 because Serverside Gump Commands use this Index as textline ref=
erences
 	for i =3D 0,newgump.numTextLines-1 do
-		local textlen =3D input:PopNetUint16()
+		textlen =3D input:PopNetUint16()
 		printdebug("gump","reading text line ",i," with length ",textlen)
 		newgump.textline[i] =3D input:PopUnicodeString(textlen) -- warning, data=
 is sent as unicode, we only interpret the asci part at the moment
 		-- TODO : maybe textlen / 2 ?
 		printdebug("gump",sprintf("newgump.textline[%d](len=3D%d)=3D\n",i,textle=
n),newgump.textline[i])
-		totaltext =3D totaltext .. "\n" .. newgump.textline[i]
+--		totaltext =3D totaltext .. "\n" .. newgump.textline[i]
 	end
 =

 	GumpParser(newgump)
@@ -699,16 +700,17 @@
 		-- print gumpdata
 		for k,v in pairs(newgump) do printdebug("gump",sprintf("newgump.%s =3D "=
,k),v) end
 		=

-		local totaltext =3D ""
+--		local totaltext =3D ""
+		local textlen =3D 0
 		newgump.textline =3D {}
 		--Index 0 because Serverside Gump Commands use this Index as textline re=
ferences
 		for i =3D 0,newgump.numTextLines-1 do
-			local textlen =3D decompressed:PopNetUint16()
+			textlen =3D decompressed:PopNetUint16()
 			printdebug("gump","reading text line ",i," with length ",textlen)
 			newgump.textline[i] =3D decompressed:PopUnicodeString(textlen) -- warni=
ng, data is sent as unicode, we only interpret the asci part at the moment
 			-- TODO : maybe textlen / 2 ?
 			printdebug("gump",sprintf("newgump.textline[%d](len=3D%d)=3D\n",i,textl=
en),newgump.textline[i])
-			totaltext =3D totaltext .. "\n" .. newgump.textline[i]
+--			totaltext =3D totaltext .. "\n" .. newgump.textline[i]
 		end
 	end
 =




From no-reply at zwischenwelt.org  Thu Feb 14 00:32:47 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 13 Feb 2008 23:32:47 -0000
Subject: [Iris-commit] [IRIS] r1905 - in /trunk: data/ data/guis/naked/ lua/
Message-ID: <20080213233248.15D6E1C18746@zwischenwelt.org>

Author: sience
Date: Thu Feb 14 00:32:47 2008
New Revision: 1905

Log:
-new hotbarskin added (not funktional yet)

Added:
    trunk/data/guis/naked/
    trunk/data/guis/naked/gor_iris2_gui_17_naked_sliced_chat.png   (with pr=
ops)
    trunk/data/guis/naked/gor_iris2_gui_17_naked_sliced_mainmenu.png   (wit=
h props)
    trunk/data/guis/naked/gor_iris2_gui_17_naked_sliced_radar.png   (with p=
rops)
    trunk/data/guis/naked/gor_iris2_gui_17_naked_sliced_spellbar.png   (wit=
h props)
    trunk/data/guis/naked/gor_iris2_gui_17_naked_sliced_status.png   (with =
props)
    trunk/data/guis/naked/hotbar.material
Modified:
    trunk/data/config.lua.dist
    trunk/lua/main.lua

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Thu Feb 14 00:32:47 2008
@@ -53,7 +53,7 @@
 gGuiDefaultStyleSet =3D "sience"
 =

 -- just for testing the new guistyles
-gNewGuiStyle=3D"gorgui"
+gNewGuiStyle=3D"naked"
 =

 -- loader types, FullFile is faster, but uses more ram, OnDemand is slower=
, but uses almost no ram
 gGroundBlockLoaderType 				=3D "FullFile"

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Thu Feb 14 00:32:47 2008
@@ -191,6 +191,7 @@
 =

 	--~ # custom guis
 	OgreAddResLoc(mydatapath.."guis/gorgui"					,"FileSystem","General")
+	OgreAddResLoc(mydatapath.."guis/naked"					,"FileSystem","General")
 =

 	--~ # custom models
 	OgreAddResLoc(mydatapath.."custom/materials"			,"FileSystem","General")



From no-reply at zwischenwelt.org  Fri Feb 15 23:46:07 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 15 Feb 2008 22:46:07 -0000
Subject: [Iris-commit] [IRIS] r1906 - /trunk/lua/obj/obj.container.lua
Message-ID: <20080215224607.C94FB1C1874A@zwischenwelt.org>

Author: ghoulsblade
Date: Fri Feb 15 23:46:06 2008
New Revision: 1906

Log:
added object prop analysis stuff, debug only so far

Modified:
    trunk/lua/obj/obj.container.lua

Modified: trunk/lua/obj/obj.container.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/obj/obj.container.lua (original)
+++ trunk/lua/obj/obj.container.lua Fri Feb 15 23:46:06 2008
@@ -3,6 +3,8 @@
 -- TODO : later : paperdoll stuff, corpse... kPacket_Corpse_Equipment
 =

 gContainerPrototype =3D {}
+
+gLastDebugContainer =3D nil
 =

 kUOToolTippOffX =3D -16
 kUOToolTippOffY =3D 32
@@ -109,6 +111,7 @@
 		dialog.backpane.on_mouse_right_down	=3D function (widget) CloseContainer=
(widget.dialog.uoContainer.serial) end
 		dialog.backpane.on_mouse_left_down	=3D function (widget) widget.dialog:B=
ringToFront() gui.StartMoveDialog(widget.dialog.rootwidget) end
 	end
+	gLastDebugContainer =3D container
 	RefreshContainerItemWidgets(container)
 =

 	SecureTradeRebuildContainerHook(container)
@@ -159,6 +162,168 @@
 		DestroyContainerItemWidgets(container)
 		for k,item in pairs(container:GetContent()) do MakeContainerItemWidget(i=
tem) end
 	end
+end
+
+
+function ScanItemPropBoolean	(props,line,pattern,field) end
+function ScanItemPropNumber		(props,line,pattern,field) end
+
+gItemPropAOS =3D {
+	{"^luck (%d+)"								,{0}		,"luck"				},	=

+	{"^lower reagent cost (%d+)%%"				,{0}		,"lrc"				},	=

+	{"^lower mana cost (%d+)%%"					,{0}		,"lmc"				},	=

+	{"^defense chance increase (%d+)%%"			,{0}		,"dci"				},	=

+	{"^hit chance increase (%d+)%%"				,{0}		,"hci"				},	=

+	{"^skillbonus_sum"							,0			,"skillbonus_sum"	},-- dummy entry, pattern=
 will never match
+	{"^faster cast recovery (%d+)"				,{0}		,"fastcastrecov"	},	=

+	{"^faster casting (%d+)"					,{0}		,"fastcast"			},	=

+	{"^mage armor"								,false		,"magearmor"		},	=

+	{"^\"Maximum sockets allowed is (%d+).\""	,{0}		,"maxsocket"		},	=

+	{"^mana regeneration (%d+)"					,{0}		,"manareg"			},	=

+	{"^mana increase (%d+)"						,{0}		,"manainc"			},	=

+	{"^damage increase (%d+)%%"					,{0}		,"dmginc"			},	=

+	{"^spell damage increase (%d+)%%"			,{0}		,"sdi"				},	=

+	{"^strength bonus (%d+)"					,{0}		,"bonusstr"			},	=

+	{"^dexterity bonus (%d+)"					,{0}		,"bonusdex"			},	=

+	{"^intelligence bonus (%d+)"				,{0}		,"bonusint"			},	=

+	{"^<b>Insured</b>"							,false		,"insured"			},	=

+	{"^self repair (%d+)%%"						,{0}		,"selfrepair"		},	=

+	{"^enhance potions (%d+)%%"					,{0}		,"enhancepotion"	},	=

+	{"^hit point regeneration (%d+)"			,{0}		,"hpreg"			},	=

+	{"^hit point increase (%d+)"				,{0}		,"hpinc"			},	=

+	{"^physical resist (%d+)%%"					,{0}		,"resistphysical"	},	=

+	{"^poison resist (%d+)%%"					,{0}		,"resistpoison"		},	=

+	{"^cold resist (%d+)%%"						,{0}		,"resistcold"		},	=

+	{"^fire resist (%d+)%%"						,{0}		,"resistfire"		},	=

+	{"^energy resist (%d+)%%"					,{0}		,"resistenergy"		},	=

+	{"^strength requirement (%d+)"				,{0}		,"strengthreq"		},
+	{"^durability (%d+) / (%d+)"				,{0,0}		,"durability"		},
+	{"^Weight: (%d+) stones"					,{0}		,"weight"			},	=

+	{"^night sight"								,false		,"nightsight"		},
+}
+	=

+--[[
+crafted by Lady Smya,lower requirements 90%,stamina regeneration 2,durabil=
ity 20%,
+reflect physical damage 3%,
+crafted by Lady Smya,reflect physical damage 15%,self repair 3,durability =
20%,
+lower requirements 50%,reflect physical damage 6%,self repair 3,spell chan=
neling,durability 20%,
+physical damage 100%,weapon damage 16 - 17,weapon speed 29,two-handed weap=
on,skill required: swordsmanship,
+hit life leech 6%,physical damage 100%,weapon damage 16 - 18,weapon speed =
25,range 10,two-handed weapon,skill required: archery,"1 Sockets. 1 availab=
le.,Maximum sockets allowed is 2.",Quiver using: Normal,
+hit cold area 10%,hit dispel 10%,hit lower attack 10%,hit mana leech 10%,p=
hysical damage 100%,weapon damage 11 - 13,weapon speed 47,two-handed weapon=
,skill required: mace fighting,
+lower requirements 40%,physical damage 100%,weapon damage 14 - 16,weapon s=
peed 37,two-handed weapon,skill required: fencing,
+lower requirements 20%,physical damage 100%,weapon damage 19 - 20,weapon s=
peed 22,range 8,two-handed weapon,skill required: archery,Quiver using: Nor=
mal,
+faster casting -1,reflect physical damage 3%,spell channeling,
+hit life leech 24%,hit lightning 6%,hit lower attack 6%,swing speed increa=
se 15%,physical damage 100%,weapon damage 14 - 15,weapon speed 33,one-hande=
d weapon,skill required: swordsmanship,
+hit lower attack 14%,hit mana leech 10%,lower requirements 30%,physical da=
mage 100%,weapon damage 11 - 13,weapon speed 46,one-handed weapon,skill req=
uired: swordsmanship,
+
+physical damage 100%,weapon damage 15 - 17,weapon speed 33,two-handed weap=
on,skill required: mace fighting,
+Weapon: +2 Leech Mana, +2 Leech Life,Armor: +1 Mana Regen, +1 Hits Regen,C=
reature: +20 Hits,
+repond slayer,swing speed increase 10%,physical damage 100%,weapon damage =
15 - 17,weapon speed 28,one-handed weapon,skill required: swordsmanship,
+mage weapon -28 skill,physical damage 100%,weapon damage 15 - 17,weapon sp=
eed 33,two-handed weapon,skill required: swordsmanship,
+
+]]--
+
+
+function countmatches (text,searchpattern)
+	local counter =3D 0
+	for w in string.gmatch(text,searchpattern) do counter =3D counter + 1 end
+	return counter
+end
+			=

+function DebugDumpContainerContentInfo ()
+	print("DebugDumpContainerContentInfo")
+	local container =3D gLastDebugContainer  =

+	if (not container) then return end
+	local fp =3D io.open("myitems.csv","a")
+	=

+	local csvout =3D "name;type"
+	for k1,arr in pairs(gItemPropAOS) do =

+		local infopattern,defaultval,propfield =3D unpack(arr)
+		csvout =3D csvout..";"..propfield
+	end
+	csvout =3D csvout..";".."rest"
+	fp:write(csvout.."\n")
+	=

+	for k,item in pairs(container:GetContent()) do =

+		local name =3D GetStaticTileTypeName(item.artid) or ""
+		local tooltiptext =3D AosToolTip_GetText(item.serial) or ""
+		local props =3D {rest=3D"",skillbonus_sum=3D0,skillbonus=3D{}}
+		=

+		for k,line in pairs(strsplit("\n",tooltiptext)) do
+			if (k =3D=3D 1) then =

+				props.name =3D line
+			else
+				-- try to match all known property format strings
+				local found =3D false
+				for k1,arr in pairs(gItemPropAOS) do =

+					local infopattern,defaultval,propfield =3D unpack(arr)
+					local p0,p1,a,b =3D string.find(line,infopattern)
+					if (p0) then -- only happens for one of the patterns
+						found =3D true
+						props[propfield] =3D {a,b}
+					end
+				end
+				=

+				-- check for skillbonus like "Peacemaking +7"
+				local p0,p1,skillname,bonus =3D string.find(line,"^([%w ]+) %+(%d+)")
+				if (skillname) then
+					--found =3D true   -- just count, but also mention in "rest"
+					props.skillbonus_sum =3D props.skillbonus_sum + tonumber(bonus)
+					props.skillbonus[skillname] =3D bonus
+					=

+				end
+				=

+				-- if unknown prop, append to props.rest
+				if (not found) then props.rest =3D props.rest .. line .. "," end
+			end
+		end
+		=

+		local bInteresting =3D false
+		if (tonumber(props.skillbonus["Animal Taming"] or 0) >=3D 10) then bInte=
resting =3D true end
+		if (props.lrc and tonumber(props.lrc[1]) >=3D 14) then bInteresting =3D =
true end
+		if (props.luck and tonumber(props.luck[1]) >=3D 85) then bInteresting =
=3D true end
+		if (bInteresting) then =

+			print("interesting item found, moving to backpack")
+			local amount =3D 1
+			local itemserial =3D item.serial
+			local x,y,z =3D 0,0,0
+			local containerserial =3D gPlayerBackPack and gPlayerBackPack.serial
+			if (containerserial) then
+				print("grab",itemserial,containerserial)
+				Send_Take_Object(itemserial,amount)
+				Client_USleep(500)
+				Send_Drop_Object(itemserial,x,y,z,containerserial)
+				Client_USleep(1000)
+			else 	=

+				print("error, backpack not found")
+			end
+		end
+		=

+--~ 		print(props.rest)
+		=

+		local layer =3D GetPaperdollLayerFromTileType(item.artid) or 0
+		=

+		local csvout =3D props.name..";"..layer
+		for k1,arr in pairs(gItemPropAOS) do =

+			local infopattern,defaultval,propfield =3D unpack(arr)
+			local val =3D props[propfield] or defaultval
+			if (val and type(val) =3D=3D "number") then  -- 0 : skillbonus sum
+				val =3D val
+			elseif (val and val[2]) then =

+				val =3D val[1].."/"..val[2] =

+			elseif (val and val[1]) then =

+				val =3D val[1]
+			elseif (val and type(val) =3D=3D "table") then  -- {} : "yes", etc for =
nightsight,magearmor : match without params
+				val =3D "ja"
+			else
+				val =3D "nein"
+			end
+			csvout =3D csvout..";"..val
+		end
+		csvout =3D csvout..";"..props.rest
+		fp:write(csvout.."\n")
+	end
+	fp:close()
 end
 =

 -- TODO use lib.gfm.lua : MakeArtGumpPart ?



From no-reply at zwischenwelt.org  Sat Feb 16 00:46:59 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 15 Feb 2008 23:46:59 -0000
Subject: [Iris-commit] [IRIS] r1907 - in /trunk: data/models/materials/
 data/models/models/to_011000/ data/models/textures/ lua/ lua/filter/
Message-ID: <20080215234700.86C501C181BD@zwischenwelt.org>

Author: hagish
Date: Sat Feb 16 00:46:56 2008
New Revision: 1907

Log:
improved debug tool: adjust position, added new japan slide door

Added:
    trunk/data/models/models/to_011000/mdl_010762.mesh   (with props)
    trunk/data/models/models/to_011000/mdl_010763.mesh   (with props)
    trunk/data/models/models/to_011000/mdl_010764.mesh   (with props)
    trunk/data/models/textures/tex_slidingdoor.png   (with props)
Modified:
    trunk/data/models/materials/textures.material
    trunk/lua/filter/filter.art.lua
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.devtool.lua

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Feb 16 00:46:56 2008
@@ -8258,3 +8258,18 @@
 		}
 	} =

 }
+
+material tex_slidingdoor : tex_base
+{ =

+	technique =

+	{ =

+		pass =

+		{		=

+			texture_unit =

+			{ =

+				texture tex_slidingdoor.png =

+			}	=

+		}
+	} =

+}
+

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Sat Feb 16 00:46:56 2008
@@ -143,6 +143,13 @@
 gArtFilter[3353]=3D{maptoid=3D3351}
 gArtFilter[3349]=3D{maptoid=3D3350}
 =

+-- houseparts
+gArtFilter[10761]=3D{maptoid=3D10763}
+gArtFilter[10759]=3D{maptoid=3D10763,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
+gArtFilter[10757]=3D{maptoid=3D10763,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
+gArtFilter[10760]=3D{maptoid=3D10762,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
+gArtFilter[10758]=3D{maptoid=3D10764,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
+
 ----------------------------------------------------------------------
 =

 -- Seasonal Dynamic & Static Art Translation (run tiles)	-- eventuell (iTi=
leTypeID + 16384)
@@ -221,4 +228,4 @@
 ["d02"]=3D-1,
 --Foliage multiple tiles
 ["d45"]=3D-1
-})
+})

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sat Feb 16 00:46:56 2008
@@ -41,8 +41,9 @@
 		for k,dynamic in pairs(GetDynamicList()) do
 			-- print("DEBUG","ADD DYNAMIC",dynamic.meshname)
 			if (dynamic.meshname and DynamicIsInWorld(dynamic)) then
-				x,y,z =3D Renderer3D:UOPosToLocal(dynamic.xloc,dynamic.yloc,dynamic.zl=
oc * 0.1) =

+				x,y,z =3D Renderer3D:UOPosToLocal(dynamic.xloc + dynamic.xadd,dynamic.=
yloc + dynamic.yadd,dynamic.zloc * 0.1 + dynamic.zadd) =

 				qw,qx,qy,qz =3D GetStaticMeshOrientation(dynamic.artid)
+				-- print("FASTBATCH POS",x,y,z,"ROT",qw,qx,qy,qz)
 =

 				local r,g,b,a =3D 1,1,1,1
 				if (gHueLoader and dynamic.hue > 0) then
@@ -66,6 +67,7 @@
 	if (dynamic.gfx) then
 		dynamic.gfx:SetPosition(self:UOPosToLocal(dynamic.xloc + dynamic.xadd,dy=
namic.yloc + dynamic.yadd,dynamic.zloc * 0.1 + dynamic.zadd))
 	end
+	-- TODO update dynamic fastbatch?
 end
 =

 function Renderer3D:UpdateDynamicVisibility	(dynamic) =

@@ -73,6 +75,31 @@
 		-- normal item
 		dynamic.gfx:SetVisible(self:IsZLayerVisible(dynamic.zloc))
 		if (dynamic.gfx.billboard) then dynamic.gfx.billboard:SetVisible(self:Is=
ZLayerVisible(dynamic.zloc)) end
+	end
+end
+
+-- rebuilds the graphic of the dynamics
+function Renderer3D:RebuildDynamic ( dynamic )
+	-- update position adjustments
+	dynamic.xadd =3D FilterPositionX(dynamic.artid) or 0
+	dynamic.yadd =3D FilterPositionY(dynamic.artid) or 0
+	dynamic.zadd =3D FilterPositionZ(dynamic.artid) or 0
+
+	if gFastBatchDynamics then
+		Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
+	elseif dynamic.gfx then
+		-- update rotation
+		if dynamic.gfx then dynamic.gfx:SetOrientation(GetStaticMeshOrientation(=
dynamic.artid)) end
+		-- update position
+		Renderer3D:UpdateDynamicItemPos(dynamic)
+	end
+end
+
+function Renderer3D:RebuildAllDynamicsWithArtid(artid)
+	for k,v in pairs(gDynamics) do
+		if v and v.artid and v.artid =3D=3D artid then
+			Renderer3D:RebuildDynamic(v)
+		end
 	end
 end
 =

@@ -165,7 +192,6 @@
 	else
 		-- normal 1 part object
 		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid) -- ,item.hue)
-		item.meshname =3D meshname
 		item.meshname =3D meshname
 		-- print("DEBUG","meshname",item.meshname)
 		=


Modified: trunk/lua/lib.devtool.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.devtool.lua (original)
+++ trunk/lua/lib.devtool.lua Sat Feb 16 00:46:56 2008
@@ -187,6 +187,9 @@
 	print("filter.art.lua","gArtFilter["..dialog.tileid.."]=3D{maptoid=3D"..o=
therid..",rotation=3D\"x:"..dialog.xrot..",y:"..dialog.yrot..",z:"..dialog.=
zrot.."\",xadd=3D"..dialog.xadd..",yadd=3D"..dialog.yadd..",zadd=3D"..dialo=
g.zadd.."}")
 	-- update geometry
 	Renderer3D:RebuildMap()
+	-- update dynamics
+	Renderer3D:RebuildAllDynamicsWithArtid(otherid)
+	Renderer3D:RebuildAllDynamicsWithArtid(dialog.tileid)
 end
 =

 function AdjustArtPositionControlDialog(tileid)
@@ -254,7 +257,7 @@
 	}
 	=

 	-- statics
-	local statics =3D ListStaticsNearPos(x,y,z,0)
+	local statics =3D ListStaticsNearPos(x,y,z,1)
 	for k,entity in pairs(statics) do =

 		local i =3D entity.iTileTypeID
 		local meshpath =3D GetModelPath(i)
@@ -267,11 +270,16 @@
 	end
 	=

 	-- dynamics
-	local dynamics =3D ListDynamicsNearPos(x,y,z,0)
+	local dynamics =3D ListDynamicsNearPos(x,y,z,1)
 	for k,item in pairs(dynamics) do =

+		print("DEBUG",k,item)
 		local i =3D item.artid
 		local meshpath =3D GetModelPath(i)
-		local texlist =3D meshpath and OgreMeshTextures(meshpath)
+		local name =3D GetStaticTileTypeName(i) or "unknown"
+		table.insert(rows,{ =

+			{type=3D"Button",text=3D"#"..i..": "..name,onMouseDown=3Dfunction(widge=
t) widget.dialog:Destroy() AdjustArtPositionControlDialog(i) end},
+		})
+
 		print("DEBUG","dynamic",i,meshpath)
 	end
 =




From no-reply at zwischenwelt.org  Sat Feb 16 02:07:03 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 01:07:03 -0000
Subject: [Iris-commit] [IRIS] r1908 - in /trunk: data/base/ lua/ lua/gui/
	lua/net/ vs8/
Message-ID: <20080216010703.F34341C18223@zwischenwelt.org>

Author: sience
Date: Sat Feb 16 02:07:03 2008
New Revision: 1908

Log:
-several updates to mesh rendering dynamics/statics
-hued_effects updated
-new project settings
-lib.pagedialog.lua moved to gui/gui.pagedialog.lua
-questmark.png renamed to trackarrow.png
-several materialnames changed
-obsolete materials removed

Added:
    trunk/data/base/trackarrow.png   (with props)
    trunk/lua/gui/gui.pagedialog.lua
Removed:
    trunk/data/base/questmark.png
    trunk/lua/lib.pagedialog.lua
Modified:
    trunk/data/base/main.material
    trunk/lua/gui/gui.main.lua
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.mobile.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.debugmenu.lua
    trunk/lua/lib.keybinds.lua
    trunk/lua/lib.packet.lua
    trunk/lua/lib.static.lua
    trunk/lua/lib.test.lua
    trunk/lua/main.lua
    trunk/lua/net/net.effect.lua
    trunk/lua/net/net.other.lua
    trunk/vs8/iris.sln
    trunk/vs8/iris.vcproj

Modified: trunk/data/base/main.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/base/main.material (original)
+++ trunk/data/base/main.material Sat Feb 16 02:07:03 2008
@@ -93,7 +93,7 @@
 			//depth_write off
 			//depth_check off
 =

-			texture_unit skytex
+			texture_unit
 			{
 				texture stone512.dds
 				tex_address_mode border
@@ -112,42 +112,8 @@
 	set_texture_alias arttex art_fallback.png
 }
 =

-// mouse cursor material
-material mousecursor
-{
-	set_texture_alias guitex mousecursor.png
-}
-
-// radarcompass materials
-material tempmap_0_small : tempmapbase
-{
-	set_texture_alias skytex tempmap_0_small_s.tga
-}
-
-material tempmap_1_small : tempmapbase
-{
-	set_texture_alias skytex tempmap_1_small_s.tga
-}
-
-material tempmap_2_small : tempmapbase
-{
-	set_texture_alias skytex tempmap_2_small_s.tga
-}
-material tempmap_3_small : tempmapbase
-{
-	set_texture_alias skytex tempmap_3_small_s.tga
-}
-material tempmap_4_small : tempmapbase
-{
-	set_texture_alias skytex tempmap_4_small_s.tga
-}
-material tempmap_5_small : tempmapbase
-{
-	set_texture_alias skytex tempmap_5_small_s.tga
-}
-
 // material to show a simple 3D health bar
-material bar : guibase
+material mobile/3d_healthbar : guibase
 {
 	technique
 	{
@@ -164,7 +130,7 @@
 	}
 }
 =

-material aura_base : guibase
+material mobile/aura_base : guibase
 {
 	technique
 	{
@@ -183,7 +149,7 @@
 	}
 }
 =

-material quest_arrow : guibase
+material tracking_arrow : guibase
 {
 	technique
 	{
@@ -193,7 +159,7 @@
 			{
 				filtering anisotropic
 				max_anisotropy 8
-				texture questmark.png
+				texture trackarrow.png
 				tex_address_mode clamp
 			}
 		}

Modified: trunk/lua/gui/gui.main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.main.lua (original)
+++ trunk/lua/gui/gui.main.lua Sat Feb 16 02:07:03 2008
@@ -1,9 +1,12 @@
 dofile(libpath .. "gui/gui.widget.lua")
 dofile(libpath .. "gui/gui.gumpmanager.lua")
-dofile(libpath .. "gui/gui.container.lua")
 dofile(libpath .. "gui/gui.paperdoll.lua")
 dofile(libpath .. "gui/gui.journal.lua")
 dofile(libpath .. "gui/gui.quit.lua")
 dofile(libpath .. "gui/gui.status.lua")
 dofile(libpath .. "gui/gui.styles.lua")
 dofile(libpath .. "gui/gui.hotbar.lua")
+
+-- TODO
+dofile(libpath .. "gui/gui.container.lua")
+dofile(libpath .. "gui/gui.pagedialog.lua")

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sat Feb 16 02:07:03 2008
@@ -21,7 +21,6 @@
 end
 =

 function Renderer3D:CheckForFastBatchDynamicsUpdate ()
-	if (gTestHideDynamics) then return end =

 	if Renderer3D.gFastBatchDynamicsUpdateNeeded and =

 		(not Renderer3D.gFastBatchDynamicsUpdateNext or Renderer3D.gFastBatchDyn=
amicsUpdateNext < gMyTicks) then
 =

@@ -39,11 +38,9 @@
 		local qw,qx,qy,qz
 		-- add dynamics
 		for k,dynamic in pairs(GetDynamicList()) do
-			-- print("DEBUG","ADD DYNAMIC",dynamic.meshname)
 			if (dynamic.meshname and DynamicIsInWorld(dynamic)) then
 				x,y,z =3D Renderer3D:UOPosToLocal(dynamic.xloc + dynamic.xadd,dynamic.=
yloc + dynamic.yadd,dynamic.zloc * 0.1 + dynamic.zadd) =

 				qw,qx,qy,qz =3D GetStaticMeshOrientation(dynamic.artid)
-				-- print("FASTBATCH POS",x,y,z,"ROT",qw,qx,qy,qz)
 =

 				local r,g,b,a =3D 1,1,1,1
 				if (gHueLoader and dynamic.hue > 0) then
@@ -106,7 +103,6 @@
 -- TODO: Multis & Serversidemultis don't recognize kTileDataFlag_LightSour=
ce yet
 function Renderer3D:CreateDynamicGfx( item )
 	assert(not item.gfx)
-	if (gTestHideDynamics) then return end
 =

 	-- FILTER: get correction
 	item.xadd =3D FilterPositionX(item.artid) or 0
@@ -191,66 +187,62 @@
 		end
 	else
 		-- normal 1 part object
-		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid) -- ,item.hue)
+		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid, 0)
 		item.meshname =3D meshname
-		-- print("DEBUG","meshname",item.meshname)
 		=

-		if gFastBatchDynamics and meshname and meshname ~=3D false then
+		if (gFastBatchDynamics and meshname and meshname ~=3D false) then
 			-- trigger: burn all dynamics into the dynamic fastbatch
 			item.meshbuffer =3D GetMeshBuffer(meshname) -- for mousepicking
 			TexAtlas_AdjustMeshBufferIfNeeded(meshname,item.meshbuffer)
 			Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
-		else
+		elseif (meshname and meshname ~=3D false) then
 			-- just add the dynamic as a scene node
 			item.gfx =3D CreateRootGfx3D()
-			if (meshname and meshname ~=3D false) then
-				item.gfx:SetMesh(meshname)
-				item.gfx:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong=
 mirrored mashes
-				item.gfx:SetNormaliseNormals(true)
-				item.gfx:SetCastShadows(gDynamicsCastShadows)
-				-- primary color hueing
-				if gHueLoader and item.hue > 0 then
-					local r,g,b =3D gHueLoader:GetColor(item.hue - 1,31) -- get first col=
or
-					HueMeshEntity(item.gfx,r,g,b,r,g,b)
-				end
-			elseif (gEnableFallBackBillboards_Dynamics) then
-				local iTranslatedTileTypeID =3D SeasonalStaticTranslation(item.artid, =
gSeasonSetting)
-				-- we have to add 16384 for fallbacks, because static Art starts on 16=
384 in Art.mul file
-				iTranslatedTileTypeID =3D iTranslatedTileTypeID + 16384
-
-				-- fallback to billboard with original art
-				if (not IsArtBillboardFallBackSkipped(item.artid)) then
-					-- generate uoart billboard fallback
-					item.gfx.billboard =3D item.gfx:CreateChild()
-					item.xadd =3D item.xadd + 0.5
-					item.yadd =3D item.yadd + 0.5
-					item.zadd =3D item.zadd + 0.5
-					self:CreateArtBillBoard(item.gfx.billboard,iTranslatedTileTypeID,item=
.hue)
-					printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed loa=
ding mesh for dynamic: artid=3D%i z_typename=3D%s\n",item.artid or -1,GetSt=
aticTileTypeName(item.artid) or ""))
-				end
-			end
-
+			item.gfx:SetMesh(meshname)
+			item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
+			item.gfx:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong =
mirrored meshes
+			item.gfx:SetNormaliseNormals(true)
+			item.gfx:SetCastShadows(gDynamicsCastShadows)
+			-- primary color hueing
+			if gHueLoader and item.hue > 0 then
+				local r,g,b =3D gHueLoader:GetColor(item.hue - 1,31) -- get first color
+				HueMeshEntity(item.gfx,r,g,b,r,g,b)
+			end
 			item.gfx:SetRenderingDistance(self.gDynamicMaxRenderDist)
-
-			-- FILTER: correction
-			item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
-
+			-- set's position and add's xadd,yadd,zadd corrections
 			self:UpdateDynamicItemPos(item)
-
-		end
-
-		-- creates a light if lights are enabled and static is a lightsource
-		-- note! lights don't cast shadows
-		if (gLightsources) then
-			local arrtiletype =3D GetStaticTileType(item.artid)
-			if( arrtiletype and TestBit(arrtiletype.miFlags or 0,kTileDataFlag_Ligh=
tSource) ) then
-				local x,y,z =3D Renderer3D:UOPosToLocal(item.xloc,item.yloc,(item.zloc=
+arrtiletype.miHeight) * 0.1)
-				item.lightname=3DClient_AddPointLight(x,y,z, 0.3,0.3,0.0, 0.3,0.3,0.0,=
 5.0,0.1,0.1,0.0)
-			end
-		end
-
-	end
-	self:UpdateDynamicVisibility(item)
+			-- updates the layer-visibility
+			self:UpdateDynamicVisibility(item)
+		elseif (gEnableFallBackBillboards_Dynamics) then
+			-- fallback to billboard with original art
+			if (not IsArtBillboardFallBackSkipped(item.artid)) then
+				item.gfx =3D CreateRootGfx3D()
+				item.gfx.billboard =3D item.gfx:CreateChild()
+				item.xadd =3D item.xadd + 0.5
+				item.yadd =3D item.yadd + 0.5
+				item.zadd =3D item.zadd + 0.5
+				self:CreateArtBillBoard(item.gfx.billboard,item.artid + 16384,item.hue)
+				printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed load=
ing mesh for dynamic: artid=3D%i z_typename=3D%s\n",item.artid or -1,GetSta=
ticTileTypeName(item.artid) or ""))
+				item.gfx:SetRenderingDistance(self.gDynamicMaxRenderDist)
+				-- set's position and add's xadd,yadd,zadd corrections
+				self:UpdateDynamicItemPos(item)
+				-- updates the layer-visibility
+				self:UpdateDynamicVisibility(item)
+			end
+		else
+			print("no mesh found & no billboard used for this artID=3D"..item.artid)
+		end
+	end
+
+	-- creates a light if lights are enabled and static is a lightsource
+	-- note! lights don't cast shadows
+--	if (gLightsources) then
+--		local arrtiletype =3D GetStaticTileType(item.artid)
+--		if( arrtiletype and TestBit(arrtiletype.miFlags or 0,kTileDataFlag_Lig=
htSource) ) then
+--			local x,y,z =3D Renderer3D:UOPosToLocal(item.xloc,item.yloc,(item.zlo=
c+arrtiletype.miHeight) * 0.1)
+--			item.lightname=3DClient_AddPointLight(x,y,z, 0.3,0.3,0.0, 0.3,0.3,0.0=
, 5.0,0.1,0.1,0.0)
+--		end
+--	end
 end
 =

 function Renderer3D:CreateArtBillBoard( gfx, iArtID, iHue )

Modified: trunk/lua/lib.3d.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mobile.lua (original)
+++ trunk/lua/lib.3d.mobile.lua Sat Feb 16 02:07:03 2008
@@ -45,7 +45,7 @@
 	if (not mobile.bar) then
 		mobile.bar =3D CreateRootGfx3D()
 		mobile.bar:SetSimpleRenderable()
-		mobile.bar:SetMaterial("bar")
+		mobile.bar:SetMaterial("mobile/3d_healthbar")
 		mobile.bar:SetForceRotCam(GetMainCam())
 		mobile.bar.lastn =3D nil
 	end
@@ -104,7 +104,7 @@
 	if (not mobile.aura) then
 		mobile.aura =3D CreateRootGfx3D()
 		mobile.aura:SetSimpleRenderable()
-		mobile.aura:SetMaterial("aura_base")
+		mobile.aura:SetMaterial("mobile/aura_base")
 		mobile.aura.lastn =3D nil
 	end
 	=

@@ -139,7 +139,7 @@
 		local e =3D 1.0
 		mobile.selection =3D CreateRootGfx3D()
 		mobile.selection:SetSimpleRenderable()
-		mobile.selection:SetMaterial("aura_base")
+		mobile.selection:SetMaterial("mobile/aura_base")
 		mobile.selection:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
 		mobile.selection:RenderableVertex(-e,-e,0, nx,ny,nz, 0,0, r,g,b,a)
 		mobile.selection:RenderableVertex( e,-e,0, nx,ny,nz, 1,0, r,g,b,a)

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sat Feb 16 02:07:03 2008
@@ -160,6 +160,7 @@
 		OgreShadowTechnique(gShadowTechnique)
 		OgreSetShadowTextureSize(2048)
 		OgreSetShadowCasterRenderBackFaces(false)
+		OgreSetShadowTextureCount(3)
 =

 --mLiSPSMSetup =3D new LiSPSMShadowCameraSetup()
 --m_pSceneMgr->setShadowCameraSetup(ShadowCameraSetupPtr(mLiSPSMSetup))
@@ -174,6 +175,7 @@
  		OgreShadowTechnique(gShadowTechnique)
 		OgreSetShadowTextureSize(2048)
 		OgreSetShadowCasterRenderBackFaces(false)
+		OgreSetShadowTextureCount(3)
 =

 		OgreSetShadowTexturePixelFormat(PF_FLOAT32_R)
 		OgreSetShadowTextureCasterMaterial("Ogre/DepthShadowmap/Caster/Float")
@@ -297,10 +299,11 @@
 		workingeffect =3D Renderer3D:AddParticleEffect( effect, gParticleEffects=
[effect.itemid].name,
 								gParticleEffects[effect.itemid].relx, gParticleEffects[effect.item=
id].rely, gParticleEffects[effect.itemid].relz,
 								gParticleEffects[effect.itemid].scalex, gParticleEffects[effect.it=
emid].scaley, gParticleEffects[effect.itemid].scalez)
-	elseif (effect.iseffect~=3Dtrue) then
+	elseif ( effect.huedeffect ) then
 		workingeffect =3D Renderer3D:AddHuedEffect( effect, 1, 0, 0 )
 	end
 =

+	-- if it's no huedeffect or no particle effect is defined, use a standard=
 particle effect
 	if (workingeffect =3D=3D nil) then
 		Renderer3D:AddParticleEffect( effect, gParticleEffects[StandardEffect].n=
ame,
 								gParticleEffects[StandardEffect].relx, gParticleEffects[StandardEf=
fect].rely, gParticleEffects[StandardEffect].relz,
@@ -310,12 +313,29 @@
 =

 -- Hued Effect : to display Meshes as instant Effects
 function Renderer3D:AddHuedEffect( effect, relx, rely, relz )
-	local meshname =3D GetMeshName(effect.itemid,effect.hue)
+	local meshname =3D GetMeshName(effect.itemid, 0)
 	if (meshname and meshname ~=3D false) then
 		effect.gfx =3D CreateRootGfx3D()
 		effect.gfx:SetMesh(meshname)
+		effect.gfx:SetOrientation(GetStaticMeshOrientation(effect.itemid))
+		effect.gfx:SetScale(-1,1,1)				-- (-1) thats because xmirror bug and wro=
ng mirrored meshes
+		effect.gfx:SetNormaliseNormals(true)
+		effect.gfx:SetCastShadows(gDynamicsCastShadows)
+		-- primary color hueing
+		if gHueLoader and effect.hue > 0 then
+			local r,g,b =3D gHueLoader:GetColor(effect.hue - 1,31) -- get first col=
or
+			HueMeshEntity(effect.gfx,r,g,b,r,g,b)
+		end
 		effect.gfx:SetRenderingDistance(self.gDynamicMaxRenderDist)
-		effect.gfx:SetPosition(self:UOPosToLocal(effect.current_locx + relx,effe=
ct.current_locy + rely,effect.current_locz * 0.1 + relz))
+
+		-- position adjustment for statics and dynamics
+		effect.xadd =3D FilterPositionX(effect.itemid) or 0
+		effect.yadd =3D FilterPositionY(effect.itemid) or 0
+		effect.zadd =3D FilterPositionZ(effect.itemid) or 0
+
+		effect.gfx:SetPosition(self:UOPosToLocal(effect.current_locx + relx,
+												 effect.current_locy + rely,
+												 effect.current_locz * 0.1 + relz))
 =

 		printdebug("effect",sprintf("Create HuedEffect with Mesh=3D%s MeshID=3D0=
x%04x.\n",meshname,effect.itemid) )
 =

@@ -329,12 +349,6 @@
 		end)
 =

 		printdebug("effect",vardump(effect))
-		--~ print("##################################")
-		--~ print("DEBUG",effect.speed,effect.duration)
-		--~ print("DEBUG current",effect.current_locx,effect.current_locy,effect=
.current_locz)
-		--~ print("DEBUG source",effect.source_locx,effect.source_locy,effect.so=
urce_locz)
-		--~ print("DEBUG target",effect.target_locx,effect.target_locy,effect.ta=
rget_locz)
-		--~ print("##################################")
 =

 		if =

 			effect.current_locx ~=3D effect.target_locx or
@@ -429,12 +443,6 @@
 	end)
 	=

 	printdebug("effect",vardump(effect))
-	--~ print("##################################")
-	--~ print("DEBUG",effect.speed,effect.duration)
-	--~ print("DEBUG current",effect.current_locx,effect.current_locy,effect.=
current_locz)
-	--~ print("DEBUG source",effect.source_locx,effect.source_locy,effect.sou=
rce_locz)
-	--~ print("DEBUG target",effect.target_locx,effect.target_locy,effect.tar=
get_locz)
-	--~ print("##################################")
 =

 	if =

 		effect.current_locx ~=3D effect.target_locx or
@@ -507,16 +515,16 @@
 =

 =

 --###############################
---###       QUEST ARROW       ###
+--###       Tracking ARROW    ###
 --###############################
-Renderer3D.gQuestArrow =3D nil
-
-function Renderer3D:ShowQuestArrow( active, x, y )
+Renderer3D.gTrackingArrow =3D nil
+
+function Renderer3D:UpdateTrackingArrow( active, x, y )
 	if (active=3D=3D1) then
-		if (not self.gQuestArrow) then
-			self.gQuestArrow =3D CreateRootGfx3D()
-			self.gQuestArrow:SetSimpleRenderable()
-			self.gQuestArrow:SetMaterial("quest_arrow")
+		if (not self.gTrackingArrow) then
+			self.gTrackingArrow =3D CreateRootGfx3D()
+			self.gTrackingArrow:SetSimpleRenderable()
+			self.gTrackingArrow:SetMaterial("tracking_arrow")
 		end
 =

 		local nx,ny,nz =3D 0,0,1
@@ -527,20 +535,20 @@
 		local a =3D 0.6
 		local e =3D 0.3
 =

-		self.gQuestArrow:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
-		self.gQuestArrow:RenderableVertex(-e,-e,0, nx,ny,nz, 0,0, r,g,b,a)
-		self.gQuestArrow:RenderableVertex( e,-e,0, nx,ny,nz, 1,0, r,g,b,a)
-		self.gQuestArrow:RenderableVertex(-e, e,0, nx,ny,nz, 0,1, r,g,b,a)
-		self.gQuestArrow:RenderableVertex( e, e,0, nx,ny,nz, 1,1, r,g,b,a)
-		self.gQuestArrow:RenderableIndex3(0,1,2)
-		self.gQuestArrow:RenderableIndex3(1,3,2)
-		self.gQuestArrow:RenderableEnd()
-		self.gQuestArrow:SetForceRotCam(GetMainCam())
-		self.gQuestArrow:SetPosition( self:UOPosToLocal(0.5 + x,0.5 + y,0.1 + ( =
iZLoc+30) * 0.1) )
+		self.gTrackingArrow:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
+		self.gTrackingArrow:RenderableVertex(-e,-e,0, nx,ny,nz, 0,0, r,g,b,a)
+		self.gTrackingArrow:RenderableVertex( e,-e,0, nx,ny,nz, 1,0, r,g,b,a)
+		self.gTrackingArrow:RenderableVertex(-e, e,0, nx,ny,nz, 0,1, r,g,b,a)
+		self.gTrackingArrow:RenderableVertex( e, e,0, nx,ny,nz, 1,1, r,g,b,a)
+		self.gTrackingArrow:RenderableIndex3(0,1,2)
+		self.gTrackingArrow:RenderableIndex3(1,3,2)
+		self.gTrackingArrow:RenderableEnd()
+		self.gTrackingArrow:SetForceRotCam(GetMainCam())
+		self.gTrackingArrow:SetPosition( self:UOPosToLocal(0.5 + x,0.5 + y,0.1 +=
 ( iZLoc+30) * 0.1) )
 	else
-		if (self.gQuestArrow) then
-			self.gQuestArrow:Destroy()
-			self.gQuestArrow=3Dnil
+		if (self.gTrackingArrow) then
+			self.gTrackingArrow:Destroy()
+			self.gTrackingArrow=3Dnil
 		end
 	end
 end

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Sat Feb 16 02:07:03 2008
@@ -546,8 +546,6 @@
 	gDebugRootGfx =3D CreateRootGfx3D()
 	gDebugRootGfx2 =3D CreateRootGfx3D()
 	=

-	local xadd,yadd,zadd =3D 0,0,0
-	=

 	-- granny =

 	if (gCurDebugMode =3D=3D kDebugMode_Granny) then
 		local mobile =3D gDebugMenuModelTable[index]
@@ -569,13 +567,13 @@
 		if (gDebugMenuAnimIndex >=3D 0) then gDebugBodyGfx:StartAnimLoop(gDebugM=
enuAnimIndex) end
 	end
 	=

-	=

+	local xadd,yadd,zadd =3D 0,0,0
 	-- static =

 	if (gCurDebugMode =3D=3D kDebugMode_Static) then
 		local iTileType =3D gDebugMenuModelIndex
 		local iHue =3D gDebugMenuAnimIndex
 		local info =3D GetStaticTileType(iTileType)
-		local meshname =3D GetMeshName(iTileType,iHue)
+		local meshname =3D GetMeshName(iTileType, 0)	-- iHue
 		if gDebugLastMeshName then ReloadMesh(gDebugLastMeshName) end
 		gDebugLastMeshName =3D meshname
 		local tricount =3D meshname and CountMeshTriangles(meshname) or 0
@@ -583,8 +581,14 @@
 		if (meshname and meshname ~=3D false) then
 			gDebugRootGfx:SetMesh(meshname)
 			gDebugRootGfx:SetOrientation(GetStaticMeshOrientation(iTileType))
-			gDebugRootGfx:SetScale(-1,1,1)			-- (-1) thats because xmirror bug and =
wrong mirrored mashes
+			gDebugRootGfx:SetScale(-1,1,1)			-- (-1) thats because xmirror bug and =
wrong mirrored meshes
 			gDebugRootGfx:SetNormaliseNormals(true)
+			gDebugRootGfx:SetCastShadows(gDynamicsCastShadows)
+			-- primary color hueing
+			if gHueLoader and iHue > 0 then
+				local r,g,b =3D gHueLoader:GetColor(iHue - 1,31) -- get first color
+				HueMeshEntity(gDebugRootGfx,r,g,b,r,g,b)
+			end
 			-- position adjustment for statics and dynamics
 			xadd =3D FilterPositionX(iTileType) or 0
 			yadd =3D FilterPositionY(iTileType) or 0
@@ -612,10 +616,10 @@
 			local tries =3D 400
 			local add =3D (delta > 0) and 1 or -1
 			newval =3D newval + add
-			local meshname =3D GetMeshName(newval,0)
+			local meshname =3D GetMeshName(newval, 0)
 			while (tries > 0 and ((not meshname) or (CountMeshTriangles(meshname) >=
 6))) do
 				newval =3D newval + add
-				meshname =3D GetMeshName(newval,0)
+				meshname =3D GetMeshName(newval, 0)
 				tries =3D tries - 1
 			end =

 		end

Modified: trunk/lua/lib.keybinds.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.keybinds.lua (original)
+++ trunk/lua/lib.keybinds.lua Sat Feb 16 02:07:03 2008
@@ -33,7 +33,7 @@
 	Bind("up",      function (state) if (not gActiveEditText) then if (state =
> 0) then CancelAutoWalk() end else ChatLine_HistoryUpDown(1) end end)
 	=

 	-------------------------------------------------------------------------=
----------
---[[
+
 	if (true) then
 		Bind("f7",		function (state) if (not gActiveEditText) then if (state > 0=
) then
 			if (gAmbientLight.r < 1.0) then
@@ -60,18 +60,22 @@
 			Client_SetAmbientLight(gAmbientLight.r, gAmbientLight.g, gAmbientLight.=
b, 1)
 	 	end end end)
 		Bind("f9",		function (state) if (not gActiveEditText) then if (state > 0=
) then
-			--local vr =3D OgreAddCompositor(GetMainViewport(), "B&W")
-			Send_AOSCommand(kPacket_AOS_Command_WeaponAbilityRequest,hex2num("0x1")=
,2)
+			if (gCompositor) then
+				print("remove compositor")
+				OgreRemoveCompositor(GetMainViewport(),"B&W")
+				gCompositor =3D false
+			else
+				print("add compositor")
+				OgreAddCompositor(GetMainViewport(), "B&W")
+				gCompositor =3D true
+			end
+			--Send_AOSCommand(kPacket_AOS_Command_WeaponAbilityRequest,hex2num("0x1=
"),2)
 		 end end end)
 	=

 		Bind("f2",		function (state) if (not gActiveEditText) then if (state > 0=
) then =

 			local mobile =3D GetPlayerMobile()
 			if mobile then
 				local effect =3D {}
-				effect.source_locx =3D mobile.xloc
-				effect.source_locy =3D mobile.yloc
-				effect.source_locz =3D mobile.zloc
-		=

 				effect.current_locx =3D mobile.xloc
 				effect.current_locy =3D mobile.yloc
 				effect.current_locz =3D mobile.zloc
@@ -88,6 +92,6 @@
 			end
 		end end end)
 	end
-]]--
+
 =

 end

Modified: trunk/lua/lib.packet.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.packet.lua (original)
+++ trunk/lua/lib.packet.lua Sat Feb 16 02:07:03 2008
@@ -194,7 +194,7 @@
 gPacketType.kPacket_Help_Text										=3D { id=3Dhex2num("0xB7") }
 gPacketType.kPacket_Character_Profile								=3D { id=3Dhex2num("0xB8") }
 gPacketType.kPacket_Features										=3D { id=3Dhex2num("0xB9") }
-gPacketType.kPacket_QuestArrow										=3D { id=3Dhex2num("0xBA") }
+gPacketType.kPacket_TrackingArrow									=3D { id=3Dhex2num("0xBA") }
 gPacketType.kPacket_Account_ID										=3D { id=3Dhex2num("0xBB") }
 gPacketType.kPacket_Game_Season										=3D { id=3Dhex2num("0xBC") }
 gPacketType.kPacket_Client_Version									=3D { id=3Dhex2num("0xBD") }

Modified: trunk/lua/lib.static.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.static.lua (original)
+++ trunk/lua/lib.static.lua Sat Feb 16 02:07:03 2008
@@ -35,7 +35,7 @@
 -- generates or retrieves meshname for static model
 -- TODO : not flexible enough, what if model should be skipped, or multipl=
e models set ? or model depending on surrounding ?
 gLegacyModelCache =3D {}
-function GetMeshName (iTileTypeID,iHue)
+function GetMeshName (iTileTypeID, iHue)
 	-- hue default value is 0
 	iHue =3D tonumber(iHue) or 0
 	--1st: Seasonal Translation
@@ -71,7 +71,8 @@
 		else
 			printdebug("static","mesh already found in cache ",meshname, iHue)
 		end
-
+--[[
+		-- not needed for fastbatch ( it's managed in CreateMapChunkEntity )
 		-- TODO: CLONEMESH & HUEMESH both have a very huge load and should use E=
ntities for Material Hueing !!!!!!!!!!!!!
 		-- Hue this Model | TODO: Partitial Hue is currently skipped
 		if (gHueLoader and meshname) then
@@ -87,6 +88,7 @@
 				return clonemeshname
 			end
 		end
+]]--
 	else
 		printdebug("static","mesh already found in cache ",meshname, iHue)
 	end
@@ -109,6 +111,6 @@
 -- TODO: Wrong !!! hueing must be taken from statics instead of tiledata
 function PreloadAllStaticMesh()
 	for i =3D 0,16085 do
-		GetMeshName(i)
+		GetMeshName(i, 0)
 	end
 end

Modified: trunk/lua/lib.test.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.test.lua (original)
+++ trunk/lua/lib.test.lua Sat Feb 16 02:07:03 2008
@@ -117,12 +117,9 @@
 =

 	local polycount =3D 0
 	for k,obj in pairs(staticAnalysis) do
-		-- obsolete, because Legacy Loader has been removed
-		--polycount =3D gLegacyModelAndTextureLoader:GetMeshPolyCount(obj.typeid)
-
---		print("obj.typeid: "..obj.typeid)
---		local meshname =3D GetMeshName(obj.typeid,0)
---		if (meshname and meshname ~=3D false) then polycount =3D CountMeshTria=
ngles(meshname) end
+		print("obj.typeid: "..obj.typeid)
+		local meshname =3D GetMeshName(obj.typeid,0)
+		if (meshname and meshname ~=3D false) then polycount =3D CountMeshTriang=
les(meshname) end
 		if (polycount < 1) then =

 			print(obj.amount,sprintf("0x%04x",obj.typeid),obj.typeid,obj.typeobj.ms=
Name,polycount)
 		end

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sat Feb 16 02:07:03 2008
@@ -79,7 +79,6 @@
 dofile(libpath .. "lib.cursor.lua")
 dofile(libpath .. "lib.mainmenu.lua")
 dofile(libpath .. "lib.debugmenu.lua")
-dofile(libpath .. "lib.pagedialog.lua")
 dofile(libpath .. "lib.diff.lua")
 dofile(libpath .. "lib.deffileparser.lua")
 dofile(libpath .. "lib.fallback.lua")

Modified: trunk/lua/net/net.effect.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.effect.lua (original)
+++ trunk/lua/net/net.effect.lua Sat Feb 16 02:07:03 2008
@@ -9,29 +9,25 @@
 	effect.targetserial =3D input:PopNetUint32()
 	effect.itemid =3D input:PopNetUint16()
 	=

-	effect.source_locx =3D input:PopNetUint16()
-	effect.source_locy =3D input:PopNetUint16()
-	effect.source_locz =3D input:PopNetUint8()
+	effect.current_locx =3D input:PopNetUint16()
+	effect.current_locy =3D input:PopNetUint16()
+	effect.current_locz =3D input:PopNetUint8()
 	=

 	effect.target_locx =3D input:PopNetUint16()
 	effect.target_locy =3D input:PopNetUint16()
 	effect.target_locz =3D input:PopNetUint8()
 =

-	effect.current_locx =3D effect.source_locx
-	effect.current_locy =3D effect.source_locy
-	effect.current_locz =3D effect.source_locz
-
 	effect.speed =3D input:PopNetUint8()
 	effect.duration =3D input:PopNetUint8()
 	effect.unkown =3D input:PopNetUint16()
-	effect.fixeddirection =3D input:PopNetUint8()
+	effect.fixeddirection =3D input:PopNetUint8()		-- fixed duration ??
 	effect.explodes =3D input:PopNetUint8()
 	effect.hue =3D input:PopNetUint32()
 	effect.rendermode =3D input:PopNetUint32()
-	effect.iseffect =3D true
+	effect.huedeffect =3D true
 	=

 	printdebug("net", sprintf("Hued_FX: artid=3D0x%04x locx=3D%i locy=3D%i lo=
cz=3D%i targetx=3D%i targety=3D%i targetz=3D%i effect_type=3D%s\n",
-			effect.itemid, effect.source_locx, effect.source_locy, effect.source_lo=
cz,
+			effect.itemid, effect.current_locx, effect.current_locy, effect.current=
_locz,
 			effect.target_locx, effect.target_locy, effect.target_locz, gEffectType=
s[effect.effect_type]) )
 	=

 	if (gParticleEffectSystem) then gCurrentRenderer:AddEffect( effect ) end

Modified: trunk/lua/net/net.other.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.other.lua (original)
+++ trunk/lua/net/net.other.lua Sat Feb 16 02:07:03 2008
@@ -9,12 +9,13 @@
 kPacket_Generic_SubCommand_PartySystem			=3D hex2num("0x06")
 kPacket_Generic_SubCommand_QuestArrow			=3D hex2num("0x07")
 kPacket_Generic_SubCommand_MapChange			=3D hex2num("0x08")
-
+kPacket_Generic_SubCommand_DisarmRequest		=3D hex2num("0x09")
 kPacket_Generic_SubCommand_AOSTooltip			=3D hex2num("0x10")
 --(0x0A) Sent by using the client Wrestle Stun Macro key in Options.
 --This is no longer used since AoS was introduced. The Macro selection tha=
t used it was removed.
 kPacket_Generic_SubCommand_Wrestling_Stun		=3D hex2num("0x0A")
 kPacket_Generic_SubCommand_ClientLanguage		=3D hex2num("0x0B")	-- Client s=
ends Client-language to Server
+kPacket_Generic_SubCommand_CloseStatus			=3D hex2num("0x0C")
 kPacket_Generic_SubCommand_3DClientAction		=3D hex2num("0x0E")	-- Client S=
ent. Server responds with Play Animation packets.
 kPacket_Generic_SubCommand_PopupRequest			=3D hex2num("0x13")	-- Client ->=
 Server packet
 kPacket_Generic_SubCommand_DisplayPopup			=3D hex2num("0x14")
@@ -150,6 +151,7 @@
 =

 	-- Quest Arrow (mobile)
 	if (subcmd =3D=3D kPacket_Generic_SubCommand_QuestArrow) then --0x07
+		-- TODO: check ... specification is: byte - Right Click (1=3Dyes, 0=3Dno)
 		for i =3D 0, size-6 do
 			local temp =3D input:PopNetUint8()
 			print("NET (todo): 0xbf Quest_Arrow subcmd 0x07: "..temp)
@@ -160,7 +162,12 @@
 	if (subcmd =3D=3D kPacket_Generic_SubCommand_MapChange) then -- 0x08
 		local mapid =3D input:PopNetUint8()
 		MapChangeRequest(mapid)
-		-- PROBABLY WRONG NOW we index internally with 1, OSi with 0
+	end
+
+	if (subcmd =3D=3D kPacket_Generic_SubCommand_CloseStatus) then	--0x0C
+		local mobilestatus_serial =3D input:PopNetUint8()
+		-- TODO:	=

+		--closemobilestatusgump(mobilestatus_serial)
 	end
 =

 	-- AOSTooltip
@@ -327,17 +334,21 @@
 	end
 end
 =

--- Quest Arrow
--- TODO : show/hide quest arrow	- also look at 0xbf subpacket 0x07
-function gPacketHandler.kPacket_QuestArrow ()	-- 0xba
+-- Tracking Arrow
+function gPacketHandler.kPacket_TrackingArrow ()	-- 0xba
 	local input =3D GetRecvFIFO()
 	local id =3D input:PopNetUint8()
-	local Questarrow_Active =3D input:PopNetUint8()
-	local Questarrow_xloc =3D input:PopNetUint16()
-	local Questarrow_yloc =3D input:PopNetUint16()
-	--printf("NET: Questarrow is ON xLoc=3D0x%04x yLoc=3D0x%04x\n",Questarrow=
_xloc,Questarrow_yloc)
+	local arrow_active =3D input:PopNetUint8()
+	local arrow_xloc =3D input:PopNetUint16()
+	local arrow_yloc =3D input:PopNetUint16()
+
+	printdebug("net",sprintf("NET: Trackingarrow is ON xLoc=3D0x%04x yLoc=3D0=
x%04x\n",arrow_xloc,arrow_yloc))
+
 	-- Update Tracking Symbol
-	gCurrentRenderer:ShowQuestArrow( Questarrow_Active, Questarrow_xloc, Ques=
tarrow_yloc )
+	-- because of renaming, it doesn't work with 2d renderer (renamed from Sh=
owQuestArrow)
+	if (gCurrentRenderer=3D=3DRenderer3D) then
+		gCurrentRenderer:UpdateTrackingArrow( arrow_active, arrow_xloc, arrow_yl=
oc )
+	end
 end
 =

 --[[
@@ -633,7 +644,6 @@
 =

 	for k,v in pairs(newgump) do printdebug("gump",sprintf("newgump.%s =3D ",=
k),v) end
 	=

---	local totaltext =3D ""
 	local textlen =3D 0
 	newgump.textline =3D {}
 	--Index 0 because Serverside Gump Commands use this Index as textline ref=
erences
@@ -643,7 +653,6 @@
 		newgump.textline[i] =3D input:PopUnicodeString(textlen) -- warning, data=
 is sent as unicode, we only interpret the asci part at the moment
 		-- TODO : maybe textlen / 2 ?
 		printdebug("gump",sprintf("newgump.textline[%d](len=3D%d)=3D\n",i,textle=
n),newgump.textline[i])
---		totaltext =3D totaltext .. "\n" .. newgump.textline[i]
 	end
 =

 	GumpParser(newgump)
@@ -700,7 +709,6 @@
 		-- print gumpdata
 		for k,v in pairs(newgump) do printdebug("gump",sprintf("newgump.%s =3D "=
,k),v) end
 		=

---		local totaltext =3D ""
 		local textlen =3D 0
 		newgump.textline =3D {}
 		--Index 0 because Serverside Gump Commands use this Index as textline re=
ferences
@@ -710,7 +718,6 @@
 			newgump.textline[i] =3D decompressed:PopUnicodeString(textlen) -- warni=
ng, data is sent as unicode, we only interpret the asci part at the moment
 			-- TODO : maybe textlen / 2 ?
 			printdebug("gump",sprintf("newgump.textline[%d](len=3D%d)=3D\n",i,textl=
en),newgump.textline[i])
---			totaltext =3D totaltext .. "\n" .. newgump.textline[i]
 		end
 	end
 =

@@ -746,7 +753,7 @@
 function Send_Spell(spellid,expansionflag)
 	if (not(expansionflag)) then expansionflag=3D0 end
 	if (not(spellid)) then
-		--print("no spellid defined")
+		print("no spellid defined")
 		return
 	end
 --	printf("NET: Send_SpellSelected : spellid=3D%d\n",spellid)

Modified: trunk/vs8/iris.sln
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.sln (original)
+++ trunk/vs8/iris.sln Sat Feb 16 02:07:03 2008
@@ -3,6 +3,7 @@
 # Visual C++ Express 2005
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "iris", "iris.vcproj=
", "{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}"
 	ProjectSection(ProjectDependencies) =3D postProject
+		{5A02700F-C389-4E19-AF35-C4C893E72A64} =3D {5A02700F-C389-4E19-AF35-C4C8=
93E72A64}
 		{FF3B6490-D65F-7B41-982B-8D8339958224} =3D {FF3B6490-D65F-7B41-982B-8D83=
39958224}
 	EndProjectSection
 EndProject

Modified: trunk/vs8/iris.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.vcproj (original)
+++ trunk/vs8/iris.vcproj Sat Feb 16 02:07:03 2008
@@ -39,7 +39,7 @@
 				Name=3D"VCCLCompilerTool"
 				Optimization=3D"0"
 				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;C:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS&quot;;..\include;..\include\lua;..\include\=
zlib;..\include\fmodx;..\lugre\include;&quot;..\lugre\lib\lua-5.0.3\include=
&quot;;..\lugre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\l=
ib\caelum\include;E:\_Iris\_Iris_Ogre\lugre\lib\paged_geometry\include\;..\=
lugre\lib\paged_geometry\include"
-				PreprocessorDefinitions=3D"WIN32;_DEBUG;USE_FMOD;MAIN_WORKING_DIR=3D\&=
quot;../\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CAELUM"
+				PreprocessorDefinitions=3D"WIN32;_DEBUG;USE_FMOD;MAIN_WORKING_DIR=3D\&=
quot;../\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CAELUM;OGRE_DEBUG_MEMORY_MA=
NAGER"
 				RuntimeLibrary=3D"1"
 				RuntimeTypeInfo=3D"false"
 				AssemblerOutput=3D"2"
@@ -98,6 +98,7 @@
 			IntermediateDirectory=3D"$(ConfigurationName)"
 			ConfigurationType=3D"1"
 			UseOfMFC=3D"0"
+			CharacterSet=3D"2"
 			WholeProgramOptimization=3D"1"
 			>
 			<Tool
@@ -119,21 +120,24 @@
 				Name=3D"VCCLCompilerTool"
 				UseUnicodeResponseFiles=3D"false"
 				Optimization=3D"4"
-				InlineFunctionExpansion=3D"2"
+				InlineFunctionExpansion=3D"1"
 				EnableIntrinsicFunctions=3D"true"
 				FavorSizeOrSpeed=3D"1"
 				OmitFramePointers=3D"true"
 				EnableFiberSafeOptimizations=3D"false"
 				WholeProgramOptimization=3D"true"
-				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;c:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\include\zlib;..\lugre=
\include;..\include\fmodx;&quot;..\lugre\lib\lua-5.0.3\include\&quot;;..\lu=
gre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\lib\paged_geo=
metry\include;..\lugre\lib\caelum\include"
-				PreprocessorDefinitions=3D"WIN32;USE_FMOD;MAIN_WORKING_DIR=3D\&quot;..=
/\&quot;;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CADUNE_TREE;USE_LUGRE_LIB_PAGED_GE=
OMETRY;USE_LUGRE_LIB_CAELUM"
+				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;c:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\include\zlib;..\lugre=
\include;..\include\fmodx;&quot;..\lugre\lib\lua-5.0.3\include\&quot;;..\lu=
gre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\lib\paged_geo=
metry\include;..\lugre\lib\caelum\include;c:\Programme\boost\boost_1_34_1\"
+				PreprocessorDefinitions=3D"WIN32;NDEBUG;_WINDOWS;MAIN_WORKING_DIR=3D\&=
quot;../\&quot;;USE_FMOD;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CADUNE_TREE;USE_LU=
GRE_LIB_CAELUM;USE_LUGRE_LIB_PAGED_GEOMETRY"
 				GeneratePreprocessedFile=3D"0"
+				StringPooling=3D"true"
 				RuntimeLibrary=3D"0"
+				EnableFunctionLevelLinking=3D"true"
 				EnableEnhancedInstructionSet=3D"1"
 				FloatingPointModel=3D"0"
-				RuntimeTypeInfo=3D"false"
+				RuntimeTypeInfo=3D"true"
+				WarningLevel=3D"1"
 				Detect64BitPortabilityProblems=3D"true"
-				DebugInformationFormat=3D"0"
+				DebugInformationFormat=3D"3"
 			/>
 			<Tool
 				Name=3D"VCManagedResourceCompilerTool"
@@ -147,23 +151,30 @@
 			/>
 			<Tool
 				Name=3D"VCLinkerTool"
-				AdditionalDependencies=3D"LIBCMT.lib LIBCPMT.LIB AdvAPI32.Lib User32.L=
ib zlib.lib ws2_32.lib lua50.lib OgreMain.lib OIS.lib fmodex_vc.lib pagedge=
ometry_lib.lib"
+				AdditionalDependencies=3D"AdvAPI32.Lib User32.Lib ws2_32.lib zlib.lib =
OgreMain.lib OIS.lib lua50.lib fmodex_vc.lib pagedgeometry_lib.lib"
 				OutputFile=3D"$(OutDir)\..\..\bin\iris2.exe"
-				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\c=
aelum\lib\static;..\lugre\lib\paged_geometry\lib\static"
+				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\c=
aelum\lib\static;..\lugre\lib\paged_geometry\lib\static;c:\Programme\boost\=
boost_1_34_1\lib"
 				GenerateManifest=3D"true"
-				IgnoreAllDefaultLibraries=3D"true"
-				IgnoreDefaultLibraryNames=3D""
+				IgnoreAllDefaultLibraries=3D"false"
+				IgnoreDefaultLibraryNames=3D"LIBCMT.lib"
 				ModuleDefinitionFile=3D""
 				DelayLoadDLLs=3D""
+				SubSystem=3D"1"
 				LargeAddressAware=3D"0"
 				TerminalServerAware=3D"0"
+				OptimizeReferences=3D"2"
+				EnableCOMDATFolding=3D"2"
+				OptimizeForWindows98=3D"1"
 				SetChecksum=3D"true"
+				TargetMachine=3D"1"
+				FixedBaseAddress=3D"1"
 			/>
 			<Tool
 				Name=3D"VCALinkTool"
 			/>
 			<Tool
 				Name=3D"VCManifestTool"
+				UseFAT32Workaround=3D"true"
 			/>
 			<Tool
 				Name=3D"VCXDCMakeTool"



From no-reply at zwischenwelt.org  Sat Feb 16 02:17:48 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 01:17:48 -0000
Subject: [Iris-commit] [IRIS] r1909 - in /rawdata/sd_pd: houseparts.blend
 tex_lantern.png tex_lantern.xcf tex_slidingdoor.xcf
Message-ID: <20080216011749.082461C181DB@zwischenwelt.org>

Author: hagish
Date: Sat Feb 16 02:17:47 2008
New Revision: 1909

Log:
raw data update

Added:
    rawdata/sd_pd/tex_lantern.png   (with props)
    rawdata/sd_pd/tex_lantern.xcf   (with props)
    rawdata/sd_pd/tex_slidingdoor.xcf   (with props)
Modified:
    rawdata/sd_pd/houseparts.blend

Modified: rawdata/sd_pd/houseparts.blend
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Feb 16 02:19:17 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 01:19:17 -0000
Subject: [Iris-commit] [IRIS] r1910 - in /trunk: data/models/atlas/
 data/models/materials/ data/models/models/to_010000/ data/models/textures/
 lua/
Message-ID: <20080216011917.959461524004@zwischenwelt.org>

Author: hagish
Date: Sat Feb 16 02:19:16 2008
New Revision: 1910

Log:
add model paper lantern, texatlas update

Added:
    trunk/data/models/models/to_010000/mdl_009411.mesh   (with props)
    trunk/data/models/textures/tex_lantern.png   (with props)
Modified:
    trunk/data/models/atlas/tex_atlas_alpha_low.lua
    trunk/data/models/atlas/tex_atlas_alpha_low0.png
    trunk/data/models/atlas/tex_atlas_alpha_med.lua
    trunk/data/models/atlas/tex_atlas_alpha_med.material
    trunk/data/models/atlas/tex_atlas_alpha_med1.png
    trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua
    trunk/data/models/atlas/tex_atlas_alpha_ultralow0.png
    trunk/data/models/atlas/tex_atlas_med.material
    trunk/data/models/materials/textures.material
    trunk/lua/lib.debugmenu.lua

Modified: trunk/data/models/atlas/tex_atlas_alpha_low.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_low.lua (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_low.lua Sat Feb 16 02:19:16 2008
@@ -140,6 +140,9 @@
 TexAtlas_RegisterMatTransform('tex_2481', 'tex_atlas_alpha_low0', 0.816406=
25,0.49609375,0.87890625,0.55859375)
 TexAtlas_RegisterMatTransform('tex_grass', 'tex_atlas_alpha_low0', 0.88671=
875,0.49609375,0.94921875,0.55859375)
 TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_alpha_low0', 0.00=
390625,0.56640625,0.06640625,0.62890625)
+TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_alpha_low0', 0.0=
7421875,0.56640625,0.13671875,0.62890625)
+TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_alpha_low0', 0=
.14453125,0.56640625,0.20703125,0.62890625)
+TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_alpha_low0', 0.214=
84375,0.56640625,0.27734375,0.62890625)
 TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_low0', 0.0039062=
5,0.63671875,0.06640625,0.66796875)
 TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_low0', 0.0742187=
5,0.63671875,0.13671875,0.66796875)
 TexAtlas_RegisterMatTransform('tex_155', 'tex_atlas_alpha_low0', 0.1445312=
5,0.63671875,0.20703125,0.66796875)

Modified: trunk/data/models/atlas/tex_atlas_alpha_low0.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_alpha_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_med.lua (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_med.lua Sat Feb 16 02:19:16 2008
@@ -109,6 +109,9 @@
 TexAtlas_RegisterMatTransform('tex_2481', 'tex_atlas_alpha_med1', 0.130859=
375,0.392578125,0.255859375,0.517578125)
 TexAtlas_RegisterMatTransform('tex_grass', 'tex_atlas_alpha_med1', 0.25976=
5625,0.392578125,0.384765625,0.517578125)
 TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_alpha_med1', 0.38=
8671875,0.392578125,0.513671875,0.517578125)
+TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_alpha_med1', 0.5=
17578125,0.392578125,0.642578125,0.517578125)
+TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_alpha_med1', 0=
.646484375,0.392578125,0.771484375,0.517578125)
+TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_alpha_med1', 0.775=
390625,0.392578125,0.900390625,0.517578125)
 TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_med1', 0.0019531=
25,0.521484375,0.126953125,0.583984375)
 TexAtlas_RegisterMatTransform('tex_531', 'tex_atlas_alpha_med1', 0.1308593=
75,0.521484375,0.193359375,0.583984375)
 TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_med1', 0.1972656=
25,0.521484375,0.322265625,0.583984375)

Modified: trunk/data/models/atlas/tex_atlas_alpha_med.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_med.material (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_med.material Sat Feb 16 02:19:1=
6 2008
@@ -6,7 +6,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_alpha_med0.dds =

+				texture tex_atlas_alpha_med0.png =

 			}	=

 		}
 	} =

@@ -19,7 +19,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_alpha_med1.dds =

+				texture tex_atlas_alpha_med1.png =

 			}	=

 		}
 	} =


Modified: trunk/data/models/atlas/tex_atlas_alpha_med1.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua Sat Feb 16 02:19:1=
6 2008
@@ -140,6 +140,9 @@
 TexAtlas_RegisterMatTransform('tex_2481', 'tex_atlas_alpha_ultralow0', 0.4=
296875,0.2421875,0.4609375,0.2734375)
 TexAtlas_RegisterMatTransform('tex_grass', 'tex_atlas_alpha_ultralow0', 0.=
4765625,0.2421875,0.5078125,0.2734375)
 TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_alpha_ultralow0',=
 0.5234375,0.2421875,0.5546875,0.2734375)
+TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_alpha_ultralow0'=
, 0.5703125,0.2421875,0.6015625,0.2734375)
+TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_alpha_ultralow=
0', 0.6171875,0.2421875,0.6484375,0.2734375)
+TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_alpha_ultralow0', =
0.6640625,0.2421875,0.6953125,0.2734375)
 TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_ultralow0', 0.00=
78125,0.2890625,0.0390625,0.3046875)
 TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_ultralow0', 0.05=
46875,0.2890625,0.0859375,0.3046875)
 TexAtlas_RegisterMatTransform('tex_155', 'tex_atlas_alpha_ultralow0', 0.10=
15625,0.2890625,0.1328125,0.3046875)

Modified: trunk/data/models/atlas/tex_atlas_alpha_ultralow0.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_med.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_med.material (original)
+++ trunk/data/models/atlas/tex_atlas_med.material Sat Feb 16 02:19:16 2008
@@ -6,7 +6,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med0.dds =

+				texture tex_atlas_med0.png =

 			}	=

 		}
 	} =

@@ -19,7 +19,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med1.dds =

+				texture tex_atlas_med1.png =

 			}	=

 		}
 	} =

@@ -32,7 +32,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med2.dds =

+				texture tex_atlas_med2.png =

 			}	=

 		}
 	} =

@@ -45,7 +45,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med3.dds =

+				texture tex_atlas_med3.png =

 			}	=

 		}
 	} =

@@ -58,7 +58,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med4.dds =

+				texture tex_atlas_med4.png =

 			}	=

 		}
 	} =


Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Feb 16 02:19:16 2008
@@ -8273,3 +8273,16 @@
 	} =

 }
 =

+material tex_lantern : tex_base
+{ =

+	technique =

+	{ =

+		pass =

+		{		=

+			texture_unit =

+			{ =

+				texture tex_lantern.png =

+			}	=

+		}
+	} =

+}

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Sat Feb 16 02:19:16 2008
@@ -630,6 +630,9 @@
 end
 =

 function StartDebugMenu ()
+	-- dont show fallback boxes in debug mode
+	gUseWhiteBoxAsFallBack =3D false
+
 	-- parse command line args
 	if gCommandLineSwitches["-artid"] then
 		local id =3D gCommandLineArguments[gCommandLineSwitches["-artid"]+1]



From no-reply at zwischenwelt.org  Sat Feb 16 04:30:52 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 03:30:52 -0000
Subject: [Iris-commit] [IRIS] r1911 - in /trunk: bin/iris2.exe
 lua/lib.3d.dynamic.lua lua/lib.3d.map.lua
Message-ID: <20080216033053.385A61C1874A@zwischenwelt.org>

Author: sience
Date: Sat Feb 16 04:30:52 2008
New Revision: 1911

Log:
-new binary
-temp. bugfix for dynamics (i have to debug this bug ;)

Modified:
    trunk/bin/iris2.exe
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.map.lua

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sat Feb 16 04:30:52 2008
@@ -173,7 +173,6 @@
 					-- add part
 					table.insert(multi.lparts, {iTileTypeID,iX,iY,iZ,iHue})
 					Renderer3D:RebuildChunkAtUOPos(iX,iY)
-					--print("DEBUG",iTileTypeID,iX,iY,iZ,iHue)
 				end
 			end
 			=

@@ -186,6 +185,59 @@
 			printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed loadi=
ng mesh for dynamic (multi): artid=3D%i z_typename=3D%s\n",item.artid or -1=
,GetStaticTileTypeName(item.artid) or ""))
 		end
 	else
+
+		-- normal 1 part object
+		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid) -- ,item.hue)
+		item.meshname =3D meshname
+		-- print("DEBUG","meshname",item.meshname)
+		=

+		if gFastBatchDynamics and meshname and meshname ~=3D false then
+			-- trigger: burn all dynamics into the dynamic fastbatch
+			item.meshbuffer =3D GetMeshBuffer(meshname) -- for mousepicking
+			TexAtlas_AdjustMeshBufferIfNeeded(meshname,item.meshbuffer)
+			Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
+		else
+			-- just add the dynamic as a scene node
+			item.gfx =3D CreateRootGfx3D()
+			if (meshname and meshname ~=3D false) then
+				item.gfx:SetMesh(meshname)
+				item.gfx:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong=
 mirrored mashes
+				item.gfx:SetNormaliseNormals(true)
+				item.gfx:SetCastShadows(gDynamicsCastShadows)
+				-- primary color hueing
+				if gHueLoader and item.hue > 0 then
+					local r,g,b =3D gHueLoader:GetColor(item.hue - 1,31) -- get first col=
or
+					HueMeshEntity(item.gfx,r,g,b,r,g,b)
+				end
+			elseif (gEnableFallBackBillboards_Dynamics) then
+				local iTranslatedTileTypeID =3D SeasonalStaticTranslation(item.artid, =
gSeasonSetting)
+				-- we have to add 16384 for fallbacks, because static Art starts on 16=
384 in Art.mul file
+				iTranslatedTileTypeID =3D iTranslatedTileTypeID + 16384
+
+				-- fallback to billboard with original art
+				if (not IsArtBillboardFallBackSkipped(item.artid)) then
+					-- generate uoart billboard fallback
+					item.gfx.billboard =3D item.gfx:CreateChild()
+					item.xadd =3D item.xadd + 0.5
+					item.yadd =3D item.yadd + 0.5
+					item.zadd =3D item.zadd + 0.5
+					self:CreateArtBillBoard(item.gfx.billboard,iTranslatedTileTypeID,item=
.hue)
+					printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed loa=
ding mesh for dynamic: artid=3D%i z_typename=3D%s\n",item.artid or -1,GetSt=
aticTileTypeName(item.artid) or ""))
+				end
+			end
+
+			item.gfx:SetRenderingDistance(self.gDynamicMaxRenderDist)
+
+			-- FILTER: correction
+			item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
+
+			self:UpdateDynamicItemPos(item)
+
+		end
+	end
+	self:UpdateDynamicVisibility(item)
+
+--[[
 		-- normal 1 part object
 		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid, 0)
 		item.meshname =3D meshname
@@ -214,15 +266,16 @@
 			-- updates the layer-visibility
 			self:UpdateDynamicVisibility(item)
 		elseif (gEnableFallBackBillboards_Dynamics) then
+			local iTranslatedTileTypeID =3D SeasonalStaticTranslation(item.artid, g=
SeasonSetting)
 			-- fallback to billboard with original art
-			if (not IsArtBillboardFallBackSkipped(item.artid)) then
+			if (not IsArtBillboardFallBackSkipped(iTranslatedTileTypeID)) then
 				item.gfx =3D CreateRootGfx3D()
 				item.gfx.billboard =3D item.gfx:CreateChild()
 				item.xadd =3D item.xadd + 0.5
 				item.yadd =3D item.yadd + 0.5
 				item.zadd =3D item.zadd + 0.5
-				self:CreateArtBillBoard(item.gfx.billboard,item.artid + 16384,item.hue)
-				printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed load=
ing mesh for dynamic: artid=3D%i z_typename=3D%s\n",item.artid or -1,GetSta=
ticTileTypeName(item.artid) or ""))
+				self:CreateArtBillBoard(item.gfx.billboard,iTranslatedTileTypeID + 163=
84,item.hue)
+				printdebug("missing",sprintf("Fallback: Dynamic Billboard created : iT=
ranslatedTileTypeID=3D%i\n", iTranslatedTileTypeID))
 				item.gfx:SetRenderingDistance(self.gDynamicMaxRenderDist)
 				-- set's position and add's xadd,yadd,zadd corrections
 				self:UpdateDynamicItemPos(item)
@@ -233,6 +286,7 @@
 			print("no mesh found & no billboard used for this artID=3D"..item.artid)
 		end
 	end
+]]--
 =

 	-- creates a light if lights are enabled and static is a lightsource
 	-- note! lights don't cast shadows

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sat Feb 16 04:30:52 2008
@@ -342,15 +342,15 @@
 	-- What about cahing here ??
 	elseif (gEnableFallBackBillboards_Statics) then
 		local iTranslatedTileTypeID =3D SeasonalStaticTranslation(iTileTypeID, g=
SeasonSetting)
-		if (not IsArtBillboardFallBackSkipped(iTileTypeID)) then
+		if (not IsArtBillboardFallBackSkipped(iTranslatedTileTypeID)) then
 			entity.x,entity.y,entity.z =3D self:UOPosToLocal(entity.xloc+0.5,entity=
.yloc+0.5,entity.zloc*0.1 + 0.5)
 			entity.gfx =3D CreateRootGfx3D()
 			entity.gfx:SetPosition(entity.x,entity.y,entity.z)
 			entity.gfx.billboard =3D entity.gfx:CreateChild()
 			-- we have to add 16384 for fallbacks
-			self:CreateArtBillBoard(entity.gfx.billboard,iTranslatedTileTypeID + 16=
384,iHue)
+			self:CreateArtBillBoard(entity.gfx.billboard,iTranslatedTileTypeID + 16=
384,entity.iHue)
 			table.insert(chunk.lStaticEntities,entity)
-			printdebug("missing",sprintf("Fallback: Billboard created : iTranslated=
TileTypeID=3D%i\n", iTranslatedTileTypeID))
+			printdebug("missing",sprintf("Fallback: Static Billboard created : iTra=
nslatedTileTypeID=3D%i\n", iTranslatedTileTypeID))
 		end
 	end
 =




From no-reply at zwischenwelt.org  Sat Feb 16 12:21:15 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 11:21:15 -0000
Subject: [Iris-commit] [IRIS] r1912 - in /trunk/data/models:
 materials/textures.material models/to_004000/mdl_003203.mesh
 models/to_004000/mdl_003204.mesh textures/tex_flowers.png
Message-ID: <20080216112115.2DE041C186F4@zwischenwelt.org>

Author: hagish
Date: Sat Feb 16 12:21:14 2008
New Revision: 1912

Log:
added two flower models

Added:
    trunk/data/models/models/to_004000/mdl_003203.mesh   (with props)
    trunk/data/models/models/to_004000/mdl_003204.mesh   (with props)
    trunk/data/models/textures/tex_flowers.png   (with props)
Modified:
    trunk/data/models/materials/textures.material

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Feb 16 12:21:14 2008
@@ -8286,3 +8286,17 @@
 		}
 	} =

 }
+
+material tex_flowers : tex_base_alpha
+{ =

+	technique =

+	{ =

+		pass =

+		{		=

+			texture_unit =

+			{ =

+				texture tex_flowers.png =

+			}	=

+		}
+	} =

+}



From no-reply at zwischenwelt.org  Sat Feb 16 14:15:36 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 13:15:36 -0000
Subject: [Iris-commit] [IRIS] r1913 - in /trunk/lua: lib.3d.dynamic.lua
	lib.3d.mousepick.lua
Message-ID: <20080216131537.7D0ED1C1874A@zwischenwelt.org>

Author: sience
Date: Sat Feb 16 14:15:32 2008
New Revision: 1913

Log:
-bugfix (during mousepicking, skippedfallbacks now skipped)

Modified:
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.mousepick.lua

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sat Feb 16 14:15:32 2008
@@ -185,72 +185,21 @@
 			printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed loadi=
ng mesh for dynamic (multi): artid=3D%i z_typename=3D%s\n",item.artid or -1=
,GetStaticTileTypeName(item.artid) or ""))
 		end
 	else
-
 		-- normal 1 part object
-		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid) -- ,item.hue)
-		item.meshname =3D meshname
-		-- print("DEBUG","meshname",item.meshname)
-		=

-		if gFastBatchDynamics and meshname and meshname ~=3D false then
+		item.meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNam=
e(item.artid, 0)
+
+		-- Fastbatch rendering
+		if (gFastBatchDynamics and item.meshname and item.meshname ~=3D false) t=
hen
 			-- trigger: burn all dynamics into the dynamic fastbatch
-			item.meshbuffer =3D GetMeshBuffer(meshname) -- for mousepicking
-			TexAtlas_AdjustMeshBufferIfNeeded(meshname,item.meshbuffer)
+			item.meshbuffer =3D GetMeshBuffer(item.meshname) -- for mousepicking
+			TexAtlas_AdjustMeshBufferIfNeeded(item.meshname,item.meshbuffer)
 			Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
-		else
+
+		-- Old rendering method
+		elseif (not(gFastBatchDynamics) and item.meshname and item.meshname ~=3D=
 false) then
 			-- just add the dynamic as a scene node
 			item.gfx =3D CreateRootGfx3D()
-			if (meshname and meshname ~=3D false) then
-				item.gfx:SetMesh(meshname)
-				item.gfx:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong=
 mirrored mashes
-				item.gfx:SetNormaliseNormals(true)
-				item.gfx:SetCastShadows(gDynamicsCastShadows)
-				-- primary color hueing
-				if gHueLoader and item.hue > 0 then
-					local r,g,b =3D gHueLoader:GetColor(item.hue - 1,31) -- get first col=
or
-					HueMeshEntity(item.gfx,r,g,b,r,g,b)
-				end
-			elseif (gEnableFallBackBillboards_Dynamics) then
-				local iTranslatedTileTypeID =3D SeasonalStaticTranslation(item.artid, =
gSeasonSetting)
-				-- we have to add 16384 for fallbacks, because static Art starts on 16=
384 in Art.mul file
-				iTranslatedTileTypeID =3D iTranslatedTileTypeID + 16384
-
-				-- fallback to billboard with original art
-				if (not IsArtBillboardFallBackSkipped(item.artid)) then
-					-- generate uoart billboard fallback
-					item.gfx.billboard =3D item.gfx:CreateChild()
-					item.xadd =3D item.xadd + 0.5
-					item.yadd =3D item.yadd + 0.5
-					item.zadd =3D item.zadd + 0.5
-					self:CreateArtBillBoard(item.gfx.billboard,iTranslatedTileTypeID,item=
.hue)
-					printdebug("missing",sprintf("Renderer3D:CreateDynamicGfx: failed loa=
ding mesh for dynamic: artid=3D%i z_typename=3D%s\n",item.artid or -1,GetSt=
aticTileTypeName(item.artid) or ""))
-				end
-			end
-
-			item.gfx:SetRenderingDistance(self.gDynamicMaxRenderDist)
-
-			-- FILTER: correction
-			item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
-
-			self:UpdateDynamicItemPos(item)
-
-		end
-	end
-	self:UpdateDynamicVisibility(item)
-
---[[
-		-- normal 1 part object
-		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid, 0)
-		item.meshname =3D meshname
-		=

-		if (gFastBatchDynamics and meshname and meshname ~=3D false) then
-			-- trigger: burn all dynamics into the dynamic fastbatch
-			item.meshbuffer =3D GetMeshBuffer(meshname) -- for mousepicking
-			TexAtlas_AdjustMeshBufferIfNeeded(meshname,item.meshbuffer)
-			Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
-		elseif (meshname and meshname ~=3D false) then
-			-- just add the dynamic as a scene node
-			item.gfx =3D CreateRootGfx3D()
-			item.gfx:SetMesh(meshname)
+			item.gfx:SetMesh(item.meshname)
 			item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
 			item.gfx:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong =
mirrored meshes
 			item.gfx:SetNormaliseNormals(true)
@@ -265,6 +214,8 @@
 			self:UpdateDynamicItemPos(item)
 			-- updates the layer-visibility
 			self:UpdateDynamicVisibility(item)
+		=

+		-- Fallback billboard rendering
 		elseif (gEnableFallBackBillboards_Dynamics) then
 			local iTranslatedTileTypeID =3D SeasonalStaticTranslation(item.artid, g=
SeasonSetting)
 			-- fallback to billboard with original art
@@ -283,20 +234,19 @@
 				self:UpdateDynamicVisibility(item)
 			end
 		else
-			print("no mesh found & no billboard used for this artID=3D"..item.artid)
-		end
-	end
-]]--
+			print("no mesh found & no dynamic billboard used for this artID=3D"..it=
em.artid, item.meshname)
+		end
+	end
 =

 	-- creates a light if lights are enabled and static is a lightsource
 	-- note! lights don't cast shadows
---	if (gLightsources) then
---		local arrtiletype =3D GetStaticTileType(item.artid)
---		if( arrtiletype and TestBit(arrtiletype.miFlags or 0,kTileDataFlag_Lig=
htSource) ) then
---			local x,y,z =3D Renderer3D:UOPosToLocal(item.xloc,item.yloc,(item.zlo=
c+arrtiletype.miHeight) * 0.1)
---			item.lightname=3DClient_AddPointLight(x,y,z, 0.3,0.3,0.0, 0.3,0.3,0.0=
, 5.0,0.1,0.1,0.0)
---		end
---	end
+	if (gLightsources) then
+		local arrtiletype =3D GetStaticTileType(item.artid)
+		if( arrtiletype and TestBit(arrtiletype.miFlags or 0,kTileDataFlag_Light=
Source) ) then
+			local x,y,z =3D Renderer3D:UOPosToLocal(item.xloc,item.yloc,(item.zloc+=
arrtiletype.miHeight) * 0.1)
+			item.lightname=3DClient_AddPointLight(x,y,z, 0.3,0.3,0.0, 0.3,0.3,0.0, =
5.0,0.1,0.1,0.0)
+		end
+	end
 end
 =

 function Renderer3D:CreateArtBillBoard( gfx, iArtID, iHue )

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Sat Feb 16 14:15:32 2008
@@ -196,8 +196,8 @@
 	=

 	-- dynamics
 	for k,dynamic in pairs(GetDynamicList()) do
-		-- if Dynamic is in World (not Container) and if it's not an Multis
-		if (DynamicIsInWorld(dynamic) and (dynamic.artid < gMulti_ID)) then
+		-- if Dynamic is in World (if it's not an Container) & if it's not an Mu=
lti & if it's not a skipped Fallback (multitile mesh)
+		if (DynamicIsInWorld(dynamic) and (dynamic.artid < gMulti_ID) and not(Is=
ArtBillboardFallBackSkipped(dynamic.artid))) then
 			-- WARNING copy & paste code
 			if (self:IsZLayerVisible(dynamic.zloc)) then
 				if (dynamic.gfx and dynamic.gfx.billboard) then
@@ -206,7 +206,7 @@
 					fHitDist =3D SphereRayPick(x,y,z,0.5,rx,ry,rz,rvx,rvy,rvz) -- 0.5 rad
 					bHit =3D (fHitDist ~=3D nil)
 				elseif ( dynamic.meshbuffer ) then
-					-- mesh mousepick
+						-- mesh mousepick
 						local x,y,z =3D Renderer3D:UOPosToLocal (dynamic.xloc,dynamic.yloc,d=
ynamic.zloc * 0.1) =

 						local qw,qx,qy,qz =3D GetStaticMeshOrientation(dynamic.artid)
 						=

@@ -215,9 +215,8 @@
 				elseif ( dynamic.gfx ) then
 					bHit,fHitDist =3D dynamic.gfx:RayPick(rx,ry,rz,rvx,rvy,rvz)
 				else
-					print("WARNING visible but no mousepicking possible on dynamic",dynam=
ic.artid)
 					local name =3D GetStaticTileTypeName(dynamic.artid)
-					print(name or "can't find Tiletypename for this ArtID (shure it's no =
multi or it's in tiledata.mul?)")
+					print("WARNING visible but no mousepicking possible on dynamic",dynam=
ic.artid, name)
 				end
 				=

 				if (bHit and ((not gMousePickFoundHit) or fHitDist < self.gMousePickFo=
undDist)) then



From no-reply at zwischenwelt.org  Sat Feb 16 16:06:52 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 15:06:52 -0000
Subject: [Iris-commit] [IRIS] r1914 - /trunk/lua/lib.gumpparser.lua
Message-ID: <20080216150654.17CAE1C1874A@zwischenwelt.org>

Author: sience
Date: Sat Feb 16 16:06:52 2008
New Revision: 1914

Log:
-small addition to htmlgumpparser

Modified:
    trunk/lua/lib.gumpparser.lua

Modified: trunk/lua/lib.gumpparser.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gumpparser.lua (original)
+++ trunk/lua/lib.gumpparser.lua Sat Feb 16 16:06:52 2008
@@ -496,6 +496,8 @@
 			msg.center =3D true
 		elseif (command =3D=3D "b") then
 			msg.bold =3D true
+		elseif (command =3D=3D "big") then
+			msg.bold =3D true
 		elseif (command =3D=3D "u") then
 			msg.underline =3D true
 		elseif (command =3D=3D "i") then



From no-reply at zwischenwelt.org  Sat Feb 16 19:48:39 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 18:48:39 -0000
Subject: [Iris-commit] [IRIS] r1915 - in /trunk/lua: lib.speech.lua
 lib.uoids.lua main.lua net/net.other.lua
Message-ID: <20080216184840.9C7B11C186F1@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Feb 16 19:48:38 2008
New Revision: 1915

Log:
fixed speech.mul code, now works with boat and animal commands

Modified:
    trunk/lua/lib.speech.lua
    trunk/lua/lib.uoids.lua
    trunk/lua/main.lua
    trunk/lua/net/net.other.lua

Modified: trunk/lua/lib.speech.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.speech.lua (original)
+++ trunk/lua/lib.speech.lua Sat Feb 16 19:48:38 2008
@@ -1,25 +1,30 @@
 -- speech.mul loader
 -- Keywords detected from client-chat, converted back to index id and send=
 to server
--- see also http://doc.wpdev.org/formats/speech.html
+-- see also http://doc.wpdev.org/formats/speech.html (dead link)...
 =

-function GetSpeechID (text)
-	local speechids =3D {}
 =

---	for k,v in pairs(gSpeechLoader[1]) do
---		print(v.text)
---	end
---[[
-	for wort in string.gfind(text, "%a+") do
-		print("word v",wort)
-		for i=3D1, table.getn(gSpeechLoader) do
-			if (gSpeechLoader[i]=3D=3Dv) then
-				speechids[k] =3D i
-				print("hit found=3D"..i.." name=3D"..speechids[i])
+function SpeechParseKeywords (ascistr) -- used by Send_UnicodeSpeech kPack=
et_Speech_Unicode 0xAD
+	if (not gSpeechLoader) then return {} end
+	local speechlistbypos =3D {}
+	for speechid,speechentrylist in pairs(gSpeechLoader) do
+		local found_for_this_speechid =3D false
+		for languageid,speechentry in pairs(speechentrylist) do
+			if (not found_for_this_speechid) then
+				local keyword =3D speechentry.text
+				local startpos =3D string.find(ascistr,keyword,0,true)
+				if (startpos) then =

+					print("SpeechParseKeywords:found keyword",keyword,startpos,speechid)
+					table.insert(speechlistbypos,{ startpos=3Dstartpos, speechid=3Dspeech=
id, keyword=3Dkeyword })
+					found_for_this_speechid =3D true
+				end
 			end
 		end
 	end
-]]--
-	return speechids
+	=

+	table.sort(speechlistbypos,function (a,b) return a.startpos < b.startpos =
end)
+	local speechlist =3D {}
+	for k,v in pairs(speechlistbypos) do table.insert(speechlist,v.speechid) =
end
+	return speechlist
 end
 =

 function CreateSpeechLoader(loadertype,base_file,bWarnOnMissingFile)

Modified: trunk/lua/lib.uoids.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.uoids.lua (original)
+++ trunk/lua/lib.uoids.lua Sat Feb 16 19:48:38 2008
@@ -247,6 +247,18 @@
 gCharCreateSkillIDs["Ninjitsu"]					=3D 53
 gCharCreateSkillIDs["Spellweaving"]				=3D 54
 =

+
+kMessageType =3D {}
+kMessageType.Regular	=3D hex2num("0x00")
+kMessageType.System		=3D hex2num("0x01")
+kMessageType.Emote		=3D hex2num("0x02")
+kMessageType.Label		=3D hex2num("0x06")
+kMessageType.Focus		=3D hex2num("0x07")
+kMessageType.Whisper	=3D hex2num("0x08")
+kMessageType.Yell		=3D hex2num("0x09")
+kMessageType.Spell		=3D hex2num("0x0A")
+kMessageType.Encoded	=3D hex2num("0xC0")
+
 -- skill ids and stuff
 glSkillNames =3D {	=

 	[1] 	=3D "Alchemy",

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sat Feb 16 19:48:38 2008
@@ -311,7 +311,7 @@
 =

 	NotifyListener("Hook_PreLoad")
 	PreLoad()
-
+	=

 	InvokeExporters()
 	=

 	------------------------------------------ obsolete, just for testing ---=
--------------------------------

Modified: trunk/lua/net/net.other.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.other.lua (original)
+++ trunk/lua/net/net.other.lua Sat Feb 16 19:48:38 2008
@@ -813,105 +813,51 @@
 	printf("NET: Send_Speech : speech=3D%s\n",speech)
 end
 =

---kPacket_Speech_Unicode
-function Send_UnicodeSpeech(ascistr, mode, huecolor, font)	-- (0xAD)
-	if not ascistr then print("unknown ascistr=3D",ascistr) return end
-	local ascilen =3D string.len(ascistr)
-
-	local speechids =3D {}
-	local speechcount =3D 0
-
-	if (gSpeechLoader) then
-		print("Check Keywords...")
-		speechids=3DGetSpeechID(ascistr)
-		speechcount=3Dtable.getn(speechids)
-	end
-	if ( speechcount > 0 ) then
-		local keyw_size =3D 0
---[[
-		int keyw_size =3D 2;
-		for ( int k =3D 0; k < count; k++ )
-		{
-			if ( (k & 1) =3D=3D 0 )
-			{
-				keyw_size+=3D1;
-			}
+-- kPacket_Speech_Unicode 0xAD
+-- see runuo1 sourcecode ./Network/PacketHandlers.cs:1176: UnicodeSpeech  =
  for details of encoding/decoding
+-- see also lib.speech.lua for  SpeechParseKeywords
+function Send_UnicodeSpeech (ascistr, mode, huecolor, font)	-- (0xAD)
+	print("Send_UnicodeSpeech",gSpeechLoader,ascistr, mode, huecolor, font)
+	if not ascistr then print("Send_UnicodeSpeech:missing text") return end
+	=

+	local ascilen		=3D string.len(ascistr)
+	local keywords		=3D SpeechParseKeywords(ascistr)
+	local keywordcount	=3D table.getn(keywords)
+	local bEncoded		=3D keywordcount > 0
+	local hue			=3D hex2num("0x34")
+	local font			=3D 0 -- ignored by runuo 1
+	local msgtype		=3D kMessageType.Regular + (bEncoded and kMessageType.Enco=
ded or 0)
+	local packetlen		=3D 1+2+1+2+2+4+ (bEncoded and (2+0+ascilen) or (ascilen=
*2))
+	for i =3D 0,keywordcount-1 do packetlen =3D packetlen + ((math.mod(i,2) =
=3D=3D 0) and 1 or 2) end -- calc packetlength for encoding
+	=

+	local out =3D GetSendFIFO()
+	out:PushNetUint8(kPacket_Speech_Unicode)
+	out:PushNetUint16(packetlen)
+	out:PushNetUint8(msgtype)
+	out:PushNetUint16(hue)
+	out:PushNetUint16(font)
+	out:PushFilledString(gLanguage or "ENU", 4)
+	=

+	if (bEncoded) then
+		local count	=3D keywordcount -- should be in [0,50]
+		local hold	=3D BitwiseAND(BitwiseSHR(keywords[1],8),hex2num("0xf")) -- s=
hould be in [0,0xF]
+		local value	=3D BitwiseSHL(keywordcount,4) + hold
+		out:PushNetUint16(value)
+		for i =3D 0,keywordcount-1 do
+			if (math.mod(i,2) =3D=3D 0) then
+				out:PushNetUint8(BitwiseAND(keywords[i+1],hex2num("0xff")))
 			else
-			{
-				keyw_size+=3D2;
-			}
-		}
-]]--
-		local out =3D GetSendFIFO()
-		out:PushNetUint8(kPacket_Speech_Unicode)
-		out:PushNetUint16(2*ascilen+14+keyw_size) -- ?
-		if (speechcount > 0) then
-			out:PushNetUint8(hex2num("0xC0"))
-		else
-			out:PushNetUint8(0)
-		end
-		out:PushNetUint16(hex2num("0x65"))				-- Color
-		out:PushNetUint16(0)							-- Font
-		out:PushFilledString(gLanguage or "ENU", 4)		-- Language (Null Terminate=
d) =C2=93enu=C2=93 - United States English, =C2=93deu=C2=94 - German German=
y etc.
-		out:PushNetUint16(hex2num("0xc0")) -- (( count << 4 ) | ( (keywords.at( =
0 ) & 0xF000) >> 8 ))
-
-		for i=3D0, i < speechcount do
-			if ( not TestBit(i,1) ) then
-				out:PushNetUint16(speechids[i])
-			else
-				local nextword
-				if (i=3D=3D(speechcount-1)) then
-					nextword=3D0
-				else
-					nextword=3Dspeechids[i+1]
-				end
-				out:PushNetUint16(speechids[i])
+				local hold	=3D BitwiseAND(BitwiseSHR(keywords[i+2] or 0,8),hex2num("0x=
f")) -- should be in [0,0xF]
+				local value	=3D BitwiseSHL(keywords[i+1],4) + hold
+				out:PushNetUint16(value)
 			end
 		end
---[[
-		for ( int i =3D 0; i < count; i++ )
-		{
-			if ( (i & 1) =3D=3D 0 )
-			{
-				Uint8 word =3D  (Uint8)keywords.at( i );
-				packet.AddByte( word );
-			}
-			else
-			{
-				Uint16 nextword;
-
-				if ( i =3D=3D count - 1 )
-				{
-					nextword=3D0;
-				}
-				else
-				{
-					nextword =3D keywords.at( i + 1 );
-				}
-
-				Uint16 word =3D keywords.at( i );
-				word <<=3D 4;
-				word |=3D (nextword  & 0xF000);
-				packet.AddWord( word );
-			}
-		}
-]]--
-		out:PushFilledUnicodeString(ascistr, ascilen)
-		out:PushNetUint16(0)		-- add a Null-Terminator to sendstring
-		out:SendPacket()
-	else
-		local out =3D GetSendFIFO()
-		out:PushNetUint8(kPacket_Speech_Unicode)
-		out:PushNetUint16(2*ascilen+14)
-		out:PushNetUint8(mode or 0)		-- Type - If Mode&0xc0 then there are keywo=
rds (from speech.mul) present.
-								-- Mode(0=3Dsay,2=3Demote,8=3Dwhisper,9=3Dyell,10=3Dspell,13=3Dgui=
ld,14=3Dalliance,15=3DGM,0xc0=3Dencoded commands)
-		out:PushNetUint16(huecolor or hex2num("0x34"))	-- Color
-		out:PushNetUint16(font or 0)	-- Font
-		out:PushFilledString(gLanguage or "ENU", 4)		-- Language (Null Terminate=
d) =C2=93enu=C2=93 - United States English, =C2=93deu=C2=94 - German German=
y etc.
-		out:PushFilledUnicodeString(ascistr, ascilen)
-		out:PushNetUint16(0)		-- add a Null-Terminator to sendstring
-		out:SendPacket()
-	end
+		out:PushFilledString(ascistr, ascilen)  -- utf8
+	else =

+		out:PushFilledUnicodeString(ascistr, ascilen) -- unicode, 16 bit per let=
ter
+	end
+	=

+	out:SendPacket()
 end =

 =

 =




From no-reply at zwischenwelt.org  Sat Feb 16 19:58:47 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 16 Feb 2008 18:58:47 -0000
Subject: [Iris-commit] [IRIS] r1916 - in /trunk/data: base/ models/atlas/
Message-ID: <20080216185848.9AA9E1C186F1@zwischenwelt.org>

Author: sience
Date: Sat Feb 16 19:58:43 2008
New Revision: 1916

Log:
-obsolete texture removed

Removed:
    trunk/data/base/irislogo256x256.png
    trunk/data/models/atlas/tex_atlas_alpha_med0.dds
    trunk/data/models/atlas/tex_atlas_alpha_med1.dds
    trunk/data/models/atlas/tex_atlas_med0.dds
    trunk/data/models/atlas/tex_atlas_med1.dds
    trunk/data/models/atlas/tex_atlas_med2.dds
    trunk/data/models/atlas/tex_atlas_med3.dds
    trunk/data/models/atlas/tex_atlas_med4.dds



From no-reply at zwischenwelt.org  Sun Feb 17 02:23:31 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 01:23:31 -0000
Subject: [Iris-commit] [IRIS] r1917 - in /trunk:
 data/models/models/to_017000/mdl_016010.mesh
 data/models/models/to_017000/mdl_016049.mesh
 data/models/models/to_017000/mdl_016093.mesh lua/filter/filter.art.lua
 lua/lib.3d.dynamic.lua lua/main.lua
Message-ID: <20080217012332.06CB81C186F4@zwischenwelt.org>

Author: sience
Date: Sun Feb 17 02:23:31 2008
New Revision: 1917

Log:
-boat support added (small boat is working now :-)

Added:
    trunk/data/models/models/to_017000/mdl_016093.mesh   (with props)
Removed:
    trunk/data/models/models/to_017000/mdl_016010.mesh
    trunk/data/models/models/to_017000/mdl_016049.mesh
Modified:
    trunk/lua/filter/filter.art.lua
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/main.lua

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Sun Feb 17 02:23:31 2008
@@ -150,6 +150,13 @@
 gArtFilter[10760]=3D{maptoid=3D10762,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
 gArtFilter[10758]=3D{maptoid=3D10764,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
 =

+-- boats
+gArtFilter[15962]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:270",xadd=3D1.0=
,yadd=3D  0,zadd=3D0}
+gArtFilter[16098]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:180",xadd=3D1.0=
,yadd=3D1.0,zadd=3D0}
+gArtFilter[15980]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:90" ,xadd=3D  0=
,yadd=3D1.0,zadd=3D0}
+
+
+
 ----------------------------------------------------------------------
 =

 -- Seasonal Dynamic & Static Art Translation (run tiles)	-- eventuell (iTi=
leTypeID + 16384)

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sun Feb 17 02:23:31 2008
@@ -103,6 +103,11 @@
 -- TODO: Multis & Serversidemultis don't recognize kTileDataFlag_LightSour=
ce yet
 function Renderer3D:CreateDynamicGfx( item )
 	assert(not item.gfx)
+
+	item.artid=3DCheckIfBoat(item.artid)
+	=

+	-- TODO: check if corpse
+	-- item.artid=3DCheckIfCorpse(item.artid)
 =

 	-- FILTER: get correction
 	item.xadd =3D FilterPositionX(item.artid) or 0

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Feb 17 02:23:31 2008
@@ -55,6 +55,7 @@
 =

 dofile(libpath .. "lib.renderer.lua")
 dofile(libpath .. "lib.uoids.lua")
+dofile(libpath .. "lib.boat.lua")
 dofile(libpath .. "lib.terrain.lua")
 dofile(libpath .. "lib.terrain.multitex.lua")
 dofile(libpath .. "lib.static.lua")



From no-reply at zwischenwelt.org  Sun Feb 17 13:20:58 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 12:20:58 -0000
Subject: [Iris-commit] [IRIS] r1918 - /trunk/lua/filter/filter.art.lua
Message-ID: <20080217122058.E409A1C1868F@zwischenwelt.org>

Author: sience
Date: Sun Feb 17 13:20:58 2008
New Revision: 1918

Log:
-some boat improvements

Modified:
    trunk/lua/filter/filter.art.lua

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Sun Feb 17 13:20:58 2008
@@ -151,9 +151,10 @@
 gArtFilter[10758]=3D{maptoid=3D10764,rotation=3D"x:0,y:0,z:90",xadd=3D0,ya=
dd=3D1.85,zadd=3D0}
 =

 -- boats
-gArtFilter[15962]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:270",xadd=3D1.0=
,yadd=3D  0,zadd=3D0}
-gArtFilter[16098]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:180",xadd=3D1.0=
,yadd=3D1.0,zadd=3D0}
-gArtFilter[15980]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:90" ,xadd=3D  0=
,yadd=3D1.0,zadd=3D0}
+gArtFilter[16093]=3D{xadd=3D  0,yadd=3D  0,zadd=3D-0.4}
+gArtFilter[15962]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:270",xadd=3D1.0=
,yadd=3D  0,zadd=3D-0.25}
+gArtFilter[16098]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:180",xadd=3D1.0=
,yadd=3D1.0,zadd=3D-0.25}
+gArtFilter[15980]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:90" ,xadd=3D  0=
,yadd=3D1.0,zadd=3D-0.25}
 =

 =

 =




From no-reply at zwischenwelt.org  Sun Feb 17 13:34:09 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 12:34:09 -0000
Subject: [Iris-commit] [IRIS] r1919 - /trunk/lua/lib.boat.lua
Message-ID: <20080217123412.77B9E1C1868E@zwischenwelt.org>

Author: sience
Date: Sun Feb 17 13:34:08 2008
New Revision: 1919

Log:
-ups lib.boat.lua added

Added:
    trunk/lua/lib.boat.lua



From no-reply at zwischenwelt.org  Sun Feb 17 16:04:04 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 15:04:04 -0000
Subject: [Iris-commit] [IRIS] r1920 - in /trunk: bin/iris2.exe
 data/config.lua.dist lua/lib.3d.dynamic.lua lua/lib.3d.map.lua
 lua/lib.3d.renderer.lua
Message-ID: <20080217150405.2515D1C1868E@zwischenwelt.org>

Author: sience
Date: Sun Feb 17 16:04:04 2008
New Revision: 1920

Log:
-new binary
-integrated depth shadowmapping preconfigured

Modified:
    trunk/bin/iris2.exe
    trunk/data/config.lua.dist
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Sun Feb 17 16:04:04 2008
@@ -294,6 +294,7 @@
 =

 -- activates Lightsources
 gLightsources =3D false
+gLightsCastShadows =3D false
 =

 -- activates Particle Effects
 gParticleEffectSystem =3D true

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sun Feb 17 16:04:04 2008
@@ -249,7 +249,8 @@
 		local arrtiletype =3D GetStaticTileType(item.artid)
 		if( arrtiletype and TestBit(arrtiletype.miFlags or 0,kTileDataFlag_Light=
Source) ) then
 			local x,y,z =3D Renderer3D:UOPosToLocal(item.xloc,item.yloc,(item.zloc+=
arrtiletype.miHeight) * 0.1)
-			item.lightname=3DClient_AddPointLight(x,y,z, 0.3,0.3,0.0, 0.3,0.3,0.0, =
5.0,0.1,0.1,0.0)
+			item.lightname=3DClient_AddPointLight(x,y,z, 0.3,0.3,0.2, 0.3,0.3,0.2, =
5.0,0.1,0.1,0.0)
+			Light_SetCastShadows(item.lightname, gLightsCastShadows)
 		end
 	end
 end

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sun Feb 17 16:04:04 2008
@@ -360,6 +360,7 @@
 		local arrtiletype =3D GetStaticTileType(iTileTypeID)
 		if( arrtiletype and TestBit(arrtiletype.miFlags or 0,kTileDataFlag_Light=
Source) ) then
 			entity.lightname=3DClient_AddPointLight(entity.x-0.5,entity.y-0.5,entit=
y.z+arrtiletype.miHeight, 0.3,0.3,0.0, 0.3,0.3,0.0, 5.0,0.1,0.1,0.0)
+			Light_SetCastShadows(entity.lightname, gLightsCastShadows)
 		end
 	end
 =


Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sun Feb 17 16:04:04 2008
@@ -160,8 +160,8 @@
 		OgreShadowTechnique(gShadowTechnique)
 		OgreSetShadowTextureSize(2048)
 		OgreSetShadowCasterRenderBackFaces(false)
-		OgreSetShadowTextureCount(3)
-
+
+--		OgreSetShadowTextureCount(3)
 --mLiSPSMSetup =3D new LiSPSMShadowCameraSetup()
 --m_pSceneMgr->setShadowCameraSetup(ShadowCameraSetupPtr(mLiSPSMSetup))
 --		OgreSetShadowTexturePixelFormat(PF_FLOAT32_RGBA)
@@ -173,9 +173,9 @@
 		OgreSetShadowTextureFadeStart(0.5)
 		OgreSetShadowTextureFadeEnd(0.9)
  		OgreShadowTechnique(gShadowTechnique)
-		OgreSetShadowTextureSize(2048)
+		OgreSetShadowTextureSize(1024)
 		OgreSetShadowCasterRenderBackFaces(false)
-		OgreSetShadowTextureCount(3)
+		OgreSetShadowTextureCount(4)
 =

 		OgreSetShadowTexturePixelFormat(PF_FLOAT32_R)
 		OgreSetShadowTextureCasterMaterial("Ogre/DepthShadowmap/Caster/Float")



From no-reply at zwischenwelt.org  Sun Feb 17 18:13:14 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 17:13:14 -0000
Subject: [Iris-commit] [IRIS] r1921 - in /trunk/data/models/models:
 texture_list.php textures_skipped_in_atlas.txt
Message-ID: <20080217180013.E9DE61C1868F@zwischenwelt.org>

Author: hagish
Date: Sun Feb 17 18:13:12 2008
New Revision: 1921

Log:
its possible to excluse textures from atlas, just add the material name to =
textures_skipped_in_atlas.txt

Added:
    trunk/data/models/models/textures_skipped_in_atlas.txt
Modified:
    trunk/data/models/models/texture_list.php

Modified: trunk/data/models/models/texture_list.php
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/models/texture_list.php (original)
+++ trunk/data/models/models/texture_list.php Sun Feb 17 18:13:12 2008
@@ -1,4 +1,6 @@
 <?php
+
+$ignore_list =3D array_map("trim",file("textures_skipped_in_atlas.txt"));
 =

 $dir =3D "../textures/";
 =

@@ -11,7 +13,7 @@
 				$path =3D $dir.$file;
 				$name =3D str_replace(".png","",$file);
 				=

-				if(strpos($name,"tex_") =3D=3D=3D false)continue;
+				if(strpos($name,"tex_") =3D=3D=3D false || in_array($name,$ignore_list=
))continue;
 				=

 				echo $name."\t".$path."\n";
 			}



From no-reply at zwischenwelt.org  Sun Feb 17 21:11:18 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 20:11:18 -0000
Subject: [Iris-commit] [IRIS] r1922 - /trunk/lua/lib.gumpparser.lua
Message-ID: <20080217201119.129DB1C18078@zwischenwelt.org>

Author: hagish
Date: Sun Feb 17 21:11:18 2008
New Revision: 1922

Log:
bugfix: switching pages in gumps kills the dialog

Modified:
    trunk/lua/lib.gumpparser.lua

Modified: trunk/lua/lib.gumpparser.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gumpparser.lua (original)
+++ trunk/lua/lib.gumpparser.lua Sun Feb 17 21:11:18 2008
@@ -112,7 +112,7 @@
 			local command =3D string.lower(bToken[1])
 			--Description:  Specifies which page to define. Page 0 is already prese=
nt and visible with all other Pages (1,2,3,etc) =

 			if ((command =3D=3D "page") and (table.getn(bToken)>=3D 2)) then
-				local pagenum=3Dtonumber(bToken[2])
+				local pagenum =3D tonumber(bToken[2])
 				curpage =3D pages[pagenum]
 				if (not curpage) then
 					curpage =3D guimaker.MakePage(pagenum)
@@ -227,14 +227,12 @@
 				if (bToken[8]) then widget.returnmsg =3D tonumber(bToken[8]) end
 				widget.page			=3D tonumber(bToken[7])
 				widget.onLeftClick =3D function (widget)
-										if (widget.returnmsg) then
-											printdebug("gump","Button pressed -> Send button return_message=
: "..widget.returnmsg)
-											GumpReturnMsg(Gumpdata.playerid, Gumpdata.dialogId, widget.retu=
rnmsg, ServerSideGump_GetParams(Gumpdata.dialogId))
-										end
 										if (widget.page > 0 and not(widget.page > table.getn(pages)) ) t=
hen
 											printdebug("gump","Parsegump Button: Switch to Page "..widget.p=
age.."/"..table.getn(pages))
 											widget.dialog:ShowPage(widget.page)
-										else
+										elseif (widget.returnmsg) then
+											printdebug("gump","Button pressed -> Send button return_message=
: "..widget.returnmsg)
+											GumpReturnMsg(Gumpdata.playerid, Gumpdata.dialogId, widget.retu=
rnmsg, ServerSideGump_GetParams(Gumpdata.dialogId))
 											widget.dialog:Close()
 										end
 									end



From no-reply at zwischenwelt.org  Sun Feb 17 21:13:37 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 17 Feb 2008 20:13:37 -0000
Subject: [Iris-commit] [IRIS] r1923 - in /trunk/lua: gui/gui.paperdoll.lua
	net/net.other.lua
Message-ID: <20080217201338.4D0081C18058@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Feb 17 21:13:37 2008
New Revision: 1923

Log:
added a few notes

Modified:
    trunk/lua/gui/gui.paperdoll.lua
    trunk/lua/net/net.other.lua

Modified: trunk/lua/gui/gui.paperdoll.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.paperdoll.lua (original)
+++ trunk/lua/gui/gui.paperdoll.lua Sun Feb 17 21:13:37 2008
@@ -86,6 +86,7 @@
 			dialog.controls["btn_virtues"].onMouseDown =3D function (widget,mousebu=
tton)
 														if (mousebutton =3D=3D 1) then
 															widget.gfx:SetMaterial(widget.mat_pressed)
+															print("btn_virtues,GumpReturnMsg : warning ! playerserial m=
ight be wrong here, usually this param is the gump-serial")
 															GumpReturnMsg(gPlayerBodySerial, hex2num("0x000001CD"),
 																		  hex2num("0x00000001"), nil,
 																		  hex2num("0x00000001"), gPlayerBodySerial)

Modified: trunk/lua/net/net.other.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.other.lua (original)
+++ trunk/lua/net/net.other.lua Sun Feb 17 21:13:37 2008
@@ -533,8 +533,8 @@
 ______________________________________
 BYTE[1]	ID (B1)
 BYTE[2]	-Packet Size
-BYTE[4]	-Gump Serial		--?? playerserial (first Id in 0xb0)
-BYTE[4]	-Gump ID			--?? gumpserial (second Id in 0xb0)
+BYTE[4]	-Gump Serial		--?? gumpserial (first Id in 0xb0)  (mislabled as pl=
ayerserial sometimes...)
+BYTE[4]	-Gump ID			--?? gumptypeid (second Id in 0xb0)
 BYTE[4]	-Button ID			--which button pressed or 0 if closed
 BYTE[4]	-Switches Count		--(response info for radio buttons and checkboxes=
, any switches listed here are switched on)
 =

@@ -557,7 +557,7 @@
 --table: switches: 10940BA0 returnmessage: 108
 =

 --TODO : readout checkboxes,radiobuttons and edit text fields
-function GumpReturnMsg(playerserial, gumpserial, ret_value, params, switch=
count, textcount)	-- len 0x17
+function GumpReturnMsg(playerserial, gumptypeid, ret_value, params, switch=
count, textcount)	-- len 0x17
 	local packetlen =3D 23	--(1 + 2 + 4*5) size for empty params
 	if (params) then
 		packetlen =3D packetlen + 4 * table.getn(params.switches)
@@ -570,9 +570,9 @@
 	out:PushNetUint8(kPacket_Generic_Gump_Trigger) -- 0xB1
 	out:PushNetUint16(packetlen)
 	out:PushNetUint32(playerserial)
-	out:PushNetUint32(gumpserial)
+	out:PushNetUint32(gumptypeid)
 	out:PushNetUint32(ret_value)
-	--print("GumpReturnMsg player,gump,retval:",playerserial,gumpserial,ret_v=
alue)
+	--print("GumpReturnMsg player,gump,retval:",playerserial,gumptypeid,ret_v=
alue)
 	=

 	=

 	if (params) then



From no-reply at zwischenwelt.org  Mon Feb 18 12:19:28 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 11:19:28 -0000
Subject: [Iris-commit] [IRIS] r1924 - in /rawdata/sd_pd: flowers.blend
 houseparts.blend tex_flowers.png
Message-ID: <20080218111929.029F21C184AA@zwischenwelt.org>

Author: hagish
Date: Mon Feb 18 12:19:28 2008
New Revision: 1924

Log:
raw data update

Added:
    rawdata/sd_pd/flowers.blend   (with props)
    rawdata/sd_pd/tex_flowers.png   (with props)
Modified:
    rawdata/sd_pd/houseparts.blend

Modified: rawdata/sd_pd/houseparts.blend
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Mon Feb 18 13:28:20 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 12:28:20 -0000
Subject: [Iris-commit] [IRIS] r1925 - in /trunk: data/config.lua.dist
	lua/lib.static.lua
Message-ID: <20080218130012.E7FD41524007@zwischenwelt.org>

Author: hagish
Date: Mon Feb 18 13:28:19 2008
New Revision: 1925

Log:
added mode to dump missing models as art images

Modified:
    trunk/data/config.lua.dist
    trunk/lua/lib.static.lua

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Mon Feb 18 13:28:19 2008
@@ -311,6 +311,9 @@
 =

 -- used for client localization
 gLanguage =3D "ENU"
+
+-- used to dump images of the missing models into a missing folder in the =
bin directory, you need to create the directory manually
+gDumpMissingModels =3D false
 =

 ------------------------------ UO Files --------------------------
 gHuesFile		=3D "hues.mul"

Modified: trunk/lua/lib.static.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.static.lua (original)
+++ trunk/lua/lib.static.lua Mon Feb 18 13:28:19 2008
@@ -93,6 +93,24 @@
 		printdebug("static","mesh already found in cache ",meshname, iHue)
 	end
 	=

+	-- dump missing models as images
+	if gDumpMissingModels then
+		local filename =3D "missing/"..iTileTypeID..".png"
+		if not meshname and not file_exists(filename) and gArtMapLoader then
+			print("dump missing art",iTileTypeID,filename)
+			-- render fallback image
+			local img =3D CreateImage()
+			if gArtMapLoader:ExportToImage(img,iTileTypeID + 16384) then
+				img:SaveAsFile(filename)
+			end
+			img:Destroy()
+		elseif meshname and file_exists(filename) then
+			-- remove existing missing images
+			print("remove missing art image because there is now a model",iTileType=
ID,filename)
+			remove_file(filename)
+		end
+	end
+	=

 	-- gray box fallback?
 	if gUseWhiteBoxAsFallBack and not meshname then
 		meshname =3D GetFallBackBoxMesh()



From no-reply at zwischenwelt.org  Mon Feb 18 14:02:10 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 13:02:10 -0000
Subject: [Iris-commit] [IRIS] r1926 - in /trunk/data/models: materials/
 models/to_003000/ models/to_004000/ models/to_010000/ textures/
Message-ID: <20080218130212.BB91D1524004@zwischenwelt.org>

Author: hagish
Date: Mon Feb 18 14:02:10 2008
New Revision: 1926

Log:
new models and flower updates

Added:
    trunk/data/models/models/to_003000/mdl_002269.mesh   (with props)
    trunk/data/models/models/to_004000/mdl_003375.mesh   (with props)
    trunk/data/models/models/to_004000/mdl_003800.mesh   (with props)
    trunk/data/models/textures/tex_stoneplate.png   (with props)
Modified:
    trunk/data/models/materials/textures.material
    trunk/data/models/models/to_004000/mdl_003203.mesh
    trunk/data/models/models/to_010000/mdl_009411.mesh
    trunk/data/models/textures/tex_flowers.png

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Mon Feb 18 14:02:10 2008
@@ -8300,3 +8300,17 @@
 		}
 	} =

 }
+
+material tex_stoneplate : tex_base
+{ =

+	technique =

+	{ =

+		pass =

+		{		=

+			texture_unit =

+			{ =

+				texture tex_stoneplate.png =

+			}	=

+		}
+	} =

+}

Modified: trunk/data/models/models/to_004000/mdl_003203.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_010000/mdl_009411.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_flowers.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Mon Feb 18 14:02:53 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 13:02:53 -0000
Subject: [Iris-commit] [IRIS] r1927 - in /rawdata/sd_pd: flowers.blend
 houseparts.blend tex_flowers.png tex_stoneplate.png
Message-ID: <20080218130253.A4A7A1524004@zwischenwelt.org>

Author: hagish
Date: Mon Feb 18 14:02:52 2008
New Revision: 1927

Log:
rawdata update

Added:
    rawdata/sd_pd/tex_stoneplate.png   (with props)
Modified:
    rawdata/sd_pd/flowers.blend
    rawdata/sd_pd/houseparts.blend
    rawdata/sd_pd/tex_flowers.png

Modified: rawdata/sd_pd/flowers.blend
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: rawdata/sd_pd/houseparts.blend
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: rawdata/sd_pd/tex_flowers.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Mon Feb 18 18:32:32 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 17:32:32 -0000
Subject: [Iris-commit] [IRIS] r1928 - in /trunk: lua/2d/lib.2d.renderer.luac
 lua/lib.3d.cam.lua lua/lib.gui.iris.lua lua/main.lua premake.lua
Message-ID: <20080218173232.D2F501524004@zwischenwelt.org>

Author: ghoulsblade
Date: Mon Feb 18 18:32:30 2008
New Revision: 1928

Log:
upgrade from lua-5.0.3 to lua-5.1.3

Removed:
    trunk/lua/2d/lib.2d.renderer.luac
Modified:
    trunk/lua/lib.3d.cam.lua
    trunk/lua/lib.gui.iris.lua
    trunk/lua/main.lua
    trunk/premake.lua

Modified: trunk/lua/lib.3d.cam.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.cam.lua (original)
+++ trunk/lua/lib.3d.cam.lua Mon Feb 18 18:32:30 2008
@@ -16,7 +16,7 @@
 Renderer3D.gCamKeyCode.Slow	=3D GetNamedKey("lshift")
 Renderer3D.gCamKeyCode.Fast	=3D GetNamedKey("lalt")
 Renderer3D.gCamKeyName =3D {}
-for k,v in Renderer3D.gCamKeyCode do Renderer3D.gCamKeyName[v] =3D k end
+for k,v in pairs(Renderer3D.gCamKeyCode) do Renderer3D.gCamKeyName[v] =3D =
k end
 Renderer3D.gCamKeyDown =3D {}
 Renderer3D.gCamMoveWithMouse	=3D false
 Renderer3D.gCamMoveWithMouse_OffX	=3D nil

Modified: trunk/lua/lib.gui.iris.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.gui.iris.lua (original)
+++ trunk/lua/lib.gui.iris.lua Mon Feb 18 18:32:30 2008
@@ -36,6 +36,8 @@
 	if (gMyTicks > gMemStats_NextUpdate) then
 		gMemStats_NextUpdate =3D gMyTicks + 1000
 		local mem_dyn, mem_tresh =3D gcinfo()
+		mem_dyn =3D mem_dyn or 0
+		mem_tresh =3D mem_tresh or 0
 		local text =3D sprintf("%5.1ffps %0.1fmb %dt %db OGRE | %0.fmb/%0.1fmb L=
UA",OgreAvgFPS(),memoryusage / 1024 / 1024, OgreTriangleCount(), OgreBatchC=
ount(), mem_dyn / 1024, mem_tresh / 1024)
 		if (not gMemoryUsageField) then
 			local vw,vh =3D GetViewportSize()

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Mon Feb 18 18:32:30 2008
@@ -14,7 +14,6 @@
 =

 gInGameStarted =3D false
 gNet_State =3D false
-
 =

 --###############################
 --###     OTHER LUA FILES     ###
@@ -44,14 +43,6 @@
 dofile(libpath .. "lib.3d.map.lua")
 dofile(libpath .. "lib.3d.combat.lua")
 dofile(libpath .. "lib.3d.cam.lua")
-
-if (file_exists( libpath .. "2d/lib.2d.renderer.lua" )) then
-	dofile(libpath .. "2d/lib.2d.renderer.lua")
-	dofile(libpath .. "2d/lib.2d.config.lua")
-elseif (file_exists( libpath .. "2d/lib.2d.renderer.luac" ) and GetPointer=
Size() =3D=3D 4 ) then
-	dofile(libpath .. "2d/lib.2d.renderer.luac")
-	dofile(libpath .. "2d/lib.2d.config.lua")
-end
 =

 dofile(libpath .. "lib.renderer.lua")
 dofile(libpath .. "lib.uoids.lua")
@@ -370,7 +361,6 @@
 			gStaticLoader =3D CreatePagedGeometryStaticLoader(gGrass, gStaticBlockL=
oader, -1,1,10, x,y,z)
 			gStaticLoader:AssignToPagedGeometry(gGrass)
 			=

-			--[[
 			gGrassLoader =3D CreateGrassLoader(gGrass)
 			gGrassLoader:AssignToPagedGeometry(gGrass)
 =

@@ -392,7 +382,6 @@
 			l:SetColorMapFileColor("terrain_texture.jpg")
 			l:SetDensityMapFileAlpha("grass_density.png")
 			l:SetMapBounds(-1500, -1500, 1500, 1500)
-			]]--
 		end
 		]]--
 		------------------------------------------------------------------------=
----------------------------------

Modified: trunk/premake.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/premake.lua (original)
+++ trunk/premake.lua Mon Feb 18 18:32:30 2008
@@ -14,7 +14,7 @@
 gLugreDir =3D "lugre"
 if (io.open("mylugre/lua/lugre.lua")) then print("using mylugre dir overri=
de") gLugreDir =3D "mylugre" end
 =

-gLugreLuaSrcDir =3D "./"..gLugreDir.."/lib/lua-5.0.3/"
+gLugreLuaSrcDir =3D "./"..gLugreDir.."/lib/lua-5.1.3/"
 =

 -- list of easy libs inclusion (located in lugre/lib/NAME). this will add =
lugre/lib/NAME/src and lugre/lib/NAME/include.
 gLugreLibList =3D {
@@ -46,7 +46,6 @@
 	addcustomlib(package,"boost_thread-mt")	=

 =

 	table.insert(package.links, "lugrelua")
-	table.insert(package.links, "lugrelualib")
 =

 	-- add lib defines like USE_LUGRE_LIB_NAME
 	for k,v in pairs(gLugreLibList) do =

@@ -98,22 +97,12 @@
 package.language =3D "c++"
 package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, "opt=
imize" }
 package.buildoptions =3D {}
-package.includepaths =3D { gLugreLuaSrcDir.."/include" }
+package.includepaths =3D { gLugreLuaSrcDir.."/src" }
+package.defines =3D { =

+	"LUA_USE_POPEN", -- execute shellcommands
+}	=

 package.files =3D {
-  matchfiles(gLugreLuaSrcDir.."/include/*.h", gLugreLuaSrcDir.."/src/*.c"),
-}
-
--- ---------------------------------------------
-
-package =3D newpackage()
-package.name =3D "lugrelualib"
-package.kind =3D "lib"
-package.language =3D "c++"
-package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, "opt=
imize" }
-package.buildoptions =3D {}
-package.includepaths =3D { gLugreLuaSrcDir.."/include" }
-package.files =3D {
-  matchfiles(gLugreLuaSrcDir.."/include/*.h", gLugreLuaSrcDir.."/src/lib/*=
.c"),
+  matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c"),
 }
 =

 -- ---------------------------------------------
@@ -128,9 +117,9 @@
 	package.language =3D "c++"
 	package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, "op=
timize" }
 	package.buildoptions =3D {}
-	package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/incl=
ude/", "include" }
+	package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/=
", "include" }
 	package.files =3D {
-		matchfiles(gLugreLuaSrcDir.."/include/*.h", gLugreLuaSrcDir.."/src/lib/*=
.c"),
+		matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c"),
 	}
 	table.insert(package.files, matchrecursive(gLugreDir.."/lib/"..v.."/inclu=
de/*.h")) =

 	table.insert(package.files, matchrecursive(gLugreDir.."/lib/"..v.."/src/*=
.cpp")) =

@@ -147,10 +136,10 @@
 package.name =3D "lugrelib"
 package.kind =3D "lib"
 package.language =3D "c++"
-package.links =3D { "lugrelua", "lugrelualib" }
+package.links =3D { "lugrelua" }
 package.buildflags =3D { bExtraWarnings and "extra-warnings" or nil, "opti=
mize" }
 package.buildoptions =3D {}
-package.includepaths =3D { gLugreLuaSrcDir.."/include", gLugreDir.."/inclu=
de" }
+package.includepaths =3D { gLugreLuaSrcDir.."/src", gLugreDir.."/include" }
 package.files =3D {
   matchrecursive(gLugreDir.."/include/*.h", gLugreDir.."/src/*.cpp"),
 }
@@ -168,14 +157,14 @@
 package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, "opt=
imize" }
 package.buildoptions =3D {}
 =

-package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/inclu=
de/", "include" }
+package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/"=
, "include" }
 -- add lib includes
 for k,v in pairs(gLugreLibList) do =

 	table.insert(package.includepaths, gLugreDir.."/lib/"..v.."/include/") =

 end
 =

 package.linkoptions =3D {}
-package.links =3D { "lugrelua","lugrelualib" }
+package.links =3D { "lugrelua" }
 =

 package.links =3D { "lugrelib" }
 AddLugreDeps(package)



From no-reply at zwischenwelt.org  Mon Feb 18 20:44:06 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 19:44:06 -0000
Subject: [Iris-commit] [IRIS] r1929 - in /trunk/vs8: iris.sln iris.vcproj
Message-ID: <20080218200013.9A5ED1C1802A@zwischenwelt.org>

Author: sience
Date: Mon Feb 18 20:44:05 2008
New Revision: 1929

Log:
-vs2005 projectfile update for lua-5.1.3

Modified:
    trunk/vs8/iris.sln
    trunk/vs8/iris.vcproj

Modified: trunk/vs8/iris.sln
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.sln (original)
+++ trunk/vs8/iris.sln Mon Feb 18 20:44:05 2008
@@ -4,38 +4,31 @@
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "iris", "iris.vcproj=
", "{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}"
 	ProjectSection(ProjectDependencies) =3D postProject
 		{5A02700F-C389-4E19-AF35-C4C893E72A64} =3D {5A02700F-C389-4E19-AF35-C4C8=
93E72A64}
-		{FF3B6490-D65F-7B41-982B-8D8339958224} =3D {FF3B6490-D65F-7B41-982B-8D83=
39958224}
+		{D7488B96-456A-1E46-8B0B-0F698E025694} =3D {D7488B96-456A-1E46-8B0B-0F69=
8E025694}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "lua50_lib", "..\lug=
re\lib\lua-5.0.3\mak.vs2005\lua50_lib.vcproj", "{FF3B6490-D65F-7B41-982B-8D=
8339958224}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "pagedgeometry_lib",=
 "..\lugre\lib\paged_geometry\vs2005\pagedgeometry_lib.vcproj", "{5A02700F-=
C389-4E19-AF35-C4C893E72A64}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "pagedgeometry_lib",=
 "..\lugre\lib\paged_geometry\vs2005\pagedgeometry_lib.vcproj", "{5A02700F-=
C389-4E19-AF35-C4C893E72A64}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") =3D "lua5.1_lib", "..\lu=
gre\lib\lua-5.1.3\mak.vs2005\lua5.1_lib.vcproj", "{D7488B96-456A-1E46-8B0B-=
0F698E025694}"
 EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) =3D preSolution
 		Debug|Win32 =3D Debug|Win32
-		Release - boost-threads_enabled|Win32 =3D Release - boost-threads_enable=
d|Win32
 		Release|Win32 =3D Release|Win32
 	EndGlobalSection
 	GlobalSection(ProjectConfigurationPlatforms) =3D postSolution
 		{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
 		{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}.Debug|Win32.Build.0 =3D Debug|Win=
32
-		{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}.Release - boost-threads_enabled|W=
in32.ActiveCfg =3D Release|Win32
-		{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
 		{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
 		{E2D2CF97-591B-450F-B5EA-21CB9B6A5DA5}.Release|Win32.Build.0 =3D Release=
|Win32
-		{FF3B6490-D65F-7B41-982B-8D8339958224}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
-		{FF3B6490-D65F-7B41-982B-8D8339958224}.Debug|Win32.Build.0 =3D Debug|Win=
32
-		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release - boost-threads_enabled|W=
in32.ActiveCfg =3D Release|Win32
-		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
-		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
-		{FF3B6490-D65F-7B41-982B-8D8339958224}.Release|Win32.Build.0 =3D Release=
|Win32
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Debug|Win32.Build.0 =3D Debug|Win=
32
-		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release - boost-threads_enabled|W=
in32.ActiveCfg =3D Release|Win32
-		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release - boost-threads_enabled|W=
in32.Build.0 =3D Release|Win32
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
 		{5A02700F-C389-4E19-AF35-C4C893E72A64}.Release|Win32.Build.0 =3D Release=
|Win32
+		{D7488B96-456A-1E46-8B0B-0F698E025694}.Debug|Win32.ActiveCfg =3D Debug|W=
in32
+		{D7488B96-456A-1E46-8B0B-0F698E025694}.Debug|Win32.Build.0 =3D Debug|Win=
32
+		{D7488B96-456A-1E46-8B0B-0F698E025694}.Release|Win32.ActiveCfg =3D Relea=
se|Win32
+		{D7488B96-456A-1E46-8B0B-0F698E025694}.Release|Win32.Build.0 =3D Release=
|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) =3D preSolution
 		HideSolutionNode =3D FALSE

Modified: trunk/vs8/iris.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vs8/iris.vcproj (original)
+++ trunk/vs8/iris.vcproj Mon Feb 18 20:44:05 2008
@@ -126,7 +126,7 @@
 				OmitFramePointers=3D"true"
 				EnableFiberSafeOptimizations=3D"false"
 				WholeProgramOptimization=3D"true"
-				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;c:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\include\zlib;..\lugre=
\include;..\include\fmodx;&quot;..\lugre\lib\lua-5.0.3\include\&quot;;..\lu=
gre\lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\lib\paged_geo=
metry\include;..\lugre\lib\caelum\include;c:\Programme\boost\boost_1_34_1\"
+				AdditionalIncludeDirectories=3D"&quot;$(INCLUDE)&quot;;&quot;c:\Progra=
mme\Microsoft Platform SDK\Include\&quot;;&quot;$(OGRE_HOME)\include\&quot;=
;&quot;$(OGRE_HOME)\include\OIS\&quot;;..\include\;..\include\zlib;..\lugre=
\include;..\include\fmodx;&quot;..\lugre\lib\lua-5.1.3\src\&quot;;..\lugre\=
lib\md5\include;..\lugre\lib\cadune_tree\include;..\lugre\lib\paged_geometr=
y\include;..\lugre\lib\caelum\include;c:\Programme\boost\boost_1_34_1\"
 				PreprocessorDefinitions=3D"WIN32;NDEBUG;_WINDOWS;MAIN_WORKING_DIR=3D\&=
quot;../\&quot;;USE_FMOD;USE_LUGRE_LIB_MD5;USE_LUGRE_LIB_CADUNE_TREE;USE_LU=
GRE_LIB_CAELUM;USE_LUGRE_LIB_PAGED_GEOMETRY"
 				GeneratePreprocessedFile=3D"0"
 				StringPooling=3D"true"
@@ -151,9 +151,9 @@
 			/>
 			<Tool
 				Name=3D"VCLinkerTool"
-				AdditionalDependencies=3D"AdvAPI32.Lib User32.Lib ws2_32.lib zlib.lib =
OgreMain.lib OIS.lib lua50.lib fmodex_vc.lib pagedgeometry_lib.lib"
+				AdditionalDependencies=3D"AdvAPI32.Lib User32.Lib ws2_32.lib zlib.lib =
OgreMain.lib OIS.lib lua5.1.lib fmodex_vc.lib pagedgeometry_lib.lib"
 				OutputFile=3D"$(OutDir)\..\..\bin\iris2.exe"
-				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.0.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\c=
aelum\lib\static;..\lugre\lib\paged_geometry\lib\static;c:\Programme\boost\=
boost_1_34_1\lib"
+				AdditionalLibraryDirectories=3D"&quot;$(LIB)&quot;;&quot;$(OGRE_HOME)\=
lib\&quot;;..\libs\fmodx;..\libs\zlib;&quot;..\lugre\lib\lua-5.1.3\lib\stat=
ic&quot;;&quot;c:\Programme\Microsoft Platform SDK\Lib&quot;;..\lugre\lib\c=
aelum\lib\static;..\lugre\lib\paged_geometry\lib\static;c:\Programme\boost\=
boost_1_34_1\lib"
 				GenerateManifest=3D"true"
 				IgnoreAllDefaultLibraries=3D"false"
 				IgnoreDefaultLibraryNames=3D"LIBCMT.lib"



From no-reply at zwischenwelt.org  Mon Feb 18 21:09:06 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 18 Feb 2008 20:09:06 -0000
Subject: [Iris-commit] [IRIS] r1930 - /trunk/lua/lib.3d.mobile.lua
Message-ID: <20080218200909.1AEEA1524004@zwischenwelt.org>

Author: sience
Date: Mon Feb 18 21:09:05 2008
New Revision: 1930

Log:
-small fix for lua5.1.3

Modified:
    trunk/lua/lib.3d.mobile.lua

Modified: trunk/lua/lib.3d.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mobile.lua (original)
+++ trunk/lua/lib.3d.mobile.lua Mon Feb 18 21:09:05 2008
@@ -366,8 +366,8 @@
 	if (mobile.bodygfx)		then mobile.bodygfx:SetVisible(bVisible) end
 	if (mobile.gfx)			then mobile.gfx:SetVisible(bVisible and (false or gDebu=
gBBoxMobiles)) end
 	if (mobile.selection)	then mobile.selection:SetVisible(bVisible and mobil=
e.isselected) end
-	=

-	for k,partgfx in arr do =

+
+	for k,partgfx in pairs(arr) do 	=

 		if (partgfx and partgfx.SetVisible) then partgfx:SetVisible(bVisible) end
 	end
 	if (mobile.hudname and mobile.hudname.gfx) then =




From no-reply at zwischenwelt.org  Tue Feb 19 19:30:54 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 19 Feb 2008 18:30:54 -0000
Subject: [Iris-commit] [IRIS] r1931 - in /trunk: data/base/ data/base/ui/
	data/models/atlas/ lua/
Message-ID: <20080219183054.B54151524004@zwischenwelt.org>

Author: sience
Date: Tue Feb 19 19:30:53 2008
New Revision: 1931

Log:
-some material cleanups
-gui textures set to 0 mipmaps
-medium texture atlas converted to DDS again (it saves 30mb vram)

Added:
    trunk/data/models/atlas/tex_atlas_alpha_med0.dds   (with props)
    trunk/data/models/atlas/tex_atlas_alpha_med1.dds   (with props)
    trunk/data/models/atlas/tex_atlas_med0.dds   (with props)
    trunk/data/models/atlas/tex_atlas_med1.dds   (with props)
    trunk/data/models/atlas/tex_atlas_med2.dds   (with props)
    trunk/data/models/atlas/tex_atlas_med3.dds   (with props)
    trunk/data/models/atlas/tex_atlas_med4.dds   (with props)
Modified:
    trunk/data/base/main.material
    trunk/data/base/ui/ui.material
    trunk/data/models/atlas/tex_atlas_alpha_med.material
    trunk/data/models/atlas/tex_atlas_med.material
    trunk/lua/lib.test.lua

Modified: trunk/data/base/main.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/base/main.material (original)
+++ trunk/data/base/main.material Tue Feb 19 19:30:53 2008
@@ -22,16 +22,218 @@
 =

 			texture_unit guitex
 			{
+				texture guibase.png 2d 0
+				tex_address_mode clamp
+				filtering none
+			}
+		}
+	}
+}
+
+// TEMPMAP BASE TEMPLATE
+material tempmapbase
+{
+	technique
+	{
+		pass
+		{
+			ambient 1 1 1 1
+			specular 0 0 0 1
+			=

+			cull_hardware none
+			cull_software none
+			=

+			lighting off
+			//depth_write off
+			//depth_check off
+
+			texture_unit
+			{
 				texture guibase.png
-				tex_address_mode clamp
+				tex_address_mode border
+				tex_border_colour 0.0 0.22 0.32
 				filtering none
 			}
 		}
 	}
 }
 =

-// ART-FALLBACK BASE TEMPLATE
-material artfallbackbase
+// --------------- THIS IS THE END OF BASE MATERIALS ----------------------
+
+// material to show a simple 3D health bar
+material mobile/3d_healthbar : guibase
+{
+	technique
+	{
+		pass
+		{
+			texture_unit
+			{
+				filtering anisotropic
+				max_anisotropy 8
+				texture bar.png
+				tex_address_mode clamp
+			}
+		}
+	}
+}
+
+material mobile/aura_base : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_bias 16
+
+			texture_unit
+			{
+				filtering anisotropic
+				max_anisotropy 8
+				texture aura2.png alpha
+				tex_address_mode clamp
+			}
+		}
+	}
+}
+
+material tracking_arrow : guibase
+{
+	technique
+	{
+		pass
+		{
+			texture_unit
+			{
+				filtering anisotropic
+				max_anisotropy 8
+				texture trackarrow.png
+				tex_address_mode clamp
+			}
+		}
+	}
+}
+
+material mapdot : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_check off
+
+			texture_unit
+			{
+				texture mapdot.png 2d 0
+			}
+		}
+	}
+}
+
+material compassframe_static : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_check off
+
+			texture_unit
+			{
+				texture compassframe_static.png 2d 0
+			}
+		}
+	}
+}
+material compassframe_zoomin : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_check off
+
+			texture_unit
+			{
+				texture compassframe_zoomin.png 2d 0
+			}
+		}
+	}
+}
+material compassframe_zoomout : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_check off
+
+			texture_unit
+			{
+				texture compassframe_zoomout.png 2d 0
+			}
+		}
+	}
+}
+
+material compassframe_rot : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_check off
+
+			texture_unit
+			{
+				texture compassframe_rot.png 2d 0
+			}
+		}
+	}
+}
+
+material compassframe_mask : guibase
+{
+	technique
+	{
+		pass
+		{
+			depth_check off
+
+			texture_unit
+			{
+				texture compassframe_mask.png 2d 0
+			}
+		}
+	}
+}
+
+material irislogo : guibase
+{
+	set_texture_alias guitex irislogo256x256bw.png
+}
+
+material rtt_base : guibase
+{
+	technique
+	{
+		pass
+		{
+			texture_unit
+			{
+				filtering anisotropic =

+				max_anisotropy 8
+				texture guibase.png
+				tex_address_mode clamp
+			}
+		}
+	}
+}
+
+// ------------------- non standard materials -------------------
+
+// ART-FALLBACK
+material art_fallback
 {
 	technique
 	{
@@ -48,7 +250,7 @@
 			=

 			texture_unit arttex
 			{
-				texture stone512.dds
+				texture art_fallback.png 2d 0
 				tex_address_mode clamp
 			}
 		}
@@ -76,8 +278,7 @@
 	}
 }
 =

-// TEMPMAP BASE TEMPLATE
-material tempmapbase
+material debug_grid_3D
 {
 	technique
 	{
@@ -85,219 +286,6 @@
 		{
 			ambient 1 1 1 1
 			specular 0 0 0 1
-			=

-			cull_hardware none
-			cull_software none
-			=

-			lighting off
-			//depth_write off
-			//depth_check off
-
-			texture_unit
-			{
-				texture stone512.dds
-				tex_address_mode border
-				tex_border_colour 0.0 0.22 0.32
-				filtering none
-			}
-		}
-	}
-}
-
-// --------------- THIS IS THE END OF BASE MATERIALS ----------------------
-
-// fallback if there is no uo art image available
-material art_fallback : artfallbackbase
-{
-	set_texture_alias arttex art_fallback.png
-}
-
-// material to show a simple 3D health bar
-material mobile/3d_healthbar : guibase
-{
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				filtering anisotropic
-				max_anisotropy 8
-				texture bar.png
-				tex_address_mode clamp
-			}
-		}
-	}
-}
-
-material mobile/aura_base : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_bias 16
-
-			texture_unit
-			{
-				filtering anisotropic
-				max_anisotropy 8
-				texture aura2.png alpha
-				tex_address_mode clamp
-			}
-		}
-	}
-}
-
-material tracking_arrow : guibase
-{
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				filtering anisotropic
-				max_anisotropy 8
-				texture trackarrow.png
-				tex_address_mode clamp
-			}
-		}
-	}
-}
-
-material mapdot : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_check off
-
-			texture_unit
-			{
-				texture mapdot.png
-			}
-		}
-	}
-}
-
-material compassframe_static : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_check off
-
-			texture_unit
-			{
-				texture compassframe_static.png
-			}
-		}
-	}
-}
-material compassframe_zoomin : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_check off
-
-			texture_unit
-			{
-				texture compassframe_zoomin.png
-			}
-		}
-	}
-}
-material compassframe_zoomout : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_check off
-
-			texture_unit
-			{
-				texture compassframe_zoomout.png
-			}
-		}
-	}
-}
-
-material compassframe_rot : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_check off
-
-			texture_unit
-			{
-				texture compassframe_rot.png
-			}
-		}
-	}
-}
-
-material compassframe_mask : guibase
-{
-	technique
-	{
-		pass
-		{
-			depth_check off
-
-			texture_unit
-			{
-				texture compassframe_mask.png
-			}
-		}
-	}
-}
-
-material checker : guibase
-{
-	set_texture_alias guitex checker.png
-}
-
-
-material irislogo : guibase
-{
-	set_texture_alias guitex irislogo256x256bw.png
-}
-
-material rtt_base : guibase
-{
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				filtering anisotropic =

-				max_anisotropy 8
-				texture guibase.png
-				tex_address_mode clamp
-			}
-		}
-	}
-}
-
-// ------------------- non standard materials -------------------
-
-material debug_grid_3D
-{
-	technique
-	{
-		pass
-		{
-			ambient 1 1 1 1
-			specular 0 0 0 1
 =

 			cull_hardware none
 			cull_software none
@@ -382,24 +370,6 @@
 	}
 }
 =

-material stone
-{
-	technique
-	{
-		pass
-		{
-			ambient 1 1 1 1
-			specular 0 0 0 1
-			=

-			texture_unit
-			{
-				texture stone512.dds
-				tex_address_mode clamp
-			}
-		}
-	}
-}
-
 material plaincolor_base
 {
 	technique

Modified: trunk/data/base/ui/ui.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/base/ui/ui.material (original)
+++ trunk/data/base/ui/ui.material Tue Feb 19 19:30:53 2008
@@ -1,126 +1,45 @@
 material ui_ray_border : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/ray_border.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/ray_border.png
 }
 =

 material ui_ray_button : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/ray_button.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/ray_button.png
 }
 =

 material ui_ray_window : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/ray_window.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/ray_window.png
 }
 =

 =

 material ui_iris_border : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/iris_border.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/iris_border.png
 }
 =

 material ui_iris_button : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/iris_button.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/iris_button.png
 }
 =

 material ui_iris_window : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/iris_window.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/iris_window.png
 }
 =

 material ui_sience_border : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/sience_border.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/sience_border.png
 }
 =

 material ui_sience_button : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/sience_button.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/sience_button.png
 }
 =

 material ui_sience_window : guibase
 {
-	technique
-	{
-		pass
-		{
-			texture_unit
-			{
-				texture ui/sience_window.png
-			}
-		}
-	}
+	set_texture_alias guitex ui/sience_window.png
 }

Modified: trunk/data/models/atlas/tex_atlas_alpha_med.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_med.material (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_med.material Tue Feb 19 19:30:5=
3 2008
@@ -6,7 +6,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_alpha_med0.png =

+				texture tex_atlas_alpha_med0.dds =

 			}	=

 		}
 	} =

@@ -19,7 +19,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_alpha_med1.png =

+				texture tex_atlas_alpha_med1.dds =

 			}	=

 		}
 	} =


Modified: trunk/data/models/atlas/tex_atlas_med.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_med.material (original)
+++ trunk/data/models/atlas/tex_atlas_med.material Tue Feb 19 19:30:53 2008
@@ -6,7 +6,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med0.png =

+				texture tex_atlas_med0.dds =

 			}	=

 		}
 	} =

@@ -19,7 +19,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med1.png =

+				texture tex_atlas_med1.dds =

 			}	=

 		}
 	} =

@@ -32,7 +32,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med2.png =

+				texture tex_atlas_med2.dds =

 			}	=

 		}
 	} =

@@ -45,7 +45,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med3.png =

+				texture tex_atlas_med3.dds =

 			}	=

 		}
 	} =

@@ -58,7 +58,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med4.png =

+				texture tex_atlas_med4.dds =

 			}	=

 		}
 	} =


Modified: trunk/lua/lib.test.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.test.lua (original)
+++ trunk/lua/lib.test.lua Tue Feb 19 19:30:53 2008
@@ -1,13 +1,6 @@
 -- contains all sorts of tests for checking the runtime environment and de=
bugging
 =

 -- april 2007
-function TestGuiSystem2_Init ()
-	--local dialog =3D gui.CreateDialog(300,100)
-	--local w1 =3D dialog:CreateImage("checker",0,0,100,100)
-	--local w2 =3D dialog:CreateText("blub",10,10)
-	--w1.mytext =3D "myimage"
-	--w2.mytext =3D "mytext"
-end
 function TestGuiSystem2_Step ()
 	local widget =3D gui.GetWidgetUnderMouse()
 	Client_SetBottomLine("TestGuiSystem2 WidgetUnderMouse : "..(widget and (w=
idget.mytext or "unknown") or "NONE"))



From no-reply at zwischenwelt.org  Fri Feb 22 17:56:13 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 22 Feb 2008 16:56:13 -0000
Subject: [Iris-commit] [IRIS] r1932 - /trunk/bin/iris2.exe
Message-ID: <20080222165613.DB1071524004@zwischenwelt.org>

Author: sience
Date: Fri Feb 22 17:56:13 2008
New Revision: 1932

Log:
-new binary w32

Modified:
    trunk/bin/iris2.exe

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Tue Feb 26 20:53:19 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 26 Feb 2008 19:53:19 -0000
Subject: [Iris-commit] [IRIS] r1933 - in /trunk: bin/
 data/models/models/to_004000/ data/models/models/to_007000/ lua/
 lua/filter/ src/
Message-ID: <20080226195324.664281524006@zwischenwelt.org>

Author: sience
Date: Tue Feb 26 20:53:09 2008
New Revision: 1933

Log:
-Meshes from Wilian Galvani added (license_public_domain) (bone meshes from=
 Map3)
-fix from arahil to builder.cpp
-new binary
-filter.art.lua adjusted for bone meshes

Added:
    trunk/data/models/models/to_004000/mdl_003788.mesh   (with props)
    trunk/data/models/models/to_004000/mdl_003791.mesh   (with props)
    trunk/data/models/models/to_004000/mdl_003793.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006872.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006873.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006874.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006875.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006876.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006880.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006881.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006882.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006883.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006884.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006921.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006922.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006923.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006924.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006925.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006926.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006927.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006928.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006929.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006930.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006931.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006933.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006934.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006935.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006936.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006937.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006938.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006939.mesh   (with props)
    trunk/data/models/models/to_007000/mdl_006940.mesh   (with props)
Modified:
    trunk/bin/iris2.exe
    trunk/lua/filter/filter.art.lua
    trunk/lua/lib.static.lua
    trunk/src/builder.cpp

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Tue Feb 26 20:53:09 2008
@@ -135,6 +135,7 @@
 gArtFilter[3326]=3D{maptoid=3D3274}
 gArtFilter[3323]=3D{maptoid=3D3274}
 gArtFilter[3320]=3D{maptoid=3D3274}
+
 -- cedar tree
 gArtFilter[3288]=3D{maptoid=3D3286,xadd=3D0.8,yadd=3D-0.7,zadd=3D0}
 =

@@ -156,7 +157,10 @@
 gArtFilter[16098]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:180",xadd=3D1.0=
,yadd=3D1.0,zadd=3D-0.25}
 gArtFilter[15980]=3D{maptoid=3D16093,rotation=3D"x:0,y:0,z:90" ,xadd=3D  0=
,yadd=3D1.0,zadd=3D-0.25}
 =

-
+-- bones
+gArtFilter[3792]=3D{maptoid=3D3791,rotation=3D"x:0,y:0,z:180",xadd=3D0,yad=
d=3D0,zadd=3D0}
+gArtFilter[3794]=3D{maptoid=3D3793,rotation=3D"x:0,y:0,z:180",xadd=3D0,yad=
d=3D0,zadd=3D0}
+gArtFilter[3789]=3D{maptoid=3D3788,rotation=3D"x:0,y:0,z:90",xadd=3D0,yadd=
=3D0,zadd=3D0}
 =

 ----------------------------------------------------------------------
 =


Modified: trunk/lua/lib.static.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.static.lua (original)
+++ trunk/lua/lib.static.lua Tue Feb 26 20:53:09 2008
@@ -13,14 +13,14 @@
 	local cached =3D gCustomModelCache[id]
 	if (cached ~=3D nil) then print("Model schonmal im gCustomModelCache") re=
turn cached end
 =

-	local base =3D id - math.mod(id,1000) + 1000
-	local relpath  =3D sprintf("models/to_%06d/",base)
-
 	local custompath =3D datapath.."custom/models/"..GetModelName(id)
 	if file_exists(custompath) then
 		gCustomModelCache[id] =3D custompath
 		return custompath
 	end
+
+	local base =3D id - math.mod(id,1000) + 1000
+	local relpath  =3D sprintf("models/to_%06d/",base)
 =

 	local meshpath =3D datapath.."models/"..relpath..GetModelName(id)
 	if file_exists(meshpath) then

Modified: trunk/src/builder.cpp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/src/builder.cpp (original)
+++ trunk/src/builder.cpp Tue Feb 26 20:53:09 2008
@@ -907,7 +907,9 @@
 			fValues[((y*8+x)*4+1)*3+1] =3D v.y;
 			fValues[((y*8+x)*4+1)*3+2] =3D v.z;
 =

-			v =3D NormalMap[x+1][y+1][2] + NormalMap[x][y+2][1] + NormalMap[x+2][y]=
[3] + NormalMap[x+2][y+2][0];
+//			v =3D NormalMap[x+1][y+1][2] + NormalMap[x][y+2][1] + NormalMap[x+2][=
y][3] + NormalMap[x+2][y+2][0];
+//Patch from Arahil
+			v =3D NormalMap[x+1][y+1][2] + NormalMap[x+1][y+2][1] + NormalMap[x+2][=
y+1][3] + NormalMap[x+2][y+2][0];
 			v.normalise();
 			fValues[((y*8+x)*4+2)*3+0] =3D v.x;
 			fValues[((y*8+x)*4+2)*3+1] =3D v.y;



From no-reply at zwischenwelt.org  Wed Feb 27 04:09:23 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 27 Feb 2008 03:09:23 -0000
Subject: [Iris-commit] [IRIS] r1934 - /trunk/lua/net/net.cursor.lua
Message-ID: <20080227030923.207F01C1870E@zwischenwelt.org>

Author: ghoulsblade
Date: Wed Feb 27 04:09:22 2008
New Revision: 1934

Log:
note about uo target netmessage

Modified:
    trunk/lua/net/net.cursor.lua

Modified: trunk/lua/net/net.cursor.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.cursor.lua (original)
+++ trunk/lua/net/net.cursor.lua Wed Feb 27 04:09:22 2008
@@ -5,7 +5,7 @@
 	local input =3D GetRecvFIFO()
 	local id 			=3D input:PopNetUint8()
 	gTargetModeType 	=3D input:PopNetUint8()  -- 0x00 =3D Select Object   0x0=
1 =3D Select X, Y, Z
-	gTargetModeSerial	=3D input:PopNetUint32() --  	The targeting cursor's se=
rial (usually this is just the player's serial).
+	gTargetModeSerial	=3D input:PopNetUint32() --  	The target request id, pr=
obably unique everytime : this is sent back in the answer packet
 	local flag 			=3D input:PopNetUint8() =

 		-- * 0x00 - Normal  =

 		-- * 0x01 - Criminal Action =




From no-reply at zwischenwelt.org  Wed Feb 27 10:57:00 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 27 Feb 2008 09:57:00 -0000
Subject: [Iris-commit] [IRIS] r1935 - in /trunk/data/models: atlas/ textures/
Message-ID: <20080227095701.428F91C1872C@zwischenwelt.org>

Author: hagish
Date: Wed Feb 27 10:57:00 2008
New Revision: 1935

Log:
some small texture improvements and atlas update

Modified:
    trunk/data/models/atlas/tex_atlas_alpha_low.lua
    trunk/data/models/atlas/tex_atlas_alpha_low0.png
    trunk/data/models/atlas/tex_atlas_alpha_med.lua
    trunk/data/models/atlas/tex_atlas_alpha_med.material
    trunk/data/models/atlas/tex_atlas_alpha_med0.png
    trunk/data/models/atlas/tex_atlas_alpha_med1.png
    trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua
    trunk/data/models/atlas/tex_atlas_alpha_ultralow0.png
    trunk/data/models/atlas/tex_atlas_low.lua
    trunk/data/models/atlas/tex_atlas_low1.png
    trunk/data/models/atlas/tex_atlas_med.lua
    trunk/data/models/atlas/tex_atlas_med.material
    trunk/data/models/atlas/tex_atlas_med2.png
    trunk/data/models/atlas/tex_atlas_med3.png
    trunk/data/models/atlas/tex_atlas_med4.png
    trunk/data/models/atlas/tex_atlas_ultralow.lua
    trunk/data/models/atlas/tex_atlas_ultralow0.png
    trunk/data/models/textures/tex_442.png
    trunk/data/models/textures/tex_443.png
    trunk/data/models/textures/tex_lantern.png
    trunk/data/models/textures/tex_mushroom.png
    trunk/data/models/textures/tex_mushroom2.png
    trunk/data/models/textures/tex_slidingdoor.png

Modified: trunk/data/models/atlas/tex_atlas_alpha_low.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_low.lua (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_low.lua Wed Feb 27 10:57:00 2008
@@ -138,30 +138,26 @@
 TexAtlas_RegisterMatTransform('tex_521', 'tex_atlas_alpha_low0', 0.7070312=
5,0.49609375,0.76953125,0.55859375)
 TexAtlas_RegisterMatTransform('tex_440', 'tex_atlas_alpha_low0', 0.7773437=
5,0.49609375,0.80859375,0.55859375)
 TexAtlas_RegisterMatTransform('tex_2481', 'tex_atlas_alpha_low0', 0.816406=
25,0.49609375,0.87890625,0.55859375)
-TexAtlas_RegisterMatTransform('tex_grass', 'tex_atlas_alpha_low0', 0.88671=
875,0.49609375,0.94921875,0.55859375)
-TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_alpha_low0', 0.00=
390625,0.56640625,0.06640625,0.62890625)
-TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_alpha_low0', 0.0=
7421875,0.56640625,0.13671875,0.62890625)
-TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_alpha_low0', 0=
.14453125,0.56640625,0.20703125,0.62890625)
-TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_alpha_low0', 0.214=
84375,0.56640625,0.27734375,0.62890625)
-TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_low0', 0.0039062=
5,0.63671875,0.06640625,0.66796875)
-TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_low0', 0.0742187=
5,0.63671875,0.13671875,0.66796875)
-TexAtlas_RegisterMatTransform('tex_155', 'tex_atlas_alpha_low0', 0.1445312=
5,0.63671875,0.20703125,0.66796875)
-TexAtlas_RegisterMatTransform('tex_164', 'tex_atlas_alpha_low0', 0.2148437=
5,0.63671875,0.27734375,0.66796875)
-TexAtlas_RegisterMatTransform('tex_485', 'tex_atlas_alpha_low0', 0.2851562=
5,0.63671875,0.34765625,0.66796875)
-TexAtlas_RegisterMatTransform('tex_173', 'tex_atlas_alpha_low0', 0.3554687=
5,0.63671875,0.41796875,0.66796875)
-TexAtlas_RegisterMatTransform('tex_156', 'tex_atlas_alpha_low0', 0.4257812=
5,0.63671875,0.48828125,0.66796875)
-TexAtlas_RegisterMatTransform('tex_122', 'tex_atlas_alpha_low0', 0.4960937=
5,0.63671875,0.55859375,0.66796875)
-TexAtlas_RegisterMatTransform('tex_165', 'tex_atlas_alpha_low0', 0.5664062=
5,0.63671875,0.62890625,0.66796875)
-TexAtlas_RegisterMatTransform('tex_417', 'tex_atlas_alpha_low0', 0.6367187=
5,0.63671875,0.69921875,0.66796875)
-TexAtlas_RegisterMatTransform('tex_559', 'tex_atlas_alpha_low0', 0.7070312=
5,0.63671875,0.76953125,0.66796875)
-TexAtlas_RegisterMatTransform('tex_123', 'tex_atlas_alpha_low0', 0.7773437=
5,0.63671875,0.83984375,0.66796875)
-TexAtlas_RegisterMatTransform('tex_418', 'tex_atlas_alpha_low0', 0.8476562=
5,0.63671875,0.91015625,0.66796875)
-TexAtlas_RegisterMatTransform('tex_480', 'tex_atlas_alpha_low0', 0.9179687=
5,0.63671875,0.98046875,0.66796875)
-TexAtlas_RegisterMatTransform('tex_570', 'tex_atlas_alpha_low0', 0.0039062=
5,0.67578125,0.06640625,0.70703125)
-TexAtlas_RegisterMatTransform('tex_419', 'tex_atlas_alpha_low0', 0.0742187=
5,0.67578125,0.13671875,0.70703125)
-TexAtlas_RegisterMatTransform('tex_420', 'tex_atlas_alpha_low0', 0.1445312=
5,0.67578125,0.20703125,0.70703125)
-TexAtlas_RegisterMatTransform('tex_151', 'tex_atlas_alpha_low0', 0.2148437=
5,0.67578125,0.27734375,0.70703125)
-TexAtlas_RegisterMatTransform('tex_160', 'tex_atlas_alpha_low0', 0.2851562=
5,0.67578125,0.34765625,0.70703125)
-TexAtlas_RegisterMatTransform('tex_153', 'tex_atlas_alpha_low0', 0.3554687=
5,0.67578125,0.41796875,0.70703125)
-TexAtlas_RegisterMatTransform('tex_62', 'tex_atlas_alpha_low0', 0.00390625=
,0.71484375,0.06640625,0.73046875)
-TexAtlas_RegisterMatTransform('tex_64', 'tex_atlas_alpha_low0', 0.07421875=
,0.71484375,0.13671875,0.73046875)
+TexAtlas_RegisterMatTransform('tex_flowers', 'tex_atlas_alpha_low0', 0.886=
71875,0.49609375,0.94921875,0.55859375)
+TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_low0', 0.0039062=
5,0.56640625,0.06640625,0.59765625)
+TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_low0', 0.0742187=
5,0.56640625,0.13671875,0.59765625)
+TexAtlas_RegisterMatTransform('tex_155', 'tex_atlas_alpha_low0', 0.1445312=
5,0.56640625,0.20703125,0.59765625)
+TexAtlas_RegisterMatTransform('tex_164', 'tex_atlas_alpha_low0', 0.2148437=
5,0.56640625,0.27734375,0.59765625)
+TexAtlas_RegisterMatTransform('tex_485', 'tex_atlas_alpha_low0', 0.2851562=
5,0.56640625,0.34765625,0.59765625)
+TexAtlas_RegisterMatTransform('tex_173', 'tex_atlas_alpha_low0', 0.3554687=
5,0.56640625,0.41796875,0.59765625)
+TexAtlas_RegisterMatTransform('tex_156', 'tex_atlas_alpha_low0', 0.4257812=
5,0.56640625,0.48828125,0.59765625)
+TexAtlas_RegisterMatTransform('tex_122', 'tex_atlas_alpha_low0', 0.4960937=
5,0.56640625,0.55859375,0.59765625)
+TexAtlas_RegisterMatTransform('tex_165', 'tex_atlas_alpha_low0', 0.5664062=
5,0.56640625,0.62890625,0.59765625)
+TexAtlas_RegisterMatTransform('tex_417', 'tex_atlas_alpha_low0', 0.6367187=
5,0.56640625,0.69921875,0.59765625)
+TexAtlas_RegisterMatTransform('tex_559', 'tex_atlas_alpha_low0', 0.7070312=
5,0.56640625,0.76953125,0.59765625)
+TexAtlas_RegisterMatTransform('tex_123', 'tex_atlas_alpha_low0', 0.7773437=
5,0.56640625,0.83984375,0.59765625)
+TexAtlas_RegisterMatTransform('tex_418', 'tex_atlas_alpha_low0', 0.8476562=
5,0.56640625,0.91015625,0.59765625)
+TexAtlas_RegisterMatTransform('tex_480', 'tex_atlas_alpha_low0', 0.9179687=
5,0.56640625,0.98046875,0.59765625)
+TexAtlas_RegisterMatTransform('tex_570', 'tex_atlas_alpha_low0', 0.0039062=
5,0.60546875,0.06640625,0.63671875)
+TexAtlas_RegisterMatTransform('tex_419', 'tex_atlas_alpha_low0', 0.0742187=
5,0.60546875,0.13671875,0.63671875)
+TexAtlas_RegisterMatTransform('tex_420', 'tex_atlas_alpha_low0', 0.1445312=
5,0.60546875,0.20703125,0.63671875)
+TexAtlas_RegisterMatTransform('tex_151', 'tex_atlas_alpha_low0', 0.2148437=
5,0.60546875,0.27734375,0.63671875)
+TexAtlas_RegisterMatTransform('tex_160', 'tex_atlas_alpha_low0', 0.2851562=
5,0.60546875,0.34765625,0.63671875)
+TexAtlas_RegisterMatTransform('tex_153', 'tex_atlas_alpha_low0', 0.3554687=
5,0.60546875,0.41796875,0.63671875)
+TexAtlas_RegisterMatTransform('tex_62', 'tex_atlas_alpha_low0', 0.00390625=
,0.64453125,0.06640625,0.66015625)
+TexAtlas_RegisterMatTransform('tex_64', 'tex_atlas_alpha_low0', 0.07421875=
,0.64453125,0.13671875,0.66015625)

Modified: trunk/data/models/atlas/tex_atlas_alpha_low0.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_alpha_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_med.lua (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_med.lua Wed Feb 27 10:57:00 2008
@@ -107,11 +107,7 @@
 TexAtlas_RegisterMatTransform('tex_59', 'tex_atlas_alpha_med1', 0.85351562=
5,0.263671875,0.916015625,0.388671875)
 TexAtlas_RegisterMatTransform('tex_521', 'tex_atlas_alpha_med1', 0.0019531=
25,0.392578125,0.126953125,0.517578125)
 TexAtlas_RegisterMatTransform('tex_2481', 'tex_atlas_alpha_med1', 0.130859=
375,0.392578125,0.255859375,0.517578125)
-TexAtlas_RegisterMatTransform('tex_grass', 'tex_atlas_alpha_med1', 0.25976=
5625,0.392578125,0.384765625,0.517578125)
-TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_alpha_med1', 0.38=
8671875,0.392578125,0.513671875,0.517578125)
-TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_alpha_med1', 0.5=
17578125,0.392578125,0.642578125,0.517578125)
-TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_alpha_med1', 0=
.646484375,0.392578125,0.771484375,0.517578125)
-TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_alpha_med1', 0.775=
390625,0.392578125,0.900390625,0.517578125)
+TexAtlas_RegisterMatTransform('tex_flowers', 'tex_atlas_alpha_med1', 0.259=
765625,0.392578125,0.384765625,0.517578125)
 TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_med1', 0.0019531=
25,0.521484375,0.126953125,0.583984375)
 TexAtlas_RegisterMatTransform('tex_531', 'tex_atlas_alpha_med1', 0.1308593=
75,0.521484375,0.193359375,0.583984375)
 TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_med1', 0.1972656=
25,0.521484375,0.322265625,0.583984375)

Modified: trunk/data/models/atlas/tex_atlas_alpha_med.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_med.material (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_med.material Wed Feb 27 10:57:0=
0 2008
@@ -6,7 +6,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_alpha_med0.dds =

+				texture tex_atlas_alpha_med0.png =

 			}	=

 		}
 	} =

@@ -19,7 +19,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_alpha_med1.dds =

+				texture tex_atlas_alpha_med1.png =

 			}	=

 		}
 	} =


Modified: trunk/data/models/atlas/tex_atlas_alpha_med0.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_alpha_med1.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua (original)
+++ trunk/data/models/atlas/tex_atlas_alpha_ultralow.lua Wed Feb 27 10:57:0=
0 2008
@@ -138,11 +138,7 @@
 TexAtlas_RegisterMatTransform('tex_521', 'tex_atlas_alpha_ultralow0', 0.35=
15625,0.2421875,0.3828125,0.2734375)
 TexAtlas_RegisterMatTransform('tex_440', 'tex_atlas_alpha_ultralow0', 0.39=
84375,0.2421875,0.4140625,0.2734375)
 TexAtlas_RegisterMatTransform('tex_2481', 'tex_atlas_alpha_ultralow0', 0.4=
296875,0.2421875,0.4609375,0.2734375)
-TexAtlas_RegisterMatTransform('tex_grass', 'tex_atlas_alpha_ultralow0', 0.=
4765625,0.2421875,0.5078125,0.2734375)
-TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_alpha_ultralow0',=
 0.5234375,0.2421875,0.5546875,0.2734375)
-TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_alpha_ultralow0'=
, 0.5703125,0.2421875,0.6015625,0.2734375)
-TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_alpha_ultralow=
0', 0.6171875,0.2421875,0.6484375,0.2734375)
-TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_alpha_ultralow0', =
0.6640625,0.2421875,0.6953125,0.2734375)
+TexAtlas_RegisterMatTransform('tex_flowers', 'tex_atlas_alpha_ultralow0', =
0.4765625,0.2421875,0.5078125,0.2734375)
 TexAtlas_RegisterMatTransform('tex_163', 'tex_atlas_alpha_ultralow0', 0.00=
78125,0.2890625,0.0390625,0.3046875)
 TexAtlas_RegisterMatTransform('tex_172', 'tex_atlas_alpha_ultralow0', 0.05=
46875,0.2890625,0.0859375,0.3046875)
 TexAtlas_RegisterMatTransform('tex_155', 'tex_atlas_alpha_ultralow0', 0.10=
15625,0.2890625,0.1328125,0.3046875)

Modified: trunk/data/models/atlas/tex_atlas_alpha_ultralow0.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_low.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_low.lua (original)
+++ trunk/data/models/atlas/tex_atlas_low.lua Wed Feb 27 10:57:00 2008
@@ -341,7 +341,12 @@
 TexAtlas_RegisterMatTransform('tex_324', 'tex_atlas_low1', 0.81640625,0.50=
390625,0.87890625,0.56640625)
 TexAtlas_RegisterMatTransform('tex_208', 'tex_atlas_low1', 0.88671875,0.50=
390625,0.94921875,0.56640625)
 TexAtlas_RegisterMatTransform('tex_5351', 'tex_atlas_low1', 0.00390625,0.5=
7421875,0.06640625,0.63671875)
-TexAtlas_RegisterMatTransform('tex_5634', 'tex_atlas_low1', 0.07421875,0.5=
7421875,0.13671875,0.63671875)
+TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_low1', 0.07421875=
,0.57421875,0.13671875,0.63671875)
+TexAtlas_RegisterMatTransform('tex_5634', 'tex_atlas_low1', 0.14453125,0.5=
7421875,0.20703125,0.63671875)
+TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_low1', 0.2148437=
5,0.57421875,0.27734375,0.63671875)
+TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_low1', 0.28515625,=
0.57421875,0.34765625,0.63671875)
+TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_low1', 0.35546=
875,0.57421875,0.41796875,0.63671875)
+TexAtlas_RegisterMatTransform('tex_stoneplate', 'tex_atlas_low1', 0.425781=
25,0.57421875,0.48828125,0.63671875)
 TexAtlas_RegisterMatTransform('tex_483', 'tex_atlas_low1', 0.00390625,0.64=
453125,0.06640625,0.67578125)
 TexAtlas_RegisterMatTransform('tex_564', 'tex_atlas_low1', 0.07421875,0.64=
453125,0.13671875,0.67578125)
 TexAtlas_RegisterMatTransform('tex_286', 'tex_atlas_low1', 0.14453125,0.64=
453125,0.20703125,0.67578125)

Modified: trunk/data/models/atlas/tex_atlas_low1.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_med.lua (original)
+++ trunk/data/models/atlas/tex_atlas_med.lua Wed Feb 27 10:57:00 2008
@@ -176,240 +176,245 @@
 TexAtlas_RegisterMatTransform('tex_16', 'tex_atlas_med2', 0.001953125,0.65=
0390625,0.126953125,0.775390625)
 TexAtlas_RegisterMatTransform('tex_405', 'tex_atlas_med2', 0.130859375,0.6=
50390625,0.255859375,0.775390625)
 TexAtlas_RegisterMatTransform('tex_5351', 'tex_atlas_med2', 0.259765625,0.=
650390625,0.384765625,0.775390625)
-TexAtlas_RegisterMatTransform('tex_5634', 'tex_atlas_med2', 0.388671875,0.=
650390625,0.513671875,0.775390625)
-TexAtlas_RegisterMatTransform('tex_483', 'tex_atlas_med2', 0.001953125,0.7=
79296875,0.126953125,0.841796875)
-TexAtlas_RegisterMatTransform('tex_564', 'tex_atlas_med2', 0.130859375,0.7=
79296875,0.255859375,0.841796875)
-TexAtlas_RegisterMatTransform('tex_367', 'tex_atlas_med2', 0.259765625,0.7=
79296875,0.322265625,0.841796875)
-TexAtlas_RegisterMatTransform('tex_286', 'tex_atlas_med2', 0.326171875,0.7=
79296875,0.451171875,0.841796875)
-TexAtlas_RegisterMatTransform('tex_333', 'tex_atlas_med2', 0.455078125,0.7=
79296875,0.517578125,0.841796875)
-TexAtlas_RegisterMatTransform('tex_171', 'tex_atlas_med2', 0.521484375,0.7=
79296875,0.646484375,0.841796875)
-TexAtlas_RegisterMatTransform('tex_136', 'tex_atlas_med2', 0.650390625,0.7=
79296875,0.775390625,0.841796875)
-TexAtlas_RegisterMatTransform('tex_217', 'tex_atlas_med2', 0.779296875,0.7=
79296875,0.841796875,0.841796875)
-TexAtlas_RegisterMatTransform('tex_342', 'tex_atlas_med2', 0.845703125,0.7=
79296875,0.908203125,0.841796875)
-TexAtlas_RegisterMatTransform('tex_145', 'tex_atlas_med2', 0.001953125,0.8=
45703125,0.126953125,0.908203125)
-TexAtlas_RegisterMatTransform('tex_226', 'tex_atlas_med2', 0.130859375,0.8=
45703125,0.193359375,0.908203125)
-TexAtlas_RegisterMatTransform('tex_307', 'tex_atlas_med2', 0.197265625,0.8=
45703125,0.259765625,0.908203125)
-TexAtlas_RegisterMatTransform('tex_188', 'tex_atlas_med2', 0.263671875,0.8=
45703125,0.326171875,0.908203125)
-TexAtlas_RegisterMatTransform('tex_154', 'tex_atlas_med2', 0.330078125,0.8=
45703125,0.455078125,0.908203125)
-TexAtlas_RegisterMatTransform('tex_235', 'tex_atlas_med2', 0.458984375,0.8=
45703125,0.521484375,0.908203125)
-TexAtlas_RegisterMatTransform('tex_316', 'tex_atlas_med2', 0.525390625,0.8=
45703125,0.587890625,0.908203125)
-TexAtlas_RegisterMatTransform('tex_556', 'tex_atlas_med2', 0.591796875,0.8=
45703125,0.654296875,0.908203125)
-TexAtlas_RegisterMatTransform('tex_197', 'tex_atlas_med2', 0.658203125,0.8=
45703125,0.720703125,0.908203125)
-TexAtlas_RegisterMatTransform('tex_201', 'tex_atlas_med2', 0.724609375,0.8=
45703125,0.787109375,0.908203125)
-TexAtlas_RegisterMatTransform('tex_325', 'tex_atlas_med2', 0.791015625,0.8=
45703125,0.853515625,0.908203125)
-TexAtlas_RegisterMatTransform('tex_244', 'tex_atlas_med2', 0.857421875,0.8=
45703125,0.919921875,0.908203125)
-TexAtlas_RegisterMatTransform('tex_209', 'tex_atlas_med2', 0.923828125,0.8=
45703125,0.986328125,0.908203125)
-TexAtlas_RegisterMatTransform('tex_128', 'tex_atlas_med2', 0.001953125,0.9=
12109375,0.126953125,0.974609375)
-TexAtlas_RegisterMatTransform('tex_484', 'tex_atlas_med2', 0.130859375,0.9=
12109375,0.255859375,0.974609375)
-TexAtlas_RegisterMatTransform('tex_368', 'tex_atlas_med2', 0.259765625,0.9=
12109375,0.322265625,0.974609375)
-TexAtlas_RegisterMatTransform('tex_26', 'tex_atlas_med2', 0.326171875,0.91=
2109375,0.388671875,0.974609375)
-TexAtlas_RegisterMatTransform('tex_210', 'tex_atlas_med2', 0.392578125,0.9=
12109375,0.455078125,0.974609375)
-TexAtlas_RegisterMatTransform('tex_334', 'tex_atlas_med2', 0.458984375,0.9=
12109375,0.521484375,0.974609375)
-TexAtlas_RegisterMatTransform('tex_137', 'tex_atlas_med2', 0.525390625,0.9=
12109375,0.650390625,0.974609375)
-TexAtlas_RegisterMatTransform('tex_493', 'tex_atlas_med2', 0.654296875,0.9=
12109375,0.716796875,0.974609375)
-TexAtlas_RegisterMatTransform('tex_70', 'tex_atlas_med2', 0.720703125,0.91=
2109375,0.845703125,0.974609375)
-TexAtlas_RegisterMatTransform('tex_343', 'tex_atlas_med2', 0.849609375,0.9=
12109375,0.912109375,0.974609375)
-TexAtlas_RegisterMatTransform('tex_146', 'tex_atlas_med3', 0.001953125,0.0=
05859375,0.126953125,0.068359375)
-TexAtlas_RegisterMatTransform('tex_227', 'tex_atlas_med3', 0.130859375,0.0=
05859375,0.193359375,0.068359375)
-TexAtlas_RegisterMatTransform('tex_308', 'tex_atlas_med3', 0.197265625,0.0=
05859375,0.259765625,0.068359375)
-TexAtlas_RegisterMatTransform('tex_386', 'tex_atlas_med3', 0.263671875,0.0=
05859375,0.326171875,0.068359375)
-TexAtlas_RegisterMatTransform('tex_189', 'tex_atlas_med3', 0.330078125,0.0=
05859375,0.392578125,0.068359375)
-TexAtlas_RegisterMatTransform('tex_190', 'tex_atlas_med3', 0.396484375,0.0=
05859375,0.458984375,0.068359375)
-TexAtlas_RegisterMatTransform('tex_236', 'tex_atlas_med3', 0.462890625,0.0=
05859375,0.525390625,0.068359375)
-TexAtlas_RegisterMatTransform('tex_317', 'tex_atlas_med3', 0.529296875,0.0=
05859375,0.591796875,0.068359375)
-TexAtlas_RegisterMatTransform('tex_198', 'tex_atlas_med3', 0.595703125,0.0=
05859375,0.658203125,0.068359375)
-TexAtlas_RegisterMatTransform('tex_202', 'tex_atlas_med3', 0.662109375,0.0=
05859375,0.724609375,0.068359375)
-TexAtlas_RegisterMatTransform('tex_121', 'tex_atlas_med3', 0.728515625,0.0=
05859375,0.791015625,0.068359375)
-TexAtlas_RegisterMatTransform('tex_326', 'tex_atlas_med3', 0.794921875,0.0=
05859375,0.857421875,0.068359375)
-TexAtlas_RegisterMatTransform('tex_245', 'tex_atlas_med3', 0.861328125,0.0=
05859375,0.923828125,0.068359375)
-TexAtlas_RegisterMatTransform('tex_129', 'tex_atlas_med3', 0.001953125,0.0=
72265625,0.126953125,0.134765625)
-TexAtlas_RegisterMatTransform('tex_369', 'tex_atlas_med3', 0.130859375,0.0=
72265625,0.193359375,0.134765625)
-TexAtlas_RegisterMatTransform('tex_27', 'tex_atlas_med3', 0.197265625,0.07=
2265625,0.259765625,0.134765625)
-TexAtlas_RegisterMatTransform('tex_2', 'tex_atlas_med3', 0.263671875,0.072=
265625,0.326171875,0.134765625)
-TexAtlas_RegisterMatTransform('tex_130', 'tex_atlas_med3', 0.330078125,0.0=
72265625,0.455078125,0.134765625)
-TexAtlas_RegisterMatTransform('tex_211', 'tex_atlas_med3', 0.458984375,0.0=
72265625,0.521484375,0.134765625)
-TexAtlas_RegisterMatTransform('tex_370', 'tex_atlas_med3', 0.525390625,0.0=
72265625,0.587890625,0.134765625)
-TexAtlas_RegisterMatTransform('tex_335', 'tex_atlas_med3', 0.591796875,0.0=
72265625,0.654296875,0.134765625)
-TexAtlas_RegisterMatTransform('tex_138', 'tex_atlas_med3', 0.658203125,0.0=
72265625,0.783203125,0.134765625)
-TexAtlas_RegisterMatTransform('tex_494', 'tex_atlas_med3', 0.787109375,0.0=
72265625,0.849609375,0.134765625)
-TexAtlas_RegisterMatTransform('tex_220', 'tex_atlas_med3', 0.853515625,0.0=
72265625,0.916015625,0.134765625)
-TexAtlas_RegisterMatTransform('tex_344', 'tex_atlas_med3', 0.919921875,0.0=
72265625,0.982421875,0.134765625)
-TexAtlas_RegisterMatTransform('tex_147', 'tex_atlas_med3', 0.001953125,0.1=
38671875,0.126953125,0.201171875)
-TexAtlas_RegisterMatTransform('tex_228', 'tex_atlas_med3', 0.130859375,0.1=
38671875,0.193359375,0.201171875)
-TexAtlas_RegisterMatTransform('tex_309', 'tex_atlas_med3', 0.197265625,0.1=
38671875,0.259765625,0.201171875)
-TexAtlas_RegisterMatTransform('tex_310', 'tex_atlas_med3', 0.263671875,0.1=
38671875,0.326171875,0.201171875)
-TexAtlas_RegisterMatTransform('tex_113', 'tex_atlas_med3', 0.330078125,0.1=
38671875,0.455078125,0.201171875)
-TexAtlas_RegisterMatTransform('tex_515', 'tex_atlas_med3', 0.458984375,0.1=
38671875,0.521484375,0.201171875)
-TexAtlas_RegisterMatTransform('tex_191', 'tex_atlas_med3', 0.525390625,0.1=
38671875,0.587890625,0.201171875)
-TexAtlas_RegisterMatTransform('tex_237', 'tex_atlas_med3', 0.591796875,0.1=
38671875,0.654296875,0.201171875)
-TexAtlas_RegisterMatTransform('tex_318', 'tex_atlas_med3', 0.658203125,0.1=
38671875,0.720703125,0.201171875)
-TexAtlas_RegisterMatTransform('tex_477', 'tex_atlas_med3', 0.724609375,0.1=
38671875,0.787109375,0.201171875)
-TexAtlas_RegisterMatTransform('tex_396', 'tex_atlas_med3', 0.791015625,0.1=
38671875,0.853515625,0.201171875)
-TexAtlas_RegisterMatTransform('tex_199', 'tex_atlas_med3', 0.857421875,0.1=
38671875,0.919921875,0.201171875)
-TexAtlas_RegisterMatTransform('tex_400', 'tex_atlas_med3', 0.923828125,0.1=
38671875,0.986328125,0.201171875)
-TexAtlas_RegisterMatTransform('tex_203', 'tex_atlas_med3', 0.001953125,0.2=
05078125,0.064453125,0.267578125)
-TexAtlas_RegisterMatTransform('tex_524', 'tex_atlas_med3', 0.068359375,0.2=
05078125,0.130859375,0.267578125)
-TexAtlas_RegisterMatTransform('tex_327', 'tex_atlas_med3', 0.134765625,0.2=
05078125,0.197265625,0.267578125)
-TexAtlas_RegisterMatTransform('tex_246', 'tex_atlas_med3', 0.201171875,0.2=
05078125,0.263671875,0.267578125)
-TexAtlas_RegisterMatTransform('tex_131', 'tex_atlas_med3', 0.267578125,0.2=
05078125,0.392578125,0.267578125)
-TexAtlas_RegisterMatTransform('tex_212', 'tex_atlas_med3', 0.396484375,0.2=
05078125,0.458984375,0.267578125)
-TexAtlas_RegisterMatTransform('tex_371', 'tex_atlas_med3', 0.462890625,0.2=
05078125,0.525390625,0.267578125)
-TexAtlas_RegisterMatTransform('tex_336', 'tex_atlas_med3', 0.529296875,0.2=
05078125,0.591796875,0.267578125)
-TexAtlas_RegisterMatTransform('tex_139', 'tex_atlas_med3', 0.595703125,0.2=
05078125,0.720703125,0.267578125)
-TexAtlas_RegisterMatTransform('tex_495', 'tex_atlas_med3', 0.724609375,0.2=
05078125,0.787109375,0.267578125)
-TexAtlas_RegisterMatTransform('tex_140', 'tex_atlas_med3', 0.791015625,0.2=
05078125,0.916015625,0.267578125)
-TexAtlas_RegisterMatTransform('tex_221', 'tex_atlas_med3', 0.919921875,0.2=
05078125,0.982421875,0.267578125)
-TexAtlas_RegisterMatTransform('tex_461', 'tex_atlas_med3', 0.001953125,0.2=
71484375,0.033203125,0.333984375)
-TexAtlas_RegisterMatTransform('tex_345', 'tex_atlas_med3', 0.037109375,0.2=
71484375,0.099609375,0.333984375)
-TexAtlas_RegisterMatTransform('tex_183', 'tex_atlas_med3', 0.103515625,0.2=
71484375,0.166015625,0.333984375)
-TexAtlas_RegisterMatTransform('tex_148', 'tex_atlas_med3', 0.169921875,0.2=
71484375,0.294921875,0.333984375)
-TexAtlas_RegisterMatTransform('tex_229', 'tex_atlas_med3', 0.298828125,0.2=
71484375,0.361328125,0.333984375)
-TexAtlas_RegisterMatTransform('tex_230', 'tex_atlas_med3', 0.365234375,0.2=
71484375,0.427734375,0.333984375)
-TexAtlas_RegisterMatTransform('tex_311', 'tex_atlas_med3', 0.431640625,0.2=
71484375,0.494140625,0.333984375)
-TexAtlas_RegisterMatTransform('tex_551', 'tex_atlas_med3', 0.498046875,0.2=
71484375,0.560546875,0.333984375)
-TexAtlas_RegisterMatTransform('tex_516', 'tex_atlas_med3', 0.564453125,0.2=
71484375,0.626953125,0.333984375)
-TexAtlas_RegisterMatTransform('tex_192', 'tex_atlas_med3', 0.630859375,0.2=
71484375,0.693359375,0.333984375)
-TexAtlas_RegisterMatTransform('tex_157', 'tex_atlas_med3', 0.697265625,0.2=
71484375,0.822265625,0.333984375)
-TexAtlas_RegisterMatTransform('tex_238', 'tex_atlas_med3', 0.826171875,0.2=
71484375,0.888671875,0.333984375)
-TexAtlas_RegisterMatTransform('tex_319', 'tex_atlas_med3', 0.892578125,0.2=
71484375,0.955078125,0.333984375)
-TexAtlas_RegisterMatTransform('tex_397', 'tex_atlas_med3', 0.001953125,0.3=
37890625,0.064453125,0.400390625)
-TexAtlas_RegisterMatTransform('tex_401', 'tex_atlas_med3', 0.068359375,0.3=
37890625,0.130859375,0.400390625)
-TexAtlas_RegisterMatTransform('tex_320', 'tex_atlas_med3', 0.134765625,0.3=
37890625,0.197265625,0.400390625)
-TexAtlas_RegisterMatTransform('tex_204', 'tex_atlas_med3', 0.201171875,0.3=
37890625,0.263671875,0.400390625)
-TexAtlas_RegisterMatTransform('tex_525', 'tex_atlas_med3', 0.267578125,0.3=
37890625,0.330078125,0.400390625)
-TexAtlas_RegisterMatTransform('tex_409', 'tex_atlas_med3', 0.333984375,0.3=
37890625,0.458984375,0.400390625)
-TexAtlas_RegisterMatTransform('tex_328', 'tex_atlas_med3', 0.462890625,0.3=
37890625,0.525390625,0.400390625)
-TexAtlas_RegisterMatTransform('tex_166', 'tex_atlas_med3', 0.529296875,0.3=
37890625,0.654296875,0.400390625)
-TexAtlas_RegisterMatTransform('tex_132', 'tex_atlas_med3', 0.658203125,0.3=
37890625,0.783203125,0.400390625)
-TexAtlas_RegisterMatTransform('tex_213', 'tex_atlas_med3', 0.787109375,0.3=
37890625,0.849609375,0.400390625)
-TexAtlas_RegisterMatTransform('tex_453', 'tex_atlas_med3', 0.853515625,0.3=
37890625,0.916015625,0.400390625)
-TexAtlas_RegisterMatTransform('tex_337', 'tex_atlas_med3', 0.919921875,0.3=
37890625,0.982421875,0.400390625)
-TexAtlas_RegisterMatTransform('tex_256', 'tex_atlas_med3', 0.001953125,0.4=
04296875,0.126953125,0.466796875)
-TexAtlas_RegisterMatTransform('tex_496', 'tex_atlas_med3', 0.130859375,0.4=
04296875,0.193359375,0.466796875)
-TexAtlas_RegisterMatTransform('tex_141', 'tex_atlas_med3', 0.197265625,0.4=
04296875,0.322265625,0.466796875)
-TexAtlas_RegisterMatTransform('tex_222', 'tex_atlas_med3', 0.326171875,0.4=
04296875,0.388671875,0.466796875)
-TexAtlas_RegisterMatTransform('tex_303', 'tex_atlas_med3', 0.392578125,0.4=
04296875,0.455078125,0.466796875)
-TexAtlas_RegisterMatTransform('tex_462', 'tex_atlas_med3', 0.458984375,0.4=
04296875,0.490234375,0.466796875)
-TexAtlas_RegisterMatTransform('tex_184', 'tex_atlas_med3', 0.494140625,0.4=
04296875,0.556640625,0.466796875)
-TexAtlas_RegisterMatTransform('tex_149', 'tex_atlas_med3', 0.560546875,0.4=
04296875,0.685546875,0.466796875)
-TexAtlas_RegisterMatTransform('tex_150', 'tex_atlas_med3', 0.689453125,0.4=
04296875,0.814453125,0.466796875)
-TexAtlas_RegisterMatTransform('tex_231', 'tex_atlas_med3', 0.818359375,0.4=
04296875,0.880859375,0.466796875)
-TexAtlas_RegisterMatTransform('tex_312', 'tex_atlas_med3', 0.884765625,0.4=
04296875,0.947265625,0.466796875)
-TexAtlas_RegisterMatTransform('tex_517', 'tex_atlas_med3', 0.001953125,0.4=
70703125,0.064453125,0.533203125)
-TexAtlas_RegisterMatTransform('tex_193', 'tex_atlas_med3', 0.068359375,0.4=
70703125,0.130859375,0.533203125)
-TexAtlas_RegisterMatTransform('tex_158', 'tex_atlas_med3', 0.134765625,0.4=
70703125,0.259765625,0.533203125)
-TexAtlas_RegisterMatTransform('tex_239', 'tex_atlas_med3', 0.263671875,0.4=
70703125,0.326171875,0.533203125)
-TexAtlas_RegisterMatTransform('tex_479', 'tex_atlas_med3', 0.330078125,0.4=
70703125,0.392578125,0.533203125)
-TexAtlas_RegisterMatTransform('tex_398', 'tex_atlas_med3', 0.396484375,0.4=
70703125,0.458984375,0.533203125)
-TexAtlas_RegisterMatTransform('tex_402', 'tex_atlas_med3', 0.462890625,0.4=
70703125,0.525390625,0.533203125)
-TexAtlas_RegisterMatTransform('tex_240', 'tex_atlas_med3', 0.529296875,0.4=
70703125,0.591796875,0.533203125)
-TexAtlas_RegisterMatTransform('tex_321', 'tex_atlas_med3', 0.595703125,0.4=
70703125,0.658203125,0.533203125)
-TexAtlas_RegisterMatTransform('tex_205', 'tex_atlas_med3', 0.662109375,0.4=
70703125,0.724609375,0.533203125)
-TexAtlas_RegisterMatTransform('tex_124', 'tex_atlas_med3', 0.728515625,0.4=
70703125,0.853515625,0.533203125)
-TexAtlas_RegisterMatTransform('tex_561', 'tex_atlas_med3', 0.857421875,0.4=
70703125,0.982421875,0.533203125)
-TexAtlas_RegisterMatTransform('tex_526', 'tex_atlas_med3', 0.001953125,0.5=
37109375,0.064453125,0.599609375)
-TexAtlas_RegisterMatTransform('tex_329', 'tex_atlas_med3', 0.068359375,0.5=
37109375,0.130859375,0.599609375)
-TexAtlas_RegisterMatTransform('tex_167', 'tex_atlas_med3', 0.134765625,0.5=
37109375,0.259765625,0.599609375)
-TexAtlas_RegisterMatTransform('tex_22', 'tex_atlas_med3', 0.263671875,0.53=
7109375,0.326171875,0.599609375)
-TexAtlas_RegisterMatTransform('tex_330', 'tex_atlas_med3', 0.330078125,0.5=
37109375,0.392578125,0.599609375)
-TexAtlas_RegisterMatTransform('tex_133', 'tex_atlas_med3', 0.396484375,0.5=
37109375,0.521484375,0.599609375)
-TexAtlas_RegisterMatTransform('tex_214', 'tex_atlas_med3', 0.525390625,0.5=
37109375,0.587890625,0.599609375)
-TexAtlas_RegisterMatTransform('tex_338', 'tex_atlas_med3', 0.591796875,0.5=
37109375,0.654296875,0.599609375)
-TexAtlas_RegisterMatTransform('tex_142', 'tex_atlas_med3', 0.658203125,0.5=
37109375,0.783203125,0.599609375)
-TexAtlas_RegisterMatTransform('tex_223', 'tex_atlas_med3', 0.787109375,0.5=
37109375,0.849609375,0.599609375)
-TexAtlas_RegisterMatTransform('tex_304', 'tex_atlas_med3', 0.853515625,0.5=
37109375,0.916015625,0.599609375)
-TexAtlas_RegisterMatTransform('tex_463', 'tex_atlas_med3', 0.919921875,0.5=
37109375,0.982421875,0.599609375)
-TexAtlas_RegisterMatTransform('tex_185', 'tex_atlas_med3', 0.001953125,0.6=
03515625,0.064453125,0.666015625)
-TexAtlas_RegisterMatTransform('tex_232', 'tex_atlas_med3', 0.068359375,0.6=
03515625,0.130859375,0.666015625)
-TexAtlas_RegisterMatTransform('tex_313', 'tex_atlas_med3', 0.134765625,0.6=
03515625,0.197265625,0.666015625)
-TexAtlas_RegisterMatTransform('tex_194', 'tex_atlas_med3', 0.201171875,0.6=
03515625,0.263671875,0.666015625)
-TexAtlas_RegisterMatTransform('tex_159', 'tex_atlas_med3', 0.267578125,0.6=
03515625,0.392578125,0.666015625)
-TexAtlas_RegisterMatTransform('tex_399', 'tex_atlas_med3', 0.396484375,0.6=
03515625,0.458984375,0.666015625)
-TexAtlas_RegisterMatTransform('tex_403', 'tex_atlas_med3', 0.462890625,0.6=
03515625,0.587890625,0.666015625)
-TexAtlas_RegisterMatTransform('tex_241', 'tex_atlas_med3', 0.591796875,0.6=
03515625,0.654296875,0.666015625)
-TexAtlas_RegisterMatTransform('tex_322', 'tex_atlas_med3', 0.658203125,0.6=
03515625,0.720703125,0.666015625)
-TexAtlas_RegisterMatTransform('tex_206', 'tex_atlas_med3', 0.724609375,0.6=
03515625,0.787109375,0.666015625)
-TexAtlas_RegisterMatTransform('tex_125', 'tex_atlas_med3', 0.791015625,0.6=
03515625,0.916015625,0.666015625)
-TexAtlas_RegisterMatTransform('tex_168', 'tex_atlas_med3', 0.001953125,0.6=
69921875,0.126953125,0.732421875)
-TexAtlas_RegisterMatTransform('tex_23', 'tex_atlas_med3', 0.130859375,0.66=
9921875,0.255859375,0.732421875)
-TexAtlas_RegisterMatTransform('tex_331', 'tex_atlas_med3', 0.259765625,0.6=
69921875,0.322265625,0.732421875)
-TexAtlas_RegisterMatTransform('tex_134', 'tex_atlas_med3', 0.326171875,0.6=
69921875,0.451171875,0.732421875)
-TexAtlas_RegisterMatTransform('tex_215', 'tex_atlas_med3', 0.455078125,0.6=
69921875,0.517578125,0.732421875)
-TexAtlas_RegisterMatTransform('tex_571', 'tex_atlas_med3', 0.521484375,0.6=
69921875,0.646484375,0.732421875)
-TexAtlas_RegisterMatTransform('tex_339', 'tex_atlas_med3', 0.650390625,0.6=
69921875,0.712890625,0.732421875)
-TexAtlas_RegisterMatTransform('tex_258', 'tex_atlas_med3', 0.716796875,0.6=
69921875,0.779296875,0.732421875)
-TexAtlas_RegisterMatTransform('tex_340', 'tex_atlas_med3', 0.783203125,0.6=
69921875,0.845703125,0.732421875)
-TexAtlas_RegisterMatTransform('tex_143', 'tex_atlas_med3', 0.849609375,0.6=
69921875,0.974609375,0.732421875)
-TexAtlas_RegisterMatTransform('tex_224', 'tex_atlas_med3', 0.001953125,0.7=
36328125,0.064453125,0.798828125)
-TexAtlas_RegisterMatTransform('tex_305', 'tex_atlas_med3', 0.068359375,0.7=
36328125,0.130859375,0.798828125)
-TexAtlas_RegisterMatTransform('tex_464', 'tex_atlas_med3', 0.134765625,0.7=
36328125,0.197265625,0.798828125)
-TexAtlas_RegisterMatTransform('tex_186', 'tex_atlas_med3', 0.201171875,0.7=
36328125,0.263671875,0.798828125)
-TexAtlas_RegisterMatTransform('tex_152', 'tex_atlas_med3', 0.267578125,0.7=
36328125,0.392578125,0.798828125)
-TexAtlas_RegisterMatTransform('tex_233', 'tex_atlas_med3', 0.396484375,0.7=
36328125,0.458984375,0.798828125)
-TexAtlas_RegisterMatTransform('tex_314', 'tex_atlas_med3', 0.462890625,0.7=
36328125,0.525390625,0.798828125)
-TexAtlas_RegisterMatTransform('tex_195', 'tex_atlas_med3', 0.529296875,0.7=
36328125,0.591796875,0.798828125)
-TexAtlas_RegisterMatTransform('tex_161', 'tex_atlas_med3', 0.595703125,0.7=
36328125,0.720703125,0.798828125)
-TexAtlas_RegisterMatTransform('tex_242', 'tex_atlas_med3', 0.724609375,0.7=
36328125,0.787109375,0.798828125)
-TexAtlas_RegisterMatTransform('tex_323', 'tex_atlas_med3', 0.791015625,0.7=
36328125,0.853515625,0.798828125)
-TexAtlas_RegisterMatTransform('tex_207', 'tex_atlas_med3', 0.857421875,0.7=
36328125,0.919921875,0.798828125)
-TexAtlas_RegisterMatTransform('tex_126', 'tex_atlas_med3', 0.001953125,0.8=
02734375,0.126953125,0.865234375)
-TexAtlas_RegisterMatTransform('tex_366', 'tex_atlas_med3', 0.130859375,0.8=
02734375,0.193359375,0.865234375)
-TexAtlas_RegisterMatTransform('tex_169', 'tex_atlas_med3', 0.197265625,0.8=
02734375,0.322265625,0.865234375)
-TexAtlas_RegisterMatTransform('tex_332', 'tex_atlas_med3', 0.326171875,0.8=
02734375,0.388671875,0.865234375)
-TexAtlas_RegisterMatTransform('tex_170', 'tex_atlas_med3', 0.392578125,0.8=
02734375,0.517578125,0.865234375)
-TexAtlas_RegisterMatTransform('tex_251', 'tex_atlas_med3', 0.521484375,0.8=
02734375,0.646484375,0.865234375)
-TexAtlas_RegisterMatTransform('tex_135', 'tex_atlas_med3', 0.650390625,0.8=
02734375,0.775390625,0.865234375)
-TexAtlas_RegisterMatTransform('tex_216', 'tex_atlas_med3', 0.779296875,0.8=
02734375,0.841796875,0.865234375)
-TexAtlas_RegisterMatTransform('tex_572', 'tex_atlas_med3', 0.845703125,0.8=
02734375,0.970703125,0.865234375)
-TexAtlas_RegisterMatTransform('tex_259', 'tex_atlas_med3', 0.001953125,0.8=
69140625,0.064453125,0.931640625)
-TexAtlas_RegisterMatTransform('tex_33', 'tex_atlas_med3', 0.068359375,0.86=
9140625,0.130859375,0.931640625)
-TexAtlas_RegisterMatTransform('tex_260', 'tex_atlas_med3', 0.134765625,0.8=
69140625,0.197265625,0.931640625)
-TexAtlas_RegisterMatTransform('tex_144', 'tex_atlas_med3', 0.201171875,0.8=
69140625,0.326171875,0.931640625)
-TexAtlas_RegisterMatTransform('tex_225', 'tex_atlas_med3', 0.330078125,0.8=
69140625,0.392578125,0.931640625)
-TexAtlas_RegisterMatTransform('tex_306', 'tex_atlas_med3', 0.396484375,0.8=
69140625,0.458984375,0.931640625)
-TexAtlas_RegisterMatTransform('tex_465', 'tex_atlas_med3', 0.462890625,0.8=
69140625,0.525390625,0.931640625)
-TexAtlas_RegisterMatTransform('tex_187', 'tex_atlas_med3', 0.529296875,0.8=
69140625,0.591796875,0.931640625)
-TexAtlas_RegisterMatTransform('tex_110', 'tex_atlas_med3', 0.595703125,0.8=
69140625,0.720703125,0.931640625)
-TexAtlas_RegisterMatTransform('tex_234', 'tex_atlas_med3', 0.724609375,0.8=
69140625,0.787109375,0.931640625)
-TexAtlas_RegisterMatTransform('tex_315', 'tex_atlas_med3', 0.791015625,0.8=
69140625,0.853515625,0.931640625)
-TexAtlas_RegisterMatTransform('tex_555', 'tex_atlas_med3', 0.857421875,0.8=
69140625,0.919921875,0.931640625)
-TexAtlas_RegisterMatTransform('tex_474', 'tex_atlas_med3', 0.923828125,0.8=
69140625,0.986328125,0.931640625)
-TexAtlas_RegisterMatTransform('tex_196', 'tex_atlas_med3', 0.001953125,0.9=
35546875,0.064453125,0.998046875)
-TexAtlas_RegisterMatTransform('tex_200', 'tex_atlas_med3', 0.068359375,0.9=
35546875,0.130859375,0.998046875)
-TexAtlas_RegisterMatTransform('tex_162', 'tex_atlas_med3', 0.134765625,0.9=
35546875,0.259765625,0.998046875)
-TexAtlas_RegisterMatTransform('tex_243', 'tex_atlas_med3', 0.263671875,0.9=
35546875,0.326171875,0.998046875)
-TexAtlas_RegisterMatTransform('tex_324', 'tex_atlas_med3', 0.330078125,0.9=
35546875,0.392578125,0.998046875)
-TexAtlas_RegisterMatTransform('tex_208', 'tex_atlas_med3', 0.396484375,0.9=
35546875,0.458984375,0.998046875)
-TexAtlas_RegisterMatTransform('tex_127', 'tex_atlas_med3', 0.462890625,0.9=
35546875,0.587890625,0.998046875)
-TexAtlas_RegisterMatTransform('tex_25', 'tex_atlas_med4', 0.001953125,0.00=
5859375,0.064453125,0.037109375)
-TexAtlas_RegisterMatTransform('tex_492', 'tex_atlas_med4', 0.068359375,0.0=
05859375,0.099609375,0.037109375)
-TexAtlas_RegisterMatTransform('tex_394', 'tex_atlas_med4', 0.103515625,0.0=
05859375,0.134765625,0.037109375)
-TexAtlas_RegisterMatTransform('tex_540', 'tex_atlas_med4', 0.138671875,0.0=
05859375,0.169921875,0.037109375)
-TexAtlas_RegisterMatTransform('tex_395', 'tex_atlas_med4', 0.173828125,0.0=
05859375,0.205078125,0.037109375)
-TexAtlas_RegisterMatTransform('tex_523', 'tex_atlas_med4', 0.208984375,0.0=
05859375,0.271484375,0.037109375)
-TexAtlas_RegisterMatTransform('tex_36', 'tex_atlas_med4', 0.275390625,0.00=
5859375,0.337890625,0.037109375)
-TexAtlas_RegisterMatTransform('tex_486', 'tex_atlas_med4', 0.341796875,0.0=
05859375,0.357421875,0.037109375)
-TexAtlas_RegisterMatTransform('tex_3', 'tex_atlas_med4', 0.361328125,0.005=
859375,0.423828125,0.037109375)
-TexAtlas_RegisterMatTransform('tex_388', 'tex_atlas_med4', 0.427734375,0.0=
05859375,0.458984375,0.037109375)
-TexAtlas_RegisterMatTransform('tex_247', 'tex_atlas_med4', 0.462890625,0.0=
05859375,0.587890625,0.037109375)
-TexAtlas_RegisterMatTransform('tex_487', 'tex_atlas_med4', 0.591796875,0.0=
05859375,0.607421875,0.037109375)
-TexAtlas_RegisterMatTransform('tex_21', 'tex_atlas_med4', 0.611328125,0.00=
5859375,0.736328125,0.037109375)
-TexAtlas_RegisterMatTransform('tex_30', 'tex_atlas_med4', 0.740234375,0.00=
5859375,0.865234375,0.037109375)
-TexAtlas_RegisterMatTransform('tex_389', 'tex_atlas_med4', 0.869140625,0.0=
05859375,0.900390625,0.037109375)
-TexAtlas_RegisterMatTransform('tex_390', 'tex_atlas_med4', 0.904296875,0.0=
05859375,0.935546875,0.037109375)
-TexAtlas_RegisterMatTransform('tex_248', 'tex_atlas_med4', 0.001953125,0.0=
41015625,0.126953125,0.072265625)
-TexAtlas_RegisterMatTransform('tex_488', 'tex_atlas_med4', 0.130859375,0.0=
41015625,0.146484375,0.072265625)
-TexAtlas_RegisterMatTransform('tex_31', 'tex_atlas_med4', 0.150390625,0.04=
1015625,0.275390625,0.072265625)
-TexAtlas_RegisterMatTransform('tex_107', 'tex_atlas_med4', 0.279296875,0.0=
41015625,0.404296875,0.072265625)
-TexAtlas_RegisterMatTransform('tex_391', 'tex_atlas_med4', 0.408203125,0.0=
41015625,0.439453125,0.072265625)
-TexAtlas_RegisterMatTransform('tex_249', 'tex_atlas_med4', 0.443359375,0.0=
41015625,0.568359375,0.072265625)
-TexAtlas_RegisterMatTransform('tex_489', 'tex_atlas_med4', 0.572265625,0.0=
41015625,0.587890625,0.072265625)
-TexAtlas_RegisterMatTransform('tex_250', 'tex_atlas_med4', 0.591796875,0.0=
41015625,0.654296875,0.072265625)
-TexAtlas_RegisterMatTransform('tex_32', 'tex_atlas_med4', 0.658203125,0.04=
1015625,0.783203125,0.072265625)
-TexAtlas_RegisterMatTransform('tex_421', 'tex_atlas_med4', 0.787109375,0.0=
41015625,0.818359375,0.072265625)
-TexAtlas_RegisterMatTransform('tex_108', 'tex_atlas_med4', 0.822265625,0.0=
41015625,0.947265625,0.072265625)
-TexAtlas_RegisterMatTransform('tex_392', 'tex_atlas_med4', 0.951171875,0.0=
41015625,0.982421875,0.072265625)
-TexAtlas_RegisterMatTransform('tex_563', 'tex_atlas_med4', 0.001953125,0.0=
76171875,0.126953125,0.107421875)
-TexAtlas_RegisterMatTransform('tex_491', 'tex_atlas_med4', 0.130859375,0.0=
76171875,0.162109375,0.107421875)
-TexAtlas_RegisterMatTransform('tex_393', 'tex_atlas_med4', 0.166015625,0.0=
76171875,0.197265625,0.107421875)
-TexAtlas_RegisterMatTransform('tex_174', 'tex_atlas_med4', 0.001953125,0.1=
11328125,0.064453125,0.126953125)
+TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_med2', 0.38867187=
5,0.650390625,0.513671875,0.775390625)
+TexAtlas_RegisterMatTransform('tex_5634', 'tex_atlas_med2', 0.517578125,0.=
650390625,0.642578125,0.775390625)
+TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_med2', 0.6464843=
75,0.650390625,0.771484375,0.775390625)
+TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_med2', 0.775390625=
,0.650390625,0.900390625,0.775390625)
+TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_med2', 0.00195=
3125,0.779296875,0.126953125,0.904296875)
+TexAtlas_RegisterMatTransform('tex_stoneplate', 'tex_atlas_med2', 0.130859=
375,0.779296875,0.255859375,0.904296875)
+TexAtlas_RegisterMatTransform('tex_483', 'tex_atlas_med2', 0.001953125,0.9=
08203125,0.126953125,0.970703125)
+TexAtlas_RegisterMatTransform('tex_564', 'tex_atlas_med2', 0.130859375,0.9=
08203125,0.255859375,0.970703125)
+TexAtlas_RegisterMatTransform('tex_367', 'tex_atlas_med2', 0.259765625,0.9=
08203125,0.322265625,0.970703125)
+TexAtlas_RegisterMatTransform('tex_286', 'tex_atlas_med2', 0.326171875,0.9=
08203125,0.451171875,0.970703125)
+TexAtlas_RegisterMatTransform('tex_333', 'tex_atlas_med2', 0.455078125,0.9=
08203125,0.517578125,0.970703125)
+TexAtlas_RegisterMatTransform('tex_171', 'tex_atlas_med2', 0.521484375,0.9=
08203125,0.646484375,0.970703125)
+TexAtlas_RegisterMatTransform('tex_136', 'tex_atlas_med2', 0.650390625,0.9=
08203125,0.775390625,0.970703125)
+TexAtlas_RegisterMatTransform('tex_217', 'tex_atlas_med2', 0.779296875,0.9=
08203125,0.841796875,0.970703125)
+TexAtlas_RegisterMatTransform('tex_342', 'tex_atlas_med2', 0.845703125,0.9=
08203125,0.908203125,0.970703125)
+TexAtlas_RegisterMatTransform('tex_145', 'tex_atlas_med3', 0.001953125,0.0=
05859375,0.126953125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_226', 'tex_atlas_med3', 0.130859375,0.0=
05859375,0.193359375,0.068359375)
+TexAtlas_RegisterMatTransform('tex_307', 'tex_atlas_med3', 0.197265625,0.0=
05859375,0.259765625,0.068359375)
+TexAtlas_RegisterMatTransform('tex_188', 'tex_atlas_med3', 0.263671875,0.0=
05859375,0.326171875,0.068359375)
+TexAtlas_RegisterMatTransform('tex_154', 'tex_atlas_med3', 0.330078125,0.0=
05859375,0.455078125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_235', 'tex_atlas_med3', 0.458984375,0.0=
05859375,0.521484375,0.068359375)
+TexAtlas_RegisterMatTransform('tex_316', 'tex_atlas_med3', 0.525390625,0.0=
05859375,0.587890625,0.068359375)
+TexAtlas_RegisterMatTransform('tex_556', 'tex_atlas_med3', 0.591796875,0.0=
05859375,0.654296875,0.068359375)
+TexAtlas_RegisterMatTransform('tex_197', 'tex_atlas_med3', 0.658203125,0.0=
05859375,0.720703125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_201', 'tex_atlas_med3', 0.724609375,0.0=
05859375,0.787109375,0.068359375)
+TexAtlas_RegisterMatTransform('tex_325', 'tex_atlas_med3', 0.791015625,0.0=
05859375,0.853515625,0.068359375)
+TexAtlas_RegisterMatTransform('tex_244', 'tex_atlas_med3', 0.857421875,0.0=
05859375,0.919921875,0.068359375)
+TexAtlas_RegisterMatTransform('tex_209', 'tex_atlas_med3', 0.923828125,0.0=
05859375,0.986328125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_128', 'tex_atlas_med3', 0.001953125,0.0=
72265625,0.126953125,0.134765625)
+TexAtlas_RegisterMatTransform('tex_484', 'tex_atlas_med3', 0.130859375,0.0=
72265625,0.255859375,0.134765625)
+TexAtlas_RegisterMatTransform('tex_368', 'tex_atlas_med3', 0.259765625,0.0=
72265625,0.322265625,0.134765625)
+TexAtlas_RegisterMatTransform('tex_26', 'tex_atlas_med3', 0.326171875,0.07=
2265625,0.388671875,0.134765625)
+TexAtlas_RegisterMatTransform('tex_210', 'tex_atlas_med3', 0.392578125,0.0=
72265625,0.455078125,0.134765625)
+TexAtlas_RegisterMatTransform('tex_334', 'tex_atlas_med3', 0.458984375,0.0=
72265625,0.521484375,0.134765625)
+TexAtlas_RegisterMatTransform('tex_137', 'tex_atlas_med3', 0.525390625,0.0=
72265625,0.650390625,0.134765625)
+TexAtlas_RegisterMatTransform('tex_493', 'tex_atlas_med3', 0.654296875,0.0=
72265625,0.716796875,0.134765625)
+TexAtlas_RegisterMatTransform('tex_70', 'tex_atlas_med3', 0.720703125,0.07=
2265625,0.845703125,0.134765625)
+TexAtlas_RegisterMatTransform('tex_343', 'tex_atlas_med3', 0.849609375,0.0=
72265625,0.912109375,0.134765625)
+TexAtlas_RegisterMatTransform('tex_146', 'tex_atlas_med3', 0.001953125,0.1=
38671875,0.126953125,0.201171875)
+TexAtlas_RegisterMatTransform('tex_227', 'tex_atlas_med3', 0.130859375,0.1=
38671875,0.193359375,0.201171875)
+TexAtlas_RegisterMatTransform('tex_308', 'tex_atlas_med3', 0.197265625,0.1=
38671875,0.259765625,0.201171875)
+TexAtlas_RegisterMatTransform('tex_386', 'tex_atlas_med3', 0.263671875,0.1=
38671875,0.326171875,0.201171875)
+TexAtlas_RegisterMatTransform('tex_189', 'tex_atlas_med3', 0.330078125,0.1=
38671875,0.392578125,0.201171875)
+TexAtlas_RegisterMatTransform('tex_190', 'tex_atlas_med3', 0.396484375,0.1=
38671875,0.458984375,0.201171875)
+TexAtlas_RegisterMatTransform('tex_236', 'tex_atlas_med3', 0.462890625,0.1=
38671875,0.525390625,0.201171875)
+TexAtlas_RegisterMatTransform('tex_317', 'tex_atlas_med3', 0.529296875,0.1=
38671875,0.591796875,0.201171875)
+TexAtlas_RegisterMatTransform('tex_198', 'tex_atlas_med3', 0.595703125,0.1=
38671875,0.658203125,0.201171875)
+TexAtlas_RegisterMatTransform('tex_202', 'tex_atlas_med3', 0.662109375,0.1=
38671875,0.724609375,0.201171875)
+TexAtlas_RegisterMatTransform('tex_121', 'tex_atlas_med3', 0.728515625,0.1=
38671875,0.791015625,0.201171875)
+TexAtlas_RegisterMatTransform('tex_326', 'tex_atlas_med3', 0.794921875,0.1=
38671875,0.857421875,0.201171875)
+TexAtlas_RegisterMatTransform('tex_245', 'tex_atlas_med3', 0.861328125,0.1=
38671875,0.923828125,0.201171875)
+TexAtlas_RegisterMatTransform('tex_129', 'tex_atlas_med3', 0.001953125,0.2=
05078125,0.126953125,0.267578125)
+TexAtlas_RegisterMatTransform('tex_369', 'tex_atlas_med3', 0.130859375,0.2=
05078125,0.193359375,0.267578125)
+TexAtlas_RegisterMatTransform('tex_27', 'tex_atlas_med3', 0.197265625,0.20=
5078125,0.259765625,0.267578125)
+TexAtlas_RegisterMatTransform('tex_2', 'tex_atlas_med3', 0.263671875,0.205=
078125,0.326171875,0.267578125)
+TexAtlas_RegisterMatTransform('tex_130', 'tex_atlas_med3', 0.330078125,0.2=
05078125,0.455078125,0.267578125)
+TexAtlas_RegisterMatTransform('tex_211', 'tex_atlas_med3', 0.458984375,0.2=
05078125,0.521484375,0.267578125)
+TexAtlas_RegisterMatTransform('tex_370', 'tex_atlas_med3', 0.525390625,0.2=
05078125,0.587890625,0.267578125)
+TexAtlas_RegisterMatTransform('tex_335', 'tex_atlas_med3', 0.591796875,0.2=
05078125,0.654296875,0.267578125)
+TexAtlas_RegisterMatTransform('tex_138', 'tex_atlas_med3', 0.658203125,0.2=
05078125,0.783203125,0.267578125)
+TexAtlas_RegisterMatTransform('tex_494', 'tex_atlas_med3', 0.787109375,0.2=
05078125,0.849609375,0.267578125)
+TexAtlas_RegisterMatTransform('tex_220', 'tex_atlas_med3', 0.853515625,0.2=
05078125,0.916015625,0.267578125)
+TexAtlas_RegisterMatTransform('tex_344', 'tex_atlas_med3', 0.919921875,0.2=
05078125,0.982421875,0.267578125)
+TexAtlas_RegisterMatTransform('tex_147', 'tex_atlas_med3', 0.001953125,0.2=
71484375,0.126953125,0.333984375)
+TexAtlas_RegisterMatTransform('tex_228', 'tex_atlas_med3', 0.130859375,0.2=
71484375,0.193359375,0.333984375)
+TexAtlas_RegisterMatTransform('tex_309', 'tex_atlas_med3', 0.197265625,0.2=
71484375,0.259765625,0.333984375)
+TexAtlas_RegisterMatTransform('tex_310', 'tex_atlas_med3', 0.263671875,0.2=
71484375,0.326171875,0.333984375)
+TexAtlas_RegisterMatTransform('tex_113', 'tex_atlas_med3', 0.330078125,0.2=
71484375,0.455078125,0.333984375)
+TexAtlas_RegisterMatTransform('tex_515', 'tex_atlas_med3', 0.458984375,0.2=
71484375,0.521484375,0.333984375)
+TexAtlas_RegisterMatTransform('tex_191', 'tex_atlas_med3', 0.525390625,0.2=
71484375,0.587890625,0.333984375)
+TexAtlas_RegisterMatTransform('tex_237', 'tex_atlas_med3', 0.591796875,0.2=
71484375,0.654296875,0.333984375)
+TexAtlas_RegisterMatTransform('tex_318', 'tex_atlas_med3', 0.658203125,0.2=
71484375,0.720703125,0.333984375)
+TexAtlas_RegisterMatTransform('tex_477', 'tex_atlas_med3', 0.724609375,0.2=
71484375,0.787109375,0.333984375)
+TexAtlas_RegisterMatTransform('tex_396', 'tex_atlas_med3', 0.791015625,0.2=
71484375,0.853515625,0.333984375)
+TexAtlas_RegisterMatTransform('tex_199', 'tex_atlas_med3', 0.857421875,0.2=
71484375,0.919921875,0.333984375)
+TexAtlas_RegisterMatTransform('tex_400', 'tex_atlas_med3', 0.923828125,0.2=
71484375,0.986328125,0.333984375)
+TexAtlas_RegisterMatTransform('tex_203', 'tex_atlas_med3', 0.001953125,0.3=
37890625,0.064453125,0.400390625)
+TexAtlas_RegisterMatTransform('tex_524', 'tex_atlas_med3', 0.068359375,0.3=
37890625,0.130859375,0.400390625)
+TexAtlas_RegisterMatTransform('tex_327', 'tex_atlas_med3', 0.134765625,0.3=
37890625,0.197265625,0.400390625)
+TexAtlas_RegisterMatTransform('tex_246', 'tex_atlas_med3', 0.201171875,0.3=
37890625,0.263671875,0.400390625)
+TexAtlas_RegisterMatTransform('tex_131', 'tex_atlas_med3', 0.267578125,0.3=
37890625,0.392578125,0.400390625)
+TexAtlas_RegisterMatTransform('tex_212', 'tex_atlas_med3', 0.396484375,0.3=
37890625,0.458984375,0.400390625)
+TexAtlas_RegisterMatTransform('tex_371', 'tex_atlas_med3', 0.462890625,0.3=
37890625,0.525390625,0.400390625)
+TexAtlas_RegisterMatTransform('tex_336', 'tex_atlas_med3', 0.529296875,0.3=
37890625,0.591796875,0.400390625)
+TexAtlas_RegisterMatTransform('tex_139', 'tex_atlas_med3', 0.595703125,0.3=
37890625,0.720703125,0.400390625)
+TexAtlas_RegisterMatTransform('tex_495', 'tex_atlas_med3', 0.724609375,0.3=
37890625,0.787109375,0.400390625)
+TexAtlas_RegisterMatTransform('tex_140', 'tex_atlas_med3', 0.791015625,0.3=
37890625,0.916015625,0.400390625)
+TexAtlas_RegisterMatTransform('tex_221', 'tex_atlas_med3', 0.919921875,0.3=
37890625,0.982421875,0.400390625)
+TexAtlas_RegisterMatTransform('tex_461', 'tex_atlas_med3', 0.001953125,0.4=
04296875,0.033203125,0.466796875)
+TexAtlas_RegisterMatTransform('tex_345', 'tex_atlas_med3', 0.037109375,0.4=
04296875,0.099609375,0.466796875)
+TexAtlas_RegisterMatTransform('tex_183', 'tex_atlas_med3', 0.103515625,0.4=
04296875,0.166015625,0.466796875)
+TexAtlas_RegisterMatTransform('tex_148', 'tex_atlas_med3', 0.169921875,0.4=
04296875,0.294921875,0.466796875)
+TexAtlas_RegisterMatTransform('tex_229', 'tex_atlas_med3', 0.298828125,0.4=
04296875,0.361328125,0.466796875)
+TexAtlas_RegisterMatTransform('tex_230', 'tex_atlas_med3', 0.365234375,0.4=
04296875,0.427734375,0.466796875)
+TexAtlas_RegisterMatTransform('tex_311', 'tex_atlas_med3', 0.431640625,0.4=
04296875,0.494140625,0.466796875)
+TexAtlas_RegisterMatTransform('tex_551', 'tex_atlas_med3', 0.498046875,0.4=
04296875,0.560546875,0.466796875)
+TexAtlas_RegisterMatTransform('tex_516', 'tex_atlas_med3', 0.564453125,0.4=
04296875,0.626953125,0.466796875)
+TexAtlas_RegisterMatTransform('tex_192', 'tex_atlas_med3', 0.630859375,0.4=
04296875,0.693359375,0.466796875)
+TexAtlas_RegisterMatTransform('tex_157', 'tex_atlas_med3', 0.697265625,0.4=
04296875,0.822265625,0.466796875)
+TexAtlas_RegisterMatTransform('tex_238', 'tex_atlas_med3', 0.826171875,0.4=
04296875,0.888671875,0.466796875)
+TexAtlas_RegisterMatTransform('tex_319', 'tex_atlas_med3', 0.892578125,0.4=
04296875,0.955078125,0.466796875)
+TexAtlas_RegisterMatTransform('tex_397', 'tex_atlas_med3', 0.001953125,0.4=
70703125,0.064453125,0.533203125)
+TexAtlas_RegisterMatTransform('tex_401', 'tex_atlas_med3', 0.068359375,0.4=
70703125,0.130859375,0.533203125)
+TexAtlas_RegisterMatTransform('tex_320', 'tex_atlas_med3', 0.134765625,0.4=
70703125,0.197265625,0.533203125)
+TexAtlas_RegisterMatTransform('tex_204', 'tex_atlas_med3', 0.201171875,0.4=
70703125,0.263671875,0.533203125)
+TexAtlas_RegisterMatTransform('tex_525', 'tex_atlas_med3', 0.267578125,0.4=
70703125,0.330078125,0.533203125)
+TexAtlas_RegisterMatTransform('tex_409', 'tex_atlas_med3', 0.333984375,0.4=
70703125,0.458984375,0.533203125)
+TexAtlas_RegisterMatTransform('tex_328', 'tex_atlas_med3', 0.462890625,0.4=
70703125,0.525390625,0.533203125)
+TexAtlas_RegisterMatTransform('tex_166', 'tex_atlas_med3', 0.529296875,0.4=
70703125,0.654296875,0.533203125)
+TexAtlas_RegisterMatTransform('tex_132', 'tex_atlas_med3', 0.658203125,0.4=
70703125,0.783203125,0.533203125)
+TexAtlas_RegisterMatTransform('tex_213', 'tex_atlas_med3', 0.787109375,0.4=
70703125,0.849609375,0.533203125)
+TexAtlas_RegisterMatTransform('tex_453', 'tex_atlas_med3', 0.853515625,0.4=
70703125,0.916015625,0.533203125)
+TexAtlas_RegisterMatTransform('tex_337', 'tex_atlas_med3', 0.919921875,0.4=
70703125,0.982421875,0.533203125)
+TexAtlas_RegisterMatTransform('tex_256', 'tex_atlas_med3', 0.001953125,0.5=
37109375,0.126953125,0.599609375)
+TexAtlas_RegisterMatTransform('tex_496', 'tex_atlas_med3', 0.130859375,0.5=
37109375,0.193359375,0.599609375)
+TexAtlas_RegisterMatTransform('tex_141', 'tex_atlas_med3', 0.197265625,0.5=
37109375,0.322265625,0.599609375)
+TexAtlas_RegisterMatTransform('tex_222', 'tex_atlas_med3', 0.326171875,0.5=
37109375,0.388671875,0.599609375)
+TexAtlas_RegisterMatTransform('tex_303', 'tex_atlas_med3', 0.392578125,0.5=
37109375,0.455078125,0.599609375)
+TexAtlas_RegisterMatTransform('tex_462', 'tex_atlas_med3', 0.458984375,0.5=
37109375,0.490234375,0.599609375)
+TexAtlas_RegisterMatTransform('tex_184', 'tex_atlas_med3', 0.494140625,0.5=
37109375,0.556640625,0.599609375)
+TexAtlas_RegisterMatTransform('tex_149', 'tex_atlas_med3', 0.560546875,0.5=
37109375,0.685546875,0.599609375)
+TexAtlas_RegisterMatTransform('tex_150', 'tex_atlas_med3', 0.689453125,0.5=
37109375,0.814453125,0.599609375)
+TexAtlas_RegisterMatTransform('tex_231', 'tex_atlas_med3', 0.818359375,0.5=
37109375,0.880859375,0.599609375)
+TexAtlas_RegisterMatTransform('tex_312', 'tex_atlas_med3', 0.884765625,0.5=
37109375,0.947265625,0.599609375)
+TexAtlas_RegisterMatTransform('tex_517', 'tex_atlas_med3', 0.001953125,0.6=
03515625,0.064453125,0.666015625)
+TexAtlas_RegisterMatTransform('tex_193', 'tex_atlas_med3', 0.068359375,0.6=
03515625,0.130859375,0.666015625)
+TexAtlas_RegisterMatTransform('tex_158', 'tex_atlas_med3', 0.134765625,0.6=
03515625,0.259765625,0.666015625)
+TexAtlas_RegisterMatTransform('tex_239', 'tex_atlas_med3', 0.263671875,0.6=
03515625,0.326171875,0.666015625)
+TexAtlas_RegisterMatTransform('tex_479', 'tex_atlas_med3', 0.330078125,0.6=
03515625,0.392578125,0.666015625)
+TexAtlas_RegisterMatTransform('tex_398', 'tex_atlas_med3', 0.396484375,0.6=
03515625,0.458984375,0.666015625)
+TexAtlas_RegisterMatTransform('tex_402', 'tex_atlas_med3', 0.462890625,0.6=
03515625,0.525390625,0.666015625)
+TexAtlas_RegisterMatTransform('tex_240', 'tex_atlas_med3', 0.529296875,0.6=
03515625,0.591796875,0.666015625)
+TexAtlas_RegisterMatTransform('tex_321', 'tex_atlas_med3', 0.595703125,0.6=
03515625,0.658203125,0.666015625)
+TexAtlas_RegisterMatTransform('tex_205', 'tex_atlas_med3', 0.662109375,0.6=
03515625,0.724609375,0.666015625)
+TexAtlas_RegisterMatTransform('tex_124', 'tex_atlas_med3', 0.728515625,0.6=
03515625,0.853515625,0.666015625)
+TexAtlas_RegisterMatTransform('tex_561', 'tex_atlas_med3', 0.857421875,0.6=
03515625,0.982421875,0.666015625)
+TexAtlas_RegisterMatTransform('tex_526', 'tex_atlas_med3', 0.001953125,0.6=
69921875,0.064453125,0.732421875)
+TexAtlas_RegisterMatTransform('tex_329', 'tex_atlas_med3', 0.068359375,0.6=
69921875,0.130859375,0.732421875)
+TexAtlas_RegisterMatTransform('tex_167', 'tex_atlas_med3', 0.134765625,0.6=
69921875,0.259765625,0.732421875)
+TexAtlas_RegisterMatTransform('tex_22', 'tex_atlas_med3', 0.263671875,0.66=
9921875,0.326171875,0.732421875)
+TexAtlas_RegisterMatTransform('tex_330', 'tex_atlas_med3', 0.330078125,0.6=
69921875,0.392578125,0.732421875)
+TexAtlas_RegisterMatTransform('tex_133', 'tex_atlas_med3', 0.396484375,0.6=
69921875,0.521484375,0.732421875)
+TexAtlas_RegisterMatTransform('tex_214', 'tex_atlas_med3', 0.525390625,0.6=
69921875,0.587890625,0.732421875)
+TexAtlas_RegisterMatTransform('tex_338', 'tex_atlas_med3', 0.591796875,0.6=
69921875,0.654296875,0.732421875)
+TexAtlas_RegisterMatTransform('tex_142', 'tex_atlas_med3', 0.658203125,0.6=
69921875,0.783203125,0.732421875)
+TexAtlas_RegisterMatTransform('tex_223', 'tex_atlas_med3', 0.787109375,0.6=
69921875,0.849609375,0.732421875)
+TexAtlas_RegisterMatTransform('tex_304', 'tex_atlas_med3', 0.853515625,0.6=
69921875,0.916015625,0.732421875)
+TexAtlas_RegisterMatTransform('tex_463', 'tex_atlas_med3', 0.919921875,0.6=
69921875,0.982421875,0.732421875)
+TexAtlas_RegisterMatTransform('tex_185', 'tex_atlas_med3', 0.001953125,0.7=
36328125,0.064453125,0.798828125)
+TexAtlas_RegisterMatTransform('tex_232', 'tex_atlas_med3', 0.068359375,0.7=
36328125,0.130859375,0.798828125)
+TexAtlas_RegisterMatTransform('tex_313', 'tex_atlas_med3', 0.134765625,0.7=
36328125,0.197265625,0.798828125)
+TexAtlas_RegisterMatTransform('tex_194', 'tex_atlas_med3', 0.201171875,0.7=
36328125,0.263671875,0.798828125)
+TexAtlas_RegisterMatTransform('tex_159', 'tex_atlas_med3', 0.267578125,0.7=
36328125,0.392578125,0.798828125)
+TexAtlas_RegisterMatTransform('tex_399', 'tex_atlas_med3', 0.396484375,0.7=
36328125,0.458984375,0.798828125)
+TexAtlas_RegisterMatTransform('tex_403', 'tex_atlas_med3', 0.462890625,0.7=
36328125,0.587890625,0.798828125)
+TexAtlas_RegisterMatTransform('tex_241', 'tex_atlas_med3', 0.591796875,0.7=
36328125,0.654296875,0.798828125)
+TexAtlas_RegisterMatTransform('tex_322', 'tex_atlas_med3', 0.658203125,0.7=
36328125,0.720703125,0.798828125)
+TexAtlas_RegisterMatTransform('tex_206', 'tex_atlas_med3', 0.724609375,0.7=
36328125,0.787109375,0.798828125)
+TexAtlas_RegisterMatTransform('tex_125', 'tex_atlas_med3', 0.791015625,0.7=
36328125,0.916015625,0.798828125)
+TexAtlas_RegisterMatTransform('tex_168', 'tex_atlas_med3', 0.001953125,0.8=
02734375,0.126953125,0.865234375)
+TexAtlas_RegisterMatTransform('tex_23', 'tex_atlas_med3', 0.130859375,0.80=
2734375,0.255859375,0.865234375)
+TexAtlas_RegisterMatTransform('tex_331', 'tex_atlas_med3', 0.259765625,0.8=
02734375,0.322265625,0.865234375)
+TexAtlas_RegisterMatTransform('tex_134', 'tex_atlas_med3', 0.326171875,0.8=
02734375,0.451171875,0.865234375)
+TexAtlas_RegisterMatTransform('tex_215', 'tex_atlas_med3', 0.455078125,0.8=
02734375,0.517578125,0.865234375)
+TexAtlas_RegisterMatTransform('tex_571', 'tex_atlas_med3', 0.521484375,0.8=
02734375,0.646484375,0.865234375)
+TexAtlas_RegisterMatTransform('tex_339', 'tex_atlas_med3', 0.650390625,0.8=
02734375,0.712890625,0.865234375)
+TexAtlas_RegisterMatTransform('tex_258', 'tex_atlas_med3', 0.716796875,0.8=
02734375,0.779296875,0.865234375)
+TexAtlas_RegisterMatTransform('tex_340', 'tex_atlas_med3', 0.783203125,0.8=
02734375,0.845703125,0.865234375)
+TexAtlas_RegisterMatTransform('tex_143', 'tex_atlas_med3', 0.849609375,0.8=
02734375,0.974609375,0.865234375)
+TexAtlas_RegisterMatTransform('tex_224', 'tex_atlas_med3', 0.001953125,0.8=
69140625,0.064453125,0.931640625)
+TexAtlas_RegisterMatTransform('tex_305', 'tex_atlas_med3', 0.068359375,0.8=
69140625,0.130859375,0.931640625)
+TexAtlas_RegisterMatTransform('tex_464', 'tex_atlas_med3', 0.134765625,0.8=
69140625,0.197265625,0.931640625)
+TexAtlas_RegisterMatTransform('tex_186', 'tex_atlas_med3', 0.201171875,0.8=
69140625,0.263671875,0.931640625)
+TexAtlas_RegisterMatTransform('tex_152', 'tex_atlas_med3', 0.267578125,0.8=
69140625,0.392578125,0.931640625)
+TexAtlas_RegisterMatTransform('tex_233', 'tex_atlas_med3', 0.396484375,0.8=
69140625,0.458984375,0.931640625)
+TexAtlas_RegisterMatTransform('tex_314', 'tex_atlas_med3', 0.462890625,0.8=
69140625,0.525390625,0.931640625)
+TexAtlas_RegisterMatTransform('tex_195', 'tex_atlas_med3', 0.529296875,0.8=
69140625,0.591796875,0.931640625)
+TexAtlas_RegisterMatTransform('tex_161', 'tex_atlas_med3', 0.595703125,0.8=
69140625,0.720703125,0.931640625)
+TexAtlas_RegisterMatTransform('tex_242', 'tex_atlas_med3', 0.724609375,0.8=
69140625,0.787109375,0.931640625)
+TexAtlas_RegisterMatTransform('tex_323', 'tex_atlas_med3', 0.791015625,0.8=
69140625,0.853515625,0.931640625)
+TexAtlas_RegisterMatTransform('tex_207', 'tex_atlas_med3', 0.857421875,0.8=
69140625,0.919921875,0.931640625)
+TexAtlas_RegisterMatTransform('tex_126', 'tex_atlas_med3', 0.001953125,0.9=
35546875,0.126953125,0.998046875)
+TexAtlas_RegisterMatTransform('tex_366', 'tex_atlas_med3', 0.130859375,0.9=
35546875,0.193359375,0.998046875)
+TexAtlas_RegisterMatTransform('tex_169', 'tex_atlas_med3', 0.197265625,0.9=
35546875,0.322265625,0.998046875)
+TexAtlas_RegisterMatTransform('tex_332', 'tex_atlas_med3', 0.326171875,0.9=
35546875,0.388671875,0.998046875)
+TexAtlas_RegisterMatTransform('tex_170', 'tex_atlas_med3', 0.392578125,0.9=
35546875,0.517578125,0.998046875)
+TexAtlas_RegisterMatTransform('tex_251', 'tex_atlas_med3', 0.521484375,0.9=
35546875,0.646484375,0.998046875)
+TexAtlas_RegisterMatTransform('tex_135', 'tex_atlas_med3', 0.650390625,0.9=
35546875,0.775390625,0.998046875)
+TexAtlas_RegisterMatTransform('tex_216', 'tex_atlas_med3', 0.779296875,0.9=
35546875,0.841796875,0.998046875)
+TexAtlas_RegisterMatTransform('tex_572', 'tex_atlas_med3', 0.845703125,0.9=
35546875,0.970703125,0.998046875)
+TexAtlas_RegisterMatTransform('tex_259', 'tex_atlas_med4', 0.001953125,0.0=
05859375,0.064453125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_33', 'tex_atlas_med4', 0.068359375,0.00=
5859375,0.130859375,0.068359375)
+TexAtlas_RegisterMatTransform('tex_260', 'tex_atlas_med4', 0.134765625,0.0=
05859375,0.197265625,0.068359375)
+TexAtlas_RegisterMatTransform('tex_144', 'tex_atlas_med4', 0.201171875,0.0=
05859375,0.326171875,0.068359375)
+TexAtlas_RegisterMatTransform('tex_225', 'tex_atlas_med4', 0.330078125,0.0=
05859375,0.392578125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_306', 'tex_atlas_med4', 0.396484375,0.0=
05859375,0.458984375,0.068359375)
+TexAtlas_RegisterMatTransform('tex_465', 'tex_atlas_med4', 0.462890625,0.0=
05859375,0.525390625,0.068359375)
+TexAtlas_RegisterMatTransform('tex_187', 'tex_atlas_med4', 0.529296875,0.0=
05859375,0.591796875,0.068359375)
+TexAtlas_RegisterMatTransform('tex_110', 'tex_atlas_med4', 0.595703125,0.0=
05859375,0.720703125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_234', 'tex_atlas_med4', 0.724609375,0.0=
05859375,0.787109375,0.068359375)
+TexAtlas_RegisterMatTransform('tex_315', 'tex_atlas_med4', 0.791015625,0.0=
05859375,0.853515625,0.068359375)
+TexAtlas_RegisterMatTransform('tex_555', 'tex_atlas_med4', 0.857421875,0.0=
05859375,0.919921875,0.068359375)
+TexAtlas_RegisterMatTransform('tex_474', 'tex_atlas_med4', 0.923828125,0.0=
05859375,0.986328125,0.068359375)
+TexAtlas_RegisterMatTransform('tex_196', 'tex_atlas_med4', 0.001953125,0.0=
72265625,0.064453125,0.134765625)
+TexAtlas_RegisterMatTransform('tex_200', 'tex_atlas_med4', 0.068359375,0.0=
72265625,0.130859375,0.134765625)
+TexAtlas_RegisterMatTransform('tex_162', 'tex_atlas_med4', 0.134765625,0.0=
72265625,0.259765625,0.134765625)
+TexAtlas_RegisterMatTransform('tex_243', 'tex_atlas_med4', 0.263671875,0.0=
72265625,0.326171875,0.134765625)
+TexAtlas_RegisterMatTransform('tex_324', 'tex_atlas_med4', 0.330078125,0.0=
72265625,0.392578125,0.134765625)
+TexAtlas_RegisterMatTransform('tex_208', 'tex_atlas_med4', 0.396484375,0.0=
72265625,0.458984375,0.134765625)
+TexAtlas_RegisterMatTransform('tex_127', 'tex_atlas_med4', 0.462890625,0.0=
72265625,0.587890625,0.134765625)
+TexAtlas_RegisterMatTransform('tex_25', 'tex_atlas_med4', 0.001953125,0.13=
8671875,0.064453125,0.169921875)
+TexAtlas_RegisterMatTransform('tex_492', 'tex_atlas_med4', 0.068359375,0.1=
38671875,0.099609375,0.169921875)
+TexAtlas_RegisterMatTransform('tex_394', 'tex_atlas_med4', 0.103515625,0.1=
38671875,0.134765625,0.169921875)
+TexAtlas_RegisterMatTransform('tex_540', 'tex_atlas_med4', 0.138671875,0.1=
38671875,0.169921875,0.169921875)
+TexAtlas_RegisterMatTransform('tex_395', 'tex_atlas_med4', 0.173828125,0.1=
38671875,0.205078125,0.169921875)
+TexAtlas_RegisterMatTransform('tex_523', 'tex_atlas_med4', 0.208984375,0.1=
38671875,0.271484375,0.169921875)
+TexAtlas_RegisterMatTransform('tex_36', 'tex_atlas_med4', 0.275390625,0.13=
8671875,0.337890625,0.169921875)
+TexAtlas_RegisterMatTransform('tex_486', 'tex_atlas_med4', 0.341796875,0.1=
38671875,0.357421875,0.169921875)
+TexAtlas_RegisterMatTransform('tex_3', 'tex_atlas_med4', 0.361328125,0.138=
671875,0.423828125,0.169921875)
+TexAtlas_RegisterMatTransform('tex_388', 'tex_atlas_med4', 0.427734375,0.1=
38671875,0.458984375,0.169921875)
+TexAtlas_RegisterMatTransform('tex_247', 'tex_atlas_med4', 0.462890625,0.1=
38671875,0.587890625,0.169921875)
+TexAtlas_RegisterMatTransform('tex_487', 'tex_atlas_med4', 0.591796875,0.1=
38671875,0.607421875,0.169921875)
+TexAtlas_RegisterMatTransform('tex_21', 'tex_atlas_med4', 0.611328125,0.13=
8671875,0.736328125,0.169921875)
+TexAtlas_RegisterMatTransform('tex_30', 'tex_atlas_med4', 0.740234375,0.13=
8671875,0.865234375,0.169921875)
+TexAtlas_RegisterMatTransform('tex_389', 'tex_atlas_med4', 0.869140625,0.1=
38671875,0.900390625,0.169921875)
+TexAtlas_RegisterMatTransform('tex_390', 'tex_atlas_med4', 0.904296875,0.1=
38671875,0.935546875,0.169921875)
+TexAtlas_RegisterMatTransform('tex_248', 'tex_atlas_med4', 0.001953125,0.1=
73828125,0.126953125,0.205078125)
+TexAtlas_RegisterMatTransform('tex_488', 'tex_atlas_med4', 0.130859375,0.1=
73828125,0.146484375,0.205078125)
+TexAtlas_RegisterMatTransform('tex_31', 'tex_atlas_med4', 0.150390625,0.17=
3828125,0.275390625,0.205078125)
+TexAtlas_RegisterMatTransform('tex_107', 'tex_atlas_med4', 0.279296875,0.1=
73828125,0.404296875,0.205078125)
+TexAtlas_RegisterMatTransform('tex_391', 'tex_atlas_med4', 0.408203125,0.1=
73828125,0.439453125,0.205078125)
+TexAtlas_RegisterMatTransform('tex_249', 'tex_atlas_med4', 0.443359375,0.1=
73828125,0.568359375,0.205078125)
+TexAtlas_RegisterMatTransform('tex_489', 'tex_atlas_med4', 0.572265625,0.1=
73828125,0.587890625,0.205078125)
+TexAtlas_RegisterMatTransform('tex_250', 'tex_atlas_med4', 0.591796875,0.1=
73828125,0.654296875,0.205078125)
+TexAtlas_RegisterMatTransform('tex_32', 'tex_atlas_med4', 0.658203125,0.17=
3828125,0.783203125,0.205078125)
+TexAtlas_RegisterMatTransform('tex_421', 'tex_atlas_med4', 0.787109375,0.1=
73828125,0.818359375,0.205078125)
+TexAtlas_RegisterMatTransform('tex_108', 'tex_atlas_med4', 0.822265625,0.1=
73828125,0.947265625,0.205078125)
+TexAtlas_RegisterMatTransform('tex_392', 'tex_atlas_med4', 0.951171875,0.1=
73828125,0.982421875,0.205078125)
+TexAtlas_RegisterMatTransform('tex_563', 'tex_atlas_med4', 0.001953125,0.2=
08984375,0.126953125,0.240234375)
+TexAtlas_RegisterMatTransform('tex_491', 'tex_atlas_med4', 0.130859375,0.2=
08984375,0.162109375,0.240234375)
+TexAtlas_RegisterMatTransform('tex_393', 'tex_atlas_med4', 0.166015625,0.2=
08984375,0.197265625,0.240234375)
+TexAtlas_RegisterMatTransform('tex_174', 'tex_atlas_med4', 0.001953125,0.2=
44140625,0.064453125,0.259765625)

Modified: trunk/data/models/atlas/tex_atlas_med.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_med.material (original)
+++ trunk/data/models/atlas/tex_atlas_med.material Wed Feb 27 10:57:00 2008
@@ -6,7 +6,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med0.dds =

+				texture tex_atlas_med0.png =

 			}	=

 		}
 	} =

@@ -19,7 +19,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med1.dds =

+				texture tex_atlas_med1.png =

 			}	=

 		}
 	} =

@@ -32,7 +32,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med2.dds =

+				texture tex_atlas_med2.png =

 			}	=

 		}
 	} =

@@ -45,7 +45,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med3.dds =

+				texture tex_atlas_med3.png =

 			}	=

 		}
 	} =

@@ -58,7 +58,7 @@
 		{		=

 			texture_unit =

 			{ =

-				texture tex_atlas_med4.dds =

+				texture tex_atlas_med4.png =

 			}	=

 		}
 	} =


Modified: trunk/data/models/atlas/tex_atlas_med2.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_med3.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_med4.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/atlas/tex_atlas_ultralow.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/atlas/tex_atlas_ultralow.lua (original)
+++ trunk/data/models/atlas/tex_atlas_ultralow.lua Wed Feb 27 10:57:00 2008
@@ -341,7 +341,12 @@
 TexAtlas_RegisterMatTransform('tex_324', 'tex_atlas_ultralow0', 0.9140625,=
0.6640625,0.9453125,0.6953125)
 TexAtlas_RegisterMatTransform('tex_208', 'tex_atlas_ultralow0', 0.9609375,=
0.6640625,0.9921875,0.6953125)
 TexAtlas_RegisterMatTransform('tex_5351', 'tex_atlas_ultralow0', 0.0078125=
,0.7109375,0.0390625,0.7421875)
-TexAtlas_RegisterMatTransform('tex_5634', 'tex_atlas_ultralow0', 0.0546875=
,0.7109375,0.0859375,0.7421875)
+TexAtlas_RegisterMatTransform('tex_mushroom', 'tex_atlas_ultralow0', 0.054=
6875,0.7109375,0.0859375,0.7421875)
+TexAtlas_RegisterMatTransform('tex_5634', 'tex_atlas_ultralow0', 0.1015625=
,0.7109375,0.1328125,0.7421875)
+TexAtlas_RegisterMatTransform('tex_mushroom2', 'tex_atlas_ultralow0', 0.14=
84375,0.7109375,0.1796875,0.7421875)
+TexAtlas_RegisterMatTransform('tex_lantern', 'tex_atlas_ultralow0', 0.1953=
125,0.7109375,0.2265625,0.7421875)
+TexAtlas_RegisterMatTransform('tex_slidingdoor', 'tex_atlas_ultralow0', 0.=
2421875,0.7109375,0.2734375,0.7421875)
+TexAtlas_RegisterMatTransform('tex_stoneplate', 'tex_atlas_ultralow0', 0.2=
890625,0.7109375,0.3203125,0.7421875)
 TexAtlas_RegisterMatTransform('tex_483', 'tex_atlas_ultralow0', 0.0078125,=
0.7578125,0.0390625,0.7734375)
 TexAtlas_RegisterMatTransform('tex_564', 'tex_atlas_ultralow0', 0.0546875,=
0.7578125,0.0859375,0.7734375)
 TexAtlas_RegisterMatTransform('tex_286', 'tex_atlas_ultralow0', 0.1015625,=
0.7578125,0.1328125,0.7734375)

Modified: trunk/data/models/atlas/tex_atlas_ultralow0.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_442.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_443.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_lantern.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_mushroom.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_mushroom2.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_slidingdoor.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Wed Feb 27 14:11:45 2008
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 27 Feb 2008 13:11:45 -0000
Subject: [Iris-commit] [IRIS] r1936 - /trunk/lua/lib.static.lua
Message-ID: <20080227140006.373711C18178@zwischenwelt.org>

Author: hagish
Date: Wed Feb 27 14:11:44 2008
New Revision: 1936

Log:
improved dump-missing, now checks against skip art table

Modified:
    trunk/lua/lib.static.lua

Modified: trunk/lua/lib.static.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.static.lua (original)
+++ trunk/lua/lib.static.lua Wed Feb 27 14:11:44 2008
@@ -95,8 +95,10 @@
 	=

 	-- dump missing models as images
 	if gDumpMissingModels then
+		local skip =3D gSkippedArtBillboardFallBacks[iTranslatedTileTypeID]
 		local filename =3D "missing/"..iTileTypeID..".png"
-		if not meshname and not file_exists(filename) and gArtMapLoader then
+		=

+		if not meshname and not skip and not file_exists(filename) and gArtMapLo=
ader then
 			print("dump missing art",iTileTypeID,filename)
 			-- render fallback image
 			local img =3D CreateImage()
@@ -104,7 +106,7 @@
 				img:SaveAsFile(filename)
 			end
 			img:Destroy()
-		elseif meshname and file_exists(filename) then
+		elseif (meshname or skip) and file_exists(filename) then
 			-- remove existing missing images
 			print("remove missing art image because there is now a model",iTileType=
ID,filename)
 			remove_file(filename)



