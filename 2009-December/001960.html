<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r3200 - in /trunk: plugins/loot.lua	scripts/luabindheader.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2009-December/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3200%20-%20in%20/trunk%3A%20plugins/loot.lua%0A%09scripts/luabindheader.lua&In-Reply-To=%3C20091221200622.077A27A9812B%40simon%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001959.html">
   <LINK REL="Next"  HREF="001961.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r3200 - in /trunk: plugins/loot.lua	scripts/luabindheader.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3200%20-%20in%20/trunk%3A%20plugins/loot.lua%0A%09scripts/luabindheader.lua&In-Reply-To=%3C20091221200622.077A27A9812B%40simon%3E"
       TITLE="[Iris-commit] [IRIS] r3200 - in /trunk: plugins/loot.lua	scripts/luabindheader.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Mon Dec 21 21:06:21 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001959.html">[Iris-commit] [IRIS] r3199 - in /trunk/bin: D3DX9_42.dll iris2.exe
</A></li>
        <LI>Next message: <A HREF="001961.html">[Iris-commit] [IRIS] r3201 - /trunk/lua/lib.macrolist.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1960">[ date ]</a>
              <a href="thread.html#1960">[ thread ]</a>
              <a href="subject.html#1960">[ subject ]</a>
              <a href="author.html#1960">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ghoulsblade
Date: Mon Dec 21 21:06:19 2009
New Revision: 3200

Log:
luabinder : copyconstructor return-push for ogre image

Modified:
    trunk/plugins/loot.lua
    trunk/scripts/luabindheader.lua

Modified: trunk/plugins/loot.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/loot.lua (original)
+++ trunk/plugins/loot.lua Mon Dec 21 21:06:19 2009
@@ -36,6 +36,25 @@
 	--~ &quot;mage weapon&quot;, -- mage armor , mage weap
 	--~ &quot;slayer&quot;,
 	&quot;Origami&quot;, -- paper
+	=

+	&quot;truth&quot;, -- mysticism : book of truth
+	&quot;mysticism&quot;,
+	&quot;Animated Weapon&quot;,
+	&quot;Bombard&quot;,
+	&quot;Cleansing Winds&quot;,
+	&quot;Eagle Strike&quot;,
+	&quot;Enchant&quot;,
+	&quot;Hail Storm&quot;,
+	&quot;Healing Stone&quot;,
+	&quot;Mass Sleep&quot;,
+	&quot;Nether Bolt&quot;,
+	&quot;Nether Cyclone&quot;,
+	&quot;Purge Magic&quot;,
+	&quot;Rising Colossus&quot;,
+	&quot;Sleep&quot;,
+	&quot;Spell Plague&quot;,
+	&quot;Spell Trigger&quot;,
+	&quot;Stone Form&quot;,
 	=

 	&quot;skull&quot;,
 	&quot;bank&quot;,
@@ -172,6 +191,7 @@
 	local artid	=3D item.artid
 	local hue	=3D item.hue
 	if (artid =3D=3D 0x170b) then return true end -- kobold schuhe
+	if (artid =3D=3D 0x2da2) then return true end -- mysticism scroll
 	if (artid =3D=3D 5110 and hue =3D=3D 2419) then return true end -- gargy =
knife
 	if (artid =3D=3D 3718 and hue =3D=3D 2419) then return true end -- gargy =
pickaxe
 	if (artid =3D=3D 3909 and hue =3D=3D 2419) then return true end -- gargy =
axe

Modified: trunk/scripts/luabindheader.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/scripts/luabindheader.lua (original)
+++ trunk/scripts/luabindheader.lua Mon Dec 21 21:06:19 2009
@@ -38,6 +38,8 @@
 							{basepath..&quot;OgreKeyFrame.h&quot;				,&quot;VertexMorphKeyFrame&quot;	,{&quot;KeyFrame&quot;}=
},
 							{basepath..&quot;OgreKeyFrame.h&quot;				,&quot;VertexPoseKeyFrame&quot;	,{&quot;KeyFrame&quot;}},
 							=

+							{basepath..&quot;OgreImage.h&quot;				,&quot;Image&quot;				,{}},
+							=

 							{basepath..&quot;OgreRenderOperation.h&quot;		,&quot;RenderOperation&quot;},	-- custom =
binding made, not good for auto-bind
 							{basepath..&quot;OgreHardwareVertexBuffer.h&quot;	,&quot;VertexDeclaration&quot;},	-- c=
ustom binding made, not good for auto-bind
 							--~ GenerateBinding(RobMovable,{MovableObject})
@@ -48,16 +50,20 @@
 	-- register types and prepare
 	for k,arr in pairs(classes) do
 		local filepath,classname,parentclassnames =3D unpack(arr)
+		gBoundPointerClasses[classname] =3D true
+	end
+	RegisterVarTypes()
+	=

+	for k,arr in pairs(classes) do
+		local filepath,classname,parentclassnames =3D unpack(arr)
 		local c =3D {}
 		c.code =3D LoadHeader(filepath,classname)
 		c.classname =3D classname
-		gBoundPointerClasses[classname] =3D true
 		_G[classname] =3D c
 	end
 	=

 	gOutLines =3D {}
 =

-	RegisterVarTypes()
 	=

 	-- generate bindings here
 	for k,arr in pairs(classes) do
@@ -150,6 +156,12 @@
 		gPusher[k] =3D &quot;Push&quot;..k
 		gReader[k] =3D &quot;Param&quot;..k
 	end
+	=

+	gCopyConstructed =3D {}
+	gCopyConstructed.Image =3D true
+	for k,v in pairs(gCopyConstructed) do =

+		gPusher[k] =3D &quot;PushCopy&quot;..k
+	end
 =

 	-- gBoundPointerClasses
 	gBoundPointerClasses.RenderQueue		=3D true
@@ -170,6 +182,7 @@
 	gIntTypes.long				=3Dtrue
 	gIntTypes.ulong				=3Dtrue
 	gIntTypes.short				=3Dtrue
+	gIntTypes.uchar				=3Dtrue
 	for k,v in pairs(gIntTypes) do =

 		gPusher[k] =3D &quot;PushNumber&quot;
 		gReader[k] =3D &quot;ParamInt&quot;
@@ -290,6 +303,7 @@
 	if ((not retpush) and (not bReturnVoid)) then =

 		retpush =3D &quot;Push&quot;..ret
 		bCommentedOut =3D true
+		--~ bCommentedOut =3D NormalizeType(ret)
 	end
 	=

 	local paramtext =3D {}
@@ -302,6 +316,7 @@
 				param =3D reader..&quot;(L,&quot;..(k+1)..&quot;)&quot;
 			elseif (param ~=3D &quot;&quot;) then
 				bCommentedOut =3D true
+				--~ bCommentedOut =3D NormalizeType(string.gsub(param,&quot;^.+::&quot;,&quot;&quot;))
 				param =3D &quot;Param&quot;..param..&quot;(L,&quot;..(k+1)..&quot;)&quot;
 			end
 			table.insert(paramtext,param)
@@ -316,6 +331,7 @@
 	if (namec &gt; 1) then nameadd =3D namec end
 	=

 	local prefix2 =3D bCommentedOut and &quot;//~ &quot; or &quot;&quot;
+	--~ local prefix2 =3D bCommentedOut and (&quot;//~ (&quot;..tostring(bCommentedOut)=
..&quot;)&quot;) or &quot;&quot;
 	=

 	if (bReturnVoid) then
 		return {prefix..prefix2..&quot;LUABIND_DIRECTWRAP_RETURN_VOID_NAMEADD(&quot;,	&quot;&quot;,	=
				&quot;&quot;..name..&quot;,&quot;..nameadd,		&quot;,(&quot;..paramtext..&quot;)\t);&quot;}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001959.html">[Iris-commit] [IRIS] r3199 - in /trunk/bin: D3DX9_42.dll iris2.exe
</A></li>
	<LI>Next message: <A HREF="001961.html">[Iris-commit] [IRIS] r3201 - /trunk/lua/lib.macrolist.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1960">[ date ]</a>
              <a href="thread.html#1960">[ thread ]</a>
              <a href="subject.html#1960">[ subject ]</a>
              <a href="author.html#1960">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
