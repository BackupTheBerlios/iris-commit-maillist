<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r3268 - in /trunk/lua: lib.configdialog.hotkeys.lua lib.macrolist.lua net/net.object.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2010-March/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3268%20-%20in%20/trunk/lua%3A%0A%20lib.configdialog.hotkeys.lua%20lib.macrolist.lua%20net/net.object.lua&In-Reply-To=%3C20100307132607.8382754D0007%40simon%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002027.html">
   <LINK REL="Next"  HREF="002029.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r3268 - in /trunk/lua: lib.configdialog.hotkeys.lua lib.macrolist.lua net/net.object.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3268%20-%20in%20/trunk/lua%3A%0A%20lib.configdialog.hotkeys.lua%20lib.macrolist.lua%20net/net.object.lua&In-Reply-To=%3C20100307132607.8382754D0007%40simon%3E"
       TITLE="[Iris-commit] [IRIS] r3268 - in /trunk/lua: lib.configdialog.hotkeys.lua lib.macrolist.lua net/net.object.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Sun Mar  7 14:26:07 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002027.html">[Iris-commit] [IRIS] r3267 - /trunk/lua/lib.macrolist.lua
</A></li>
        <LI>Next message: <A HREF="002029.html">[Iris-commit] [IRIS] r3269 - in /trunk/lua: lib.macrolist.lua	net/net.uoam.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2028">[ date ]</a>
              <a href="thread.html#2028">[ thread ]</a>
              <a href="subject.html#2028">[ subject ]</a>
              <a href="author.html#2028">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ghoulsblade
Date: Sun Mar  7 14:26:07 2010
New Revision: 3268

Log:
hotkey actions bugfixes

Modified:
    trunk/lua/lib.configdialog.hotkeys.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/net/net.object.lua

Modified: trunk/lua/lib.configdialog.hotkeys.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.configdialog.hotkeys.lua (original)
+++ trunk/lua/lib.configdialog.hotkeys.lua Sun Mar  7 14:26:07 2010
@@ -79,6 +79,8 @@
 			local t =3D MacroCmd_JobGetTargetClientSide()
 			if (not t) then return end
 			local obj =3D GetDynamic(MacroCmd_GetStoredTarget_Serial(t) or 0)
+			print(&quot;######################################################&quot;)
+			print(&quot;hotkey:objpick:&quot;,SmartDump(t),MacroCmd_GetStoredTarget_Serial(t)=
,obj)
 			if (not obj) then return end
 			HotKeyDialog_SetObject(obj.serial,obj.artid,obj.hue)
 		end)
@@ -259,10 +261,10 @@
     MyAddHotkeyAction(groupname,{name=3D&quot;ToggleStatus&quot;				,callback=3Dfunc=
tion () MacroCmd_Open(&quot;Status&quot;) end})
     MyAddHotkeyAction(groupname,{name=3D&quot;ToggleCompass&quot;				,callback=3Dfun=
ction () MacroCmd_Open(&quot;Compass&quot;) end})
     MyAddHotkeyAction(groupname,{name=3D&quot;ToggleMap&quot;					,callback=3Dfuncti=
on () GUI_ToggleMap() end})
-    MyAddHotkeyAction(groupname,{name=3D&quot;CompassZoomIn&quot;				,callback=3Dfun=
ction () MacroCmd_ZoomCompass(1*1.5) end})
-    MyAddHotkeyAction(groupname,{name=3D&quot;CompassZoomOut&quot;				,callback=3Dfu=
nction () MacroCmd_ZoomCompass(1/1.5) end})
-    MyAddHotkeyAction(groupname,{name=3D&quot;CamZoomIn&quot;					,callback=3Dfuncti=
on () MacroCmd_CamChangeZoom( 0.3) end})
-    MyAddHotkeyAction(groupname,{name=3D&quot;CamZoomOut&quot;					,callback=3Dfunct=
ion () MacroCmd_CamChangeZoom(-0.3) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CompassZoomOut&quot;				,callback=3Dfu=
nction () MacroCmd_ZoomCompass(1*1.5) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CompassZoomIn&quot;				,callback=3Dfun=
ction () MacroCmd_ZoomCompass(1/1.5) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CamZoomOut&quot;					,callback=3Dfunct=
ion () MacroCmd_CamChangeZoom( 0.3) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CamZoomIn&quot;					,callback=3Dfuncti=
on () MacroCmd_CamChangeZoom(-0.3) end})
     MyAddHotkeyAction(groupname,{name=3D&quot;Screenshot&quot;					,callback=3Dfunct=
ion () MacroCmd_Screenshot() end})
     MyAddHotkeyAction(groupname,{name=3D&quot;PacketVideo:ToggleRecording&quot;	,cal=
lback=3Dfunction () MacroCmd_TogglePacketVideoRecording() end})
     MyAddHotkeyAction(groupname,{name=3D&quot;NextCamMode&quot;					,callback=3Dfunc=
tion () MacroCmd_NextCamMode() end})
@@ -275,9 +277,9 @@
 	=

     -- actions
     local groupname =3D &quot;misc&quot;
-    MyAddHotkeyAction(groupname,{name=3D&quot;UseObjectByType&quot;        	,callbac=
k=3Dfunction (serial,artid,hue) MacroCmd_Item_Use(GetDynamic(serial or 0)) =
end,bHasObjectParam=3Dtrue}) -- {potions,fukija,shuriken,bandage(old)}
-    MyAddHotkeyAction(groupname,{name=3D&quot;UseObjectByID&quot;          	,callbac=
k=3Dfunction (serial,artid,hue) if (artid) then MacroCmd_Item_UseByArtID(ar=
tid,hue) end end,bHasObjectParam=3Dtrue})
-    MyAddHotkeyAction(groupname,{name=3D&quot;UseNearbyByType&quot;        	,callbac=
k=3Dfunction (serial,artid,hue) MacroCmd_Item_Use(GetRandomArrayElement(Mac=
roCmd_Item_FindNearByArtList(artid and {artid},2))) end,bHasObjectParam=3Dt=
rue})
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseObjectByType&quot;        	,callbac=
k=3Dfunction (actiondata,serial,artid,hue) print(&quot;hotkey:UseObjectByType&quot;,s=
erial,hex(artid),hue) MacroCmd_Item_Use(GetDynamic(serial or 0)) end,bHasOb=
jectParam=3Dtrue}) -- {potions,fukija,shuriken,bandage(old)}
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseObjectByID&quot;          	,callbac=
k=3Dfunction (actiondata,serial,artid,hue) if (artid) then MacroCmd_Item_Us=
eByArtID(artid,hue) end end,bHasObjectParam=3Dtrue})
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseNearbyByType&quot;        	,callbac=
k=3Dfunction (actiondata,serial,artid,hue) MacroCmd_Item_Use(GetRandomArray=
Element(MacroCmd_Item_FindNearByArtList(artid and {artid},2))) end,bHasObje=
ctParam=3Dtrue})
     MyAddHotkeyAction(groupname,{name=3D&quot;LastSpell&quot;              	,callbac=
k=3Dfunction () MacroCmd_RepeatLastSpell() end}) -- todo : targetlast optio=
n ?
     MyAddHotkeyAction(groupname,{name=3D&quot;LastObject&quot;             	,callbac=
k=3Dfunction () MacroCmd_RepeatLastDoubleClick() end})
     MyAddHotkeyAction(groupname,{name=3D&quot;LastChat&quot;               	,callbac=
k=3Dfunction () MacroCmd_RepeatLastChat() end})

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Sun Mar  7 14:26:07 2010
@@ -228,6 +228,8 @@
 	if (not t) then return end
     if (t.hittype =3D=3D kMousePickHitType_Mobile) then return t.mobile.se=
rial end
     if (t.hittype =3D=3D kMousePickHitType_Dynamic) then return t.dynamic.=
serial end
+    if (t.hittype =3D=3D kMousePickHitType_ContainerItem) then return t.it=
em.serial end
+    if (t.hittype =3D=3D kMousePickHitType_PaperdollItem) then return t.it=
em.serial end
 end
 function MacroCmd_GetStoredTarget_Pos (t)
 	if (not t) then return end

Modified: trunk/lua/net/net.object.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.object.lua (original)
+++ trunk/lua/net/net.object.lua Sun Mar  7 14:26:07 2010
@@ -3,6 +3,7 @@
 =

 function Send_DoubleClick (iSerial)
 	if (gbDisableDoubleClick) then return end
+	if (not iSerial) then return end
 	--print(&quot;Send_DoubleClick&quot;,sprintf(&quot;0x%08x&quot;,iSerial),GetOneLineBackTrace(=
2))
 	printdebug(&quot;net&quot;,sprintf(&quot;NET: Send_DoubleClick: 0x%08x\n&quot;,iSerial))
 	local out =3D GetSendFIFO()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002027.html">[Iris-commit] [IRIS] r3267 - /trunk/lua/lib.macrolist.lua
</A></li>
	<LI>Next message: <A HREF="002029.html">[Iris-commit] [IRIS] r3269 - in /trunk/lua: lib.macrolist.lua	net/net.uoam.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2028">[ date ]</a>
              <a href="thread.html#2028">[ thread ]</a>
              <a href="subject.html#2028">[ subject ]</a>
              <a href="author.html#2028">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
