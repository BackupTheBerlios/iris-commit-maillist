<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r3266 - in /trunk/lua:	lib.configdialog.hotkeys.lua lib.macrolist.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2010-March/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3266%20-%20in%20/trunk/lua%3A%0A%09lib.configdialog.hotkeys.lua%20lib.macrolist.lua&In-Reply-To=%3C20100306173521.E5BE854D0007%40simon%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002025.html">
   <LINK REL="Next"  HREF="002027.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r3266 - in /trunk/lua:	lib.configdialog.hotkeys.lua lib.macrolist.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r3266%20-%20in%20/trunk/lua%3A%0A%09lib.configdialog.hotkeys.lua%20lib.macrolist.lua&In-Reply-To=%3C20100306173521.E5BE854D0007%40simon%3E"
       TITLE="[Iris-commit] [IRIS] r3266 - in /trunk/lua:	lib.configdialog.hotkeys.lua lib.macrolist.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Sat Mar  6 18:35:21 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002025.html">[Iris-commit] [IRIS] r3265 - in /trunk: include/builder.h	src/builder_L.cpp
</A></li>
        <LI>Next message: <A HREF="002027.html">[Iris-commit] [IRIS] r3267 - /trunk/lua/lib.macrolist.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2026">[ date ]</a>
              <a href="thread.html#2026">[ thread ]</a>
              <a href="subject.html#2026">[ subject ]</a>
              <a href="author.html#2026">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ghoulsblade
Date: Sat Mar  6 18:35:21 2010
New Revision: 3266

Log:
new macros and hotkeys : SimpleLoot,CutNearbyCorpse,Scavenge,TargetWeaponIn=
Hand,TextEntryRepeat,LootItem,CycleMaxFPS,TogglePacketVideoRecording,MountN=
earby,WalkToRandomTree,TargetNearestTree,TargetRandomNearGround,ToggleHouse=
Blendout,HideAllCorpses,WeaponSkill:ToggleAuto reactivate,SpamLastSpell

Modified:
    trunk/lua/lib.configdialog.hotkeys.lua
    trunk/lua/lib.macrolist.lua

Modified: trunk/lua/lib.configdialog.hotkeys.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.configdialog.hotkeys.lua (original)
+++ trunk/lua/lib.configdialog.hotkeys.lua Sat Mar  6 18:35:21 2010
@@ -251,86 +251,126 @@
         end
     end
     =

+    local groupname =3D &quot;interface&quot;
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleBackpack&quot;				,callback=3Dfu=
nction () MacroCmd_Open(&quot;Backpack&quot;) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleJournal&quot;				,callback=3Dfun=
ction () MacroCmd_Open(&quot;Journal&quot;) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleSkills&quot;				,callback=3Dfunc=
tion () MacroCmd_Open(&quot;Skill&quot;) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;TogglePaperdoll&quot;				,callback=3Df=
unction () MacroCmd_Open(&quot;Paperdoll&quot;) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleStatus&quot;				,callback=3Dfunc=
tion () MacroCmd_Open(&quot;Status&quot;) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleCompass&quot;				,callback=3Dfun=
ction () MacroCmd_Open(&quot;Compass&quot;) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleMap&quot;					,callback=3Dfuncti=
on () GUI_ToggleMap() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CompassZoomIn&quot;				,callback=3Dfun=
ction () MacroCmd_ZoomCompass(1*1.5) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CompassZoomOut&quot;				,callback=3Dfu=
nction () MacroCmd_ZoomCompass(1/1.5) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CamZoomIn&quot;					,callback=3Dfuncti=
on () MacroCmd_CamChangeZoom( 0.3) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CamZoomOut&quot;					,callback=3Dfunct=
ion () MacroCmd_CamChangeZoom(-0.3) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Screenshot&quot;					,callback=3Dfunct=
ion () MacroCmd_Screenshot() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;PacketVideo:ToggleRecording&quot;	,cal=
lback=3Dfunction () MacroCmd_TogglePacketVideoRecording() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;NextCamMode&quot;					,callback=3Dfunc=
tion () MacroCmd_NextCamMode() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Toggle2D/3D&quot;					,callback=3Dfunc=
tion () MacroCmd_ActivateNextRenderer() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;CycleMaxFPS&quot;					,callback=3Dfunc=
tion () MacroCmd_CycleMaxFPS() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Quit&quot;						,callback=3Dfunction (=
) MacroCmd_Quit() end})
+	=

+	=

+	=

+	=

     -- actions
-    gUOActions =3D {}
-    gUOActionByName =3D {}
-    function RegisterUOAction (action) =

-        table.insert(gUOActions,action)
-        gUOActionByName[action.name] =3D action
-    end
-    RegisterUOAction({name=3D&quot;WeaponSkill:Primary&quot;    	,callback=3Dfunctio=
n () MacroCmd_WeaponAbilityPrimary() end})
-    RegisterUOAction({name=3D&quot;WeaponSkill:Secondary&quot;  	,callback=3Dfunctio=
n () MacroCmd_WeaponAbilitySecondary() end})
-    RegisterUOAction({name=3D&quot;Dismount&quot;               	,callback=3Dfunctio=
n () MacroCmd_Dismount() end})
-    RegisterUOAction({name=3D&quot;ToggleWarmode&quot;          	,callback=3Dfunctio=
n () MacroCmd_ToggleWarmode() end})
-    RegisterUOAction({name=3D&quot;LastSpell&quot;              	,callback=3Dfunctio=
n () MacroCmd_RepeatLastSpell() end}) -- todo : targetlast option ?
-    RegisterUOAction({name=3D&quot;LastChat&quot;               	,callback=3Dfunctio=
n () MacroCmd_RepeatLastChat() end})
-    RegisterUOAction({name=3D&quot;LastObject&quot;             	,callback=3Dfunctio=
n () MacroCmd_RepeatLastDoubleClick() end})
-    RegisterUOAction({name=3D&quot;SelfInterrupt(hat)&quot;     	,callback=3Dfunctio=
n () InterruptOwnSpell(MacroCmd_GetPlayerEquipment(kLayer_Helm)) end})
-    RegisterUOAction({name=3D&quot;SelfInterrupt(robe)&quot;    	,callback=3Dfunctio=
n () InterruptOwnSpell(MacroCmd_GetPlayerEquipment(kLayer_TorsoOuter)) end})
-    RegisterUOAction({name=3D&quot;OpenDoor(new)&quot;          	,callback=3Dfunctio=
n () MacroCmd_OpenDoors() end})
-    RegisterUOAction({name=3D&quot;UseNearestGate&quot;         	,callback=3Dfunctio=
n () MacroCmd_UseNearbyGate() end})
-    RegisterUOAction({name=3D&quot;UseObjectByType&quot;        	,callback=3Dfunctio=
n (serial,artid,hue) MacroCmd_Item_Use(GetDynamic(serial or 0)) end,bHasObj=
ectParam=3Dtrue}) -- {potions,fukija,shuriken,bandage(old)}
-    RegisterUOAction({name=3D&quot;UseObjectByID&quot;          	,callback=3Dfunctio=
n (serial,artid,hue) if (artid) then MacroCmd_Item_UseByArtID(artid,hue) en=
d end,bHasObjectParam=3Dtrue})
-    RegisterUOAction({name=3D&quot;MiniHealCureSelf&quot;			,callback=3Dfunction () =
MacroCmd_MiniHealCureSelf() end})
-    RegisterUOAction({name=3D&quot;BandageSelf(builtin)&quot;		,callback=3Dfunction =
() MacroCmd_BandageSelf() end})
-    RegisterUOAction({name=3D&quot;BandageSelf(use+target)&quot;	,callback=3Dfunctio=
n () MacroCmd_Item_UseByArtID(0xe21) MacroCmd_QueueTargetSerial(GetPlayerSe=
rial(),1000) end})
-    RegisterUOAction({name=3D&quot;TargetSelf&quot;					,callback=3Dfunction () Macr=
oCmd_TargetSelfNow() end})
-    RegisterUOAction({name=3D&quot;TargetLast(dumb)&quot;			,callback=3Dfunction () =
MacroCmd_TargetLastNow() end})
-    RegisterUOAction({name=3D&quot;TargetLast(smart)&quot;			,callback=3Dfunction ()=
 MacroCmd_SendTargetSerial(MacroCmd_GetSmartTargetForLastSpell(),gSpellCast=
Range) end})
-    RegisterUOAction({name=3D&quot;SelectNearest&quot;				,callback=3Dfunction () lo=
cal m=3DMacroCmd_FindNearestMob() MobListSetMainTargetSerial(m and m.serial=
 or 0) end})
-    RegisterUOAction({name=3D&quot;SelectRandomNonFriendly&quot;	,callback=3Dfunctio=
n () MacroCmd_SmartSelectTarget() end}) -- pvp, random..    -- target with =
TargetLast(Smart)
-    RegisterUOAction({name=3D&quot;AttackSelected&quot;				,callback=3Dfunction () M=
acroCmd_AttackSelectedMobile() end}) -- melee
-    RegisterUOAction({name=3D&quot;Screenshot&quot;					,callback=3Dfunction () Macr=
oCmd_Screenshot() end})
-    RegisterUOAction({name=3D&quot;PacketVideo&quot;				,callback=3Dfunction () Pack=
etVideo_Recording_Toggle() end})
-    RegisterUOAction({name=3D&quot;HideAllCorpses&quot;				,callback=3Dfunction () M=
acroCmd_HideAllCorpses() end})
-    RegisterUOAction({name=3D&quot;WalkToMousePos&quot;				,callback=3Dfunction () M=
acroCmd_WalkToMouse() end})
-    RegisterUOAction({name=3D&quot;Walk_North&quot;					,callback=3Dfunction () Macr=
oCmd_WalkInDir(0) end})
-    RegisterUOAction({name=3D&quot;Walk_NorthEast&quot;				,callback=3Dfunction () M=
acroCmd_WalkInDir(1) end})
-    RegisterUOAction({name=3D&quot;Walk_East&quot;					,callback=3Dfunction () Macro=
Cmd_WalkInDir(2) end})
-    RegisterUOAction({name=3D&quot;Walk_SouthEast&quot;				,callback=3Dfunction () M=
acroCmd_WalkInDir(3) end})
-    RegisterUOAction({name=3D&quot;Walk_South&quot;					,callback=3Dfunction () Macr=
oCmd_WalkInDir(4) end})
-    RegisterUOAction({name=3D&quot;Walk_SouthWest&quot;				,callback=3Dfunction () M=
acroCmd_WalkInDir(5) end})
-    RegisterUOAction({name=3D&quot;Walk_West&quot;					,callback=3Dfunction () Macro=
Cmd_WalkInDir(6) end})
-    RegisterUOAction({name=3D&quot;Walk_NorthWest&quot;				,callback=3Dfunction () M=
acroCmd_WalkInDir(7) end})
-    RegisterUOAction({name=3D&quot;ToggleHouseBlendout&quot;		,callback=3Dfunction (=
) ToggleMultiOnlyShowFloor()  end})
-    RegisterUOAction({name=3D&quot;ToggleCompass&quot;				,callback=3Dfunction () Ma=
croCmd_Open(&quot;Compass&quot;) end})
-    RegisterUOAction({name=3D&quot;CompassZoomIn&quot;				,callback=3Dfunction () Ma=
croCmd_ZoomCompass(1*1.5) end})
-    RegisterUOAction({name=3D&quot;CompassZoomOut&quot;				,callback=3Dfunction () M=
acroCmd_ZoomCompass(1/1.5) end})
-    RegisterUOAction({name=3D&quot;CamZoomIn&quot;					,callback=3Dfunction () Macro=
Cmd_CamChangeZoom( 0.3) end})
-    RegisterUOAction({name=3D&quot;CamZoomOut&quot;					,callback=3Dfunction () Macr=
oCmd_CamChangeZoom(-0.3) end})
-    RegisterUOAction({name=3D&quot;ResyncRequest&quot;				,callback=3Dfunction () Se=
nd_Movement_Resync_Request() end})
-    RegisterUOAction({name=3D&quot;ToggleAlwaysRun&quot;				,callback=3Dfunction () =
gAlwaysRun =3D not gAlwaysRun end})
-	=

+    local groupname =3D &quot;misc&quot;
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseObjectByType&quot;        	,callbac=
k=3Dfunction (serial,artid,hue) MacroCmd_Item_Use(GetDynamic(serial or 0)) =
end,bHasObjectParam=3Dtrue}) -- {potions,fukija,shuriken,bandage(old)}
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseObjectByID&quot;          	,callbac=
k=3Dfunction (serial,artid,hue) if (artid) then MacroCmd_Item_UseByArtID(ar=
tid,hue) end end,bHasObjectParam=3Dtrue})
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseNearbyByType&quot;        	,callbac=
k=3Dfunction (serial,artid,hue) MacroCmd_Item_Use(GetRandomArrayElement(Mac=
roCmd_Item_FindNearByArtList(artid and {artid},2))) end,bHasObjectParam=3Dt=
rue})
+    MyAddHotkeyAction(groupname,{name=3D&quot;LastSpell&quot;              	,callbac=
k=3Dfunction () MacroCmd_RepeatLastSpell() end}) -- todo : targetlast optio=
n ?
+    MyAddHotkeyAction(groupname,{name=3D&quot;LastObject&quot;             	,callbac=
k=3Dfunction () MacroCmd_RepeatLastDoubleClick() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;LastChat&quot;               	,callbac=
k=3Dfunction () MacroCmd_RepeatLastChat() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleWarmode&quot;          	,callbac=
k=3Dfunction () MacroCmd_ToggleWarmode() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;OpenDoor&quot;       		   	,callback=
=3Dfunction () MacroCmd_OpenDoors() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;SpamLastSpell&quot;			,callback=3Dfunc=
tion () MacroCmd_TargetLastNow() MacroCmd_RepeatLastSpell() end},&quot;repeat la=
st spell on last target&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;TargetSelf&quot;				,callback=3Dfuncti=
on () MacroCmd_TargetSelfNow() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;TargetLast(dumb)&quot;		,callback=3Dfu=
nction () MacroCmd_TargetLastNow() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;TargetLast(smart)&quot;		,callback=3Df=
unction () MacroCmd_SendTargetSerial(MacroCmd_GetSmartTargetForLastSpell(),=
gSpellCastRange) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;TargetWeaponInHand&quot;		,callback=3D=
function () MacroCmd_TargetWeaponInHand() end},&quot;useful for poisoning&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;WeaponSkill:Primary&quot;    	,callbac=
k=3Dfunction () MacroCmd_WeaponAbilityPrimary() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;WeaponSkill:Secondary&quot;  	,callbac=
k=3Dfunction () MacroCmd_WeaponAbilitySecondary() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;WeaponSkill:ToggleAuto&quot;	,callback=
=3Dfunction () if (gReActivateWeaponAbilityInterval) then gReActivateWeapon=
AbilityInterval =3D nil else gReActivateWeaponAbilityInterval =3D 3100 end =
end},&quot;auto-reactivate weapon ability after 3 seconds&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;Dismount&quot;               	,callbac=
k=3Dfunction () MacroCmd_Dismount() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;MountNearby&quot;            	,callbac=
k=3Dfunction () MacroCmd_MountNearby() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;SelfInterrupt(hat)&quot;     	,callbac=
k=3Dfunction () InterruptOwnSpell(MacroCmd_GetPlayerEquipment(kLayer_Helm))=
 end},&quot;interrupt self when casting spell&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;SelfInterrupt(robe)&quot;    	,callbac=
k=3Dfunction () InterruptOwnSpell(MacroCmd_GetPlayerEquipment(kLayer_TorsoO=
uter)) end},&quot;interrupt self when casting spell&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;UseNearestGate&quot;         	,callbac=
k=3Dfunction () MacroCmd_UseNearbyGate() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;MiniHealCureSelf&quot;		,callback=3Dfu=
nction () MacroCmd_MiniHealCureSelf() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;BandageSelf(builtin)&quot;	,callback=
=3Dfunction () MacroCmd_BandageSelf() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;BandageSelf(use+target)&quot;	,callbac=
k=3Dfunction () MacroCmd_Item_UseByArtID(0xe21) MacroCmd_QueueTargetSerial(=
GetPlayerSerial(),1000) end})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;BandageNearbyParty&quot;		,callbac=
k=3Dfunction () MacroCmd_Item_UseByArtID(0xe21) MacroCmd_QueueTargetSerial(=
GetNearbyHealCurePartyMember(),1000) end})  -- pet,gray,nonparty..
+    MyAddHotkeyAction(groupname,{name=3D&quot;SelectNearest&quot;			,callback=3Dfunc=
tion () local m=3DMacroCmd_FindNearestMob() MobListSetMainTargetSerial(m an=
d m.serial or 0) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;SelectRandomNonFriendly&quot;	,callbac=
k=3Dfunction () MacroCmd_SmartSelectTarget() end}) -- pvp, random..    -- t=
arget with TargetLast(Smart)
+    MyAddHotkeyAction(groupname,{name=3D&quot;AttackSelected&quot;			,callback=3Dfun=
ction () MacroCmd_AttackSelectedMobile() end},&quot;meelee&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;HideAllCorpses&quot;			,callback=3Dfun=
ction () MacroCmd_HideAllCorpses() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleHouseBlendout&quot;		,callback=
=3Dfunction () ToggleMultiOnlyShowFloor()  end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ResyncRequest&quot;			,callback=3Dfunc=
tion () Send_Movement_Resync_Request() end},&quot;ask server to resync player po=
sition and objects&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleAlwaysRun&quot;			,callback=3Dfu=
nction () gAlwaysRun =3D not gAlwaysRun end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;TargetRandomNearGround&quot;	,callback=
=3Dfunction () MacroCmd_TargetGroundNow(gPlayerXLoc+math.random(3)-2,gPlaye=
rYLoc+math.random(3)-2) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;TargetNearestTree&quot;		,callback=3Df=
unction () local tree =3D GetRandomArrayElement(MacroCmd_FindNearbyTrees(2)=
)  if (tree) then CompleteTargetModeWithTargetStatic(tree) end end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;WalkToRandomTree&quot;		,callback=3Dfu=
nction () local tree =3D GetRandomArrayElement(MacroCmd_FindNearbyTrees(20)=
) if (tree) then MacroCmd_PathFindTo(tree.xloc,tree.yloc,2) end end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;SimpleLoot&quot;				,callback=3Dfuncti=
on () MacroCmd_SimpleLootStep() end},&quot;loot a random item from nearby corpse=
s&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleAutoLoot&quot;			,callback=3Dfun=
ction () ToggleAutoLoot() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;ScavengeNearby&quot;			,callback=3Dfun=
ction () MacroCmd_Scavenge() end},&quot;picks up nearby items&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;CutNearbyCorpse&quot;			,callback=3Dfu=
nction () MacroCmd_CutNearbyCorpse() end},&quot;uses dagger or skinning knife to=
 cut a nearby corpse&quot;)
+    MyAddHotkeyAction(groupname,{name=3D&quot;ToggleTextEntryRepeat&quot;	,callback=
=3Dfunction () MacroCmd_ToggleTextEntryRepeatLastChat() end},&quot;uses last cha=
tline as text for all text-entry prompts, useful for filling vendors&quot;)
+	=

+    local groupname =3D &quot;walk&quot;
+    MyAddHotkeyAction(groupname,{name=3D&quot;WalkToMousePos&quot;			,callback=3Dfun=
ction () MacroCmd_WalkToMouse() end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_North&quot;				,callback=3Dfuncti=
on () MacroCmd_WalkInDir(0) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_NorthEast&quot;			,callback=3Dfun=
ction () MacroCmd_WalkInDir(1) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_East&quot;				,callback=3Dfunctio=
n () MacroCmd_WalkInDir(2) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_SouthEast&quot;			,callback=3Dfun=
ction () MacroCmd_WalkInDir(3) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_South&quot;				,callback=3Dfuncti=
on () MacroCmd_WalkInDir(4) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_SouthWest&quot;			,callback=3Dfun=
ction () MacroCmd_WalkInDir(5) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_West&quot;				,callback=3Dfunctio=
n () MacroCmd_WalkInDir(6) end})
+    MyAddHotkeyAction(groupname,{name=3D&quot;Walk_NorthWest&quot;			,callback=3Dfun=
ction () MacroCmd_WalkInDir(7) end})
+	=

+	--[[
+	-- mine and lumber : =

+	MiniHealCureParty
+	TargetrandomNearbyCorpse (necro animate? cut?)
+	MountNearby (warmode off)
+	BandageNearby
+	BandageNearbyParty
+	BandageNearbyFriendly
+	BandageNearbyNonHostile
+	BandageNearbySmart  (preference, self if low, party/guild,blue,pets...)
+	RazorActions ...
+	doubleclick nearby objtype (harvest)
+	=

+	targetlast+castspell x (chooser, not last here)
+	=

+	ToggleMinerGrid
+	target nearest revenant.  (dispel)    local target =3D MacroCmd_FindNeare=
stMobByName(&quot;revenant&quot;) or MacroCmd_FindNearestMobByName(&quot;blade spirit&quot;)
+	necro-familiar-menu
+	=

+	]]--
+	-- mount nearest horse
 	-- MacroCmd_UseRuneBookPreAOS , MacroCmd_UseRuneBookPostAOS  (method,idx)
-    --~ RegisterUOAction({name=3D&quot;UseItemInHand(Wands)&quot;   })
-    --~ RegisterUOAction({name=3D&quot;OpenDoor(old/preaos)&quot;   })
-    --~ RegisterUOAction({name=3D&quot;Select&quot;                 ,bHasTargetOptio=
n=3Dtrue})
-    --~ RegisterUOAction({name=3D&quot;Attack&quot;                 ,bHasTargetOptio=
n=3Dtrue})
-    --~ RegisterUOAction({name=3D&quot;Target&quot;                 ,bHasTargetOptio=
n=3Dtrue})
-    --~ RegisterUOAction({name=3D&quot;Mini Heal/Cure&quot;         ,bHasTargetOptio=
n=3Dtrue})
-    --~ RegisterUOAction({name=3D&quot;Big Heal/Cure&quot;          ,bHasTargetOptio=
n=3Dtrue})
-    --~ RegisterUOAction({name=3D&quot;Bandage&quot;                ,bHasTargetOptio=
n=3Dtrue})
-    --~ RegisterUOAction({name=3D&quot;ReloadFukija&quot;})
-    --~ RegisterUOAction({name=3D&quot;ReloadShuriken&quot;})
-    --~ RegisterUOAction({name=3D&quot;ScavengerStep&quot;})
-    --~ RegisterUOAction({name=3D&quot;ScavengerReset&quot;})
-    --~ RegisterUOAction({name=3D&quot;Looter&quot;})
-    --~ RegisterUOAction({name=3D&quot;OpenCorpse&quot;})
-    --~ RegisterUOAction({name=3D&quot;CutCorpse&quot;})
-    --~ RegisterUOAction({name=3D&quot;CutLeather&quot;}) -- scissor
-    --~ RegisterUOAction({name=3D&quot;LeatherStep(lootleather,scissor leather,=
cut corpse,opencorpse)&quot;})
-    --~ RegisterUOAction({name=3D&quot;Harvester(cotton,flax,sheep)&quot;})
-    --~ RegisterUOAction({name=3D&quot;Restock(regs,pots,pouches,clothes)&quot;})
-    --~ RegisterUOAction({name=3D&quot;BuyAgent&quot;})
-    --~ RegisterUOAction({name=3D&quot;SellAgent&quot;})
-    --~ RegisterUOAction({name=3D&quot;Mover/Organizer(items)&quot;})  -- move betwe=
en containers, or to grid positions
-    --~ RegisterUOAction({name=3D&quot;UseOnce(Pouches)&quot;}) -- saves a list, whe=
n an item is used, it is removed from list, when list is empty, it is refil=
led ?
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;UseItemInHand(Wands)&quot;   })
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;OpenDoor(old/preaos)&quot;   })
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Select&quot;                 ,bHas=
TargetOption=3Dtrue})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Attack&quot;                 ,bHas=
TargetOption=3Dtrue})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Target&quot;                 ,bHas=
TargetOption=3Dtrue})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Mini Heal/Cure&quot;         ,bHas=
TargetOption=3Dtrue})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Big Heal/Cure&quot;          ,bHas=
TargetOption=3Dtrue})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Bandage&quot;                ,bHas=
TargetOption=3Dtrue})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;ReloadFukija&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;ReloadShuriken&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;CutCorpse&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;CutLeather&quot;}) -- scissor
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;LeatherStep(lootleather,sciss=
or leather,cut corpse,opencorpse)&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Harvester(cotton,flax,sheep)&quot;=
})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Restock(regs,pots,pouches,clo=
thes)&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;BuyAgent&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;SellAgent&quot;})
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;Mover/Organizer(items)&quot;})  --=
 move between containers, or to grid positions
+    --~ MyAddHotkeyAction(groupname,{name=3D&quot;UseOnce(Pouches)&quot;}) -- saves =
a list, when an item is used, it is removed from list, when list is empty, =
it is refilled ?
     -- (razor:add/remove friend (targetting))
 	-- todo: screenshot/vid
     =

-    -- misc
-    local groupname =3D &quot;misc&quot;
-    for k,action in pairs(gUOActions) do MyAddHotkeyAction(groupname,actio=
n) end
     =

     -- chat
     local groupname =3D &quot;chat&quot;

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Sat Mar  6 18:35:21 2010
@@ -584,6 +584,12 @@
 end
 function MacroCmd_GetItemInHand () return MacroCmd_GetPlayerEquipment(kLay=
er_OneHanded) end
 function MacroCmd_IsMounted () return MacroCmd_GetPlayerEquipment(kLayer_M=
ount) ~=3D nil end
+function MacroCmd_MountNearby ()
+	if (MacroCmd_IsMounted()) then return end
+	if (IsWarModeActive()) then MacroCmd_ToggleWarmode() end
+	local mount =3D GetRandomArrayElement(MobileList_GetByFilter(function (mo=
bile) return GetUODistToPlayer(mobile.xloc,mobile.yloc) &lt;=3D 2 and (not Mob=
ileIsHuman(mobile)) end))
+	if (mount) then Send_DoubleClick(mount.serial) end
+end
 function MacroCmd_Dismount ()
     if (MacroCmd_IsMounted()) then Send_DoubleClick(GetPlayerSerial()) ret=
urn true end -- todo : check if mounted
 end
@@ -614,6 +620,77 @@
 		Send_Drop_Object(takeserial,xloc,yloc,zloc,0xFFFFFFFF)
 	end)
 end
+
+
+function MacroCmd_TogglePacketVideoRecording() PacketVideo_Recording_Toggl=
e() MacroCmd_RiseText(1,0,0,&quot;packetvideo:rec:&quot;..(gPacketVideoRecording and =
&quot;start&quot; or &quot;stop&quot;)) end
+
+function MacroCmd_CycleMaxFPS()
+	local fps =3D {5,10,15,20,40}
+	local found
+	for k,v in pairs(fps) do if (gMaxFPS =3D=3D v) then gMaxFPS =3D fps[k+1] =
found =3D true break end end =

+	if ((not gMaxFPS) or (not found)) then gMaxFPS =3D fps[1] end
+	MacroCmd_RiseText(1,0,0,&quot;maxfps:&quot;..gMaxFPS) =

+end
+
+function MacroCmd_GetOpenBankBoxSerial ()  -- search for bankbox in curren=
tly open containers
+	for k,dynamic in pairs(GetDynamicList()) do =

+		if (dynamic.artid =3D=3D 0xe7c and dynamic.hue =3D=3D 0 and (not Dynamic=
IsInWorld(dynamic))) then =

+			print(&quot;bankbox: open&quot;,IsContainerAlreadyOpen(dynamic)) -- always false =
in norender, HandleOpenContainer: no gumploader
+			return dynamic.serial
+		end =

+	end
+end
+
+function MacroCmd_LootItem (item,containerserial,amount) =

+	if (not item) then return end
+	job.create(function () =

+		Send_Take_Object(item.serial,min(item.amount,amount or item.amount))
+		job.wait(math.random(200,300))
+		Send_Drop_Object_AutoStack(item.serial,containerserial or GetPlayerBackP=
ackSerial())
+		end)
+end
+
+function MacroCmd_ToggleTextEntryRepeatLastChat() gMacroCmd_OnTextEntryRep=
eat =3D not gMacroCmd_OnTextEntryRepeat MacroCmd_RiseText(1,1,0,&quot;entry:repe=
at:&quot;..(gMacroCmd_OnTextEntryRepeat and &quot;on&quot; or &quot;off&quot;)) end
+RegisterListenerOnce(&quot;Hook_Unicode_Text_Entry&quot;,function () if (gMacroCmd_O=
nTextEntryRepeat) then MacroCmd_RiseText(1,1,0,&quot;entry:repeat&quot;) MacroCmd_Rep=
eatLastChat() end end,&quot;MacroCmd_Hook_Unicode_Text_Entry&quot;)
+
+function MacroCmd_TargetWeaponInHand () -- useful for poisoning
+	local weapon =3D MacroCmd_GetPlayerEquipment(kLayer_OneHanded) or MacroCm=
d_GetPlayerEquipment(kLayer_TwoHanded) =

+	if (weapon) then MacroCmd_QueueTargetSerial(weapon.serial,1000) end
+end =

+
+function MacroCmd_Scavenge (artlist,dist) MacroCmd_LootItem(GetRandomArray=
Element(MacroCmd_Item_FindNearByArtList(artlist,dist))) end -- try to picku=
p nearby items
+
+function MacroCmd_CutNearbyCorpse ()
+	local corpse =3D GetRandomArrayElement(MacroCmd_Item_FindNearCorpses(2))
+	local blade =3D MacroCmd_Item_FindFirstByArtID({0x0f52,0x13f6,0xec4,0x13b=
6,0xf51}) -- 0x0f52=3Dknife 0x13f6=3Dgargyknife 0xec4:skinningknife
+	if (corpse and blade) then Send_DoubleClick(blade.serial) MacroCmd_QueueT=
argetSerial(corpse.serial,1000) end
+end
+
+function MacroCmd_SimpleLootStep ()
+	local corpses =3D MacroCmd_Item_FindNearCorpses(2)
+	local item
+	for k,corpse in pairs(corpses) do =

+		if (IsContainerAlreadyOpen(corpse)) then =

+			item =3D item or GetRandomArrayElement(corpse:GetContent()) =

+		end =

+	end
+	local backpack	=3D GetPlayerBackPackSerial()
+	local bankbox	=3D MacroCmd_GetOpenBankBoxSerial()
+	for serial,container in pairs(gObjectList) do
+		if (IsContainerAlreadyOpen(container) and serial ~=3D backpack and seria=
l ~=3D bankbox) then =

+			item =3D item or GetRandomArrayElement(container:GetContent()) =

+		end =

+	end
+	=

+	if (item) then MacroCmd_LootItem(item) return end
+	for k,corpse in pairs(corpses) do =

+		if (not IsContainerAlreadyOpen(corpse)) then =

+			Send_DoubleClick(corpse.serial)
+			return =

+		end =

+	end
+end
+
 =

 -- 0x0c9e : ohii tree not hackable
 function MacroCmd_IsHackableTrees (artid) return 0x0c9e ~=3D artid and Str=
ingContains(string.lower(GetStaticTileTypeName(artid)),&quot;tree&quot;) end
@@ -680,7 +757,7 @@
     local res =3D {}
     for k,item in pairs(GetDynamicList()) do =

         if (DynamicIsInWorld(item) and =

-            (dist =3D=3D nil or item:GetUODistToPlayer() &lt;=3D dist) and in=
_array(item.artid,artlist)) then
+            (dist =3D=3D nil or item:GetUODistToPlayer() &lt;=3D (dist or 2))=
 and ((not artlist) or in_array(item.artid,artlist))) then
             table.insert(res,item)
         end
     end


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002025.html">[Iris-commit] [IRIS] r3265 - in /trunk: include/builder.h	src/builder_L.cpp
</A></li>
	<LI>Next message: <A HREF="002027.html">[Iris-commit] [IRIS] r3267 - /trunk/lua/lib.macrolist.lua
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2026">[ date ]</a>
              <a href="thread.html#2026">[ thread ]</a>
              <a href="subject.html#2026">[ subject ]</a>
              <a href="author.html#2026">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
