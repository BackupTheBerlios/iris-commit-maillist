From no-reply at zwischenwelt.org  Sat Jan  3 03:07:32 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 02:07:32 -0000
Subject: [Iris-commit] [IRIS] r2819 - in /trunk/data/models/textures:
 tex_442.png tex_443.png tex_444.png tex_445.png tex_446.png tex_447.png
 tex_454.png tex_455.png tex_507.png tex_508.png tex_oak_bark.png
 tex_oak_leaves.png
Message-ID: <20090103020733.0EAB91C18801@zwischenwelt.org>

Author: hagish
Date: Sat Jan  3 03:07:32 2009
New Revision: 2819

Log:
improved tree textures

Added:
    trunk/data/models/textures/tex_oak_bark.png   (with props)
    trunk/data/models/textures/tex_oak_leaves.png   (with props)
Modified:
    trunk/data/models/textures/tex_442.png
    trunk/data/models/textures/tex_443.png
    trunk/data/models/textures/tex_444.png
    trunk/data/models/textures/tex_445.png
    trunk/data/models/textures/tex_446.png
    trunk/data/models/textures/tex_447.png
    trunk/data/models/textures/tex_454.png
    trunk/data/models/textures/tex_455.png
    trunk/data/models/textures/tex_507.png
    trunk/data/models/textures/tex_508.png

Modified: trunk/data/models/textures/tex_442.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_443.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_444.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_445.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_446.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_447.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_454.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_455.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_507.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_508.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan  3 03:10:14 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 02:10:14 -0000
Subject: [Iris-commit] [IRIS] r2820 - in /trunk:
 data/models/materials/textures.material
 data/models/models/to_004000/mdl_003287.mesh
 data/models/textures/tex_003287.png lua/lib.debugmenu.lua
Message-ID: <20090103021015.0B7B11C18801@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan  3 03:10:14 2009
New Revision: 2820

Log:
new needle tree model

Added:
    trunk/data/models/textures/tex_003287.png   (with props)
Modified:
    trunk/data/models/materials/textures.material
    trunk/data/models/models/to_004000/mdl_003287.mesh
    trunk/lua/lib.debugmenu.lua

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan  3 03:10:14 2009
@@ -6014,3 +6014,8 @@
 { =

 	set_texture_alias MainTexture tex_pumpkin.png
 }
+
+material tex_003287 : tex_base_alpha =

+{ =

+	set_texture_alias MainTexture tex_003287.png
+}

Modified: trunk/data/models/models/to_004000/mdl_003287.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Sat Jan  3 03:10:14 2009
@@ -1264,13 +1264,14 @@
 }
 =

 function MyStartParticleDebugMode (data) -- -dparticle data
+	gParticleDebugModeStarted =3D true
 	-- gCurDebugMode =3D kDebugMode_Particle
 	MyParticleDebugMode_SetIndex(tonumber(data) or 1)
 	GuiAddChatLine("particle debug, f5 to reload, f2,f3 to change system")
 end
 =

 function MyParticleDebugMode_Init2 ()
-	if (gDebugMenuToolboxDialog) then gDebugMenuToolboxDialog:Destroy() gDebu=
gMenuToolboxDialog =3D nil end
+	if (gParticleDebugModeStarted and gDebugMenuToolboxDialog) then gDebugMen=
uToolboxDialog:Destroy() gDebugMenuToolboxDialog =3D nil end
 end
 =

 function MyParticleDebugMode_SetIndex (index)



From no-reply at zwischenwelt.org  Sat Jan  3 03:12:32 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 02:12:32 -0000
Subject: [Iris-commit] [IRIS] r2821 - in /trunk/data/models:
 materials/textures.material models/to_004000/mdl_003293.mesh
 models/to_004000/mdl_003294.mesh
Message-ID: <20090103021232.64E1A1C18801@zwischenwelt.org>

Author: hagish
Date: Sat Jan  3 03:12:31 2009
New Revision: 2821

Log:
improved oak

Modified:
    trunk/data/models/materials/textures.material
    trunk/data/models/models/to_004000/mdl_003293.mesh
    trunk/data/models/models/to_004000/mdl_003294.mesh

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan  3 03:12:31 2009
@@ -1,3 +1,5 @@
+import * from bump.material
+
 //###########################################
 // TEMPLATES
 //###########################################
@@ -44,7 +46,7 @@
 	{
 		pass Decal
 		{
-			alpha_rejection greater_equal 200
+			alpha_rejection greater_equal 128
 			alpha_to_coverage on
 		}
 	}
@@ -6015,6 +6017,16 @@
 	set_texture_alias MainTexture tex_pumpkin.png
 }
 =

+material tex_oak_bark : tex_base =

+{ =

+	set_texture_alias MainTexture tex_oak_bark.png
+}
+
+material tex_oak_leaves : tex_base_alpha =

+{ =

+	set_texture_alias MainTexture tex_oak_leaves.png
+}
+
 material tex_003287 : tex_base_alpha =

 { =

 	set_texture_alias MainTexture tex_003287.png

Modified: trunk/data/models/models/to_004000/mdl_003293.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_004000/mdl_003294.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan  3 03:14:46 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 02:14:46 -0000
Subject: [Iris-commit] [IRIS] r2822 -
	/trunk/data/models/materials/textures.material
Message-ID: <20090103021446.DFC361C18801@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan  3 03:14:46 2009
New Revision: 2822

Log: (empty)

Modified:
    trunk/data/models/materials/textures.material

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan  3 03:14:46 2009
@@ -1,5 +1,3 @@
-import * from bump.material
-
 //###########################################
 // TEMPLATES
 //###########################################



From no-reply at zwischenwelt.org  Sat Jan  3 04:00:19 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 03:00:19 -0000
Subject: [Iris-commit] [IRIS] r2823 -
	/trunk/data/models/textures/tex_oak_leaves.png
Message-ID: <20090103030019.4D2561C18801@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan  3 04:00:18 2009
New Revision: 2823

Log:
darkened oak leaf borders a bit

Modified:
    trunk/data/models/textures/tex_oak_leaves.png

Modified: trunk/data/models/textures/tex_oak_leaves.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan  3 05:26:43 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 04:26:43 -0000
Subject: [Iris-commit] [IRIS] r2824 - in /trunk/data/models:
 models/to_009000/mdl_008722.mesh models/to_009000/mdl_008767.mesh
 textures/tex_crystal.png
Message-ID: <20090103042643.6F8EB1C18801@zwischenwelt.org>

Author: hagish
Date: Sat Jan  3 05:26:42 2009
New Revision: 2824

Log:
crystals added

Added:
    trunk/data/models/models/to_009000/mdl_008722.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008767.mesh   (with props)
    trunk/data/models/textures/tex_crystal.png   (with props)



From no-reply at zwischenwelt.org  Sat Jan  3 05:27:21 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 04:27:21 -0000
Subject: [Iris-commit] [IRIS] r2825 -
	/trunk/data/models/materials/textures.material
Message-ID: <20090103042721.AA63A1C18801@zwischenwelt.org>

Author: hagish
Date: Sat Jan  3 05:27:20 2009
New Revision: 2825

Log:
crystals added

Modified:
    trunk/data/models/materials/textures.material

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan  3 05:27:20 2009
@@ -5551,16 +5551,19 @@
 	} =

 }
 =

-material tex_grass : tex_base_sceneblend
+material tex_grass : tex_base_alpha
 { =

 	technique default
 	{
 		pass Decal
 		{
+			cull_hardware none   =

+			cull_software none
+			=

 			texture_unit =

 			{ =

 				texture tex_grass.png
-				wave_xform scale_x sine 1.0 0.2 0.0 1.0
+				wave_xform scale_x sine 1.0 0.1 0.0 1.0
 			}	=

 		}
 	} =

@@ -6029,3 +6032,8 @@
 { =

 	set_texture_alias MainTexture tex_003287.png
 }
+
+material tex_crystal : tex_base
+{ =

+	set_texture_alias MainTexture tex_crystal.png
+}



From no-reply at zwischenwelt.org  Sat Jan  3 23:07:06 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 22:07:06 -0000
Subject: [Iris-commit] [IRIS] r2826 -
	/trunk/data/models/materials/textures.material
Message-ID: <20090103220706.449F31C18802@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan  3 23:07:05 2009
New Revision: 2826

Log:
fixed ogre OgreTextureUnitState.cpp:142: Assertion mEffects.empty

Modified:
    trunk/data/models/materials/textures.material

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan  3 23:07:05 2009
@@ -5551,7 +5551,7 @@
 	} =

 }
 =

-material tex_grass : tex_base_alpha
+material tex_grass : tex_base_sceneblend
 { =

 	technique default
 	{



From no-reply at zwischenwelt.org  Sat Jan  3 23:12:10 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 22:12:10 -0000
Subject: [Iris-commit] [IRIS] r2827 -
	/trunk/data/models/models/generate_tex_atlas.php
Message-ID: <20090103221210.21E321C187FF@zwischenwelt.org>

Author: hagish
Date: Sat Jan  3 23:12:09 2009
New Revision: 2827

Log:
ogre16 fix

Modified:
    trunk/data/models/models/generate_tex_atlas.php

Modified: trunk/data/models/models/generate_tex_atlas.php
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/models/generate_tex_atlas.php (original)
+++ trunk/data/models/models/generate_tex_atlas.php Sat Jan  3 23:12:09 2009
@@ -404,6 +404,7 @@
 =

 // generate material script
 $f =3D fopen("$atlasbasename.material","w");
+fwrite($f,"import atlas_base from textures.material\nimport atlas_base_alp=
ha from textures.material\n\n");
 for($i=3D0;$i<=3D$number;++$i){
 	$name =3D $atlasbasename.$i;
 	$base =3D $atlasbasematerial;



From no-reply at zwischenwelt.org  Sat Jan  3 23:47:47 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 03 Jan 2009 22:47:47 -0000
Subject: [Iris-commit] [IRIS] r2829 - in /trunk/lua: lib.3d.dynamic.lua
 lib.3d.mousepick.lua lib.3d.renderer.lua lib.3d.tilebatch.lua
 lib.debugmenu.lua lib.mapblock.3d.multis.lua
Message-ID: <20090103224747.D8A1B1C18802@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan  3 23:47:47 2009
New Revision: 2829

Log:
removed runtime xmirror scale for models, has been baked into the models now

Modified:
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.mousepick.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.3d.tilebatch.lua
    trunk/lua/lib.debugmenu.lua
    trunk/lua/lib.mapblock.3d.multis.lua

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sat Jan  3 23:47:47 2009
@@ -96,7 +96,8 @@
 							end
 =

 							local orderval =3D dynamic.zloc -- used for blendout later (fastbat=
ch feature)
-							v.mFastBatch:FastBatch_AddMeshBuffer(GetMeshBuffer(dynamic.meshname=
), orderval, x,y,z, qw,qx,qy,qz, -1,1,1, r,g,b,a)
+							--~ mirroring now baked into meshes for shader compatibility -- -1,=
1,1
+							v.mFastBatch:FastBatch_AddMeshBuffer(GetMeshBuffer(dynamic.meshname=
), orderval, x,y,z, qw,qx,qy,qz, 1,1,1, r,g,b,a)
 							-- print("->",bx,by,dynamic.serial)
 						end
 					end
@@ -355,7 +356,7 @@
 			item.gfx =3D CreateRootGfx3D()
 			item.gfx:SetMesh(item.meshname)
 			item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
-			item.gfx:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong =
mirrored meshes
+			--~ mirroring now baked into meshes for shader compatibility -- item.gf=
x:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong mirrored me=
shes
 			item.gfx:SetNormaliseNormals(true)
 			item.gfx:SetCastShadows(gDynamicsCastShadows)
 			-- primary color hueing

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Sat Jan  3 23:47:47 2009
@@ -415,7 +415,7 @@
 			--local qw,qx,qy,qz =3D Quaternion.identity()
 			local qw,qx,qy,qz =3D GetStaticMeshOrientation(dynamic.artid) -- TODO :=
 WRONG FOR ROTATED DYNAMICS (dir) !!!
 			self.gMousePickBBox:SetOrientation(qw,qx,qy,qz)
-			self.gMousePickBBox:SetScale(-1,1,1)		-- (-1) thats because xmirror bug=
 and wrong mirrored mashes
+			--~ mirroring now baked into meshes for shader compatibility -- self.gM=
ousePickBBox:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong =
mirrored mashes
 			self.gMousePickBBox:SetNormaliseNormals(true)
 			self.gMousePickBBox:SetVisible(true)
 		end

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sat Jan  3 23:47:47 2009
@@ -629,7 +629,7 @@
 		effect.gfx =3D CreateRootGfx3D()
 		effect.gfx:SetMesh(meshname)
 		effect.gfx:SetOrientation(GetStaticMeshOrientation(effect.itemid))
-		effect.gfx:SetScale(-1,1,1)				-- (-1) thats because xmirror bug and wro=
ng mirrored meshes
+		--~ mirroring now baked into meshes for shader compatibility -- effect.g=
fx:SetScale(-1,1,1)				-- (-1) thats because xmirror bug and wrong mirrored=
 meshes
 		effect.gfx:SetNormaliseNormals(true)
 		effect.gfx:SetCastShadows(gDynamicsCastShadows)
 		-- primary color hueing

Modified: trunk/lua/lib.3d.tilebatch.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.tilebatch.lua (original)
+++ trunk/lua/lib.3d.tilebatch.lua Sat Jan  3 23:47:47 2009
@@ -183,7 +183,8 @@
 	-- create Mesh
 	if (meshname and meshname ~=3D false) then
 		local qw,qx,qy,qz =3D GetStaticMeshOrientation(iTileTypeID)
-		local sx,sy,sz =3D -1,1,1 -- scale
+		--~ mirroring now baked into meshes for shader compatibility -- local sx=
,sy,sz =3D -1,1,1 -- scale
+		local sx,sy,sz =3D 1,1,1 -- scale
 		entity.qw =3D qw
 		entity.qx =3D qx
 		entity.qy =3D qy

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Sat Jan  3 23:47:47 2009
@@ -636,7 +636,7 @@
 		if (meshname and meshname ~=3D false) then
 			gDebugRootGfx:SetMesh(meshname)
 			gDebugRootGfx:SetOrientation(GetStaticMeshOrientation(iTileType))
-			gDebugRootGfx:SetScale(-1,1,1)			-- (-1) thats because xmirror bug and =
wrong mirrored meshes
+			--~ mirroring now baked into meshes for shader compatibility -- gDebugR=
ootGfx:SetScale(-1,1,1)			-- (-1) thats because xmirror bug and wrong mirro=
red meshes
 			gDebugRootGfx:SetNormaliseNormals(true)
 			gDebugRootGfx:SetCastShadows(gDynamicsCastShadows)
 			-- primary color hueing

Modified: trunk/lua/lib.mapblock.3d.multis.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.3d.multis.lua (original)
+++ trunk/lua/lib.mapblock.3d.multis.lua Sat Jan  3 23:47:47 2009
@@ -62,9 +62,10 @@
 			local x,y,z =3D Renderer3D:UOPosToLocal(iX + xadd,iY + yadd,iZ * 0.1 + =
zadd) =

 			local qw,qx,qy,qz =3D GetStaticMeshOrientation(iTileTypeID)
 =

+			--~ mirroring now baked into meshes for shader compatibility -- mousepi=
ck.sx=3D-1
 			local mousepick =3D {
 				xadd=3Dxadd,yadd=3Dyadd,zadd=3Dzadd,qw=3Dqw,qx=3Dqx,qy=3Dqy,qz=3Dqz,
-				sx=3D-1,sy=3D1,sz=3D1,x=3Dx,y=3Dy,z=3Dz,meshbuffer=3Dmeshbuffer,
+				sx=3D1,sy=3D1,sz=3D1,x=3Dx,y=3Dy,z=3Dz,meshbuffer=3Dmeshbuffer,
 				iTileTypeID =3D iTileTypeID,
 				iHue =3D iHue,
 				iBlockX =3D math.floor(x/8), iBlockY =3D math.floor(y/8),



From no-reply at zwischenwelt.org  Sun Jan  4 01:32:22 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 00:32:22 -0000
Subject: [Iris-commit] [IRIS] r2831 - /trunk/data/models/models/to_009000/
Message-ID: <20090104003222.DD76A1C187FF@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan  4 01:32:22 2009
New Revision: 2831

Log:
added dublicates for crystal and crystal shards

Added:
    trunk/data/models/models/to_009000/mdl_008710.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008711.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008712.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008713.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008714.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008715.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008716.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008717.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008718.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008720.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008721.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008723.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008724.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008725.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008726.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008727.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008728.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008730.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008731.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008732.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008733.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008734.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008735.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008736.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008737.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008738.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008740.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008741.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008742.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008743.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008744.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008745.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008746.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008747.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008748.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008762.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008763.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008764.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008765.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008766.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008768.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008769.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008770.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008771.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008772.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008773.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008774.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008775.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008776.mesh   (with props)
    trunk/data/models/models/to_009000/mdl_008777.mesh   (with props)



From no-reply at zwischenwelt.org  Sun Jan  4 01:50:39 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 00:50:39 -0000
Subject: [Iris-commit] [IRIS] r2832 - in /trunk/data/models/models:
	to_001000/ to_010000/
Message-ID: <20090104005040.264431C18801@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan  4 01:50:35 2009
New Revision: 2832

Log:
added bark roof placeholder (copy from wooder shingles roof)

Added:
    trunk/data/models/models/to_001000/mdl_000730.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009976.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009977.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009978.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009979.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009980.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009981.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009982.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009983.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009984.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009985.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009986.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009987.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009988.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009989.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009990.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009991.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009992.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009993.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009994.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009995.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009996.mesh   (with props)



From no-reply at zwischenwelt.org  Sun Jan  4 01:55:46 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 00:55:46 -0000
Subject: [Iris-commit] [IRIS] r2833 - /trunk/data/models/models/to_012000/
Message-ID: <20090104005547.4095E1C18803@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan  4 01:55:45 2009
New Revision: 2833

Log:
added rooftile variant models (copy from set that looks the exactly the sam=
e)

Added:
    trunk/data/models/models/to_012000/mdl_011300.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011301.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011302.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011303.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011304.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011305.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011306.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011307.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011308.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011309.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011310.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011311.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011312.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011313.mesh   (with props)
    trunk/data/models/models/to_012000/mdl_011314.mesh   (with props)



From no-reply at zwischenwelt.org  Sun Jan  4 02:08:08 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 01:08:08 -0000
Subject: [Iris-commit] [IRIS] r2834 - /trunk/data/models/models/to_010000/
Message-ID: <20090104010808.CC4331C18806@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan  4 02:08:08 2009
New Revision: 2834

Log:
added hayroof placeholder, copied from  thatch roof

Added:
    trunk/data/models/models/to_010000/mdl_009946.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009947.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009948.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009949.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009950.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009951.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009952.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009953.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009954.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009955.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009956.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009957.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009958.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009959.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009960.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009961.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009962.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009963.mesh   (with props)
    trunk/data/models/models/to_010000/mdl_009964.mesh   (with props)



From no-reply at zwischenwelt.org  Sun Jan  4 11:50:25 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 10:50:25 -0000
Subject: [Iris-commit] [IRIS] r2835 - /trunk/lua/lib.static.lua
Message-ID: <20090104105025.38A631C18807@zwischenwelt.org>

Author: hagish
Date: Sun Jan  4 11:50:24 2009
New Revision: 2835

Log:
xmirror fix in fallback models

Modified:
    trunk/lua/lib.static.lua

Modified: trunk/lua/lib.static.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.static.lua (original)
+++ trunk/lua/lib.static.lua Sun Jan  4 11:50:24 2009
@@ -170,10 +170,10 @@
 		=

 		gFallbackModelCacheGfx:RenderableBegin(4,6,false,false,OT_TRIANGLE_LIST)
 		=

-		gFallbackModelCacheGfx:RenderableVertex( 0+dx,0+dy,dz, nx,ny,nz, tw,v0)
-		gFallbackModelCacheGfx:RenderableVertex( 0+dx,1+dy,dz, nx,ny,nz, u0,th)
-		gFallbackModelCacheGfx:RenderableVertex( 1+dx,0+dy,dz, nx,ny,nz, u1,th)
-		gFallbackModelCacheGfx:RenderableVertex( 1+dx,1+dy,dz, nx,ny,nz, tw,v1)
+		gFallbackModelCacheGfx:RenderableVertex( -0+dx,0+dy,dz, nx,ny,nz, tw,v0)
+		gFallbackModelCacheGfx:RenderableVertex( -0+dx,1+dy,dz, nx,ny,nz, u0,th)
+		gFallbackModelCacheGfx:RenderableVertex( -1+dx,0+dy,dz, nx,ny,nz, u1,th)
+		gFallbackModelCacheGfx:RenderableVertex( -1+dx,1+dy,dz, nx,ny,nz, tw,v1)
 		gFallbackModelCacheGfx:RenderableIndex3(0,1,2)
 		gFallbackModelCacheGfx:RenderableIndex3(1,3,2)
 		=

@@ -183,24 +183,24 @@
 		local dz =3D 0
 		local dx =3D 0
 		local dy =3D 0
-	=

+		=

 		gFallbackModelCacheGfx:RenderableBegin(4*2,6*2,false,false,OT_TRIANGLE_L=
IST)
 		=

-		local nx,ny,nz =3D calculate_triangle_normal(0+dx,0.5+dy,0+dz, 1+dx,0.5+=
dy,0+dz, 1+dx,0.5+dy,h+dz)
-		=

-		gFallbackModelCacheGfx:RenderableVertex( 0+dx,0.5+dy,0+dz, nx,ny,nz, u1,=
v1)
-		gFallbackModelCacheGfx:RenderableVertex( 1+dx,0.5+dy,0+dz, nx,ny,nz, u0,=
v1)
-		gFallbackModelCacheGfx:RenderableVertex( 1+dx,0.5+dy,h+dz, nx,ny,nz, u0,=
v0)
-		gFallbackModelCacheGfx:RenderableVertex( 0+dx,0.5+dy,h+dz, nx,ny,nz, u1,=
v0)
+		local nx,ny,nz =3D calculate_triangle_normal(-0+dx,0.5+dy,0+dz, 1+dx,0.5=
+dy,0+dz, 1+dx,0.5+dy,h+dz)
+		=

+		gFallbackModelCacheGfx:RenderableVertex( -0+dx,0.5+dy,0+dz, nx,ny,nz, u1=
,v1)
+		gFallbackModelCacheGfx:RenderableVertex( -1+dx,0.5+dy,0+dz, nx,ny,nz, u0=
,v1)
+		gFallbackModelCacheGfx:RenderableVertex( -1+dx,0.5+dy,h+dz, nx,ny,nz, u0=
,v0)
+		gFallbackModelCacheGfx:RenderableVertex( -0+dx,0.5+dy,h+dz, nx,ny,nz, u1=
,v0)
 		gFallbackModelCacheGfx:RenderableIndex3(2,1,0)
 		gFallbackModelCacheGfx:RenderableIndex3(0,3,2)
 =

-		local nx,ny,nz =3D calculate_triangle_normal(0.5+dx,0+dy,0+dz, 0.5+dx,1+=
dy,0+dz, 0.5+dx,1+dy,h+dz)
-		=

-		gFallbackModelCacheGfx:RenderableVertex( 0.5+dx,0+dy,0+dz, nx,ny,nz, u1,=
v1)
-		gFallbackModelCacheGfx:RenderableVertex( 0.5+dx,1+dy,0+dz, nx,ny,nz, u0,=
v1)
-		gFallbackModelCacheGfx:RenderableVertex( 0.5+dx,1+dy,h+dz, nx,ny,nz, u0,=
v0)
-		gFallbackModelCacheGfx:RenderableVertex( 0.5+dx,0+dy,h+dz, nx,ny,nz, u1,=
v0)
+		local nx,ny,nz =3D calculate_triangle_normal(-0.5+dx,0+dy,0+dz, 0.5+dx,1=
+dy,0+dz, 0.5+dx,1+dy,h+dz)
+		=

+		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,0+dy,0+dz, nx,ny,nz, u1=
,v1)
+		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,1+dy,0+dz, nx,ny,nz, u0=
,v1)
+		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,1+dy,h+dz, nx,ny,nz, u0=
,v0)
+		gFallbackModelCacheGfx:RenderableVertex( -0.5+dx,0+dy,h+dz, nx,ny,nz, u1=
,v0)
 		gFallbackModelCacheGfx:RenderableIndex3(4+2,4+1,4+0)
 		gFallbackModelCacheGfx:RenderableIndex3(4+0,4+3,4+2)
 =




From no-reply at zwischenwelt.org  Sun Jan  4 12:17:11 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 11:17:11 -0000
Subject: [Iris-commit] [IRIS] r2836 - in /trunk/data/models:
 models/to_004000/mdl_003293.mesh models/to_004000/mdl_003294.mesh
 textures/tex_oak_leaves.png
Message-ID: <20090104111711.8B8451C18809@zwischenwelt.org>

Author: hagish
Date: Sun Jan  4 12:17:10 2009
New Revision: 2836

Log:
improved oak leaves

Modified:
    trunk/data/models/models/to_004000/mdl_003293.mesh
    trunk/data/models/models/to_004000/mdl_003294.mesh
    trunk/data/models/textures/tex_oak_leaves.png

Modified: trunk/data/models/models/to_004000/mdl_003293.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_004000/mdl_003294.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_oak_leaves.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sun Jan  4 12:24:19 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 11:24:19 -0000
Subject: [Iris-commit] [IRIS] r2837 -
	/trunk/data/models/textures/tex_oak_leaves.png
Message-ID: <20090104112419.BA1D71C18808@zwischenwelt.org>

Author: hagish
Date: Sun Jan  4 12:24:19 2009
New Revision: 2837

Log:
improved oak leaves

Modified:
    trunk/data/models/textures/tex_oak_leaves.png

Modified: trunk/data/models/textures/tex_oak_leaves.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sun Jan  4 12:57:48 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 04 Jan 2009 11:57:48 -0000
Subject: [Iris-commit] [IRIS] r2838 - /trunk/data/models/textures/
Message-ID: <20090104115748.DFF8A1C1866B@zwischenwelt.org>

Author: hagish
Date: Sun Jan  4 12:57:44 2009
New Revision: 2838

Log:
removed white transparency edges

Modified:
    trunk/data/models/textures/tex_104.png
    trunk/data/models/textures/tex_105.png
    trunk/data/models/textures/tex_106.png
    trunk/data/models/textures/tex_112.png
    trunk/data/models/textures/tex_116.png
    trunk/data/models/textures/tex_175.png
    trunk/data/models/textures/tex_182.png
    trunk/data/models/textures/tex_261.png
    trunk/data/models/textures/tex_262.png
    trunk/data/models/textures/tex_263.png
    trunk/data/models/textures/tex_264.png
    trunk/data/models/textures/tex_265.png
    trunk/data/models/textures/tex_285.png
    trunk/data/models/textures/tex_288.png
    trunk/data/models/textures/tex_301.png
    trunk/data/models/textures/tex_302.png
    trunk/data/models/textures/tex_356.png
    trunk/data/models/textures/tex_357.png
    trunk/data/models/textures/tex_358.png
    trunk/data/models/textures/tex_359.png
    trunk/data/models/textures/tex_360.png
    trunk/data/models/textures/tex_361.png
    trunk/data/models/textures/tex_362.png
    trunk/data/models/textures/tex_363.png
    trunk/data/models/textures/tex_364.png
    trunk/data/models/textures/tex_365.png
    trunk/data/models/textures/tex_417.png
    trunk/data/models/textures/tex_418.png
    trunk/data/models/textures/tex_419.png
    trunk/data/models/textures/tex_420.png
    trunk/data/models/textures/tex_426.png
    trunk/data/models/textures/tex_49.png
    trunk/data/models/textures/tex_5.png
    trunk/data/models/textures/tex_52.png
    trunk/data/models/textures/tex_53.png
    trunk/data/models/textures/tex_59.png
    trunk/data/models/textures/tex_67.png
    trunk/data/models/textures/tex_68.png
    trunk/data/models/textures/tex_72.png
    trunk/data/models/textures/tex_75.png
    trunk/data/models/textures/tex_76.png
    trunk/data/models/textures/tex_77.png
    trunk/data/models/textures/tex_82.png
    trunk/data/models/textures/tex_83.png
    trunk/data/models/textures/tex_84.png
    trunk/data/models/textures/tex_85.png
    trunk/data/models/textures/tex_90.png
    trunk/data/models/textures/tex_93.png
    trunk/data/models/textures/tex_94.png
    trunk/data/models/textures/tex_95.png
    trunk/data/models/textures/tex_96.png
    trunk/data/models/textures/tex_97.png
    trunk/data/models/textures/tex_98.png

Modified: trunk/data/models/textures/tex_104.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_105.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_106.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_112.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_116.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_175.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_182.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_261.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_262.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_263.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_264.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_265.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_285.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_288.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_301.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_302.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_356.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_357.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_358.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_359.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_360.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_361.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_362.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_363.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_364.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_365.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_417.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_418.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_419.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_420.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_426.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_49.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_5.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_52.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_53.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_59.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_67.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_68.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_72.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_75.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_76.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_77.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_82.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_83.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_84.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_85.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_90.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_93.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_94.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_95.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_96.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_97.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_98.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Mon Jan  5 17:04:49 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 05 Jan 2009 16:04:49 -0000
Subject: [Iris-commit] [IRIS] r2839 - in /trunk: data/models/materials/
 data/models/models/to_001000/ data/models/programs/ data/models/textures/
 lua/
Message-ID: <20090105160449.775501C1866B@zwischenwelt.org>

Author: ghoulsblade
Date: Mon Jan  5 17:04:48 2009
New Revision: 2839

Log:
first parallax experiment working

Added:
    trunk/data/models/materials/OffsetMapping.material
    trunk/data/models/materials/README
    trunk/data/models/programs/
    trunk/data/models/programs/AmbientOneTexture.glsl
    trunk/data/models/programs/Common.cg
    trunk/data/models/programs/Example_Basic.cg
    trunk/data/models/programs/Examples.program
    trunk/data/models/programs/OffsetMapping.cg
    trunk/data/models/programs/OffsetMapping.hlsl
    trunk/data/models/programs/OffsetMappingFp.glsl
    trunk/data/models/programs/OffsetMappingVp.glsl
    trunk/data/models/programs/OffsetMapping_specular.asm
    trunk/data/models/programs/README
    trunk/data/models/programs/knot.mesh   (with props)
    trunk/data/models/textures/rockwall.tga   (with props)
    trunk/data/models/textures/rockwall_NH.tga   (with props)
Modified:
    trunk/data/models/models/to_001000/mdl_000578.mesh
    trunk/lua/lib.debugmenu.lua
    trunk/lua/main.lua

Modified: trunk/data/models/models/to_001000/mdl_000578.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Mon Jan  5 17:04:48 2009
@@ -625,24 +625,38 @@
 	local xadd,yadd,zadd =3D 0,0,0
 	-- static =

 	if (gCurDebugMode =3D=3D kDebugMode_Static) then
-		local iTileType =3D gDebugMenuModelIndex
+		Client_SetAmbientLight(0,0,0,0)
+		Client_ClearLights()
+		Client_AddPointLight(0,0,0)
+		=

+		local iTileType =3D tonumber(gDebugMenuModelIndex)
 		local iHue =3D gDebugMenuAnimIndex
 		local info =3D GetStaticTileType(iTileType)
 		local meshname =3D GetMeshName(iTileType)
+		--~ if (iTileType =3D=3D 578) then meshname =3D "knot.mesh" end
+		local submeshcount =3D GetMeshSubMeshCount(meshname)
+		print("mesh for tiletype=3D",iTileType,sprintf("0x%04x",iTileType)," sub=
meshcount=3D",submeshcount)
+		for i =3D 0,submeshcount-1 do =

+			print("submesh mat",i,GetMeshSubMaterial(meshname,i),iTileType)
+			if (iTileType =3D=3D 578) then SetMeshSubMaterial(meshname,i,"Examples/=
OffsetMapping/Specular") end
+			--~ if (iTileType =3D=3D 578) then SetMeshSubMaterial(meshname,i,"Examp=
les/OffsetMapping/IntegratedShadows") end
+		end
+		MeshBuildTangentVectors(meshname)
+		=

 		if gDebugLastMeshName then ReloadMesh(gDebugLastMeshName) end
 		gDebugLastMeshName =3D meshname
 		local tricount =3D meshname and CountMeshTriangles(meshname) or 0
 		GuiAddChatLine(sprintf("static %04x(=3D%d) hue=3D%d tricount=3D%d %s",iT=
ileType,iTileType,iHue,tricount,GetStaticTileTypeName(iTileType) or ""))
 		if (meshname and meshname ~=3D false) then
 			gDebugRootGfx:SetMesh(meshname)
-			gDebugRootGfx:SetOrientation(GetStaticMeshOrientation(iTileType))
+			--~ gDebugRootGfx:SetOrientation(GetStaticMeshOrientation(iTileType))
 			--~ mirroring now baked into meshes for shader compatibility -- gDebugR=
ootGfx:SetScale(-1,1,1)			-- (-1) thats because xmirror bug and wrong mirro=
red meshes
-			gDebugRootGfx:SetNormaliseNormals(true)
-			gDebugRootGfx:SetCastShadows(gDynamicsCastShadows)
+			--~ gDebugRootGfx:SetNormaliseNormals(true)
+			--~ gDebugRootGfx:SetCastShadows(gDynamicsCastShadows)
 			-- primary color hueing
 			if gHueLoader and iHue > 0 then
 				local r,g,b =3D gHueLoader:GetColor(iHue - 1,31) -- get first color
-				HueMeshEntity(gDebugRootGfx,r,g,b,r,g,b)
+				--~ HueMeshEntity(gDebugRootGfx,r,g,b,r,g,b)
 			end
 			-- position adjustment for statics and dynamics
 			xadd,yadd,zadd =3D FilterPositionXYZ(iTileType)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Mon Jan  5 17:04:48 2009
@@ -220,6 +220,7 @@
 	for i=3D1,20 do OgreAddResLoc(mydatapath.."models/models/"..sprintf("to_%=
03d000",i)	,"FileSystem","General") end
 	OgreAddResLoc(mydatapath.."models/textures/"			,"FileSystem","General")
 	OgreAddResLoc(mydatapath.."models/atlas"				,"FileSystem","General")
+	OgreAddResLoc(mydatapath.."models/programs"				,"FileSystem","General")
 =

 	--~ # custom models
 	OgreAddResLoc(mydatapath.."custom/models"				,"FileSystem","General")



From no-reply at zwischenwelt.org  Mon Jan  5 18:08:04 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 05 Jan 2009 17:08:04 -0000
Subject: [Iris-commit] [IRIS] r2840 - in /trunk/lua: lib.3d.cam.lua
	lib.debugmenu.lua
Message-ID: <20090105170804.9EFA11C187FD@zwischenwelt.org>

Author: ghoulsblade
Date: Mon Jan  5 18:08:04 2009
New Revision: 2840

Log:
screenshot key for debugmode, cam zoom limits increased a bit, debugmode ca=
m pos moved a bit, debug mode lights moved a bit

Modified:
    trunk/lua/lib.3d.cam.lua
    trunk/lua/lib.debugmenu.lua

Modified: trunk/lua/lib.3d.cam.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.cam.lua (original)
+++ trunk/lua/lib.3d.cam.lua Mon Jan  5 18:08:04 2009
@@ -143,8 +143,8 @@
 	if (add > 0) then factor =3D base end
 	if (add < 0) then factor =3D 1.0 / base end
 	=

-	gMinZoom =3D gMinZoom or 3
-	gMaxZoom =3D gMaxZoom or 20
+	gMinZoom =3D gMinZoom or 1
+	gMaxZoom =3D gMaxZoom or 40
 	local factor =3D math.max(gMinZoom,math.min(gMaxZoom,self.gThirdPersonDis=
t * factor)) / self.gThirdPersonDist =

 	self.gThirdPersonDist =3D self.gThirdPersonDist * factor
 	self.gCamLookAheadDist =3D self.gCamLookAheadDist * factor

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Mon Jan  5 18:08:04 2009
@@ -627,7 +627,14 @@
 	if (gCurDebugMode =3D=3D kDebugMode_Static) then
 		Client_SetAmbientLight(0,0,0,0)
 		Client_ClearLights()
-		Client_AddPointLight(0,0,0)
+		--~ Client_AddPointLight(2.1836402416229      ,  -0.50490587949753    , =
  1.208433508873)
+		--~ Client_AddPointLight(0				      ,  -7.2237491607666     ,   -20)
+		--~ Client_AddPointLight(7.8641700744629      ,  -7.2237491607666     , =
  -20)
+		Client_AddPointLight(7.8641700744629      ,  -7.2237491607666     ,   -5)
+		--~ Client_AddPointLight(10,0,0)
+		--~ Client_AddPointLight(-10,10,0)
+		--~ Client_AddPointLight(-10,-10,0)
+		gTileFreeWalk:SetPos_ClientSide(-1,1,0)
 		=

 		local iTileType =3D tonumber(gDebugMenuModelIndex)
 		local iHue =3D gDebugMenuAnimIndex
@@ -836,6 +843,9 @@
 	ClearAllMacros()
 =

 	BindDown("escape",	function () Terminate() end)
+	=

+	BindDown("v",		function() MacroCmd_Screenshot() end)
+	BindDown("x",		function() print("campos:",GetMainCam():GetPos()) end)
 	Bind("wheeldown",	function (state) if (not gActiveEditText) then if (stat=
e > 0) then gCurrentRenderer:CamChangeZoom( 0.3) end end end)
 	Bind("wheelup",		function (state) if (not gActiveEditText) then if (state=
 > 0) then gCurrentRenderer:CamChangeZoom(-0.3) end end end)
 	Bind("f10",		function (state) if (not gActiveEditText) then if (state > 0=
 and gCurDebugMode =3D=3D kDebugMode_Static) then =




From no-reply at zwischenwelt.org  Tue Jan  6 22:43:55 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 06 Jan 2009 21:43:55 -0000
Subject: [Iris-commit] [IRIS] r2841 - /trunk/bin/iris2.exe
Message-ID: <20090106214355.15BDB1C187FD@zwischenwelt.org>

Author: sience
Date: Tue Jan  6 22:43:54 2009
New Revision: 2841

Log:
-new win32 binary

Modified:
    trunk/bin/iris2.exe

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Wed Jan  7 12:07:12 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 07 Jan 2009 11:07:12 -0000
Subject: [Iris-commit] [IRIS] r2842 - /trunk/scripts/ogre16_shadow.patch
Message-ID: <20090107110712.C63301C187FD@zwischenwelt.org>

Author: hagish
Date: Wed Jan  7 12:07:12 2009
New Revision: 2842

Log:
patch: ogre waggy shadows

Added:
    trunk/scripts/ogre16_shadow.patch



From no-reply at zwischenwelt.org  Wed Jan  7 18:57:36 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 07 Jan 2009 17:57:36 -0000
Subject: [Iris-commit] [IRIS] r2843 - in /trunk: lua/lib.2d.renderer.lua
 lua/lib.charcreate.lua lua/lib.macrolist.lua lua/lib.net.lua
 lua/lib.protocol.lua lua/main.lua lua/net/net.mobile.lua
 lua/net/net.text.lua plugins/itemcounter.lua plugins/lib.spellbar.lua
Message-ID: <20090107175736.C595B1C18807@zwischenwelt.org>

Author: ghoulsblade
Date: Wed Jan  7 18:57:35 2009
New Revision: 2843

Log:
profiling code (disabled by default, gEnableProfiler_.. to activate) =


Modified:
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.charcreate.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/lib.net.lua
    trunk/lua/lib.protocol.lua
    trunk/lua/main.lua
    trunk/lua/net/net.mobile.lua
    trunk/lua/net/net.text.lua
    trunk/plugins/itemcounter.lua
    trunk/plugins/lib.spellbar.lua

Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Wed Jan  7 18:57:35 2009
@@ -84,21 +84,29 @@
 	return DirWrap( floor(1.5+math.atan2(my-cy,mx-cx) * 8 / (2*kPi)) ),dist2(=
mx,my,cx,cy)
 end
 =

+gProfiler_R2D_MainStep =3D CreateRoughProfiler("MainStep")
+
 -- called from mainstep while ingame
 function Renderer2D:MainStep ()
+	gProfiler_R2D_MainStep:Start(gEnableProfiler_R2D_MainStep)
+	gProfiler_R2D_MainStep:Section("CamStep")
 	self:CamStep()
+	gProfiler_R2D_MainStep:Section("MobileAnimStep")
 	self:MobileAnimStep()
 	=

+	gProfiler_R2D_MainStep:Section("walk")
 	local uodir,pixeldist =3D Get2DMouseDirAndDist()
 	=

 	local xloc,yloc,zloc =3D GetPlayerPos()
 	local bOfflineMode =3D xloc =3D=3D nil
+	local bMousePickBlockedByWalk =3D false
 	if (not bOfflineMode) then
 		if (gKeyPressed[key_mouse_right] and (not gLastMouseDownWidget)) then =

 			local bRunFlag =3D pixeldist > 200
 			if (gAlwaysRun) then bRunFlag =3D true end
 			--~ print("Get2DMouseDirAndDist",uodir,pixeldist)
 			WalkStep_WalkInDir(uodir,bRunFlag,true)
+			bMousePickBlockedByWalk =3D true
 		end
 		=

 		=

@@ -117,8 +125,11 @@
 		]]--
 	end
 	=

+	gProfiler_R2D_MainStep:Section("MobileStep")
 	-- TODO : self:CombatGuiStep() ?
 	self:MobileStep() -- bevore cam pos so cam is exactly on player
+	=

+	gProfiler_R2D_MainStep:Section("SetCamPos")
 	local xloc,yloc,zloc =3D GetPlayerPos()
 	if (xloc and (not g2DCamMove)) then =

 		self:SetCamPos(self:GetExactMobilePos(GetPlayerMobile())) -- after Mobil=
eStep so cam is exactly on player
@@ -136,11 +147,13 @@
 		if (dx ~=3D 0 or dy ~=3D 0) then self:SetCamPos(xloc+dx,yloc+dy) end
 	end
 =

-	self:EffectAnimStep() -- should be after player pos is updated, for effec=
ts moving with player
-	self:MapStep()
-	self:HUDFX_MainStep()
-	self:Dynamics_MainStep()
-	self:MousePickStep()
+	=

+	gProfiler_R2D_MainStep:Section("EffectAnimStep")		self:EffectAnimStep() -=
- should be after player pos is updated, for effects moving with player
+	gProfiler_R2D_MainStep:Section("MapStep")				self:MapStep()
+	gProfiler_R2D_MainStep:Section("HUDFX_MainStep")		self:HUDFX_MainStep()
+	gProfiler_R2D_MainStep:Section("Dynamics_MainStep")		self:Dynamics_MainSt=
ep()
+	gProfiler_R2D_MainStep:Section("MousePickStep",true)	if (not bMousePickBl=
ockedByWalk) then self:MousePickStep() end
+	gProfiler_R2D_MainStep:End()
 end
 =

 function Renderer2D:CamKeyDown						(key) end

Modified: trunk/lua/lib.charcreate.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.charcreate.lua (original)
+++ trunk/lua/lib.charcreate.lua Wed Jan  7 18:57:35 2009
@@ -77,7 +77,7 @@
 	chardata.hairColor		=3D hex2num("0x044E") -- 0x044E(human) 0x0034(elf)
 	chardata.facialHair		=3D hex2num("0x0000")
 	chardata.facialHairColor=3D hex2num("0x0000")
-	chardata.location		=3D hex2num("0x0000") -- uogamers: 0=3Dyew,1=3Dminoc,2=
=3Dbrit,3=3Dmoonglow,4=3Dtrinsik,5=3DMagincia,6=3Djhelom,7=3D
+	chardata.location		=3D hex2num("0x0000") -- uogamers: 0=3Dyew,1=3Dminoc,2=
=3Dbrit,3=3Dmoonglow,4=3Dtrinsik,5=3DMagincia,6=3Djhelom,7=3Dscara,8=3D
 	chardata.slot			=3D hex2num("0x0003")
 	chardata.shirtColor		=3D hex2num("0x036F") --hex2num("0x0083")
 	chardata.pantsColor		=3D hex2num("0x0111") --hex2num("0x01AC")

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Wed Jan  7 18:57:35 2009
@@ -37,6 +37,8 @@
 function GetPlayerStamMax() return GetMobileStat(GetPlayerMobile(),"maxSta=
mina") end =

 function GetPlayerHitsCur() return GetMobileStat(GetPlayerMobile(),"curHit=
s") end =

 function GetPlayerHitsMax() return GetMobileStat(GetPlayerMobile(),"maxHit=
s") end =

+
+function GetMobileRelHP(serial) local mobile =3D GetMobile(serial) return =
mobile and mobile:GetRelHP() end =

 =

 function MacroCmd_MiniHealCureSelf () =

 	local mobile =3D GetPlayerMobile()

Modified: trunk/lua/lib.net.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.net.lua (original)
+++ trunk/lua/lib.net.lua Wed Jan  7 18:57:35 2009
@@ -97,5 +97,4 @@
 function NetStep ()
 	NetTrafficStep()
 	--if (gRecvFifo:Size() > 0) then print("NetStep ",gRecvFifo:Size()) end
-	HandlePackets()
 end

Modified: trunk/lua/lib.protocol.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.protocol.lua (original)
+++ trunk/lua/lib.protocol.lua Wed Jan  7 18:57:35 2009
@@ -47,7 +47,7 @@
 	if (not gNoLogPackets_ByPacket) then gNoLogPackets_ByPacket =3D {} for k,=
v in pairs(gNoLogPackets) do gNoLogPackets_ByPacket[v] =3D true end end
 	local input =3D GetRecvFIFO()
 	=

-	local profile =3D MakeProfiler("HandlePackets",nil,true)
+	local profile =3D gEnableProfiler_Packets and MakeProfiler("HandlePackets=
",nil,true)
 	=

 	while (input:Size() >=3D 1) do
 		local iId =3D input:PeekNetUint8(0)
@@ -70,11 +70,11 @@
 			--~ Crash()
 		end
 		=

-		profile:StartSection(gPacketTypeId2Name[iId])
+		if (profile) then profile:StartSection(gPacketTypeId2Name[iId]) end
 		HandlePacket(input,iId,iPacketSize)
 	end
 	=

-	profile:FinishAndPrintSectionIfOver(100,300*1024,300*1024)
+	if (profile) then profile:FinishAndPrintSectionIfOverDefault() end
 end
 =

 function HandlePacket (input,iId,iPacketSize)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Wed Jan  7 18:57:35 2009
@@ -415,6 +415,7 @@
 	end
 =

 	-- mainloop
+	if (gEnableGlobalProfiler) then StartGlobalProfiler2() end
 	while (Client_IsAlive()) do =

 		MainStep() =

 	end
@@ -457,44 +458,75 @@
 	NotifyListener("Hook_StartInGame")
 end
 =

+
+gProfiler_MainStep =3D CreateRoughProfiler("MainStep")
+
 -- called every frame, after all timer-steppers, see Step() in lib.time.lua
 function MainStep ()
+	gProfiler_MainStep:Start(gEnableProfiler_MainStep)
+	gProfiler_MainStep:Section("LugreStep")
+		=

 	gViewportW,gViewportH =3D GetViewportSize()
 	LugreStep()
 	=

+	gProfiler_MainStep:Section("Hook_MainStep")
+	=

 	NotifyListener("Hook_MainStep") -- should called before physstep, so obje=
ct position changes affect the gfx correctly
 	=

+	gProfiler_MainStep:Section("NetStep")
 	NetStep()
+	gProfiler_MainStep:Section("HandlePackets",true) -- anaylsed inside
+	HandlePackets()
+	=

+	gProfiler_MainStep:Section("SoundStep")
 	SoundStep()
 =

+	gProfiler_MainStep:Section("InputStep")
 	InputStep() -- generate mouse_left_drag_* and mouse_left_click_single eve=
nts =

+	gProfiler_MainStep:Section("GUIStep")
 	GUIStep() -- generate mouse_enter, mouse_leave events (might adjust curso=
r -> before CursorStep)
+	gProfiler_MainStep:Section("ToolTipStep")
 	ToolTipStep() -- needs mouse_enter, should be after GUIStep
+	gProfiler_MainStep:Section("CursorStep")
 	CursorStep()
 =

+	gProfiler_MainStep:Section("StepDebugMenu")
 	StepDebugMenu()
 =

 	if (gInGameStarted) then
+		gProfiler_MainStep:Section("StepUODragDrop")
 		StepUODragDrop()
+		gProfiler_MainStep:Section("UpdateCompass")
 		UpdateCompass()
+		gProfiler_MainStep:Section("DisplayMemoryUsage")
 		if (not gNoOgre) then DisplayMemoryUsage(OgreMemoryUsage("all")) end
+		gProfiler_MainStep:Section("DisplayLoadingState")
 		DisplayLoadingState()
+		gProfiler_MainStep:Section("PingStep")
 		PingStep()
+		gProfiler_MainStep:Section("gCurrentRenderer:MainStep",true)
 		gCurrentRenderer:MainStep()
 	else
 		StepMainMenu()
 	end
 	=

+	gProfiler_MainStep:Section("SetToolTipSubject")
 	local gObjectUnderMouse =3D nil -- todo : mousepick every frame ?
 	SetToolTipSubject(GetWidgetUnderMouse() or gObjectUnderMouse)
 	=

+	gProfiler_MainStep:Section("Hook_HUDStep")
 	NotifyListener("Hook_HUDStep") -- updates special hud elements dependant =
on object positions that don't have auto-tracking
 	=

+	gProfiler_MainStep:Section("EveryFrame")
 	NotifyListener("EveryFrame")
 	=

+	gProfiler_MainStep:Section("Hook_PreRenderOneFrame")
 	NotifyListener("Hook_PreRenderOneFrame")
+	=

+	gProfiler_MainStep:End()
 =

 	Client_RenderOneFrame()
+	=

 	=

 	if (gMaxFPS) then =

 		local t =3D Client_GetTicks()

Modified: trunk/lua/net/net.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.mobile.lua (original)
+++ trunk/lua/net/net.mobile.lua Wed Jan  7 18:57:35 2009
@@ -16,7 +16,7 @@
 	=

 	local xloc,yloc =3D GetPlayerPos()
 	local dist =3D dist2max(xloc,yloc,mobiledata.xloc,mobiledata.yloc)
-	if (dist > gUpdateRange_MobileDestroy) then print("kPacket_Naked_MOB : di=
st >=3D ",dist) end
+	--~ if (dist > gUpdateRange_MobileDestroy) then print("kPacket_Naked_MOB =
: dist >=3D ",dist) end
 	=

 	if (mobiledata.serial =3D=3D 0x001b5369) then
 		printdebug("corpse","CORPSECODE kPacket_Naked_MOB",mobiledata.artid,mobi=
ledata.flag,mobiledata.notoriety)

Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Wed Jan  7 18:57:35 2009
@@ -180,6 +180,7 @@
 		end
 	end
 	=

+	if show_journal or show_below then print("HandleUOText",plaintext,data.cl=
ilocid) end
 	if show_journal then
 		JournalAddText(data.name,plaintext)
 	end

Modified: trunk/plugins/itemcounter.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/itemcounter.lua (original)
+++ trunk/plugins/itemcounter.lua Wed Jan  7 18:57:35 2009
@@ -32,6 +32,8 @@
 		{name=3D"gcure"		,artid=3D3847},
 		{name=3D"refresh"		,artid=3D3851},
 		{name=3D"explo"		,artid=3D3853},
+		{name=3D"dexpot"		,artid=3D0xF08},
+		{name=3D"strpot"		,artid=3D0xF09},
 	},
 	{ -- crafter
 		{name=3D"cloth"			,artid=3D0x1766},

Modified: trunk/plugins/lib.spellbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/lib.spellbar.lua (original)
+++ trunk/plugins/lib.spellbar.lua Wed Jan  7 18:57:35 2009
@@ -200,7 +200,7 @@
 gSpellbarShortMessages[1060757] =3D {r=3D1.0,g=3D0.0,b=3D0.0,txt=3D"bleeds=
tart" 		} -- You are bleeding profusely  (serial=3Dself=3D899675)
 gSpellbarShortMessages[1060167] =3D {r=3D0.0,g=3D0.5,b=3D0.0,txt=3D"bleeds=
top" 		} -- The bleeding wounds have healed, you are no longer bleeding!
 gSpellbarShortMessages[1042809] =3D {r=3D1,g=3D0.5,b=3D0.0,txt=3D"EscortDo=
ne"			} -- We have arrived! I thank thee, CHARNAME! I have no further need =
of thy services. Here is thy pay.
-
+gSpellbarShortMessages[500969] =3D {r=3D0,g=3D1,b=3D0.0,txt=3D"BandaDone"	=
			} -- You finish applying the bandages.
 =

 =

 --[[



From no-reply at zwischenwelt.org  Thu Jan  8 03:12:28 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Thu, 08 Jan 2009 02:12:28 -0000
Subject: [Iris-commit] [IRIS] r2845 - in /trunk/lua: lib.2d.renderer.lua
	lib.3d.renderer.lua
Message-ID: <20090108021228.3B3461C187FD@zwischenwelt.org>

Author: ghoulsblade
Date: Thu Jan  8 03:12:27 2009
New Revision: 2845

Log:
added 3d renderer profiler sections, not for map subjobs yet

Modified:
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Thu Jan  8 03:12:27 2009
@@ -84,7 +84,7 @@
 	return DirWrap( floor(1.5+math.atan2(my-cy,mx-cx) * 8 / (2*kPi)) ),dist2(=
mx,my,cx,cy)
 end
 =

-gProfiler_R2D_MainStep =3D CreateRoughProfiler("MainStep")
+gProfiler_R2D_MainStep =3D CreateRoughProfiler("2D:MainStep")
 =

 -- called from mainstep while ingame
 function Renderer2D:MainStep ()

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Thu Jan  8 03:12:27 2009
@@ -116,12 +116,16 @@
 	gTileFreeWalk:SetPos_All(self:LocalToUOPos(x+0.5,y+0.5,z)) -- + for both =
might be wrong..
 end
 =

+gProfiler_R3D_MainStep =3D CreateRoughProfiler("3D:MainStep")
+
 function Renderer3D:MainStep	()
-	self:CombatGuiStep()
-	self:MobileAnimStep()
-	self:CamStep()
+	gProfiler_R3D_MainStep:Start(gEnableProfiler_R3D_MainStep)
+	=

+	gProfiler_R3D_MainStep:Section("CombatGuiStep")		self:CombatGuiStep()
+	gProfiler_R3D_MainStep:Section("MobileAnimStep")	self:MobileAnimStep()
+	gProfiler_R3D_MainStep:Section("CamStep")			self:CamStep()
 	--~ self:UpdateMap()
-	self:MousePickStep()
+	gProfiler_R3D_MainStep:Section("MousePickStep")		self:MousePickStep()
 	=

 	-- b&w effect on death
 	local playermobile =3D GetPlayerMobile()
@@ -143,8 +147,11 @@
 		end
 	end
 =

-	self:MapStep()
-	self:UpdateLight()
+	=

+		=

+	gProfiler_R3D_MainStep:Section("MapStep")		self:MapStep()
+	gProfiler_R3D_MainStep:Section("UpdateLight")	self:UpdateLight()
+	gProfiler_R3D_MainStep:End()
 end
 =

 function Renderer3D:SetLastConfirmedUOPos(xloc,yloc,zloc) gTileFreeWalk:Im=
pl_SetLastConfirmedUOPos(xloc,yloc,zloc) end -- walk



From no-reply at zwischenwelt.org  Thu Jan  8 02:34:33 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Thu, 08 Jan 2009 01:34:33 -0000
Subject: [Iris-commit] [IRIS] r2844 - in /trunk/lua: gui/gui.helper.lua
	main.lua
Message-ID: <20090108013433.B6BE91C18807@zwischenwelt.org>

Author: ghoulsblade
Date: Thu Jan  8 02:34:33 2009
New Revision: 2844

Log:
cpu % display in topbar

Modified:
    trunk/lua/gui/gui.helper.lua
    trunk/lua/main.lua

Modified: trunk/lua/gui/gui.helper.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.helper.lua (original)
+++ trunk/lua/gui/gui.helper.lua Thu Jan  8 02:34:33 2009
@@ -88,10 +88,11 @@
 			end
 		end
 					=

-		local text =3D sprintf("%5.1ffps %dt %db gfx | OGRE:%s | LUA:%s | %i j %=
i/%i l",
+		local text =3D sprintf("%5.1ffps %dt %db gfx | OGRE:%s | LUA:%s | cpu/(c=
pu+gpu):%d%% | %i j %i/%i l",
 			fps, t, b, =

 			DisplayMemoryUsageFormatHelper(memoryusage),
 			DisplayMemoryUsageFormatHelper(mem_dyn), =

+			floor((gFrameTimeCPUFraction or 0)*100),
 			j, l, lu   -- #"job.create()-jobs"    blockloader: working/killme
 		)
 		if (not gMemoryUsageField) then

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Thu Jan  8 02:34:33 2009
@@ -463,6 +463,7 @@
 =

 -- called every frame, after all timer-steppers, see Step() in lib.time.lua
 function MainStep ()
+	local t_cpu_start =3D Client_GetTicks()
 	gProfiler_MainStep:Start(gEnableProfiler_MainStep)
 	gProfiler_MainStep:Section("LugreStep")
 		=

@@ -525,7 +526,12 @@
 	=

 	gProfiler_MainStep:End()
 =

+	local t_gpu_start =3D Client_GetTicks()
 	Client_RenderOneFrame()
+	local t_gpu_end =3D Client_GetTicks()
+	local dt_cpu =3D t_cpu_start - t_gpu_start
+	local dt_gpu =3D t_gpu_start - t_gpu_end
+	gFrameTimeCPUFraction =3D dt_cpu / ( dt_cpu + dt_gpu )
 	=

 	=

 	if (gMaxFPS) then =




From no-reply at zwischenwelt.org  Fri Jan  9 17:32:25 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 09 Jan 2009 16:32:25 -0000
Subject: [Iris-commit] [IRIS] r2846 - in /trunk/lua: lib.3d.mousepick.lua
	main.lua
Message-ID: <20090109163225.B9D7C1C1880A@zwischenwelt.org>

Author: ghoulsblade
Date: Fri Jan  9 17:32:24 2009
New Revision: 2846

Log:
3d mode dynamic mousepicking bug fixed (xmirror now baked into models),  pr=
ofiling output improved

Modified:
    trunk/lua/lib.3d.mousepick.lua
    trunk/lua/main.lua

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Fri Jan  9 17:32:24 2009
@@ -283,7 +283,7 @@
 						local qw,qx,qy,qz =3D GetStaticMeshOrientation(dynamic.artid)
 						=

 						bHit,fHitDist =3D dynamic.meshbuffer:RayPick(rx,ry,rz,rvx,rvy,rvz,
-							x,y,z, qw,qx,qy,qz, -1,1,1)
+							x,y,z, qw,qx,qy,qz, 1,1,1)  -- 1,1,1 =3D scaling (xmirror removed a=
s it is baked to the models now)
 				elseif ( dynamic.gfx ) then
 					bHit,fHitDist =3D dynamic.gfx:RayPick(rx,ry,rz,rvx,rvy,rvz)
 				else

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Fri Jan  9 17:32:24 2009
@@ -415,12 +415,41 @@
 	end
 =

 	-- mainloop
-	if (gEnableGlobalProfiler) then StartGlobalProfiler2() end
+	if (gEnableGlobalProfiler) then StartGlobalProfiler2() end -- old and too=
 slow, don't use
+	gMyProfilerTopTenInterval =3D 1000*30
+	RegisterIntervalStepper(gMyProfilerTopTenInterval,MyProfilerTop)
 	while (Client_IsAlive()) do =

 		MainStep() =

 	end
 	NotifyListener("Hook_Terminate")
 	gRegistry:Destroy() gRegistry =3D nil
+end
+
+
+gMyProfilerTopCPUTSum =3D 0
+gMyProfilerTopGPUTSum =3D 0
+function MyProfilerTop ()
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop =3D=3D=3D")
+	if (not gEnableRoughProfileSum) then return end
+	local arr =3D {}
+	for k,profiler in pairs({gProfiler_MainStep,gProfiler_R2D_MainStep,gProfi=
ler_R3D_MainStep}) do
+		for secname,tsum in pairs(profiler.sum) do table.insert(arr,{name=3Dprof=
iler.name..":"..secname,tsum=3Dtsum}) end
+		profiler.sum =3D {}
+	end =

+	table.sort(arr,function (a,b) return a.tsum > b.tsum end)
+	local totaltsum =3D 0
+	for k,o in pairs(arr) do =

+		if (k <=3D 5) then print(" #"..k,sprintf("%5dmsec (%3d%%)",o.tsum,floor(=
100*o.tsum/gMyProfilerTopCPUTSum)),o.name) end
+		totaltsum =3D totaltsum + o.tsum
+	end
+	print(sprintf(" total time=3D%dsec cpu=3D%d%% gpu=3D%d%% idle/maxfpswait=
=3D%d%%"	=

+															,	floor(gMyProfilerTopTenInterval/1000)
+															,	floor(100*gMyProfilerTopCPUTSum/gMyProfilerTopTenInterval)
+															,	floor(100*gMyProfilerTopGPUTSum/gMyProfilerTopTenInterval)
+															,	floor(100*(gMyProfilerTopTenInterval-(gMyProfilerTopCPUTS=
um+gMyProfilerTopGPUTSum))/gMyProfilerTopTenInterval)
+															))
+	gMyProfilerTopCPUTSum =3D 0
+	gMyProfilerTopGPUTSum =3D 0
 end
 =

 =

@@ -526,11 +555,19 @@
 	=

 	gProfiler_MainStep:End()
 =

+	=

+	=

 	local t_gpu_start =3D Client_GetTicks()
+	=

+	=

 	Client_RenderOneFrame()
+	=

+	=

 	local t_gpu_end =3D Client_GetTicks()
-	local dt_cpu =3D t_cpu_start - t_gpu_start
-	local dt_gpu =3D t_gpu_start - t_gpu_end
+	local dt_cpu =3D t_gpu_start - t_cpu_start
+	local dt_gpu =3D t_gpu_end   - t_gpu_start
+	gMyProfilerTopCPUTSum =3D gMyProfilerTopCPUTSum + dt_cpu
+	gMyProfilerTopGPUTSum =3D gMyProfilerTopGPUTSum + dt_gpu
 	gFrameTimeCPUFraction =3D dt_cpu / ( dt_cpu + dt_gpu )
 	=

 	=




From no-reply at zwischenwelt.org  Fri Jan  9 22:52:50 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 09 Jan 2009 21:52:50 -0000
Subject: [Iris-commit] [IRIS] r2847 - in /trunk: lua/config_declarations.lua
 lua/lib.3d.mobile.lua lua/lib.3d.renderer.lua lua/lib.mousepick.lua
 lua/net/net.other.lua plugins/itemcounter.lua plugins/moblist.lua
Message-ID: <20090109215251.612EE1C18807@zwischenwelt.org>

Author: hagish
Date: Fri Jan  9 22:52:49 2009
New Revision: 2847

Log:
*removed some debug output
*itemcounter plugin allows item usage on doubleclick
*attack command triggers target selection in moblist
*config option added to load uo granny textures as dds (you need to convert=
 them manually)

Modified:
    trunk/lua/config_declarations.lua
    trunk/lua/lib.3d.mobile.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.mousepick.lua
    trunk/lua/net/net.other.lua
    trunk/plugins/itemcounter.lua
    trunk/plugins/moblist.lua

Modified: trunk/lua/config_declarations.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/config_declarations.lua (original)
+++ trunk/lua/config_declarations.lua Fri Jan  9 22:52:49 2009
@@ -20,6 +20,8 @@
 =

 -- Camera Rotation - Input stuff use: "mouse1", "mouse2" or "mouse3"
 gInput_CamMouseButton =3D GetNamedKey("mouse3")
+
+gConfig:DeclareBoolean("gbUseUoDdsMaps", "gfx", "load granny dds maps", 'e=
nable this if you locally converted the uo granny map files into dds format=
', false)
 =

 gConfig:DeclareBoolean("gUseConstantCameraRotation", "input", "mouse camer=
a rotation", 'mouse camera rotation', true)
 =


Modified: trunk/lua/lib.3d.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mobile.lua (original)
+++ trunk/lua/lib.3d.mobile.lua Fri Jan  9 22:52:49 2009
@@ -34,12 +34,12 @@
 	-- update mobile aura color
 	if =

 		(mobile.aura.lastn ~=3D mobile.notoriety) or =

-		(mobile.aura.lastnhits ~=3D mobile.stats.curHits) or =

+		--~ (mobile.aura.lastnhits ~=3D mobile.stats.curHits) or =

 		forceupdate
 	then
 		=

 		mobile.aura.lastn =3D mobile.notoriety
-		mobile.aura.lastnhits =3D mobile.stats.curHits
+		--~ mobile.aura.lastnhits =3D mobile.stats.curHits
 		=

 		local nx,ny,nz =3D 0,0,1
 		local r,g,b =3D GetNotorietyColor(mobile.notoriety)
@@ -49,9 +49,9 @@
 		=

 		-- read out hp%
 		local p =3D 1
-		if mobile.stats and mobile.stats.curHits and mobile.stats.maxHits then
-			p =3D mobile.stats.curHits / mobile.stats.maxHits
-		end
+		--~ if mobile.stats and mobile.stats.curHits and mobile.stats.maxHits th=
en
+			--~ p =3D mobile.stats.curHits / mobile.stats.maxHits
+		--~ end
 		=

 		-- prepare vars
 		local k =3D 11

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Fri Jan  9 22:52:49 2009
@@ -529,7 +529,7 @@
 function Renderer3D:AddEffect( effect )
 	local workingeffect =3D nil
 	=

-	print("### Renderer3D:AddEffect",sprintf("0x%04x",effect.itemid))
+	--~ print("### Renderer3D:AddEffect",sprintf("0x%04x",effect.itemid))
 =

 	if effect.effect_type =3D=3D kEffectType_LightningStrikeAtSource then
 		workingeffect =3D Renderer3D:AddLightningEffect( effect )

Modified: trunk/lua/lib.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mousepick.lua (original)
+++ trunk/lua/lib.mousepick.lua Fri Jan  9 22:52:49 2009
@@ -232,8 +232,13 @@
 	end
 	-- select the nearest if found
 	if (minserial ~=3D 0) then
-		gCurrentRenderer:SelectMobile(minserial)
-	end
+		SelectMobile(minserial)
+	end
+end
+
+function SelectMobile(serial)
+	gCurrentRenderer:SelectMobile(serial)
+	NotifyListener("Hook_SelectMobile",serial)
 end
 =

 -- selects the next mobile cycling through all mobiles
@@ -258,11 +263,11 @@
 	=

 	-- select the next if found
 	if (nextminserial > 0) then
-		gCurrentRenderer:SelectMobile(nextminserial)
+		SelectMobile(nextminserial)
 	else
 		-- or the start if no next found
 		if (minserial > 0) then
-			gCurrentRenderer:SelectMobile(minserial)
-		end
-	end
-end
+			SelectMobile(minserial)
+		end
+	end
+end

Modified: trunk/lua/net/net.other.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.other.lua (original)
+++ trunk/lua/net/net.other.lua Fri Jan  9 22:52:49 2009
@@ -157,6 +157,7 @@
 	out:PushNetUint32(mobile_serial)
 	gLastAttackedMobileSerial =3D mobile_serial
 	printdebug("net", sprintf("NET: Attack -> serial=3D0x%08x\n",mobile_seria=
l) )
+	NotifyListener("Hook_AttackReqSend",mobile_serial)
 end
 =

 =


Modified: trunk/plugins/itemcounter.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/itemcounter.lua (original)
+++ trunk/plugins/itemcounter.lua Fri Jan  9 22:52:49 2009
@@ -5,6 +5,9 @@
 if (not gDisabledPlugins.itemcounter) then =

 =

 if (gItemCounterDialog) then gItemCounterDialog:Destroy() gItemCounterDial=
og =3D nil end
+
+kItemCounterUsageType_UseInHand =3D 1
+kItemCounterUsageType_Use =3D 2
 =

 kItemCounterLowAmount =3D 10
 kItemCounterBagType =3D 0xe76
@@ -28,12 +31,12 @@
 		{name=3D"batwing"		,artid=3D0xf78},
 	},
 	{ -- pots
-		{name=3D"gheal"		,artid=3D3852},
-		{name=3D"gcure"		,artid=3D3847},
-		{name=3D"refresh"		,artid=3D3851},
-		{name=3D"explo"		,artid=3D3853},
-		{name=3D"dexpot"		,artid=3D0xF08},
-		{name=3D"strpot"		,artid=3D0xF09},
+		{name=3D"gheal"		,artid=3D3852,	usagetype=3DkItemCounterUsageType_UseInH=
and},
+		{name=3D"gcure"		,artid=3D3847,	usagetype=3DkItemCounterUsageType_UseInH=
and},
+		{name=3D"refresh"		,artid=3D3851,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
+		{name=3D"explo"		,artid=3D3853,	usagetype=3DkItemCounterUsageType_UseInH=
and},
+		{name=3D"dexpot"		,artid=3D0xF08,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
+		{name=3D"strpot"		,artid=3D0xF09,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
 	},
 	{ -- crafter
 		{name=3D"cloth"			,artid=3D0x1766},
@@ -46,7 +49,7 @@
 	},
 	{ -- rest
 		{name=3D"gold"		,artid=3D0xeef},
-		{name=3D"bandas"		,artid=3D0xe21},
+		{name=3D"bandas"		,artid=3D0xe21,	usagetype=3DkItemCounterUsageType_Use},
 		{name=3D"arrows"		,artid=3D3903},
 	},
 }
@@ -125,7 +128,33 @@
 	if (amount < kItemCounterLowAmount) then r,g,b =3D 1,0,0 end
 	if (amount =3D=3D 0) then r,g,b =3D 0.3,0,0 end
 	local minx,miny,maxx,maxy =3D GetArtVisibleAABB(artid+0x4000)
-	self:AddWidget(self:CreateChild("UOImage",{x=3Dself.nextx-minx,y=3D0,art_=
id=3Dartid}),maxx-minx)
+	local icon =3D self:CreateChild("UOImage",{x=3Dself.nextx-minx,y=3D0,art_=
id=3Dartid})
+	icon.on_mouse_left_click_double =3D function()
+		local t =3D data.usagetype
+		if t then
+			-- try to use it
+			if t =3D=3D kItemCounterUsageType_Use then
+				MacroCmd_Item_UseByArtID(artid)
+			elseif t =3D=3D kItemCounterUsageType_UseInHand then
+				job.create(function()
+					local delay =3D 800
+					-- unequip into backpack
+					local twohand	=3D MacroCmd_GetPlayerEquipment(kLayer_TwoHanded)
+					local onehand	=3D MacroCmd_GetPlayerEquipment(kLayer_OneHanded)
+					if onehand then MacroCmd_DragDrop(onehand.serial,1) end
+					if twohand then MacroCmd_DragDrop(twohand.serial,1) end
+					job.wait(delay)
+					-- use
+					MacroCmd_Item_UseByArtID(artid)
+					job.wait(delay)
+					-- reequip
+					if onehand then MacroCmd_DragAndEquip(onehand.serial, GetPlayerSerial=
()) end
+					if twohand then MacroCmd_DragAndEquip(twohand.serial, GetPlayerSerial=
()) end
+				end)
+			end
+		end
+	end
+	self:AddWidget(icon,maxx-minx)
 	self:AddText(amount,r,g,b)
 	self:AddSpace(2)
 end

Modified: trunk/plugins/moblist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/moblist.lua (original)
+++ trunk/plugins/moblist.lua Fri Jan  9 22:52:49 2009
@@ -190,7 +190,7 @@
 	if (serial =3D=3D 0 or serial =3D=3D GetPlayerSerial() or serial =3D=3D s=
elf.maintarget_serial) then serial =3D nil end
 	self.maintarget_serial =3D serial
 	self:UpdateMainTargetListMarker()
-	print("UOMobList:SetMainTarget",serial,name)
+	--~ print("UOMobList:SetMainTarget",serial,name)
 	local gfx  =3D self.gfx_maintarget
 	local gfx2 =3D self.gfx_maintarget_line
 	if (self.maintarget_serial) then
@@ -435,5 +435,7 @@
 function MobListSetMainTargetSerial(serial) gMobList:SetMainTarget(serial)=
 end
 		=

 RegisterListener("Hook_PostLoad",function () gMobList =3D GetDesktopWidget=
():CreateChild("UOMobList") end)
-
-end
+RegisterListener("Hook_AttackReqSend",function (serial) SelectMobile(seria=
l) end)
+RegisterListener("Hook_SelectMobile",function (serial) MobListSetMainTarge=
tSerial(serial) end)
+
+end



From no-reply at zwischenwelt.org  Fri Jan  9 22:53:45 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 09 Jan 2009 21:53:45 -0000
Subject: [Iris-commit] [IRIS] r2848 - /trunk/lua/lib.granny.lua
Message-ID: <20090109215346.A5EBB1C1866B@zwischenwelt.org>

Author: hagish
Date: Fri Jan  9 22:53:45 2009
New Revision: 2848

Log:
forgot one file

Modified:
    trunk/lua/lib.granny.lua

Modified: trunk/lua/lib.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.granny.lua (original)
+++ trunk/lua/lib.granny.lua Fri Jan  9 22:53:45 2009
@@ -319,8 +319,14 @@
 	local paramgroups =3D GetGrannyParamGroups(granny)
 	local texid =3D granny:GetTextureID(index)
 	local texpath =3D paramgroups[texid-1] and paramgroups[texid-1]["__FileNa=
me"]
-	--print("texpath",texpath)
-	if (texpath) then return basename(texpath) end
+	--~ print("texpath",texpath)
+	if (texpath) then =

+		if gbUseUoDdsMaps then
+			return string.gsub(basename(texpath),"\\.tga","\\.dds")
+		else
+			return basename(texpath)
+		end
+	end
 end
 =

 =




From no-reply at zwischenwelt.org  Fri Jan  9 23:26:45 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 09 Jan 2009 22:26:45 -0000
Subject: [Iris-commit] [IRIS] r2849 - in /trunk: lua/lib.3d.dynamic.lua
 lua/lib.uodragdrop.lua lua/lib.uoids.lua plugins/loot.lua
Message-ID: <20090109222645.5B9B21C18807@zwischenwelt.org>

Author: ghoulsblade
Date: Fri Jan  9 23:26:44 2009
New Revision: 2849

Log:
loot plugin fix (gold), skeleton-deko-item fix (corpse-dragdrop), sparkle r=
eplacement fix (teleporter wasn't shown, visible as moongate gfx now

Modified:
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.uodragdrop.lua
    trunk/lua/lib.uoids.lua
    trunk/plugins/loot.lua

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Fri Jan  9 23:26:44 2009
@@ -340,8 +340,8 @@
 	else
 		-- normal 1 part object
 		local artid =3D item.artid
-		if (in_array(artid,kSparkleArtIDs)) then artid =3D kMoongateGateArtID en=
d -- provisory fix
-	=

+		if (in_array(artid,kSparkleArtIDs)) then artid =3D kMoongateGateArtID it=
em.artid =3D artid end -- provisory fix
+		=

 		item.meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNam=
e(artid)
 =

 		-- Fastbatch rendering

Modified: trunk/lua/lib.uodragdrop.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.uodragdrop.lua (original)
+++ trunk/lua/lib.uodragdrop.lua Fri Jan  9 23:26:44 2009
@@ -283,9 +283,11 @@
 end
 =

 function UODragDrop_TakeItem ()
-	if (IsCorpseArtID(gDragDrop.item.artid)) then return end
+	local bIsCorpse =3D IsCorpseArtID(gDragDrop.item.artid)
+	--~ if () then return end
 	local amount =3D gDragDrop.item.amount
-	if (amount > 1 and (not gKeyPressed[key_lshift])) then =

+	if (bIsCorpse) then amount =3D 1 end
+	if (amount > 1 and (not gKeyPressed[key_lshift]) and (not bIsCorpse)) the=
n =

 		-- show amount bSendTakeMessage
 		gDragDrop.bWithAmountDialog =3D true
 		OpenAmountAtMouse(1,amount,amount,UODragDrop_AmountEntryCallback)

Modified: trunk/lua/lib.uoids.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.uoids.lua (original)
+++ trunk/lua/lib.uoids.lua Fri Jan  9 23:26:44 2009
@@ -29,7 +29,7 @@
 gMulti_ID =3D hex2num("0x4000")
 =

 kMobileGhostArtIDs =3D {402,403,607,608,970}
-kSparkleArtIDs =3D {0x373A} -- dynamic-teleporters
+kSparkleArtIDs =3D {0x373A,0x375a} -- dynamic-teleporters
 kMoongateGateArtID =3D 3948 -- blue moongate, gate-travel-spell
 =

 -- the meaning of mobile.flag

Modified: trunk/plugins/loot.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/loot.lua (original)
+++ trunk/plugins/loot.lua Fri Jan  9 23:26:44 2009
@@ -29,6 +29,7 @@
 	35,36,  --lizzardmen
 	240, -- kappa
 	}
+	=

 gLoot_TrashCorpseTypesByID =3D {}
 for k,v in pairs(gLoot_TrashCorpseTypes) do gLoot_TrashCorpseTypesByID[v] =
=3D true end
 =

@@ -110,9 +111,11 @@
 	=

 	if (takeitem) then
 		local item =3D takeitem
-		if (takeitem =3D=3D kLootArtID_Gold) then
+		if (item.artid =3D=3D kLootArtID_Gold) then
 			local curw,maxw =3D GetPlayerWeight()
 			local w =3D ceil(item.amount * kLoot_GoldWeight)
+
+			--~ print("######------#######  takeitem =3D=3D kLootArtID_Gold",item.a=
mount , kLoot_GoldWeight,curw,maxw )
 			if (curw and maxw and curw + w > maxw) then
 				SpellBarRiseTextOnMob(GetPlayerSerial(),1,0.5,0,"backpack full!")
 				if (gLootBPFullCallBack) then gLootBPFullCallBack() end
@@ -125,6 +128,7 @@
 				Send_Drop_Object_AutoStack(item.serial,GetPlayerBackPackSerial())
 			end
 		else =

+			--~ print("######------#######  takeitem =3D=3D other",item.artid,item.=
amount , kLoot_GoldWeight,curw,maxw )
 			SpellBarRiseTextOnMob(GetPlayerSerial(),1,0.5,0,GetStaticTileTypeName(i=
tem.artid) or "???")
 			Send_Take_Object(item.serial,item.amount)
 			Send_Drop_Object_AutoStack(item.serial,GetPlayerBackPackSerial())



From no-reply at zwischenwelt.org  Sat Jan 10 19:04:39 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 10 Jan 2009 18:04:39 -0000
Subject: [Iris-commit] [IRIS] r2850 - in /trunk/data/models:
 materials/textures.material models/to_004000/mdl_003178.mesh
 models/to_004000/mdl_003179.mesh models/to_008000/mdl_007964.mesh
 textures/tex_powercrystal.png
Message-ID: <20090110180439.9405C1C1880A@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 10 19:04:38 2009
New Revision: 2850

Log:
xml-spawner model (gms, magic crystal) from cougar, pumpkin duplicates

Added:
    trunk/data/models/models/to_004000/mdl_003178.mesh   (with props)
    trunk/data/models/models/to_004000/mdl_003179.mesh   (with props)
    trunk/data/models/textures/tex_powercrystal.png   (with props)
Modified:
    trunk/data/models/materials/textures.material
    trunk/data/models/models/to_008000/mdl_007964.mesh

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan 10 19:04:38 2009
@@ -6037,3 +6037,8 @@
 { =

 	set_texture_alias MainTexture tex_crystal.png
 }
+
+material PCrystMat : tex_base
+{
+	set_texture_alias MainTexture tex_powercrystal.png
+}

Modified: trunk/data/models/models/to_008000/mdl_007964.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan 10 20:00:54 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 10 Jan 2009 19:00:54 -0000
Subject: [Iris-commit] [IRIS] r2851 - in /trunk/data/models:
 materials/textures.material models/to_008000/mdl_007964.mesh
 textures/tex_powercrystal.png
Message-ID: <20090110190225.603BB1C1880C@zwischenwelt.org>

Author: hagish
Date: Sat Jan 10 20:00:53 2009
New Revision: 2851

Log:
small fixes in powercrystal model (ie. position)

Modified:
    trunk/data/models/materials/textures.material
    trunk/data/models/models/to_008000/mdl_007964.mesh
    trunk/data/models/textures/tex_powercrystal.png

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sat Jan 10 20:00:53 2009
@@ -6038,7 +6038,7 @@
 	set_texture_alias MainTexture tex_crystal.png
 }
 =

-material PCrystMat : tex_base
+material tex_powercrystal : tex_base
 {
 	set_texture_alias MainTexture tex_powercrystal.png
 }

Modified: trunk/data/models/models/to_008000/mdl_007964.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/textures/tex_powercrystal.png
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan 10 20:12:13 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 10 Jan 2009 19:12:13 -0000
Subject: [Iris-commit] [IRIS] r2852 - in /trunk: data/models/models/
 data/models/models/to_001000/ data/models/models/to_002000/
 data/models/models/to_003000/ data/models/models/to_004000/
 data/models/models/to_005000/ data/models/models/to_006000/
 data/models/models/to_007000/ data/models/models/to_008000/
 data/models/models/to_009000/ data/models/models/to_010000/
 data/models/models/to_012000/ data/models/models/to_013000/
 data/models/models/to_014000/ data/models/models/to_015000/
 data/models/models/to_017000/ lua/filter/
Message-ID: <20090110191214.83AE21C1880A@zwischenwelt.org>

Author: hagish
Date: Sat Jan 10 20:12:10 2009
New Revision: 2852

Log:
removed duplicate model files

Added:
    trunk/data/models/models/remove_duplicate_models.php
Removed:
    trunk/data/models/models/to_001000/mdl_000047.mesh
    trunk/data/models/models/to_001000/mdl_000050.mesh
    trunk/data/models/models/to_001000/mdl_000076.mesh
    trunk/data/models/models/to_001000/mdl_000077.mesh
    trunk/data/models/models/to_001000/mdl_000081.mesh
    trunk/data/models/models/to_001000/mdl_000083.mesh
    trunk/data/models/models/to_001000/mdl_000091.mesh
    trunk/data/models/models/to_001000/mdl_000094.mesh
    trunk/data/models/models/to_001000/mdl_000100.mesh
    trunk/data/models/models/to_001000/mdl_000105.mesh
    trunk/data/models/models/to_001000/mdl_000107.mesh
    trunk/data/models/models/to_001000/mdl_000108.mesh
    trunk/data/models/models/to_001000/mdl_000126.mesh
    trunk/data/models/models/to_001000/mdl_000127.mesh
    trunk/data/models/models/to_001000/mdl_000128.mesh
    trunk/data/models/models/to_001000/mdl_000129.mesh
    trunk/data/models/models/to_001000/mdl_000130.mesh
    trunk/data/models/models/to_001000/mdl_000131.mesh
    trunk/data/models/models/to_001000/mdl_000135.mesh
    trunk/data/models/models/to_001000/mdl_000143.mesh
    trunk/data/models/models/to_001000/mdl_000155.mesh
    trunk/data/models/models/to_001000/mdl_000159.mesh
    trunk/data/models/models/to_001000/mdl_000163.mesh
    trunk/data/models/models/to_001000/mdl_000164.mesh
    trunk/data/models/models/to_001000/mdl_000167.mesh
    trunk/data/models/models/to_001000/mdl_000168.mesh
    trunk/data/models/models/to_001000/mdl_000201.mesh
    trunk/data/models/models/to_001000/mdl_000212.mesh
    trunk/data/models/models/to_001000/mdl_000221.mesh
    trunk/data/models/models/to_001000/mdl_000224.mesh
    trunk/data/models/models/to_001000/mdl_000227.mesh
    trunk/data/models/models/to_001000/mdl_000230.mesh
    trunk/data/models/models/to_001000/mdl_000232.mesh
    trunk/data/models/models/to_001000/mdl_000233.mesh
    trunk/data/models/models/to_001000/mdl_000234.mesh
    trunk/data/models/models/to_001000/mdl_000235.mesh
    trunk/data/models/models/to_001000/mdl_000236.mesh
    trunk/data/models/models/to_001000/mdl_000238.mesh
    trunk/data/models/models/to_001000/mdl_000240.mesh
    trunk/data/models/models/to_001000/mdl_000243.mesh
    trunk/data/models/models/to_001000/mdl_000244.mesh
    trunk/data/models/models/to_001000/mdl_000245.mesh
    trunk/data/models/models/to_001000/mdl_000246.mesh
    trunk/data/models/models/to_001000/mdl_000280.mesh
    trunk/data/models/models/to_001000/mdl_000294.mesh
    trunk/data/models/models/to_001000/mdl_000322.mesh
    trunk/data/models/models/to_001000/mdl_000373.mesh
    trunk/data/models/models/to_001000/mdl_000376.mesh
    trunk/data/models/models/to_001000/mdl_000399.mesh
    trunk/data/models/models/to_001000/mdl_000407.mesh
    trunk/data/models/models/to_001000/mdl_000424.mesh
    trunk/data/models/models/to_001000/mdl_000427.mesh
    trunk/data/models/models/to_001000/mdl_000428.mesh
    trunk/data/models/models/to_001000/mdl_000436.mesh
    trunk/data/models/models/to_001000/mdl_000448.mesh
    trunk/data/models/models/to_001000/mdl_000450.mesh
    trunk/data/models/models/to_001000/mdl_000451.mesh
    trunk/data/models/models/to_001000/mdl_000475.mesh
    trunk/data/models/models/to_001000/mdl_000481.mesh
    trunk/data/models/models/to_001000/mdl_000483.mesh
    trunk/data/models/models/to_001000/mdl_000492.mesh
    trunk/data/models/models/to_001000/mdl_000493.mesh
    trunk/data/models/models/to_001000/mdl_000494.mesh
    trunk/data/models/models/to_001000/mdl_000495.mesh
    trunk/data/models/models/to_001000/mdl_000497.mesh
    trunk/data/models/models/to_001000/mdl_000502.mesh
    trunk/data/models/models/to_001000/mdl_000505.mesh
    trunk/data/models/models/to_001000/mdl_000531.mesh
    trunk/data/models/models/to_001000/mdl_000532.mesh
    trunk/data/models/models/to_001000/mdl_000535.mesh
    trunk/data/models/models/to_001000/mdl_000563.mesh
    trunk/data/models/models/to_001000/mdl_000577.mesh
    trunk/data/models/models/to_001000/mdl_000636.mesh
    trunk/data/models/models/to_001000/mdl_000677.mesh
    trunk/data/models/models/to_001000/mdl_000678.mesh
    trunk/data/models/models/to_001000/mdl_000734.mesh
    trunk/data/models/models/to_001000/mdl_000735.mesh
    trunk/data/models/models/to_001000/mdl_000738.mesh
    trunk/data/models/models/to_001000/mdl_000739.mesh
    trunk/data/models/models/to_001000/mdl_000742.mesh
    trunk/data/models/models/to_001000/mdl_000744.mesh
    trunk/data/models/models/to_001000/mdl_000746.mesh
    trunk/data/models/models/to_001000/mdl_000747.mesh
    trunk/data/models/models/to_001000/mdl_000748.mesh
    trunk/data/models/models/to_001000/mdl_000788.mesh
    trunk/data/models/models/to_001000/mdl_000789.mesh
    trunk/data/models/models/to_001000/mdl_000790.mesh
    trunk/data/models/models/to_001000/mdl_000791.mesh
    trunk/data/models/models/to_001000/mdl_000792.mesh
    trunk/data/models/models/to_001000/mdl_000793.mesh
    trunk/data/models/models/to_001000/mdl_000794.mesh
    trunk/data/models/models/to_001000/mdl_000796.mesh
    trunk/data/models/models/to_001000/mdl_000797.mesh
    trunk/data/models/models/to_001000/mdl_000798.mesh
    trunk/data/models/models/to_001000/mdl_000799.mesh
    trunk/data/models/models/to_001000/mdl_000800.mesh
    trunk/data/models/models/to_001000/mdl_000801.mesh
    trunk/data/models/models/to_001000/mdl_000804.mesh
    trunk/data/models/models/to_001000/mdl_000805.mesh
    trunk/data/models/models/to_001000/mdl_000806.mesh
    trunk/data/models/models/to_001000/mdl_000807.mesh
    trunk/data/models/models/to_001000/mdl_000810.mesh
    trunk/data/models/models/to_001000/mdl_000812.mesh
    trunk/data/models/models/to_001000/mdl_000814.mesh
    trunk/data/models/models/to_001000/mdl_000815.mesh
    trunk/data/models/models/to_001000/mdl_000816.mesh
    trunk/data/models/models/to_001000/mdl_000817.mesh
    trunk/data/models/models/to_001000/mdl_000818.mesh
    trunk/data/models/models/to_001000/mdl_000819.mesh
    trunk/data/models/models/to_001000/mdl_000820.mesh
    trunk/data/models/models/to_001000/mdl_000821.mesh
    trunk/data/models/models/to_001000/mdl_000822.mesh
    trunk/data/models/models/to_001000/mdl_000824.mesh
    trunk/data/models/models/to_001000/mdl_000825.mesh
    trunk/data/models/models/to_001000/mdl_000826.mesh
    trunk/data/models/models/to_001000/mdl_000828.mesh
    trunk/data/models/models/to_001000/mdl_000830.mesh
    trunk/data/models/models/to_001000/mdl_000831.mesh
    trunk/data/models/models/to_001000/mdl_000832.mesh
    trunk/data/models/models/to_001000/mdl_000833.mesh
    trunk/data/models/models/to_001000/mdl_000834.mesh
    trunk/data/models/models/to_001000/mdl_000835.mesh
    trunk/data/models/models/to_001000/mdl_000837.mesh
    trunk/data/models/models/to_001000/mdl_000838.mesh
    trunk/data/models/models/to_001000/mdl_000840.mesh
    trunk/data/models/models/to_001000/mdl_000841.mesh
    trunk/data/models/models/to_001000/mdl_000842.mesh
    trunk/data/models/models/to_001000/mdl_000843.mesh
    trunk/data/models/models/to_001000/mdl_000846.mesh
    trunk/data/models/models/to_001000/mdl_000847.mesh
    trunk/data/models/models/to_001000/mdl_000848.mesh
    trunk/data/models/models/to_001000/mdl_000849.mesh
    trunk/data/models/models/to_001000/mdl_000850.mesh
    trunk/data/models/models/to_001000/mdl_000851.mesh
    trunk/data/models/models/to_001000/mdl_000853.mesh
    trunk/data/models/models/to_001000/mdl_000854.mesh
    trunk/data/models/models/to_001000/mdl_000855.mesh
    trunk/data/models/models/to_001000/mdl_000856.mesh
    trunk/data/models/models/to_001000/mdl_000857.mesh
    trunk/data/models/models/to_001000/mdl_000858.mesh
    trunk/data/models/models/to_001000/mdl_000860.mesh
    trunk/data/models/models/to_001000/mdl_000863.mesh
    trunk/data/models/models/to_001000/mdl_000864.mesh
    trunk/data/models/models/to_001000/mdl_000865.mesh
    trunk/data/models/models/to_001000/mdl_000866.mesh
    trunk/data/models/models/to_001000/mdl_000867.mesh
    trunk/data/models/models/to_001000/mdl_000875.mesh
    trunk/data/models/models/to_001000/mdl_000911.mesh
    trunk/data/models/models/to_001000/mdl_000914.mesh
    trunk/data/models/models/to_001000/mdl_000915.mesh
    trunk/data/models/models/to_001000/mdl_000917.mesh
    trunk/data/models/models/to_001000/mdl_000918.mesh
    trunk/data/models/models/to_001000/mdl_000924.mesh
    trunk/data/models/models/to_001000/mdl_000926.mesh
    trunk/data/models/models/to_001000/mdl_000935.mesh
    trunk/data/models/models/to_001000/mdl_000936.mesh
    trunk/data/models/models/to_001000/mdl_000938.mesh
    trunk/data/models/models/to_001000/mdl_000939.mesh
    trunk/data/models/models/to_001000/mdl_000941.mesh
    trunk/data/models/models/to_001000/mdl_000943.mesh
    trunk/data/models/models/to_001000/mdl_000944.mesh
    trunk/data/models/models/to_001000/mdl_000974.mesh
    trunk/data/models/models/to_001000/mdl_000994.mesh
    trunk/data/models/models/to_002000/mdl_001057.mesh
    trunk/data/models/models/to_002000/mdl_001058.mesh
    trunk/data/models/models/to_002000/mdl_001072.mesh
    trunk/data/models/models/to_002000/mdl_001073.mesh
    trunk/data/models/models/to_002000/mdl_001090.mesh
    trunk/data/models/models/to_002000/mdl_001091.mesh
    trunk/data/models/models/to_002000/mdl_001092.mesh
    trunk/data/models/models/to_002000/mdl_001093.mesh
    trunk/data/models/models/to_002000/mdl_001104.mesh
    trunk/data/models/models/to_002000/mdl_001105.mesh
    trunk/data/models/models/to_002000/mdl_001106.mesh
    trunk/data/models/models/to_002000/mdl_001107.mesh
    trunk/data/models/models/to_002000/mdl_001142.mesh
    trunk/data/models/models/to_002000/mdl_001143.mesh
    trunk/data/models/models/to_002000/mdl_001144.mesh
    trunk/data/models/models/to_002000/mdl_001145.mesh
    trunk/data/models/models/to_002000/mdl_001147.mesh
    trunk/data/models/models/to_002000/mdl_001148.mesh
    trunk/data/models/models/to_002000/mdl_001149.mesh
    trunk/data/models/models/to_002000/mdl_001150.mesh
    trunk/data/models/models/to_002000/mdl_001151.mesh
    trunk/data/models/models/to_002000/mdl_001152.mesh
    trunk/data/models/models/to_002000/mdl_001174.mesh
    trunk/data/models/models/to_002000/mdl_001175.mesh
    trunk/data/models/models/to_002000/mdl_001176.mesh
    trunk/data/models/models/to_002000/mdl_001183.mesh
    trunk/data/models/models/to_002000/mdl_001184.mesh
    trunk/data/models/models/to_002000/mdl_001186.mesh
    trunk/data/models/models/to_002000/mdl_001217.mesh
    trunk/data/models/models/to_002000/mdl_001218.mesh
    trunk/data/models/models/to_002000/mdl_001226.mesh
    trunk/data/models/models/to_002000/mdl_001233.mesh
    trunk/data/models/models/to_002000/mdl_001234.mesh
    trunk/data/models/models/to_002000/mdl_001239.mesh
    trunk/data/models/models/to_002000/mdl_001241.mesh
    trunk/data/models/models/to_002000/mdl_001243.mesh
    trunk/data/models/models/to_002000/mdl_001244.mesh
    trunk/data/models/models/to_002000/mdl_001246.mesh
    trunk/data/models/models/to_002000/mdl_001249.mesh
    trunk/data/models/models/to_002000/mdl_001256.mesh
    trunk/data/models/models/to_002000/mdl_001276.mesh
    trunk/data/models/models/to_002000/mdl_001277.mesh
    trunk/data/models/models/to_002000/mdl_001279.mesh
    trunk/data/models/models/to_002000/mdl_001284.mesh
    trunk/data/models/models/to_002000/mdl_001286.mesh
    trunk/data/models/models/to_002000/mdl_001318.mesh
    trunk/data/models/models/to_002000/mdl_001319.mesh
    trunk/data/models/models/to_002000/mdl_001323.mesh
    trunk/data/models/models/to_002000/mdl_001324.mesh
    trunk/data/models/models/to_002000/mdl_001328.mesh
    trunk/data/models/models/to_002000/mdl_001329.mesh
    trunk/data/models/models/to_002000/mdl_001332.mesh
    trunk/data/models/models/to_002000/mdl_001364.mesh
    trunk/data/models/models/to_002000/mdl_001365.mesh
    trunk/data/models/models/to_002000/mdl_001366.mesh
    trunk/data/models/models/to_002000/mdl_001370.mesh
    trunk/data/models/models/to_002000/mdl_001371.mesh
    trunk/data/models/models/to_002000/mdl_001378.mesh
    trunk/data/models/models/to_002000/mdl_001379.mesh
    trunk/data/models/models/to_002000/mdl_001380.mesh
    trunk/data/models/models/to_002000/mdl_001382.mesh
    trunk/data/models/models/to_002000/mdl_001384.mesh
    trunk/data/models/models/to_002000/mdl_001388.mesh
    trunk/data/models/models/to_002000/mdl_001389.mesh
    trunk/data/models/models/to_002000/mdl_001392.mesh
    trunk/data/models/models/to_002000/mdl_001393.mesh
    trunk/data/models/models/to_002000/mdl_001394.mesh
    trunk/data/models/models/to_002000/mdl_001395.mesh
    trunk/data/models/models/to_002000/mdl_001396.mesh
    trunk/data/models/models/to_002000/mdl_001399.mesh
    trunk/data/models/models/to_002000/mdl_001402.mesh
    trunk/data/models/models/to_002000/mdl_001405.mesh
    trunk/data/models/models/to_002000/mdl_001409.mesh
    trunk/data/models/models/to_002000/mdl_001411.mesh
    trunk/data/models/models/to_002000/mdl_001412.mesh
    trunk/data/models/models/to_002000/mdl_001413.mesh
    trunk/data/models/models/to_002000/mdl_001444.mesh
    trunk/data/models/models/to_002000/mdl_001445.mesh
    trunk/data/models/models/to_002000/mdl_001446.mesh
    trunk/data/models/models/to_002000/mdl_001447.mesh
    trunk/data/models/models/to_002000/mdl_001448.mesh
    trunk/data/models/models/to_002000/mdl_001449.mesh
    trunk/data/models/models/to_002000/mdl_001452.mesh
    trunk/data/models/models/to_002000/mdl_001453.mesh
    trunk/data/models/models/to_002000/mdl_001454.mesh
    trunk/data/models/models/to_002000/mdl_001455.mesh
    trunk/data/models/models/to_002000/mdl_001456.mesh
    trunk/data/models/models/to_002000/mdl_001457.mesh
    trunk/data/models/models/to_002000/mdl_001458.mesh
    trunk/data/models/models/to_002000/mdl_001474.mesh
    trunk/data/models/models/to_002000/mdl_001475.mesh
    trunk/data/models/models/to_002000/mdl_001476.mesh
    trunk/data/models/models/to_002000/mdl_001477.mesh
    trunk/data/models/models/to_002000/mdl_001478.mesh
    trunk/data/models/models/to_002000/mdl_001479.mesh
    trunk/data/models/models/to_002000/mdl_001480.mesh
    trunk/data/models/models/to_002000/mdl_001481.mesh
    trunk/data/models/models/to_002000/mdl_001482.mesh
    trunk/data/models/models/to_002000/mdl_001483.mesh
    trunk/data/models/models/to_002000/mdl_001484.mesh
    trunk/data/models/models/to_002000/mdl_001485.mesh
    trunk/data/models/models/to_002000/mdl_001486.mesh
    trunk/data/models/models/to_002000/mdl_001487.mesh
    trunk/data/models/models/to_002000/mdl_001488.mesh
    trunk/data/models/models/to_002000/mdl_001508.mesh
    trunk/data/models/models/to_002000/mdl_001509.mesh
    trunk/data/models/models/to_002000/mdl_001512.mesh
    trunk/data/models/models/to_002000/mdl_001549.mesh
    trunk/data/models/models/to_002000/mdl_001554.mesh
    trunk/data/models/models/to_002000/mdl_001559.mesh
    trunk/data/models/models/to_002000/mdl_001561.mesh
    trunk/data/models/models/to_002000/mdl_001562.mesh
    trunk/data/models/models/to_002000/mdl_001572.mesh
    trunk/data/models/models/to_002000/mdl_001575.mesh
    trunk/data/models/models/to_002000/mdl_001576.mesh
    trunk/data/models/models/to_002000/mdl_001577.mesh
    trunk/data/models/models/to_002000/mdl_001578.mesh
    trunk/data/models/models/to_002000/mdl_001581.mesh
    trunk/data/models/models/to_002000/mdl_001611.mesh
    trunk/data/models/models/to_002000/mdl_001620.mesh
    trunk/data/models/models/to_002000/mdl_001624.mesh
    trunk/data/models/models/to_002000/mdl_001629.mesh
    trunk/data/models/models/to_002000/mdl_001635.mesh
    trunk/data/models/models/to_002000/mdl_001638.mesh
    trunk/data/models/models/to_002000/mdl_001642.mesh
    trunk/data/models/models/to_002000/mdl_001643.mesh
    trunk/data/models/models/to_002000/mdl_001644.mesh
    trunk/data/models/models/to_002000/mdl_001646.mesh
    trunk/data/models/models/to_002000/mdl_001647.mesh
    trunk/data/models/models/to_002000/mdl_001653.mesh
    trunk/data/models/models/to_002000/mdl_001654.mesh
    trunk/data/models/models/to_002000/mdl_001657.mesh
    trunk/data/models/models/to_002000/mdl_001659.mesh
    trunk/data/models/models/to_002000/mdl_001661.mesh
    trunk/data/models/models/to_002000/mdl_001665.mesh
    trunk/data/models/models/to_002000/mdl_001666.mesh
    trunk/data/models/models/to_002000/mdl_001667.mesh
    trunk/data/models/models/to_002000/mdl_001668.mesh
    trunk/data/models/models/to_002000/mdl_001669.mesh
    trunk/data/models/models/to_002000/mdl_001670.mesh
    trunk/data/models/models/to_002000/mdl_001673.mesh
    trunk/data/models/models/to_002000/mdl_001675.mesh
    trunk/data/models/models/to_002000/mdl_001677.mesh
    trunk/data/models/models/to_002000/mdl_001679.mesh
    trunk/data/models/models/to_002000/mdl_001682.mesh
    trunk/data/models/models/to_002000/mdl_001683.mesh
    trunk/data/models/models/to_002000/mdl_001684.mesh
    trunk/data/models/models/to_002000/mdl_001685.mesh
    trunk/data/models/models/to_002000/mdl_001686.mesh
    trunk/data/models/models/to_002000/mdl_001689.mesh
    trunk/data/models/models/to_002000/mdl_001691.mesh
    trunk/data/models/models/to_002000/mdl_001693.mesh
    trunk/data/models/models/to_002000/mdl_001697.mesh
    trunk/data/models/models/to_002000/mdl_001698.mesh
    trunk/data/models/models/to_002000/mdl_001699.mesh
    trunk/data/models/models/to_002000/mdl_001700.mesh
    trunk/data/models/models/to_002000/mdl_001701.mesh
    trunk/data/models/models/to_002000/mdl_001705.mesh
    trunk/data/models/models/to_002000/mdl_001706.mesh
    trunk/data/models/models/to_002000/mdl_001707.mesh
    trunk/data/models/models/to_002000/mdl_001711.mesh
    trunk/data/models/models/to_002000/mdl_001713.mesh
    trunk/data/models/models/to_002000/mdl_001714.mesh
    trunk/data/models/models/to_002000/mdl_001715.mesh
    trunk/data/models/models/to_002000/mdl_001716.mesh
    trunk/data/models/models/to_002000/mdl_001719.mesh
    trunk/data/models/models/to_002000/mdl_001721.mesh
    trunk/data/models/models/to_002000/mdl_001723.mesh
    trunk/data/models/models/to_002000/mdl_001725.mesh
    trunk/data/models/models/to_002000/mdl_001727.mesh
    trunk/data/models/models/to_002000/mdl_001728.mesh
    trunk/data/models/models/to_002000/mdl_001729.mesh
    trunk/data/models/models/to_002000/mdl_001731.mesh
    trunk/data/models/models/to_002000/mdl_001732.mesh
    trunk/data/models/models/to_002000/mdl_001733.mesh
    trunk/data/models/models/to_002000/mdl_001734.mesh
    trunk/data/models/models/to_002000/mdl_001737.mesh
    trunk/data/models/models/to_002000/mdl_001738.mesh
    trunk/data/models/models/to_002000/mdl_001739.mesh
    trunk/data/models/models/to_002000/mdl_001741.mesh
    trunk/data/models/models/to_002000/mdl_001742.mesh
    trunk/data/models/models/to_002000/mdl_001746.mesh
    trunk/data/models/models/to_002000/mdl_001747.mesh
    trunk/data/models/models/to_002000/mdl_001748.mesh
    trunk/data/models/models/to_002000/mdl_001750.mesh
    trunk/data/models/models/to_002000/mdl_001751.mesh
    trunk/data/models/models/to_002000/mdl_001754.mesh
    trunk/data/models/models/to_002000/mdl_001760.mesh
    trunk/data/models/models/to_002000/mdl_001764.mesh
    trunk/data/models/models/to_002000/mdl_001765.mesh
    trunk/data/models/models/to_002000/mdl_001766.mesh
    trunk/data/models/models/to_002000/mdl_001767.mesh
    trunk/data/models/models/to_002000/mdl_001769.mesh
    trunk/data/models/models/to_002000/mdl_001770.mesh
    trunk/data/models/models/to_002000/mdl_001771.mesh
    trunk/data/models/models/to_002000/mdl_001773.mesh
    trunk/data/models/models/to_002000/mdl_001775.mesh
    trunk/data/models/models/to_002000/mdl_001778.mesh
    trunk/data/models/models/to_002000/mdl_001814.mesh
    trunk/data/models/models/to_002000/mdl_001981.mesh
    trunk/data/models/models/to_002000/mdl_001985.mesh
    trunk/data/models/models/to_002000/mdl_001987.mesh
    trunk/data/models/models/to_002000/mdl_001988.mesh
    trunk/data/models/models/to_002000/mdl_001990.mesh
    trunk/data/models/models/to_003000/mdl_002008.mesh
    trunk/data/models/models/to_003000/mdl_002077.mesh
    trunk/data/models/models/to_003000/mdl_002084.mesh
    trunk/data/models/models/to_003000/mdl_002085.mesh
    trunk/data/models/models/to_003000/mdl_002086.mesh
    trunk/data/models/models/to_003000/mdl_002092.mesh
    trunk/data/models/models/to_003000/mdl_002094.mesh
    trunk/data/models/models/to_003000/mdl_002095.mesh
    trunk/data/models/models/to_003000/mdl_002096.mesh
    trunk/data/models/models/to_003000/mdl_002097.mesh
    trunk/data/models/models/to_003000/mdl_002099.mesh
    trunk/data/models/models/to_003000/mdl_002104.mesh
    trunk/data/models/models/to_003000/mdl_002106.mesh
    trunk/data/models/models/to_003000/mdl_002107.mesh
    trunk/data/models/models/to_003000/mdl_002110.mesh
    trunk/data/models/models/to_003000/mdl_002111.mesh
    trunk/data/models/models/to_003000/mdl_002124.mesh
    trunk/data/models/models/to_003000/mdl_002128.mesh
    trunk/data/models/models/to_003000/mdl_002129.mesh
    trunk/data/models/models/to_003000/mdl_002130.mesh
    trunk/data/models/models/to_003000/mdl_002132.mesh
    trunk/data/models/models/to_003000/mdl_002134.mesh
    trunk/data/models/models/to_003000/mdl_002137.mesh
    trunk/data/models/models/to_003000/mdl_002138.mesh
    trunk/data/models/models/to_003000/mdl_002139.mesh
    trunk/data/models/models/to_003000/mdl_002143.mesh
    trunk/data/models/models/to_003000/mdl_002150.mesh
    trunk/data/models/models/to_003000/mdl_002151.mesh
    trunk/data/models/models/to_003000/mdl_002152.mesh
    trunk/data/models/models/to_003000/mdl_002154.mesh
    trunk/data/models/models/to_003000/mdl_002155.mesh
    trunk/data/models/models/to_003000/mdl_002156.mesh
    trunk/data/models/models/to_003000/mdl_002158.mesh
    trunk/data/models/models/to_003000/mdl_002160.mesh
    trunk/data/models/models/to_003000/mdl_002165.mesh
    trunk/data/models/models/to_003000/mdl_002201.mesh
    trunk/data/models/models/to_003000/mdl_002204.mesh
    trunk/data/models/models/to_003000/mdl_002205.mesh
    trunk/data/models/models/to_003000/mdl_002206.mesh
    trunk/data/models/models/to_003000/mdl_002255.mesh
    trunk/data/models/models/to_003000/mdl_002266.mesh
    trunk/data/models/models/to_003000/mdl_002295.mesh
    trunk/data/models/models/to_003000/mdl_002296.mesh
    trunk/data/models/models/to_003000/mdl_002297.mesh
    trunk/data/models/models/to_003000/mdl_002326.mesh
    trunk/data/models/models/to_003000/mdl_002327.mesh
    trunk/data/models/models/to_003000/mdl_002328.mesh
    trunk/data/models/models/to_003000/mdl_002347.mesh
    trunk/data/models/models/to_003000/mdl_002357.mesh
    trunk/data/models/models/to_003000/mdl_002359.mesh
    trunk/data/models/models/to_003000/mdl_002361.mesh
    trunk/data/models/models/to_003000/mdl_002362.mesh
    trunk/data/models/models/to_003000/mdl_002363.mesh
    trunk/data/models/models/to_003000/mdl_002364.mesh
    trunk/data/models/models/to_003000/mdl_002371.mesh
    trunk/data/models/models/to_003000/mdl_002373.mesh
    trunk/data/models/models/to_003000/mdl_002375.mesh
    trunk/data/models/models/to_003000/mdl_002376.mesh
    trunk/data/models/models/to_003000/mdl_002377.mesh
    trunk/data/models/models/to_003000/mdl_002378.mesh
    trunk/data/models/models/to_003000/mdl_002385.mesh
    trunk/data/models/models/to_003000/mdl_002387.mesh
    trunk/data/models/models/to_003000/mdl_002388.mesh
    trunk/data/models/models/to_003000/mdl_002389.mesh
    trunk/data/models/models/to_003000/mdl_002390.mesh
    trunk/data/models/models/to_003000/mdl_002392.mesh
    trunk/data/models/models/to_003000/mdl_002399.mesh
    trunk/data/models/models/to_003000/mdl_002401.mesh
    trunk/data/models/models/to_003000/mdl_002402.mesh
    trunk/data/models/models/to_003000/mdl_002403.mesh
    trunk/data/models/models/to_003000/mdl_002404.mesh
    trunk/data/models/models/to_003000/mdl_002405.mesh
    trunk/data/models/models/to_003000/mdl_002440.mesh
    trunk/data/models/models/to_003000/mdl_002478.mesh
    trunk/data/models/models/to_003000/mdl_002479.mesh
    trunk/data/models/models/to_003000/mdl_002519.mesh
    trunk/data/models/models/to_003000/mdl_002520.mesh
    trunk/data/models/models/to_003000/mdl_002521.mesh
    trunk/data/models/models/to_003000/mdl_002523.mesh
    trunk/data/models/models/to_003000/mdl_002565.mesh
    trunk/data/models/models/to_003000/mdl_002567.mesh
    trunk/data/models/models/to_003000/mdl_002568.mesh
    trunk/data/models/models/to_003000/mdl_002570.mesh
    trunk/data/models/models/to_003000/mdl_002573.mesh
    trunk/data/models/models/to_003000/mdl_002574.mesh
    trunk/data/models/models/to_003000/mdl_002575.mesh
    trunk/data/models/models/to_003000/mdl_002576.mesh
    trunk/data/models/models/to_003000/mdl_002578.mesh
    trunk/data/models/models/to_003000/mdl_002579.mesh
    trunk/data/models/models/to_003000/mdl_002581.mesh
    trunk/data/models/models/to_003000/mdl_002583.mesh
    trunk/data/models/models/to_003000/mdl_002585.mesh
    trunk/data/models/models/to_003000/mdl_002587.mesh
    trunk/data/models/models/to_003000/mdl_002588.mesh
    trunk/data/models/models/to_003000/mdl_002594.mesh
    trunk/data/models/models/to_003000/mdl_002595.mesh
    trunk/data/models/models/to_003000/mdl_002600.mesh
    trunk/data/models/models/to_003000/mdl_002628.mesh
    trunk/data/models/models/to_003000/mdl_002712.mesh
    trunk/data/models/models/to_003000/mdl_002713.mesh
    trunk/data/models/models/to_003000/mdl_002817.mesh
    trunk/data/models/models/to_003000/mdl_002818.mesh
    trunk/data/models/models/to_003000/mdl_002823.mesh
    trunk/data/models/models/to_003000/mdl_002830.mesh
    trunk/data/models/models/to_003000/mdl_002831.mesh
    trunk/data/models/models/to_003000/mdl_002869.mesh
    trunk/data/models/models/to_003000/mdl_002872.mesh
    trunk/data/models/models/to_003000/mdl_002894.mesh
    trunk/data/models/models/to_003000/mdl_002895.mesh
    trunk/data/models/models/to_003000/mdl_002896.mesh
    trunk/data/models/models/to_003000/mdl_002901.mesh
    trunk/data/models/models/to_003000/mdl_002932.mesh
    trunk/data/models/models/to_003000/mdl_002939.mesh
    trunk/data/models/models/to_003000/mdl_002951.mesh
    trunk/data/models/models/to_003000/mdl_002958.mesh
    trunk/data/models/models/to_003000/mdl_002967.mesh
    trunk/data/models/models/to_003000/mdl_002970.mesh
    trunk/data/models/models/to_004000/mdl_003045.mesh
    trunk/data/models/models/to_004000/mdl_003046.mesh
    trunk/data/models/models/to_004000/mdl_003098.mesh
    trunk/data/models/models/to_004000/mdl_003178.mesh
    trunk/data/models/models/to_004000/mdl_003179.mesh
    trunk/data/models/models/to_004000/mdl_003309.mesh
    trunk/data/models/models/to_004000/mdl_003311.mesh
    trunk/data/models/models/to_004000/mdl_003324.mesh
    trunk/data/models/models/to_004000/mdl_003399.mesh
    trunk/data/models/models/to_004000/mdl_003429.mesh
    trunk/data/models/models/to_004000/mdl_003445.mesh
    trunk/data/models/models/to_004000/mdl_003464.mesh
    trunk/data/models/models/to_004000/mdl_003469.mesh
    trunk/data/models/models/to_004000/mdl_003494.mesh
    trunk/data/models/models/to_004000/mdl_003499.mesh
    trunk/data/models/models/to_004000/mdl_003634.mesh
    trunk/data/models/models/to_004000/mdl_003635.mesh
    trunk/data/models/models/to_004000/mdl_003644.mesh
    trunk/data/models/models/to_004000/mdl_003693.mesh
    trunk/data/models/models/to_004000/mdl_003697.mesh
    trunk/data/models/models/to_004000/mdl_003724.mesh
    trunk/data/models/models/to_004000/mdl_003734.mesh
    trunk/data/models/models/to_004000/mdl_003746.mesh
    trunk/data/models/models/to_004000/mdl_003748.mesh
    trunk/data/models/models/to_004000/mdl_003811.mesh
    trunk/data/models/models/to_004000/mdl_003814.mesh
    trunk/data/models/models/to_004000/mdl_003993.mesh
    trunk/data/models/models/to_005000/mdl_004117.mesh
    trunk/data/models/models/to_005000/mdl_004119.mesh
    trunk/data/models/models/to_005000/mdl_004122.mesh
    trunk/data/models/models/to_005000/mdl_004123.mesh
    trunk/data/models/models/to_005000/mdl_004124.mesh
    trunk/data/models/models/to_005000/mdl_004126.mesh
    trunk/data/models/models/to_005000/mdl_004193.mesh
    trunk/data/models/models/to_005000/mdl_004195.mesh
    trunk/data/models/models/to_005000/mdl_004210.mesh
    trunk/data/models/models/to_005000/mdl_004212.mesh
    trunk/data/models/models/to_005000/mdl_004260.mesh
    trunk/data/models/models/to_005000/mdl_004262.mesh
    trunk/data/models/models/to_005000/mdl_004483.mesh
    trunk/data/models/models/to_005000/mdl_004492.mesh
    trunk/data/models/models/to_005000/mdl_004493.mesh
    trunk/data/models/models/to_005000/mdl_004494.mesh
    trunk/data/models/models/to_005000/mdl_004496.mesh
    trunk/data/models/models/to_005000/mdl_004558.mesh
    trunk/data/models/models/to_005000/mdl_004615.mesh
    trunk/data/models/models/to_005000/mdl_004619.mesh
    trunk/data/models/models/to_005000/mdl_004838.mesh
    trunk/data/models/models/to_005000/mdl_004840.mesh
    trunk/data/models/models/to_005000/mdl_004843.mesh
    trunk/data/models/models/to_006000/mdl_005108.mesh
    trunk/data/models/models/to_006000/mdl_005453.mesh
    trunk/data/models/models/to_006000/mdl_005476.mesh
    trunk/data/models/models/to_006000/mdl_005478.mesh
    trunk/data/models/models/to_007000/mdl_006013.mesh
    trunk/data/models/models/to_007000/mdl_006039.mesh
    trunk/data/models/models/to_007000/mdl_006040.mesh
    trunk/data/models/models/to_007000/mdl_006041.mesh
    trunk/data/models/models/to_007000/mdl_006042.mesh
    trunk/data/models/models/to_007000/mdl_006043.mesh
    trunk/data/models/models/to_007000/mdl_006044.mesh
    trunk/data/models/models/to_007000/mdl_006424.mesh
    trunk/data/models/models/to_007000/mdl_006426.mesh
    trunk/data/models/models/to_007000/mdl_006429.mesh
    trunk/data/models/models/to_007000/mdl_006430.mesh
    trunk/data/models/models/to_007000/mdl_006523.mesh
    trunk/data/models/models/to_007000/mdl_006524.mesh
    trunk/data/models/models/to_007000/mdl_006525.mesh
    trunk/data/models/models/to_007000/mdl_006530.mesh
    trunk/data/models/models/to_007000/mdl_006532.mesh
    trunk/data/models/models/to_007000/mdl_006533.mesh
    trunk/data/models/models/to_007000/mdl_006534.mesh
    trunk/data/models/models/to_007000/mdl_006535.mesh
    trunk/data/models/models/to_007000/mdl_006536.mesh
    trunk/data/models/models/to_007000/mdl_006542.mesh
    trunk/data/models/models/to_007000/mdl_006544.mesh
    trunk/data/models/models/to_007000/mdl_006545.mesh
    trunk/data/models/models/to_007000/mdl_006547.mesh
    trunk/data/models/models/to_007000/mdl_006548.mesh
    trunk/data/models/models/to_007000/mdl_006549.mesh
    trunk/data/models/models/to_007000/mdl_006554.mesh
    trunk/data/models/models/to_007000/mdl_006556.mesh
    trunk/data/models/models/to_007000/mdl_006557.mesh
    trunk/data/models/models/to_007000/mdl_006559.mesh
    trunk/data/models/models/to_007000/mdl_006560.mesh
    trunk/data/models/models/to_007000/mdl_006561.mesh
    trunk/data/models/models/to_007000/mdl_006566.mesh
    trunk/data/models/models/to_007000/mdl_006568.mesh
    trunk/data/models/models/to_007000/mdl_006569.mesh
    trunk/data/models/models/to_007000/mdl_006658.mesh
    trunk/data/models/models/to_007000/mdl_006659.mesh
    trunk/data/models/models/to_007000/mdl_006660.mesh
    trunk/data/models/models/to_007000/mdl_006668.mesh
    trunk/data/models/models/to_008000/mdl_007037.mesh
    trunk/data/models/models/to_008000/mdl_007039.mesh
    trunk/data/models/models/to_008000/mdl_007591.mesh
    trunk/data/models/models/to_008000/mdl_007595.mesh
    trunk/data/models/models/to_008000/mdl_007634.mesh
    trunk/data/models/models/to_008000/mdl_007848.mesh
    trunk/data/models/models/to_008000/mdl_007849.mesh
    trunk/data/models/models/to_008000/mdl_007850.mesh
    trunk/data/models/models/to_008000/mdl_007852.mesh
    trunk/data/models/models/to_008000/mdl_007853.mesh
    trunk/data/models/models/to_008000/mdl_007855.mesh
    trunk/data/models/models/to_008000/mdl_007965.mesh
    trunk/data/models/models/to_008000/mdl_007979.mesh
    trunk/data/models/models/to_009000/mdl_008149.mesh
    trunk/data/models/models/to_009000/mdl_008150.mesh
    trunk/data/models/models/to_009000/mdl_008151.mesh
    trunk/data/models/models/to_009000/mdl_008152.mesh
    trunk/data/models/models/to_009000/mdl_008171.mesh
    trunk/data/models/models/to_009000/mdl_008173.mesh
    trunk/data/models/models/to_009000/mdl_008174.mesh
    trunk/data/models/models/to_009000/mdl_008176.mesh
    trunk/data/models/models/to_009000/mdl_008177.mesh
    trunk/data/models/models/to_009000/mdl_008178.mesh
    trunk/data/models/models/to_009000/mdl_008179.mesh
    trunk/data/models/models/to_009000/mdl_008180.mesh
    trunk/data/models/models/to_009000/mdl_008181.mesh
    trunk/data/models/models/to_009000/mdl_008183.mesh
    trunk/data/models/models/to_009000/mdl_008184.mesh
    trunk/data/models/models/to_009000/mdl_008185.mesh
    trunk/data/models/models/to_009000/mdl_008186.mesh
    trunk/data/models/models/to_009000/mdl_008188.mesh
    trunk/data/models/models/to_009000/mdl_008296.mesh
    trunk/data/models/models/to_009000/mdl_008314.mesh
    trunk/data/models/models/to_009000/mdl_008524.mesh
    trunk/data/models/models/to_009000/mdl_008525.mesh
    trunk/data/models/models/to_009000/mdl_008568.mesh
    trunk/data/models/models/to_009000/mdl_008571.mesh
    trunk/data/models/models/to_009000/mdl_008573.mesh
    trunk/data/models/models/to_009000/mdl_008575.mesh
    trunk/data/models/models/to_009000/mdl_008577.mesh
    trunk/data/models/models/to_009000/mdl_008578.mesh
    trunk/data/models/models/to_009000/mdl_008581.mesh
    trunk/data/models/models/to_009000/mdl_008582.mesh
    trunk/data/models/models/to_009000/mdl_008645.mesh
    trunk/data/models/models/to_009000/mdl_008646.mesh
    trunk/data/models/models/to_009000/mdl_008647.mesh
    trunk/data/models/models/to_009000/mdl_008648.mesh
    trunk/data/models/models/to_009000/mdl_008649.mesh
    trunk/data/models/models/to_009000/mdl_008650.mesh
    trunk/data/models/models/to_009000/mdl_008651.mesh
    trunk/data/models/models/to_009000/mdl_008652.mesh
    trunk/data/models/models/to_009000/mdl_008658.mesh
    trunk/data/models/models/to_009000/mdl_008659.mesh
    trunk/data/models/models/to_009000/mdl_008681.mesh
    trunk/data/models/models/to_009000/mdl_008682.mesh
    trunk/data/models/models/to_009000/mdl_008683.mesh
    trunk/data/models/models/to_009000/mdl_008684.mesh
    trunk/data/models/models/to_009000/mdl_008685.mesh
    trunk/data/models/models/to_009000/mdl_008686.mesh
    trunk/data/models/models/to_009000/mdl_008687.mesh
    trunk/data/models/models/to_009000/mdl_008688.mesh
    trunk/data/models/models/to_009000/mdl_008710.mesh
    trunk/data/models/models/to_009000/mdl_008711.mesh
    trunk/data/models/models/to_009000/mdl_008712.mesh
    trunk/data/models/models/to_009000/mdl_008713.mesh
    trunk/data/models/models/to_009000/mdl_008714.mesh
    trunk/data/models/models/to_009000/mdl_008715.mesh
    trunk/data/models/models/to_009000/mdl_008716.mesh
    trunk/data/models/models/to_009000/mdl_008717.mesh
    trunk/data/models/models/to_009000/mdl_008718.mesh
    trunk/data/models/models/to_009000/mdl_008720.mesh
    trunk/data/models/models/to_009000/mdl_008721.mesh
    trunk/data/models/models/to_009000/mdl_008722.mesh
    trunk/data/models/models/to_009000/mdl_008723.mesh
    trunk/data/models/models/to_009000/mdl_008724.mesh
    trunk/data/models/models/to_009000/mdl_008725.mesh
    trunk/data/models/models/to_009000/mdl_008726.mesh
    trunk/data/models/models/to_009000/mdl_008727.mesh
    trunk/data/models/models/to_009000/mdl_008728.mesh
    trunk/data/models/models/to_009000/mdl_008730.mesh
    trunk/data/models/models/to_009000/mdl_008731.mesh
    trunk/data/models/models/to_009000/mdl_008732.mesh
    trunk/data/models/models/to_009000/mdl_008733.mesh
    trunk/data/models/models/to_009000/mdl_008734.mesh
    trunk/data/models/models/to_009000/mdl_008735.mesh
    trunk/data/models/models/to_009000/mdl_008736.mesh
    trunk/data/models/models/to_009000/mdl_008737.mesh
    trunk/data/models/models/to_009000/mdl_008738.mesh
    trunk/data/models/models/to_009000/mdl_008740.mesh
    trunk/data/models/models/to_009000/mdl_008741.mesh
    trunk/data/models/models/to_009000/mdl_008742.mesh
    trunk/data/models/models/to_009000/mdl_008743.mesh
    trunk/data/models/models/to_009000/mdl_008744.mesh
    trunk/data/models/models/to_009000/mdl_008745.mesh
    trunk/data/models/models/to_009000/mdl_008746.mesh
    trunk/data/models/models/to_009000/mdl_008747.mesh
    trunk/data/models/models/to_009000/mdl_008748.mesh
    trunk/data/models/models/to_009000/mdl_008762.mesh
    trunk/data/models/models/to_009000/mdl_008763.mesh
    trunk/data/models/models/to_009000/mdl_008764.mesh
    trunk/data/models/models/to_009000/mdl_008766.mesh
    trunk/data/models/models/to_009000/mdl_008767.mesh
    trunk/data/models/models/to_009000/mdl_008768.mesh
    trunk/data/models/models/to_009000/mdl_008769.mesh
    trunk/data/models/models/to_009000/mdl_008770.mesh
    trunk/data/models/models/to_009000/mdl_008771.mesh
    trunk/data/models/models/to_009000/mdl_008772.mesh
    trunk/data/models/models/to_009000/mdl_008773.mesh
    trunk/data/models/models/to_009000/mdl_008774.mesh
    trunk/data/models/models/to_009000/mdl_008775.mesh
    trunk/data/models/models/to_009000/mdl_008776.mesh
    trunk/data/models/models/to_009000/mdl_008777.mesh
    trunk/data/models/models/to_009000/mdl_008977.mesh
    trunk/data/models/models/to_009000/mdl_008978.mesh
    trunk/data/models/models/to_010000/mdl_009373.mesh
    trunk/data/models/models/to_010000/mdl_009947.mesh
    trunk/data/models/models/to_010000/mdl_009952.mesh
    trunk/data/models/models/to_010000/mdl_009953.mesh
    trunk/data/models/models/to_010000/mdl_009959.mesh
    trunk/data/models/models/to_010000/mdl_009960.mesh
    trunk/data/models/models/to_010000/mdl_009963.mesh
    trunk/data/models/models/to_010000/mdl_009977.mesh
    trunk/data/models/models/to_010000/mdl_009983.mesh
    trunk/data/models/models/to_010000/mdl_009988.mesh
    trunk/data/models/models/to_010000/mdl_009989.mesh
    trunk/data/models/models/to_010000/mdl_009991.mesh
    trunk/data/models/models/to_010000/mdl_009995.mesh
    trunk/data/models/models/to_012000/mdl_011300.mesh
    trunk/data/models/models/to_012000/mdl_011301.mesh
    trunk/data/models/models/to_012000/mdl_011302.mesh
    trunk/data/models/models/to_012000/mdl_011303.mesh
    trunk/data/models/models/to_012000/mdl_011304.mesh
    trunk/data/models/models/to_012000/mdl_011305.mesh
    trunk/data/models/models/to_012000/mdl_011306.mesh
    trunk/data/models/models/to_012000/mdl_011307.mesh
    trunk/data/models/models/to_012000/mdl_011308.mesh
    trunk/data/models/models/to_012000/mdl_011309.mesh
    trunk/data/models/models/to_012000/mdl_011310.mesh
    trunk/data/models/models/to_012000/mdl_011311.mesh
    trunk/data/models/models/to_012000/mdl_011312.mesh
    trunk/data/models/models/to_012000/mdl_011313.mesh
    trunk/data/models/models/to_012000/mdl_011314.mesh
    trunk/data/models/models/to_012000/mdl_011316.mesh
    trunk/data/models/models/to_012000/mdl_011317.mesh
    trunk/data/models/models/to_012000/mdl_011330.mesh
    trunk/data/models/models/to_012000/mdl_011331.mesh
    trunk/data/models/models/to_012000/mdl_011332.mesh
    trunk/data/models/models/to_012000/mdl_011333.mesh
    trunk/data/models/models/to_012000/mdl_011334.mesh
    trunk/data/models/models/to_012000/mdl_011335.mesh
    trunk/data/models/models/to_012000/mdl_011336.mesh
    trunk/data/models/models/to_012000/mdl_011337.mesh
    trunk/data/models/models/to_012000/mdl_011338.mesh
    trunk/data/models/models/to_012000/mdl_011339.mesh
    trunk/data/models/models/to_012000/mdl_011340.mesh
    trunk/data/models/models/to_012000/mdl_011341.mesh
    trunk/data/models/models/to_012000/mdl_011342.mesh
    trunk/data/models/models/to_012000/mdl_011343.mesh
    trunk/data/models/models/to_012000/mdl_011344.mesh
    trunk/data/models/models/to_012000/mdl_011346.mesh
    trunk/data/models/models/to_012000/mdl_011357.mesh
    trunk/data/models/models/to_012000/mdl_011358.mesh
    trunk/data/models/models/to_012000/mdl_011359.mesh
    trunk/data/models/models/to_013000/mdl_012583.mesh
    trunk/data/models/models/to_013000/mdl_012813.mesh
    trunk/data/models/models/to_013000/mdl_012814.mesh
    trunk/data/models/models/to_013000/mdl_012826.mesh
    trunk/data/models/models/to_013000/mdl_012833.mesh
    trunk/data/models/models/to_013000/mdl_012834.mesh
    trunk/data/models/models/to_013000/mdl_012835.mesh
    trunk/data/models/models/to_013000/mdl_012836.mesh
    trunk/data/models/models/to_013000/mdl_012838.mesh
    trunk/data/models/models/to_013000/mdl_012839.mesh
    trunk/data/models/models/to_013000/mdl_012840.mesh
    trunk/data/models/models/to_013000/mdl_012841.mesh
    trunk/data/models/models/to_013000/mdl_012842.mesh
    trunk/data/models/models/to_013000/mdl_012854.mesh
    trunk/data/models/models/to_013000/mdl_012865.mesh
    trunk/data/models/models/to_013000/mdl_012909.mesh
    trunk/data/models/models/to_013000/mdl_012910.mesh
    trunk/data/models/models/to_013000/mdl_012911.mesh
    trunk/data/models/models/to_014000/mdl_013422.mesh
    trunk/data/models/models/to_014000/mdl_013423.mesh
    trunk/data/models/models/to_014000/mdl_013424.mesh
    trunk/data/models/models/to_014000/mdl_013425.mesh
    trunk/data/models/models/to_014000/mdl_013426.mesh
    trunk/data/models/models/to_014000/mdl_013427.mesh
    trunk/data/models/models/to_014000/mdl_013428.mesh
    trunk/data/models/models/to_014000/mdl_013429.mesh
    trunk/data/models/models/to_014000/mdl_013430.mesh
    trunk/data/models/models/to_014000/mdl_013431.mesh
    trunk/data/models/models/to_014000/mdl_013432.mesh
    trunk/data/models/models/to_014000/mdl_013433.mesh
    trunk/data/models/models/to_014000/mdl_013434.mesh
    trunk/data/models/models/to_014000/mdl_013435.mesh
    trunk/data/models/models/to_014000/mdl_013436.mesh
    trunk/data/models/models/to_014000/mdl_013437.mesh
    trunk/data/models/models/to_014000/mdl_013438.mesh
    trunk/data/models/models/to_014000/mdl_013439.mesh
    trunk/data/models/models/to_014000/mdl_013440.mesh
    trunk/data/models/models/to_014000/mdl_013441.mesh
    trunk/data/models/models/to_014000/mdl_013442.mesh
    trunk/data/models/models/to_014000/mdl_013443.mesh
    trunk/data/models/models/to_014000/mdl_013444.mesh
    trunk/data/models/models/to_014000/mdl_013445.mesh
    trunk/data/models/models/to_014000/mdl_013456.mesh
    trunk/data/models/models/to_014000/mdl_013457.mesh
    trunk/data/models/models/to_014000/mdl_013458.mesh
    trunk/data/models/models/to_014000/mdl_013459.mesh
    trunk/data/models/models/to_014000/mdl_013460.mesh
    trunk/data/models/models/to_014000/mdl_013461.mesh
    trunk/data/models/models/to_014000/mdl_013462.mesh
    trunk/data/models/models/to_014000/mdl_013463.mesh
    trunk/data/models/models/to_014000/mdl_013464.mesh
    trunk/data/models/models/to_014000/mdl_013465.mesh
    trunk/data/models/models/to_014000/mdl_013466.mesh
    trunk/data/models/models/to_014000/mdl_013467.mesh
    trunk/data/models/models/to_014000/mdl_013468.mesh
    trunk/data/models/models/to_014000/mdl_013469.mesh
    trunk/data/models/models/to_014000/mdl_013470.mesh
    trunk/data/models/models/to_014000/mdl_013471.mesh
    trunk/data/models/models/to_014000/mdl_013472.mesh
    trunk/data/models/models/to_014000/mdl_013473.mesh
    trunk/data/models/models/to_014000/mdl_013474.mesh
    trunk/data/models/models/to_014000/mdl_013475.mesh
    trunk/data/models/models/to_014000/mdl_013476.mesh
    trunk/data/models/models/to_014000/mdl_013477.mesh
    trunk/data/models/models/to_014000/mdl_013478.mesh
    trunk/data/models/models/to_014000/mdl_013479.mesh
    trunk/data/models/models/to_014000/mdl_013480.mesh
    trunk/data/models/models/to_014000/mdl_013481.mesh
    trunk/data/models/models/to_014000/mdl_013482.mesh
    trunk/data/models/models/to_014000/mdl_013483.mesh
    trunk/data/models/models/to_014000/mdl_013493.mesh
    trunk/data/models/models/to_014000/mdl_013494.mesh
    trunk/data/models/models/to_014000/mdl_013496.mesh
    trunk/data/models/models/to_014000/mdl_013497.mesh
    trunk/data/models/models/to_014000/mdl_013498.mesh
    trunk/data/models/models/to_014000/mdl_013499.mesh
    trunk/data/models/models/to_014000/mdl_013501.mesh
    trunk/data/models/models/to_014000/mdl_013502.mesh
    trunk/data/models/models/to_014000/mdl_013503.mesh
    trunk/data/models/models/to_014000/mdl_013504.mesh
    trunk/data/models/models/to_014000/mdl_013506.mesh
    trunk/data/models/models/to_014000/mdl_013507.mesh
    trunk/data/models/models/to_014000/mdl_013508.mesh
    trunk/data/models/models/to_014000/mdl_013509.mesh
    trunk/data/models/models/to_014000/mdl_013511.mesh
    trunk/data/models/models/to_014000/mdl_013512.mesh
    trunk/data/models/models/to_014000/mdl_013513.mesh
    trunk/data/models/models/to_014000/mdl_013514.mesh
    trunk/data/models/models/to_014000/mdl_013521.mesh
    trunk/data/models/models/to_014000/mdl_013522.mesh
    trunk/data/models/models/to_014000/mdl_013523.mesh
    trunk/data/models/models/to_014000/mdl_013524.mesh
    trunk/data/models/models/to_014000/mdl_013525.mesh
    trunk/data/models/models/to_014000/mdl_013550.mesh
    trunk/data/models/models/to_014000/mdl_013551.mesh
    trunk/data/models/models/to_014000/mdl_013552.mesh
    trunk/data/models/models/to_014000/mdl_013553.mesh
    trunk/data/models/models/to_014000/mdl_013554.mesh
    trunk/data/models/models/to_014000/mdl_013555.mesh
    trunk/data/models/models/to_014000/mdl_013556.mesh
    trunk/data/models/models/to_014000/mdl_013558.mesh
    trunk/data/models/models/to_014000/mdl_013559.mesh
    trunk/data/models/models/to_014000/mdl_013560.mesh
    trunk/data/models/models/to_014000/mdl_013561.mesh
    trunk/data/models/models/to_014000/mdl_013562.mesh
    trunk/data/models/models/to_014000/mdl_013563.mesh
    trunk/data/models/models/to_014000/mdl_013564.mesh
    trunk/data/models/models/to_014000/mdl_013565.mesh
    trunk/data/models/models/to_014000/mdl_013567.mesh
    trunk/data/models/models/to_014000/mdl_013568.mesh
    trunk/data/models/models/to_014000/mdl_013569.mesh
    trunk/data/models/models/to_014000/mdl_013571.mesh
    trunk/data/models/models/to_014000/mdl_013572.mesh
    trunk/data/models/models/to_014000/mdl_013573.mesh
    trunk/data/models/models/to_014000/mdl_013574.mesh
    trunk/data/models/models/to_014000/mdl_013575.mesh
    trunk/data/models/models/to_014000/mdl_013576.mesh
    trunk/data/models/models/to_014000/mdl_013577.mesh
    trunk/data/models/models/to_014000/mdl_013581.mesh
    trunk/data/models/models/to_014000/mdl_013582.mesh
    trunk/data/models/models/to_014000/mdl_013583.mesh
    trunk/data/models/models/to_014000/mdl_013584.mesh
    trunk/data/models/models/to_014000/mdl_013585.mesh
    trunk/data/models/models/to_014000/mdl_013586.mesh
    trunk/data/models/models/to_014000/mdl_013587.mesh
    trunk/data/models/models/to_014000/mdl_013588.mesh
    trunk/data/models/models/to_014000/mdl_013590.mesh
    trunk/data/models/models/to_014000/mdl_013591.mesh
    trunk/data/models/models/to_014000/mdl_013593.mesh
    trunk/data/models/models/to_014000/mdl_013594.mesh
    trunk/data/models/models/to_014000/mdl_013595.mesh
    trunk/data/models/models/to_014000/mdl_013596.mesh
    trunk/data/models/models/to_014000/mdl_013597.mesh
    trunk/data/models/models/to_014000/mdl_013598.mesh
    trunk/data/models/models/to_014000/mdl_013599.mesh
    trunk/data/models/models/to_014000/mdl_013600.mesh
    trunk/data/models/models/to_014000/mdl_013601.mesh
    trunk/data/models/models/to_014000/mdl_013602.mesh
    trunk/data/models/models/to_014000/mdl_013603.mesh
    trunk/data/models/models/to_014000/mdl_013604.mesh
    trunk/data/models/models/to_014000/mdl_013605.mesh
    trunk/data/models/models/to_014000/mdl_013606.mesh
    trunk/data/models/models/to_014000/mdl_013607.mesh
    trunk/data/models/models/to_014000/mdl_013639.mesh
    trunk/data/models/models/to_014000/mdl_013640.mesh
    trunk/data/models/models/to_014000/mdl_013642.mesh
    trunk/data/models/models/to_014000/mdl_013643.mesh
    trunk/data/models/models/to_014000/mdl_013644.mesh
    trunk/data/models/models/to_015000/mdl_014013.mesh
    trunk/data/models/models/to_015000/mdl_014036.mesh
    trunk/data/models/models/to_015000/mdl_014037.mesh
    trunk/data/models/models/to_015000/mdl_014038.mesh
    trunk/data/models/models/to_015000/mdl_014039.mesh
    trunk/data/models/models/to_015000/mdl_014040.mesh
    trunk/data/models/models/to_015000/mdl_014041.mesh
    trunk/data/models/models/to_015000/mdl_014042.mesh
    trunk/data/models/models/to_015000/mdl_014045.mesh
    trunk/data/models/models/to_015000/mdl_014046.mesh
    trunk/data/models/models/to_015000/mdl_014047.mesh
    trunk/data/models/models/to_015000/mdl_014048.mesh
    trunk/data/models/models/to_015000/mdl_014049.mesh
    trunk/data/models/models/to_015000/mdl_014050.mesh
    trunk/data/models/models/to_015000/mdl_014051.mesh
    trunk/data/models/models/to_017000/mdl_016004.mesh
    trunk/data/models/models/to_017000/mdl_016007.mesh
    trunk/data/models/models/to_017000/mdl_016009.mesh
    trunk/data/models/models/to_017000/mdl_016083.mesh
    trunk/data/models/models/to_017000/mdl_016085.mesh
Modified:
    trunk/lua/filter/filter.art.lua

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Sat Jan 10 20:12:10 2009
@@ -398,7 +398,920 @@
 =

 --zaun
 gArtFilter[2187]=3D{maptoid=3D2186,rotation=3D"x:0,y:0,z:90",xadd=3D0,yadd=
=3D1,zadd=3D0}
-
+gArtFilter[2579]=3D{maptoid=3D2580}
+gArtFilter[2578]=3D{maptoid=3D2580}
+gArtFilter[8296]=3D{maptoid=3D2420}
+gArtFilter[2106]=3D{maptoid=3D2119}
+gArtFilter[2600]=3D{maptoid=3D2577}
+gArtFilter[2576]=3D{maptoid=3D2577}
+gArtFilter[2575]=3D{maptoid=3D2577}
+gArtFilter[4492]=3D{maptoid=3D2960}
+gArtFilter[4494]=3D{maptoid=3D2960}
+gArtFilter[7595]=3D{maptoid=3D2960}
+gArtFilter[4558]=3D{maptoid=3D2672}
+gArtFilter[2205]=3D{maptoid=3D2203}
+gArtFilter[2204]=3D{maptoid=3D2203}
+gArtFilter[2375]=3D{maptoid=3D2374}
+gArtFilter[2376]=3D{maptoid=3D2374}
+gArtFilter[2371]=3D{maptoid=3D2374}
+gArtFilter[2377]=3D{maptoid=3D2374}
+gArtFilter[2378]=3D{maptoid=3D2374}
+gArtFilter[2373]=3D{maptoid=3D2374}
+gArtFilter[2008]=3D{maptoid=3D2298}
+gArtFilter[2894]=3D{maptoid=3D2898}
+gArtFilter[2932]=3D{maptoid=3D2931}
+gArtFilter[2096]=3D{maptoid=3D2089}
+gArtFilter[2092]=3D{maptoid=3D2089}
+gArtFilter[2869]=3D{maptoid=3D2870}
+gArtFilter[2970]=3D{maptoid=3D2968}
+gArtFilter[2107]=3D{maptoid=3D2118}
+gArtFilter[2151]=3D{maptoid=3D2153}
+gArtFilter[2138]=3D{maptoid=3D2125}
+gArtFilter[2134]=3D{maptoid=3D2125}
+gArtFilter[2326]=3D{maptoid=3D2325}
+gArtFilter[2327]=3D{maptoid=3D2325}
+gArtFilter[2328]=3D{maptoid=3D2325}
+gArtFilter[2830]=3D{maptoid=3D2825}
+gArtFilter[8314]=3D{maptoid=3D2421}
+gArtFilter[2160]=3D{maptoid=3D2164}
+gArtFilter[2872]=3D{maptoid=3D2873}
+gArtFilter[2896]=3D{maptoid=3D2900}
+gArtFilter[2137]=3D{maptoid=3D2126}
+gArtFilter[2130]=3D{maptoid=3D2126}
+gArtFilter[2139]=3D{maptoid=3D2126}
+gArtFilter[2440]=3D{maptoid=3D2442}
+gArtFilter[2818]=3D{maptoid=3D2816}
+gArtFilter[2817]=3D{maptoid=3D2816}
+gArtFilter[2831]=3D{maptoid=3D2816}
+gArtFilter[2595]=3D{maptoid=3D2596}
+gArtFilter[2594]=3D{maptoid=3D2596}
+gArtFilter[2129]=3D{maptoid=3D2136}
+gArtFilter[2132]=3D{maptoid=3D2136}
+gArtFilter[2581]=3D{maptoid=3D2582}
+gArtFilter[2583]=3D{maptoid=3D2582}
+gArtFilter[2128]=3D{maptoid=3D2135}
+gArtFilter[2124]=3D{maptoid=3D2135}
+gArtFilter[2110]=3D{maptoid=3D2117}
+gArtFilter[2111]=3D{maptoid=3D2120}
+gArtFilter[2155]=3D{maptoid=3D2162}
+gArtFilter[2158]=3D{maptoid=3D2162}
+gArtFilter[2404]=3D{maptoid=3D2406}
+gArtFilter[2405]=3D{maptoid=3D2406}
+gArtFilter[2399]=3D{maptoid=3D2406}
+gArtFilter[2403]=3D{maptoid=3D2406}
+gArtFilter[2402]=3D{maptoid=3D2406}
+gArtFilter[2401]=3D{maptoid=3D2406}
+gArtFilter[2156]=3D{maptoid=3D2163}
+gArtFilter[2165]=3D{maptoid=3D2163}
+gArtFilter[2152]=3D{maptoid=3D2163}
+gArtFilter[2823]=3D{maptoid=3D2824}
+gArtFilter[2154]=3D{maptoid=3D2161}
+gArtFilter[2150]=3D{maptoid=3D2161}
+gArtFilter[2958]=3D{maptoid=3D2957}
+gArtFilter[4496]=3D{maptoid=3D2957}
+gArtFilter[2967]=3D{maptoid=3D2969}
+gArtFilter[2357]=3D{maptoid=3D2360}
+gArtFilter[2361]=3D{maptoid=3D2360}
+gArtFilter[2347]=3D{maptoid=3D2360}
+gArtFilter[2255]=3D{maptoid=3D2360}
+gArtFilter[2362]=3D{maptoid=3D2360}
+gArtFilter[2363]=3D{maptoid=3D2360}
+gArtFilter[2364]=3D{maptoid=3D2360}
+gArtFilter[2359]=3D{maptoid=3D2360}
+gArtFilter[2588]=3D{maptoid=3D2586}
+gArtFilter[2587]=3D{maptoid=3D2586}
+gArtFilter[2143]=3D{maptoid=3D2149}
+gArtFilter[2712]=3D{maptoid=3D2715}
+gArtFilter[2895]=3D{maptoid=3D2899}
+gArtFilter[2201]=3D{maptoid=3D2202}
+gArtFilter[2206]=3D{maptoid=3D2202}
+gArtFilter[2901]=3D{maptoid=3D2897}
+gArtFilter[2519]=3D{maptoid=3D2522}
+gArtFilter[2521]=3D{maptoid=3D2522}
+gArtFilter[2523]=3D{maptoid=3D2522}
+gArtFilter[2479]=3D{maptoid=3D2522}
+gArtFilter[2585]=3D{maptoid=3D2522}
+gArtFilter[2478]=3D{maptoid=3D2522}
+gArtFilter[2520]=3D{maptoid=3D2522}
+gArtFilter[2939]=3D{maptoid=3D2938}
+gArtFilter[2097]=3D{maptoid=3D2090}
+gArtFilter[2099]=3D{maptoid=3D2090}
+gArtFilter[2086]=3D{maptoid=3D2090}
+gArtFilter[2573]=3D{maptoid=3D2572}
+gArtFilter[2574]=3D{maptoid=3D2572}
+gArtFilter[2570]=3D{maptoid=3D2572}
+gArtFilter[2085]=3D{maptoid=3D2098}
+gArtFilter[2094]=3D{maptoid=3D2098}
+gArtFilter[2084]=3D{maptoid=3D2088}
+gArtFilter[2095]=3D{maptoid=3D2088}
+gArtFilter[2297]=3D{maptoid=3D2007}
+gArtFilter[2266]=3D{maptoid=3D2391}
+gArtFilter[2392]=3D{maptoid=3D2391}
+gArtFilter[2389]=3D{maptoid=3D2391}
+gArtFilter[2385]=3D{maptoid=3D2391}
+gArtFilter[2387]=3D{maptoid=3D2391}
+gArtFilter[2390]=3D{maptoid=3D2391}
+gArtFilter[2388]=3D{maptoid=3D2391}
+gArtFilter[2713]=3D{maptoid=3D2716}
+gArtFilter[2951]=3D{maptoid=3D2950}
+gArtFilter[2567]=3D{maptoid=3D2569}
+gArtFilter[2565]=3D{maptoid=3D2569}
+gArtFilter[2568]=3D{maptoid=3D2569}
+gArtFilter[16007]=3D{maptoid=3D16005}
+gArtFilter[16083]=3D{maptoid=3D16084}
+gArtFilter[16085]=3D{maptoid=3D16084}
+gArtFilter[16009]=3D{maptoid=3D16006}
+gArtFilter[16004]=3D{maptoid=3D16006}
+gArtFilter[8573]=3D{maptoid=3D8572}
+gArtFilter[8582]=3D{maptoid=3D8583}
+gArtFilter[8577]=3D{maptoid=3D8576}
+gArtFilter[8571]=3D{maptoid=3D8570}
+gArtFilter[8568]=3D{maptoid=3D8569}
+gArtFilter[8174]=3D{maptoid=3D8187}
+gArtFilter[8183]=3D{maptoid=3D8187}
+gArtFilter[8179]=3D{maptoid=3D8175}
+gArtFilter[8188]=3D{maptoid=3D8175}
+gArtFilter[8186]=3D{maptoid=3D8175}
+gArtFilter[8581]=3D{maptoid=3D8580}
+gArtFilter[8767]=3D{maptoid=3D8765}
+gArtFilter[8773]=3D{maptoid=3D8765}
+gArtFilter[8764]=3D{maptoid=3D8765}
+gArtFilter[8763]=3D{maptoid=3D8765}
+gArtFilter[8775]=3D{maptoid=3D8765}
+gArtFilter[8774]=3D{maptoid=3D8765}
+gArtFilter[8768]=3D{maptoid=3D8765}
+gArtFilter[8766]=3D{maptoid=3D8765}
+gArtFilter[8770]=3D{maptoid=3D8765}
+gArtFilter[8772]=3D{maptoid=3D8765}
+gArtFilter[8771]=3D{maptoid=3D8765}
+gArtFilter[8776]=3D{maptoid=3D8765}
+gArtFilter[8762]=3D{maptoid=3D8765}
+gArtFilter[8777]=3D{maptoid=3D8765}
+gArtFilter[8769]=3D{maptoid=3D8765}
+gArtFilter[8578]=3D{maptoid=3D8579}
+gArtFilter[8575]=3D{maptoid=3D8574}
+gArtFilter[8171]=3D{maptoid=3D8170}
+gArtFilter[4840]=3D{maptoid=3D4844}
+gArtFilter[4195]=3D{maptoid=3D4191}
+gArtFilter[4126]=3D{maptoid=3D4125}
+gArtFilter[4124]=3D{maptoid=3D4125}
+gArtFilter[4210]=3D{maptoid=3D4208}
+gArtFilter[4212]=3D{maptoid=3D4214}
+gArtFilter[4260]=3D{maptoid=3D4261}
+gArtFilter[4262]=3D{maptoid=3D4261}
+gArtFilter[4193]=3D{maptoid=3D4197}
+gArtFilter[4493]=3D{maptoid=3D4491}
+gArtFilter[7591]=3D{maptoid=3D4491}
+gArtFilter[4838]=3D{maptoid=3D4842}
+gArtFilter[4615]=3D{maptoid=3D4618}
+gArtFilter[4123]=3D{maptoid=3D4121}
+gArtFilter[4122]=3D{maptoid=3D4121}
+gArtFilter[4619]=3D{maptoid=3D4616}
+gArtFilter[4483]=3D{maptoid=3D4484}
+gArtFilter[4119]=3D{maptoid=3D4118}
+gArtFilter[4117]=3D{maptoid=3D4118}
+gArtFilter[4843]=3D{maptoid=3D4839}
+gArtFilter[77]=3D{maptoid=3D52}
+gArtFilter[532]=3D{maptoid=3D527}
+gArtFilter[155]=3D{maptoid=3D158}
+gArtFilter[2296]=3D{maptoid=3D103}
+gArtFilter[135]=3D{maptoid=3D123}
+gArtFilter[924]=3D{maptoid=3D321}
+gArtFilter[483]=3D{maptoid=3D480}
+gArtFilter[856]=3D{maptoid=3D852}
+gArtFilter[854]=3D{maptoid=3D852}
+gArtFilter[865]=3D{maptoid=3D852}
+gArtFilter[863]=3D{maptoid=3D852}
+gArtFilter[858]=3D{maptoid=3D852}
+gArtFilter[867]=3D{maptoid=3D852}
+gArtFilter[8650]=3D{maptoid=3D148}
+gArtFilter[8645]=3D{maptoid=3D148}
+gArtFilter[8646]=3D{maptoid=3D148}
+gArtFilter[8649]=3D{maptoid=3D148}
+gArtFilter[502]=3D{maptoid=3D740}
+gArtFilter[1107]=3D{maptoid=3D696}
+gArtFilter[492]=3D{maptoid=3D433}
+gArtFilter[126]=3D{maptoid=3D138}
+gArtFilter[817]=3D{maptoid=3D808}
+gArtFilter[815]=3D{maptoid=3D808}
+gArtFilter[806]=3D{maptoid=3D808}
+gArtFilter[804]=3D{maptoid=3D808}
+gArtFilter[819]=3D{maptoid=3D808}
+gArtFilter[810]=3D{maptoid=3D808}
+gArtFilter[505]=3D{maptoid=3D743}
+gArtFilter[227]=3D{maptoid=3D214}
+gArtFilter[224]=3D{maptoid=3D213}
+gArtFilter[850]=3D{maptoid=3D844}
+gArtFilter[167]=3D{maptoid=3D844}
+gArtFilter[837]=3D{maptoid=3D844}
+gArtFilter[848]=3D{maptoid=3D844}
+gArtFilter[846]=3D{maptoid=3D844}
+gArtFilter[841]=3D{maptoid=3D844}
+gArtFilter[1090]=3D{maptoid=3D279}
+gArtFilter[1057]=3D{maptoid=3D545}
+gArtFilter[911]=3D{maptoid=3D916}
+gArtFilter[918]=3D{maptoid=3D916}
+gArtFilter[8659]=3D{maptoid=3D949}
+gArtFilter[428]=3D{maptoid=3D425}
+gArtFilter[164]=3D{maptoid=3D162}
+gArtFilter[399]=3D{maptoid=3D401}
+gArtFilter[76]=3D{maptoid=3D75}
+gArtFilter[212]=3D{maptoid=3D198}
+gArtFilter[448]=3D{maptoid=3D443}
+gArtFilter[842]=3D{maptoid=3D836}
+gArtFilter[838]=3D{maptoid=3D836}
+gArtFilter[168]=3D{maptoid=3D836}
+gArtFilter[840]=3D{maptoid=3D836}
+gArtFilter[847]=3D{maptoid=3D836}
+gArtFilter[851]=3D{maptoid=3D836}
+gArtFilter[849]=3D{maptoid=3D836}
+gArtFilter[734]=3D{maptoid=3D496}
+gArtFilter[744]=3D{maptoid=3D496}
+gArtFilter[238]=3D{maptoid=3D247}
+gArtFilter[232]=3D{maptoid=3D247}
+gArtFilter[243]=3D{maptoid=3D247}
+gArtFilter[234]=3D{maptoid=3D247}
+gArtFilter[245]=3D{maptoid=3D247}
+gArtFilter[236]=3D{maptoid=3D247}
+gArtFilter[2295]=3D{maptoid=3D104}
+gArtFilter[677]=3D{maptoid=3D694}
+gArtFilter[1105]=3D{maptoid=3D694}
+gArtFilter[495]=3D{maptoid=3D410}
+gArtFilter[424]=3D{maptoid=3D441}
+gArtFilter[563]=3D{maptoid=3D737}
+gArtFilter[875]=3D{maptoid=3D737}
+gArtFilter[450]=3D{maptoid=3D446}
+gArtFilter[105]=3D{maptoid=3D99}
+gArtFilter[796]=3D{maptoid=3D795}
+gArtFilter[791]=3D{maptoid=3D795}
+gArtFilter[798]=3D{maptoid=3D795}
+gArtFilter[8647]=3D{maptoid=3D149}
+gArtFilter[8652]=3D{maptoid=3D149}
+gArtFilter[8651]=3D{maptoid=3D149}
+gArtFilter[8648]=3D{maptoid=3D149}
+gArtFilter[94]=3D{maptoid=3D92}
+gArtFilter[221]=3D{maptoid=3D231}
+gArtFilter[855]=3D{maptoid=3D859}
+gArtFilter[860]=3D{maptoid=3D859}
+gArtFilter[143]=3D{maptoid=3D133}
+gArtFilter[531]=3D{maptoid=3D537}
+gArtFilter[926]=3D{maptoid=3D323}
+gArtFilter[83]=3D{maptoid=3D78}
+gArtFilter[50]=3D{maptoid=3D46}
+gArtFilter[793]=3D{maptoid=3D802}
+gArtFilter[789]=3D{maptoid=3D802}
+gArtFilter[800]=3D{maptoid=3D802}
+gArtFilter[535]=3D{maptoid=3D530}
+gArtFilter[974]=3D{maptoid=3D988}
+gArtFilter[235]=3D{maptoid=3D239}
+gArtFilter[230]=3D{maptoid=3D222}
+gArtFilter[678]=3D{maptoid=3D695}
+gArtFilter[1106]=3D{maptoid=3D695}
+gArtFilter[129]=3D{maptoid=3D132}
+gArtFilter[130]=3D{maptoid=3D132}
+gArtFilter[128]=3D{maptoid=3D132}
+gArtFilter[853]=3D{maptoid=3D862}
+gArtFilter[857]=3D{maptoid=3D862}
+gArtFilter[866]=3D{maptoid=3D862}
+gArtFilter[864]=3D{maptoid=3D862}
+gArtFilter[127]=3D{maptoid=3D139}
+gArtFilter[843]=3D{maptoid=3D839}
+gArtFilter[108]=3D{maptoid=3D102}
+gArtFilter[1104]=3D{maptoid=3D693}
+gArtFilter[938]=3D{maptoid=3D940}
+gArtFilter[941]=3D{maptoid=3D940}
+gArtFilter[939]=3D{maptoid=3D940}
+gArtFilter[91]=3D{maptoid=3D93}
+gArtFilter[494]=3D{maptoid=3D409}
+gArtFilter[1073]=3D{maptoid=3D546}
+gArtFilter[1058]=3D{maptoid=3D546}
+gArtFilter[1072]=3D{maptoid=3D546}
+gArtFilter[81]=3D{maptoid=3D79}
+gArtFilter[9373]=3D{maptoid=3D515}
+gArtFilter[821]=3D{maptoid=3D8}
+gArtFilter[832]=3D{maptoid=3D8}
+gArtFilter[830]=3D{maptoid=3D8}
+gArtFilter[828]=3D{maptoid=3D8}
+gArtFilter[825]=3D{maptoid=3D8}
+gArtFilter[834]=3D{maptoid=3D8}
+gArtFilter[742]=3D{maptoid=3D504}
+gArtFilter[407]=3D{maptoid=3D435}
+gArtFilter[917]=3D{maptoid=3D910}
+gArtFilter[915]=3D{maptoid=3D910}
+gArtFilter[201]=3D{maptoid=3D242}
+gArtFilter[246]=3D{maptoid=3D237}
+gArtFilter[240]=3D{maptoid=3D237}
+gArtFilter[233]=3D{maptoid=3D237}
+gArtFilter[244]=3D{maptoid=3D237}
+gArtFilter[451]=3D{maptoid=3D447}
+gArtFilter[373]=3D{maptoid=3D375}
+gArtFilter[376]=3D{maptoid=3D375}
+gArtFilter[475]=3D{maptoid=3D469}
+gArtFilter[481]=3D{maptoid=3D485}
+gArtFilter[322]=3D{maptoid=3D925}
+gArtFilter[807]=3D{maptoid=3D811}
+gArtFilter[2104]=3D{maptoid=3D950}
+gArtFilter[100]=3D{maptoid=3D106}
+gArtFilter[636]=3D{maptoid=3D106}
+gArtFilter[497]=3D{maptoid=3D745}
+gArtFilter[735]=3D{maptoid=3D745}
+gArtFilter[994]=3D{maptoid=3D984}
+gArtFilter[812]=3D{maptoid=3D809}
+gArtFilter[818]=3D{maptoid=3D809}
+gArtFilter[814]=3D{maptoid=3D809}
+gArtFilter[805]=3D{maptoid=3D809}
+gArtFilter[816]=3D{maptoid=3D809}
+gArtFilter[790]=3D{maptoid=3D803}
+gArtFilter[799]=3D{maptoid=3D803}
+gArtFilter[797]=3D{maptoid=3D803}
+gArtFilter[792]=3D{maptoid=3D803}
+gArtFilter[577]=3D{maptoid=3D803}
+gArtFilter[788]=3D{maptoid=3D803}
+gArtFilter[794]=3D{maptoid=3D803}
+gArtFilter[801]=3D{maptoid=3D803}
+gArtFilter[1093]=3D{maptoid=3D282}
+gArtFilter[746]=3D{maptoid=3D736}
+gArtFilter[159]=3D{maptoid=3D156}
+gArtFilter[436]=3D{maptoid=3D408}
+gArtFilter[294]=3D{maptoid=3D281}
+gArtFilter[1092]=3D{maptoid=3D281}
+gArtFilter[12583]=3D{maptoid=3D26}
+gArtFilter[163]=3D{maptoid=3D165}
+gArtFilter[131]=3D{maptoid=3D141}
+gArtFilter[935]=3D{maptoid=3D937}
+gArtFilter[826]=3D{maptoid=3D7}
+gArtFilter[835]=3D{maptoid=3D7}
+gArtFilter[820]=3D{maptoid=3D7}
+gArtFilter[831]=3D{maptoid=3D7}
+gArtFilter[833]=3D{maptoid=3D7}
+gArtFilter[824]=3D{maptoid=3D7}
+gArtFilter[822]=3D{maptoid=3D7}
+gArtFilter[914]=3D{maptoid=3D909}
+gArtFilter[8658]=3D{maptoid=3D948}
+gArtFilter[47]=3D{maptoid=3D49}
+gArtFilter[943]=3D{maptoid=3D942}
+gArtFilter[944]=3D{maptoid=3D942}
+gArtFilter[280]=3D{maptoid=3D293}
+gArtFilter[1091]=3D{maptoid=3D293}
+gArtFilter[427]=3D{maptoid=3D422}
+gArtFilter[8745]=3D{maptoid=3D730}
+gArtFilter[8721]=3D{maptoid=3D730}
+gArtFilter[8732]=3D{maptoid=3D730}
+gArtFilter[8722]=3D{maptoid=3D730}
+gArtFilter[8733]=3D{maptoid=3D730}
+gArtFilter[8724]=3D{maptoid=3D730}
+gArtFilter[8735]=3D{maptoid=3D730}
+gArtFilter[8744]=3D{maptoid=3D730}
+gArtFilter[8736]=3D{maptoid=3D730}
+gArtFilter[8742]=3D{maptoid=3D730}
+gArtFilter[8710]=3D{maptoid=3D730}
+gArtFilter[8727]=3D{maptoid=3D730}
+gArtFilter[8740]=3D{maptoid=3D730}
+gArtFilter[8717]=3D{maptoid=3D730}
+gArtFilter[8720]=3D{maptoid=3D730}
+gArtFilter[8725]=3D{maptoid=3D730}
+gArtFilter[8743]=3D{maptoid=3D730}
+gArtFilter[8715]=3D{maptoid=3D730}
+gArtFilter[8711]=3D{maptoid=3D730}
+gArtFilter[8713]=3D{maptoid=3D730}
+gArtFilter[8738]=3D{maptoid=3D730}
+gArtFilter[8730]=3D{maptoid=3D730}
+gArtFilter[8723]=3D{maptoid=3D730}
+gArtFilter[8748]=3D{maptoid=3D730}
+gArtFilter[8726]=3D{maptoid=3D730}
+gArtFilter[8714]=3D{maptoid=3D730}
+gArtFilter[8712]=3D{maptoid=3D730}
+gArtFilter[8746]=3D{maptoid=3D730}
+gArtFilter[8741]=3D{maptoid=3D730}
+gArtFilter[8737]=3D{maptoid=3D730}
+gArtFilter[8716]=3D{maptoid=3D730}
+gArtFilter[8728]=3D{maptoid=3D730}
+gArtFilter[8734]=3D{maptoid=3D730}
+gArtFilter[8718]=3D{maptoid=3D730}
+gArtFilter[8747]=3D{maptoid=3D730}
+gArtFilter[8731]=3D{maptoid=3D730}
+gArtFilter[739]=3D{maptoid=3D501}
+gArtFilter[748]=3D{maptoid=3D501}
+gArtFilter[936]=3D{maptoid=3D934}
+gArtFilter[738]=3D{maptoid=3D500}
+gArtFilter[747]=3D{maptoid=3D500}
+gArtFilter[493]=3D{maptoid=3D434}
+gArtFilter[107]=3D{maptoid=3D101}
+gArtFilter[14013]=3D{maptoid=3D14000}
+gArtFilter[14039]=3D{maptoid=3D14043}
+gArtFilter[14051]=3D{maptoid=3D14043}
+gArtFilter[14045]=3D{maptoid=3D14043}
+gArtFilter[14047]=3D{maptoid=3D14043}
+gArtFilter[14041]=3D{maptoid=3D14043}
+gArtFilter[14037]=3D{maptoid=3D14043}
+gArtFilter[14049]=3D{maptoid=3D14043}
+gArtFilter[14036]=3D{maptoid=3D14044}
+gArtFilter[14048]=3D{maptoid=3D14044}
+gArtFilter[14040]=3D{maptoid=3D14044}
+gArtFilter[14046]=3D{maptoid=3D14044}
+gArtFilter[14038]=3D{maptoid=3D14044}
+gArtFilter[14050]=3D{maptoid=3D14044}
+gArtFilter[14042]=3D{maptoid=3D14044}
+gArtFilter[7848]=3D{maptoid=3D7851}
+gArtFilter[7850]=3D{maptoid=3D7851}
+gArtFilter[7849]=3D{maptoid=3D7851}
+gArtFilter[8978]=3D{maptoid=3D7775}
+gArtFilter[7037]=3D{maptoid=3D7036}
+gArtFilter[7634]=3D{maptoid=3D7631}
+gArtFilter[7852]=3D{maptoid=3D7854}
+gArtFilter[7853]=3D{maptoid=3D7854}
+gArtFilter[7855]=3D{maptoid=3D7854}
+gArtFilter[7039]=3D{maptoid=3D7040}
+gArtFilter[7965]=3D{maptoid=3D7966}
+gArtFilter[8977]=3D{maptoid=3D7774}
+gArtFilter[5476]=3D{maptoid=3D5477}
+gArtFilter[5478]=3D{maptoid=3D5479}
+gArtFilter[6044]=3D{maptoid=3D5465}
+gArtFilter[6040]=3D{maptoid=3D5465}
+gArtFilter[6042]=3D{maptoid=3D5465}
+gArtFilter[6039]=3D{maptoid=3D5465}
+gArtFilter[6041]=3D{maptoid=3D5465}
+gArtFilter[6043]=3D{maptoid=3D5465}
+gArtFilter[13551]=3D{maptoid=3D13549}
+gArtFilter[13554]=3D{maptoid=3D13549}
+gArtFilter[13550]=3D{maptoid=3D13549}
+gArtFilter[13553]=3D{maptoid=3D13549}
+gArtFilter[13552]=3D{maptoid=3D13549}
+gArtFilter[13639]=3D{maptoid=3D13641}
+gArtFilter[13644]=3D{maptoid=3D13641}
+gArtFilter[13642]=3D{maptoid=3D13641}
+gArtFilter[13643]=3D{maptoid=3D13641}
+gArtFilter[13640]=3D{maptoid=3D13641}
+gArtFilter[13575]=3D{maptoid=3D13578}
+gArtFilter[13574]=3D{maptoid=3D13578}
+gArtFilter[13573]=3D{maptoid=3D13578}
+gArtFilter[13577]=3D{maptoid=3D13578}
+gArtFilter[13576]=3D{maptoid=3D13578}
+gArtFilter[13572]=3D{maptoid=3D13570}
+gArtFilter[13568]=3D{maptoid=3D13570}
+gArtFilter[13567]=3D{maptoid=3D13570}
+gArtFilter[13569]=3D{maptoid=3D13570}
+gArtFilter[13571]=3D{maptoid=3D13570}
+gArtFilter[13595]=3D{maptoid=3D13592}
+gArtFilter[13593]=3D{maptoid=3D13592}
+gArtFilter[13591]=3D{maptoid=3D13592}
+gArtFilter[13594]=3D{maptoid=3D13592}
+gArtFilter[13596]=3D{maptoid=3D13592}
+gArtFilter[13564]=3D{maptoid=3D13566}
+gArtFilter[13561]=3D{maptoid=3D13566}
+gArtFilter[13565]=3D{maptoid=3D13566}
+gArtFilter[13563]=3D{maptoid=3D13566}
+gArtFilter[13562]=3D{maptoid=3D13566}
+gArtFilter[13555]=3D{maptoid=3D13557}
+gArtFilter[13556]=3D{maptoid=3D13557}
+gArtFilter[13559]=3D{maptoid=3D13557}
+gArtFilter[13560]=3D{maptoid=3D13557}
+gArtFilter[13558]=3D{maptoid=3D13557}
+gArtFilter[13588]=3D{maptoid=3D13589}
+gArtFilter[13585]=3D{maptoid=3D13589}
+gArtFilter[13590]=3D{maptoid=3D13589}
+gArtFilter[13587]=3D{maptoid=3D13589}
+gArtFilter[13586]=3D{maptoid=3D13589}
+gArtFilter[13437]=3D{maptoid=3D13608}
+gArtFilter[13525]=3D{maptoid=3D13608}
+gArtFilter[13512]=3D{maptoid=3D13608}
+gArtFilter[13423]=3D{maptoid=3D13608}
+gArtFilter[13462]=3D{maptoid=3D13608}
+gArtFilter[13469]=3D{maptoid=3D13608}
+gArtFilter[13443]=3D{maptoid=3D13608}
+gArtFilter[13430]=3D{maptoid=3D13608}
+gArtFilter[13434]=3D{maptoid=3D13608}
+gArtFilter[13508]=3D{maptoid=3D13608}
+gArtFilter[13599]=3D{maptoid=3D13608}
+gArtFilter[13498]=3D{maptoid=3D13608}
+gArtFilter[13501]=3D{maptoid=3D13608}
+gArtFilter[13598]=3D{maptoid=3D13608}
+gArtFilter[13422]=3D{maptoid=3D13608}
+gArtFilter[13463]=3D{maptoid=3D13608}
+gArtFilter[13440]=3D{maptoid=3D13608}
+gArtFilter[13432]=3D{maptoid=3D13608}
+gArtFilter[13471]=3D{maptoid=3D13608}
+gArtFilter[13503]=3D{maptoid=3D13608}
+gArtFilter[13523]=3D{maptoid=3D13608}
+gArtFilter[13473]=3D{maptoid=3D13608}
+gArtFilter[13431]=3D{maptoid=3D13608}
+gArtFilter[13606]=3D{maptoid=3D13608}
+gArtFilter[13478]=3D{maptoid=3D13608}
+gArtFilter[13513]=3D{maptoid=3D13608}
+gArtFilter[13428]=3D{maptoid=3D13608}
+gArtFilter[13429]=3D{maptoid=3D13608}
+gArtFilter[13438]=3D{maptoid=3D13608}
+gArtFilter[13480]=3D{maptoid=3D13608}
+gArtFilter[13456]=3D{maptoid=3D13608}
+gArtFilter[13499]=3D{maptoid=3D13608}
+gArtFilter[13424]=3D{maptoid=3D13608}
+gArtFilter[13524]=3D{maptoid=3D13608}
+gArtFilter[13433]=3D{maptoid=3D13608}
+gArtFilter[13425]=3D{maptoid=3D13608}
+gArtFilter[13457]=3D{maptoid=3D13608}
+gArtFilter[13514]=3D{maptoid=3D13608}
+gArtFilter[13602]=3D{maptoid=3D13608}
+gArtFilter[13605]=3D{maptoid=3D13608}
+gArtFilter[13509]=3D{maptoid=3D13608}
+gArtFilter[13472]=3D{maptoid=3D13608}
+gArtFilter[13496]=3D{maptoid=3D13608}
+gArtFilter[13507]=3D{maptoid=3D13608}
+gArtFilter[13604]=3D{maptoid=3D13608}
+gArtFilter[13483]=3D{maptoid=3D13608}
+gArtFilter[13477]=3D{maptoid=3D13608}
+gArtFilter[13445]=3D{maptoid=3D13608}
+gArtFilter[13522]=3D{maptoid=3D13608}
+gArtFilter[13461]=3D{maptoid=3D13608}
+gArtFilter[13475]=3D{maptoid=3D13608}
+gArtFilter[13470]=3D{maptoid=3D13608}
+gArtFilter[13481]=3D{maptoid=3D13608}
+gArtFilter[13442]=3D{maptoid=3D13608}
+gArtFilter[13459]=3D{maptoid=3D13608}
+gArtFilter[13494]=3D{maptoid=3D13608}
+gArtFilter[13465]=3D{maptoid=3D13608}
+gArtFilter[13607]=3D{maptoid=3D13608}
+gArtFilter[13482]=3D{maptoid=3D13608}
+gArtFilter[13444]=3D{maptoid=3D13608}
+gArtFilter[13502]=3D{maptoid=3D13608}
+gArtFilter[13466]=3D{maptoid=3D13608}
+gArtFilter[13479]=3D{maptoid=3D13608}
+gArtFilter[13426]=3D{maptoid=3D13608}
+gArtFilter[13441]=3D{maptoid=3D13608}
+gArtFilter[13468]=3D{maptoid=3D13608}
+gArtFilter[13511]=3D{maptoid=3D13608}
+gArtFilter[13458]=3D{maptoid=3D13608}
+gArtFilter[13497]=3D{maptoid=3D13608}
+gArtFilter[13467]=3D{maptoid=3D13608}
+gArtFilter[13597]=3D{maptoid=3D13608}
+gArtFilter[13603]=3D{maptoid=3D13608}
+gArtFilter[13436]=3D{maptoid=3D13608}
+gArtFilter[13435]=3D{maptoid=3D13608}
+gArtFilter[13476]=3D{maptoid=3D13608}
+gArtFilter[13521]=3D{maptoid=3D13608}
+gArtFilter[13474]=3D{maptoid=3D13608}
+gArtFilter[13600]=3D{maptoid=3D13608}
+gArtFilter[13464]=3D{maptoid=3D13608}
+gArtFilter[13427]=3D{maptoid=3D13608}
+gArtFilter[13460]=3D{maptoid=3D13608}
+gArtFilter[13493]=3D{maptoid=3D13608}
+gArtFilter[13601]=3D{maptoid=3D13608}
+gArtFilter[13506]=3D{maptoid=3D13608}
+gArtFilter[13439]=3D{maptoid=3D13608}
+gArtFilter[13504]=3D{maptoid=3D13608}
+gArtFilter[13582]=3D{maptoid=3D13580}
+gArtFilter[13583]=3D{maptoid=3D13580}
+gArtFilter[13581]=3D{maptoid=3D13580}
+gArtFilter[13584]=3D{maptoid=3D13580}
+gArtFilter[6544]=3D{maptoid=3D6543}
+gArtFilter[6545]=3D{maptoid=3D6543}
+gArtFilter[6542]=3D{maptoid=3D6543}
+gArtFilter[6013]=3D{maptoid=3D6017}
+gArtFilter[6429]=3D{maptoid=3D6428}
+gArtFilter[6658]=3D{maptoid=3D6667}
+gArtFilter[6659]=3D{maptoid=3D6667}
+gArtFilter[6424]=3D{maptoid=3D6425}
+gArtFilter[6568]=3D{maptoid=3D6567}
+gArtFilter[6569]=3D{maptoid=3D6567}
+gArtFilter[6566]=3D{maptoid=3D6567}
+gArtFilter[6532]=3D{maptoid=3D6531}
+gArtFilter[6533]=3D{maptoid=3D6531}
+gArtFilter[6530]=3D{maptoid=3D6531}
+gArtFilter[6561]=3D{maptoid=3D6558}
+gArtFilter[6559]=3D{maptoid=3D6558}
+gArtFilter[6560]=3D{maptoid=3D6558}
+gArtFilter[7979]=3D{maptoid=3D6587}
+gArtFilter[6549]=3D{maptoid=3D6546}
+gArtFilter[6548]=3D{maptoid=3D6546}
+gArtFilter[6547]=3D{maptoid=3D6546}
+gArtFilter[6430]=3D{maptoid=3D6431}
+gArtFilter[6660]=3D{maptoid=3D6657}
+gArtFilter[6668]=3D{maptoid=3D6657}
+gArtFilter[6556]=3D{maptoid=3D6555}
+gArtFilter[6557]=3D{maptoid=3D6555}
+gArtFilter[6554]=3D{maptoid=3D6555}
+gArtFilter[6426]=3D{maptoid=3D6427}
+gArtFilter[6525]=3D{maptoid=3D6522}
+gArtFilter[6524]=3D{maptoid=3D6522}
+gArtFilter[6523]=3D{maptoid=3D6522}
+gArtFilter[6536]=3D{maptoid=3D6537}
+gArtFilter[6534]=3D{maptoid=3D6537}
+gArtFilter[6535]=3D{maptoid=3D6537}
+gArtFilter[2628]=3D{maptoid=3D11223}
+gArtFilter[12911]=3D{maptoid=3D12832}
+gArtFilter[12833]=3D{maptoid=3D12832}
+gArtFilter[12909]=3D{maptoid=3D12832}
+gArtFilter[12835]=3D{maptoid=3D12832}
+gArtFilter[12813]=3D{maptoid=3D12832}
+gArtFilter[12839]=3D{maptoid=3D12832}
+gArtFilter[12865]=3D{maptoid=3D12832}
+gArtFilter[12814]=3D{maptoid=3D12832}
+gArtFilter[12826]=3D{maptoid=3D12832}
+gArtFilter[12838]=3D{maptoid=3D12832}
+gArtFilter[12841]=3D{maptoid=3D12832}
+gArtFilter[12840]=3D{maptoid=3D12832}
+gArtFilter[12836]=3D{maptoid=3D12832}
+gArtFilter[12842]=3D{maptoid=3D12832}
+gArtFilter[12834]=3D{maptoid=3D12832}
+gArtFilter[12854]=3D{maptoid=3D12832}
+gArtFilter[12910]=3D{maptoid=3D12906}
+gArtFilter[3445]=3D{maptoid=3D3406}
+gArtFilter[3469]=3D{maptoid=3D3406}
+gArtFilter[3399]=3D{maptoid=3D3406}
+gArtFilter[3464]=3D{maptoid=3D3406}
+gArtFilter[3324]=3D{maptoid=3D3321}
+gArtFilter[3494]=3D{maptoid=3D3498}
+gArtFilter[3644]=3D{maptoid=3D3645}
+gArtFilter[3734]=3D{maptoid=3D3692}
+gArtFilter[3179]=3D{maptoid=3D3180}
+gArtFilter[3178]=3D{maptoid=3D3180}
+gArtFilter[5108]=3D{maptoid=3D3714}
+gArtFilter[3814]=3D{maptoid=3D3812}
+gArtFilter[3993]=3D{maptoid=3D3994}
+gArtFilter[3697]=3D{maptoid=3D3726}
+gArtFilter[3499]=3D{maptoid=3D3495}
+gArtFilter[3746]=3D{maptoid=3D3747}
+gArtFilter[5453]=3D{maptoid=3D3703}
+gArtFilter[3311]=3D{maptoid=3D3313}
+gArtFilter[3693]=3D{maptoid=3D3729}
+gArtFilter[3045]=3D{maptoid=3D3027}
+gArtFilter[3046]=3D{maptoid=3D3028}
+gArtFilter[3811]=3D{maptoid=3D3813}
+gArtFilter[3309]=3D{maptoid=3D3307}
+gArtFilter[3635]=3D{maptoid=3D3633}
+gArtFilter[3634]=3D{maptoid=3D3633}
+gArtFilter[3429]=3D{maptoid=3D3421}
+gArtFilter[3748]=3D{maptoid=3D3745}
+gArtFilter[8149]=3D{maptoid=3D3949}
+gArtFilter[8151]=3D{maptoid=3D3949}
+gArtFilter[8152]=3D{maptoid=3D3949}
+gArtFilter[8150]=3D{maptoid=3D3949}
+gArtFilter[3098]=3D{maptoid=3D3089}
+gArtFilter[3724]=3D{maptoid=3D3696}
+gArtFilter[1458]=3D{maptoid=3D9957}
+gArtFilter[11359]=3D{maptoid=3D9957}
+gArtFilter[9988]=3D{maptoid=3D9990}
+gArtFilter[9991]=3D{maptoid=3D9990}
+gArtFilter[9989]=3D{maptoid=3D9990}
+gArtFilter[9983]=3D{maptoid=3D9990}
+gArtFilter[1481]=3D{maptoid=3D9990}
+gArtFilter[1479]=3D{maptoid=3D9981}
+gArtFilter[9995]=3D{maptoid=3D9993}
+gArtFilter[1487]=3D{maptoid=3D9993}
+gArtFilter[1483]=3D{maptoid=3D9985}
+gArtFilter[9963]=3D{maptoid=3D9949}
+gArtFilter[1447]=3D{maptoid=3D9949}
+gArtFilter[9977]=3D{maptoid=3D9996}
+gArtFilter[1475]=3D{maptoid=3D9996}
+gArtFilter[11316]=3D{maptoid=3D9996}
+gArtFilter[9953]=3D{maptoid=3D9961}
+gArtFilter[9960]=3D{maptoid=3D9961}
+gArtFilter[1454]=3D{maptoid=3D9961}
+gArtFilter[9952]=3D{maptoid=3D9958}
+gArtFilter[1453]=3D{maptoid=3D9958}
+gArtFilter[1486]=3D{maptoid=3D9992}
+gArtFilter[1476]=3D{maptoid=3D9978}
+gArtFilter[11317]=3D{maptoid=3D9978}
+gArtFilter[1482]=3D{maptoid=3D9984}
+gArtFilter[1449]=3D{maptoid=3D9964}
+gArtFilter[1484]=3D{maptoid=3D9986}
+gArtFilter[1485]=3D{maptoid=3D9987}
+gArtFilter[1474]=3D{maptoid=3D9976}
+gArtFilter[1457]=3D{maptoid=3D9956}
+gArtFilter[11358]=3D{maptoid=3D9956}
+gArtFilter[1455]=3D{maptoid=3D9954}
+gArtFilter[1480]=3D{maptoid=3D9982}
+gArtFilter[1456]=3D{maptoid=3D9955}
+gArtFilter[11357]=3D{maptoid=3D9955}
+gArtFilter[1477]=3D{maptoid=3D9979}
+gArtFilter[1445]=3D{maptoid=3D9946}
+gArtFilter[11346]=3D{maptoid=3D9946}
+gArtFilter[1478]=3D{maptoid=3D9980}
+gArtFilter[1446]=3D{maptoid=3D9948}
+gArtFilter[1488]=3D{maptoid=3D9994}
+gArtFilter[9947]=3D{maptoid=3D9950}
+gArtFilter[1444]=3D{maptoid=3D9950}
+gArtFilter[8524]=3D{maptoid=3D9950}
+gArtFilter[8525]=3D{maptoid=3D9950}
+gArtFilter[1448]=3D{maptoid=3D9962}
+gArtFilter[9959]=3D{maptoid=3D9951}
+gArtFilter[1452]=3D{maptoid=3D9951}
+gArtFilter[11305]=3D{maptoid=3D1464}
+gArtFilter[1620]=3D{maptoid=3D1625}
+gArtFilter[1318]=3D{maptoid=3D1320}
+gArtFilter[11341]=3D{maptoid=3D1531}
+gArtFilter[1727]=3D{maptoid=3D1718}
+gArtFilter[1731]=3D{maptoid=3D1718}
+gArtFilter[1713]=3D{maptoid=3D1709}
+gArtFilter[1706]=3D{maptoid=3D1709}
+gArtFilter[1635]=3D{maptoid=3D1645}
+gArtFilter[1767]=3D{maptoid=3D1780}
+gArtFilter[1771]=3D{maptoid=3D1780}
+gArtFilter[1778]=3D{maptoid=3D1780}
+gArtFilter[11311]=3D{maptoid=3D1470}
+gArtFilter[1990]=3D{maptoid=3D1986}
+gArtFilter[11306]=3D{maptoid=3D1465}
+gArtFilter[1176]=3D{maptoid=3D1173}
+gArtFilter[1175]=3D{maptoid=3D1173}
+gArtFilter[1174]=3D{maptoid=3D1173}
+gArtFilter[1721]=3D{maptoid=3D1717}
+gArtFilter[1728]=3D{maptoid=3D1717}
+gArtFilter[1987]=3D{maptoid=3D1983}
+gArtFilter[1562]=3D{maptoid=3D1573}
+gArtFilter[1747]=3D{maptoid=3D1743}
+gArtFilter[1734]=3D{maptoid=3D1743}
+gArtFilter[1183]=3D{maptoid=3D1181}
+gArtFilter[1332]=3D{maptoid=3D1334}
+gArtFilter[1769]=3D{maptoid=3D1776}
+gArtFilter[1765]=3D{maptoid=3D1776}
+gArtFilter[1643]=3D{maptoid=3D1631}
+gArtFilter[11331]=3D{maptoid=3D1521}
+gArtFilter[1638]=3D{maptoid=3D1648}
+gArtFilter[1147]=3D{maptoid=3D1119}
+gArtFilter[1148]=3D{maptoid=3D1119}
+gArtFilter[1151]=3D{maptoid=3D1119}
+gArtFilter[1149]=3D{maptoid=3D1119}
+gArtFilter[1150]=3D{maptoid=3D1119}
+gArtFilter[1152]=3D{maptoid=3D1119}
+gArtFilter[1624]=3D{maptoid=3D1621}
+gArtFilter[1705]=3D{maptoid=3D1712}
+gArtFilter[1701]=3D{maptoid=3D1712}
+gArtFilter[1666]=3D{maptoid=3D1655}
+gArtFilter[1668]=3D{maptoid=3D1655}
+gArtFilter[1659]=3D{maptoid=3D1655}
+gArtFilter[11336]=3D{maptoid=3D1526}
+gArtFilter[11332]=3D{maptoid=3D1522}
+gArtFilter[1700]=3D{maptoid=3D1687}
+gArtFilter[1698]=3D{maptoid=3D1687}
+gArtFilter[1691]=3D{maptoid=3D1687}
+gArtFilter[1234]=3D{maptoid=3D1248}
+gArtFilter[11313]=3D{maptoid=3D1472}
+gArtFilter[8685]=3D{maptoid=3D1472}
+gArtFilter[8686]=3D{maptoid=3D1472}
+gArtFilter[1554]=3D{maptoid=3D1543}
+gArtFilter[1319]=3D{maptoid=3D1317}
+gArtFilter[11304]=3D{maptoid=3D1463}
+gArtFilter[1412]=3D{maptoid=3D1410}
+gArtFilter[1276]=3D{maptoid=3D1410}
+gArtFilter[1246]=3D{maptoid=3D1232}
+gArtFilter[1661]=3D{maptoid=3D1658}
+gArtFilter[1665]=3D{maptoid=3D1658}
+gArtFilter[1647]=3D{maptoid=3D1636}
+gArtFilter[1677]=3D{maptoid=3D1674}
+gArtFilter[8181]=3D{maptoid=3D1674}
+gArtFilter[8185]=3D{maptoid=3D1674}
+gArtFilter[8178]=3D{maptoid=3D1674}
+gArtFilter[1750]=3D{maptoid=3D1763}
+gArtFilter[1642]=3D{maptoid=3D1630}
+gArtFilter[1186]=3D{maptoid=3D1185}
+gArtFilter[1409]=3D{maptoid=3D1278}
+gArtFilter[1413]=3D{maptoid=3D1278}
+gArtFilter[1411]=3D{maptoid=3D1278}
+gArtFilter[11309]=3D{maptoid=3D1468}
+gArtFilter[1256]=3D{maptoid=3D1335}
+gArtFilter[11334]=3D{maptoid=3D1524}
+gArtFilter[1244]=3D{maptoid=3D1245}
+gArtFilter[11312]=3D{maptoid=3D1471}
+gArtFilter[1324]=3D{maptoid=3D1322}
+gArtFilter[1760]=3D{maptoid=3D1753}
+gArtFilter[11300]=3D{maptoid=3D1459}
+gArtFilter[1241]=3D{maptoid=3D1242}
+gArtFilter[1226]=3D{maptoid=3D1228}
+gArtFilter[1218]=3D{maptoid=3D1219}
+gArtFilter[1217]=3D{maptoid=3D1219}
+gArtFilter[1239]=3D{maptoid=3D1187}
+gArtFilter[1577]=3D{maptoid=3D1565}
+gArtFilter[1729]=3D{maptoid=3D1722}
+gArtFilter[1725]=3D{maptoid=3D1722}
+gArtFilter[11343]=3D{maptoid=3D1533}
+gArtFilter[1364]=3D{maptoid=3D1377}
+gArtFilter[1380]=3D{maptoid=3D1377}
+gArtFilter[1365]=3D{maptoid=3D1377}
+gArtFilter[1379]=3D{maptoid=3D1377}
+gArtFilter[1378]=3D{maptoid=3D1377}
+gArtFilter[1366]=3D{maptoid=3D1377}
+gArtFilter[1328]=3D{maptoid=3D1330}
+gArtFilter[11339]=3D{maptoid=3D1529}
+gArtFilter[1509]=3D{maptoid=3D1513}
+gArtFilter[1748]=3D{maptoid=3D1735}
+gArtFilter[1746]=3D{maptoid=3D1735}
+gArtFilter[1739]=3D{maptoid=3D1735}
+gArtFilter[11308]=3D{maptoid=3D1467}
+gArtFilter[1561]=3D{maptoid=3D1574}
+gArtFilter[1981]=3D{maptoid=3D1982}
+gArtFilter[1685]=3D{maptoid=3D1696}
+gArtFilter[1689]=3D{maptoid=3D1696}
+gArtFilter[1764]=3D{maptoid=3D1755}
+gArtFilter[1581]=3D{maptoid=3D1628}
+gArtFilter[1629]=3D{maptoid=3D1628}
+gArtFilter[1575]=3D{maptoid=3D1564}
+gArtFilter[11337]=3D{maptoid=3D1527}
+gArtFilter[11301]=3D{maptoid=3D1460}
+gArtFilter[8681]=3D{maptoid=3D1460}
+gArtFilter[8682]=3D{maptoid=3D1460}
+gArtFilter[1737]=3D{maptoid=3D1744}
+gArtFilter[1733]=3D{maptoid=3D1744}
+gArtFilter[1742]=3D{maptoid=3D1744}
+gArtFilter[1669]=3D{maptoid=3D1680}
+gArtFilter[1673]=3D{maptoid=3D1680}
+gArtFilter[8177]=3D{maptoid=3D1680}
+gArtFilter[8173]=3D{maptoid=3D1680}
+gArtFilter[8184]=3D{maptoid=3D1680}
+gArtFilter[1711]=3D{maptoid=3D1702}
+gArtFilter[1715]=3D{maptoid=3D1702}
+gArtFilter[11335]=3D{maptoid=3D1525}
+gArtFilter[1723]=3D{maptoid=3D1730}
+gArtFilter[1732]=3D{maptoid=3D1730}
+gArtFilter[1719]=3D{maptoid=3D1730}
+gArtFilter[1578]=3D{maptoid=3D1567}
+gArtFilter[1657]=3D{maptoid=3D1664}
+gArtFilter[1653]=3D{maptoid=3D1664}
+gArtFilter[11330]=3D{maptoid=3D1520}
+gArtFilter[1389]=3D{maptoid=3D1390}
+gArtFilter[1644]=3D{maptoid=3D1633}
+gArtFilter[1770]=3D{maptoid=3D1777}
+gArtFilter[1773]=3D{maptoid=3D1777}
+gArtFilter[1751]=3D{maptoid=3D1762}
+gArtFilter[11302]=3D{maptoid=3D1461}
+gArtFilter[8684]=3D{maptoid=3D1461}
+gArtFilter[8683]=3D{maptoid=3D1461}
+gArtFilter[1549]=3D{maptoid=3D1538}
+gArtFilter[1279]=3D{maptoid=3D1408}
+gArtFilter[1512]=3D{maptoid=3D1514}
+gArtFilter[1508]=3D{maptoid=3D1514}
+gArtFilter[11303]=3D{maptoid=3D1462}
+gArtFilter[1384]=3D{maptoid=3D1385}
+gArtFilter[1766]=3D{maptoid=3D1779}
+gArtFilter[1775]=3D{maptoid=3D1779}
+gArtFilter[11314]=3D{maptoid=3D1473}
+gArtFilter[8687]=3D{maptoid=3D1473}
+gArtFilter[8688]=3D{maptoid=3D1473}
+gArtFilter[1329]=3D{maptoid=3D1327}
+gArtFilter[1572]=3D{maptoid=3D1560}
+gArtFilter[11344]=3D{maptoid=3D1534}
+gArtFilter[1654]=3D{maptoid=3D1663}
+gArtFilter[1667]=3D{maptoid=3D1663}
+gArtFilter[1814]=3D{maptoid=3D1816}
+gArtFilter[1233]=3D{maptoid=3D1247}
+gArtFilter[1402]=3D{maptoid=3D1406}
+gArtFilter[11333]=3D{maptoid=3D1523}
+gArtFilter[1679]=3D{maptoid=3D1681}
+gArtFilter[1683]=3D{maptoid=3D1681}
+gArtFilter[1670]=3D{maptoid=3D1681}
+gArtFilter[1754]=3D{maptoid=3D1761}
+gArtFilter[1738]=3D{maptoid=3D1745}
+gArtFilter[1741]=3D{maptoid=3D1745}
+gArtFilter[8176]=3D{maptoid=3D1672}
+gArtFilter[1393]=3D{maptoid=3D1368}
+gArtFilter[1399]=3D{maptoid=3D1368}
+gArtFilter[1370]=3D{maptoid=3D1368}
+gArtFilter[1394]=3D{maptoid=3D1368}
+gArtFilter[1395]=3D{maptoid=3D1368}
+gArtFilter[1371]=3D{maptoid=3D1368}
+gArtFilter[1392]=3D{maptoid=3D1368}
+gArtFilter[1576]=3D{maptoid=3D1566}
+gArtFilter[1985]=3D{maptoid=3D1989}
+gArtFilter[11310]=3D{maptoid=3D1469}
+gArtFilter[1388]=3D{maptoid=3D1387}
+gArtFilter[1249]=3D{maptoid=3D1235}
+gArtFilter[1243]=3D{maptoid=3D1240}
+gArtFilter[1646]=3D{maptoid=3D1637}
+gArtFilter[1323]=3D{maptoid=3D1321}
+gArtFilter[2077]=3D{maptoid=3D1321}
+gArtFilter[11307]=3D{maptoid=3D1466}
+gArtFilter[1697]=3D{maptoid=3D1690}
+gArtFilter[1693]=3D{maptoid=3D1690}
+gArtFilter[1145]=3D{maptoid=3D1146}
+gArtFilter[1143]=3D{maptoid=3D1146}
+gArtFilter[1144]=3D{maptoid=3D1146}
+gArtFilter[1142]=3D{maptoid=3D1146}
+gArtFilter[1396]=3D{maptoid=3D1400}
+gArtFilter[1405]=3D{maptoid=3D1401}
+gArtFilter[1988]=3D{maptoid=3D1984}
+gArtFilter[1559]=3D{maptoid=3D1571}
+gArtFilter[1286]=3D{maptoid=3D1287}
+gArtFilter[1284]=3D{maptoid=3D1287}
+gArtFilter[1277]=3D{maptoid=3D1407}
+gArtFilter[1382]=3D{maptoid=3D1383}
+gArtFilter[11340]=3D{maptoid=3D1530}
+gArtFilter[1686]=3D{maptoid=3D1695}
+gArtFilter[1699]=3D{maptoid=3D1695}
+gArtFilter[11342]=3D{maptoid=3D1532}
+gArtFilter[11338]=3D{maptoid=3D1528}
+gArtFilter[1611]=3D{maptoid=3D1632}
+gArtFilter[1184]=3D{maptoid=3D1182}
+gArtFilter[8180]=3D{maptoid=3D1676}
+gArtFilter[1707]=3D{maptoid=3D1703}
+gArtFilter[1714]=3D{maptoid=3D1703}
+gArtFilter[1716]=3D{maptoid=3D1703}
+gArtFilter[1684]=3D{maptoid=3D1671}
+gArtFilter[1682]=3D{maptoid=3D1671}
+gArtFilter[1675]=3D{maptoid=3D1671}
+
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+-- generated from remove_duplicate_models.php script
+
+----------------------------------------------------------------------
 ----------------------------------------------------------------------
 =

 -- Seasonal Dynamic & Static Art Translation (run tiles)	-- eventuell (iTi=
leTypeID + 0x4000)



From no-reply at zwischenwelt.org  Sat Jan 10 20:18:06 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 10 Jan 2009 19:18:06 -0000
Subject: [Iris-commit] [IRIS] r2853 - /trunk/lua/filter/filter.art.lua
Message-ID: <20090110191807.200BB1C1880B@zwischenwelt.org>

Author: hagish
Date: Sat Jan 10 20:18:06 2009
New Revision: 2853

Log:
inserted at the wrong position

Modified:
    trunk/lua/filter/filter.art.lua

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Sat Jan 10 20:18:06 2009
@@ -398,6 +398,10 @@
 =

 --zaun
 gArtFilter[2187]=3D{maptoid=3D2186,rotation=3D"x:0,y:0,z:90",xadd=3D0,yadd=
=3D1,zadd=3D0}
+
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+-- generated from remove_duplicate_models.php script
 gArtFilter[2579]=3D{maptoid=3D2580}
 gArtFilter[2578]=3D{maptoid=3D2580}
 gArtFilter[8296]=3D{maptoid=3D2420}
@@ -1306,11 +1310,6 @@
 gArtFilter[1684]=3D{maptoid=3D1671}
 gArtFilter[1682]=3D{maptoid=3D1671}
 gArtFilter[1675]=3D{maptoid=3D1671}
-
-----------------------------------------------------------------------
-----------------------------------------------------------------------
--- generated from remove_duplicate_models.php script
-
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 =




From no-reply at zwischenwelt.org  Sat Jan 10 23:55:32 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 10 Jan 2009 22:55:32 -0000
Subject: [Iris-commit] [IRIS] r2854 - in /trunk: include/data_groundblock.h
 lua/lib.2d.mousepick.lua lua/lib.2d.renderer.lua lua/lib.charcreate.lua
 lua/lib.mapblock.2d.terrain.lua lua/main.lua plugins/itemcounter.lua
 src/data_groundblock.cpp src/terrain_multitex.cpp
Message-ID: <20090110225533.29F821C18809@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 10 23:55:30 2009
New Revision: 2854

Log:
multitex terrain mousepick code optimized, mousepick profiling ( gEnablePro=
filer_R2D_MousePick ) , item counter custom text

Modified:
    trunk/include/data_groundblock.h
    trunk/lua/lib.2d.mousepick.lua
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.charcreate.lua
    trunk/lua/lib.mapblock.2d.terrain.lua
    trunk/lua/main.lua
    trunk/plugins/itemcounter.lua
    trunk/src/data_groundblock.cpp
    trunk/src/terrain_multitex.cpp

Modified: trunk/include/data_groundblock.h
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/include/data_groundblock.h (original)
+++ trunk/include/data_groundblock.h Sat Jan 10 23:55:30 2009
@@ -21,6 +21,7 @@
 class cGroundBlockLoader : public Lugre::cSmartPointable { public :
 	int				miMapW;
 	int				miMapH;
+	int				miLoaderID;
 	cGroundBlockLoader						(const int iMapH);
 	=

 	/// result of Get is only guaranteed to be valid until next Get call, unl=
ess PrepareGroupLoading below is used and succeeds

Modified: trunk/lua/lib.2d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.mousepick.lua (original)
+++ trunk/lua/lib.2d.mousepick.lua Sat Jan 10 23:55:30 2009
@@ -2,12 +2,16 @@
 Renderer2D.gNextMousePickStep =3D 0
 Renderer2D.gMousePickStepInterval =3D 400
 Renderer2D.gUOToolTipOverride =3D true
+
+gProfiler_R2D_MousePick =3D CreateRoughProfiler("2D:MousePick")
 =

 -- not every frame, but regularly
 function Renderer2D:MousePickStep		()
 	local t =3D Client_GetTicks()
 	if (self.gNextMousePickStep > t) then return end
 	self.gNextMousePickStep =3D t + self.gMousePickStepInterval
+	gProfiler_R2D_MousePick:Start(gEnableProfiler_R2D_MousePick)
+	gProfiler_R2D_MousePick:Section("GetMouseHitSerial start")
 	=

 	local serial
 	if (not gKeyPressed[key_mouse_right]) then
@@ -16,7 +20,9 @@
 		if (gMousePickFoundHit and gMousePickFoundHit.hittype =3D=3D kMousePickH=
itType_Container) then serial =3D nil end -- backpane
 	end
 	=

+	gProfiler_R2D_MousePick:Section("StartToolTip")
 	StartUOToolTipAtMouse_Serial(serial)
+	gProfiler_R2D_MousePick:End()
 end
 =

 function Renderer2D:MousePick_Scene () =

@@ -27,6 +33,7 @@
 	local rx,ry,rz, rvx,rvy,rvz =3D GetMouseRay()
 	=

 	-- RayPickStatics
+	gProfiler_R2D_MousePick:Section("statics")
 	local dist,sprite =3D self:RayPickStatics(rx,ry,rz, rvx,rvy,rvz)
 	if (dist and ((not founddist) or dist < founddist)) then =

 		founddist =3D dist =

@@ -41,6 +48,9 @@
 	end
 	=

 	-- RayPickTerrain
+	--~ print("mousepick terrain")
+	local t0 =3D Client_GetTicks()
+	gProfiler_R2D_MousePick:Section("terrain",true) -- this eats most
 	local dist,xloc,yloc =3D self:RayPickTerrain(rx,ry,rz, rvx,rvy,rvz)
 	if (dist and ((not founddist) or dist < founddist)) then =

 		founddist =3D dist =

@@ -52,8 +62,17 @@
 		gMousePickFoundHit.hit_zloc =3D ground.zloc
 		--~ print("RayPickTerrain",xloc,yloc)
 	end
+	local t1 =3D Client_GetTicks()
+	gTerrainMousePickProfileAvgSum =3D (gTerrainMousePickProfileAvgSum or 0) =
+ (t1-t0)
+	gTerrainMousePickProfileAvgC =3D (gTerrainMousePickProfileAvgC or 0) + 1
+	if (gTerrainMousePickProfileAvgC =3D=3D 10) then =

+		printf("mousepick terrain avg=3D%0.1f\n",gTerrainMousePickProfileAvgSum/=
gTerrainMousePickProfileAvgC)
+		gTerrainMousePickProfileAvgSum =3D 0
+		gTerrainMousePickProfileAvgC =3D 0
+	end
 	=

 	-- RayPickDynamics
+	gProfiler_R2D_MousePick:Section("dynamics")
 	local dist,sprite =3D self:RayPickDynamics(rx,ry,rz, rvx,rvy,rvz)
 	if (dist and ((not founddist) or dist < founddist)) then =

 		founddist =3D dist
@@ -68,6 +87,7 @@
 	end
 	=

 	-- RayPickMobiles
+	gProfiler_R2D_MousePick:Section("mobiles")
 	local dist,sprite =3D self:RayPickMobiles(rx,ry,rz, rvx,rvy,rvz)
 	if (dist and ((not founddist) or dist < founddist)) then =

 		founddist =3D dist =

@@ -80,6 +100,8 @@
 		gMousePickFoundHit.hit_zloc =3D mobile.zloc
 		--~ print("RayPickMobiles",sprite.data.artid) =

 	end
+	=

+	gProfiler_R2D_MousePick:Section("GetMouseHitSerial rest")
 end
 =

 function Renderer2D:MousePick_ShowHits	() =


Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Sat Jan 10 23:55:30 2009
@@ -152,7 +152,7 @@
 	gProfiler_R2D_MainStep:Section("MapStep")				self:MapStep()
 	gProfiler_R2D_MainStep:Section("HUDFX_MainStep")		self:HUDFX_MainStep()
 	gProfiler_R2D_MainStep:Section("Dynamics_MainStep")		self:Dynamics_MainSt=
ep()
-	gProfiler_R2D_MainStep:Section("MousePickStep",true)	if (not bMousePickBl=
ockedByWalk) then self:MousePickStep() end
+	gProfiler_R2D_MainStep:Section("MousePickStep",true)	self:MousePickStep()
 	gProfiler_R2D_MainStep:End()
 end
 =


Modified: trunk/lua/lib.charcreate.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.charcreate.lua (original)
+++ trunk/lua/lib.charcreate.lua Sat Jan 10 23:55:30 2009
@@ -77,7 +77,7 @@
 	chardata.hairColor		=3D hex2num("0x044E") -- 0x044E(human) 0x0034(elf)
 	chardata.facialHair		=3D hex2num("0x0000")
 	chardata.facialHairColor=3D hex2num("0x0000")
-	chardata.location		=3D hex2num("0x0000") -- uogamers: 0=3Dyew,1=3Dminoc,2=
=3Dbrit,3=3Dmoonglow,4=3Dtrinsik,5=3DMagincia,6=3Djhelom,7=3Dscara,8=3D
+	chardata.location		=3D hex2num("0x0000") -- uogamers: 0=3Dyew,1=3Dminoc,2=
=3Dbrit,3=3Dmoonglow,4=3Dtrinsik,5=3DMagincia,6=3Djhelom,7=3Dscara,8=3Dvesp=
er,9=3Docclo,10=3D
 	chardata.slot			=3D hex2num("0x0003")
 	chardata.shirtColor		=3D hex2num("0x036F") --hex2num("0x0083")
 	chardata.pantsColor		=3D hex2num("0x0111") --hex2num("0x01AC")

Modified: trunk/lua/lib.mapblock.2d.terrain.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.2d.terrain.lua (original)
+++ trunk/lua/lib.mapblock.2d.terrain.lua Sat Jan 10 23:55:30 2009
@@ -17,6 +17,7 @@
 	local gfx =3D self.gfx_terrain =

 	if (not gfx) then return end
 	local bx,by,bs =3D self.bx * 2, self.by * 2, self.iBlockSize
+	if (not self:BBRayPick(rx, ry, rz, rvx, rvy, rvz)) then return end
 	local bHit,fHitDist,tx,ty =3D TerrainMultiTex_RayPick(gGroundBlockLoader,=
bx,by,bs,bs,kRenderer2D_ZScale, rx-gfx.x,ry-gfx.y,rz-gfx.z, rvx,rvy,rvz)
 	if (not bHit) then return end
 	return fHitDist,bx * 8 + tx,by*8 + ty

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sat Jan 10 23:55:30 2009
@@ -432,7 +432,7 @@
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop =3D=3D=3D")
 	if (not gEnableRoughProfileSum) then return end
 	local arr =3D {}
-	for k,profiler in pairs({gProfiler_MainStep,gProfiler_R2D_MainStep,gProfi=
ler_R3D_MainStep}) do
+	for k,profiler in pairs({gProfiler_MainStep,gProfiler_R2D_MainStep,gProfi=
ler_R2D_MousePick,gProfiler_R3D_MainStep}) do
 		for secname,tsum in pairs(profiler.sum) do table.insert(arr,{name=3Dprof=
iler.name..":"..secname,tsum=3Dtsum}) end
 		profiler.sum =3D {}
 	end =


Modified: trunk/plugins/itemcounter.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/itemcounter.lua (original)
+++ trunk/plugins/itemcounter.lua Sat Jan 10 23:55:30 2009
@@ -111,6 +111,7 @@
 	gItemCounterDialog:AddText(curw or 0,r,g,b)
 	gItemCounterDialog:AddText("/")
 	gItemCounterDialog:AddText(maxw or 0)
+	if (ItemCounterGetCustomText) then gItemCounterDialog:AddText(ItemCounter=
GetCustomText() or "") end
 end
 =

 gWidgetClass["UOItemCounter"] =3D nil -- unregister for reload
@@ -118,7 +119,7 @@
 =

 =

 function gWidgetPrototype.UOItemCounter:AddText (text,r,g,b)
-	self:AddWidget(self:CreateChild("UOText",{x=3Dself.nextx,y=3D0,text=3Dtex=
t,col=3D{r=3Dr or 1,g=3Dg or 1,b=3Db or 1},bold=3Dtrue}))
+	return self:AddWidget(self:CreateChild("UOText",{x=3Dself.nextx,y=3D0,tex=
t=3Dtext,col=3D{r=3Dr or 1,g=3Dg or 1,b=3Db or 1},bold=3Dtrue}))
 end
 =

 function gWidgetPrototype.UOItemCounter:AddItem (data,amount)
@@ -162,6 +163,7 @@
 	table.insert(self.widgets,widget)
 	if (not xmove) then local l,t,r,b =3D widget:GetRelBounds() xmove =3D r e=
nd
 	self.nextx =3D self.nextx + xmove
+	return widget
 end
 function gWidgetPrototype.UOItemCounter:AddSpace (xmove)
 	self.nextx =3D self.nextx + xmove

Modified: trunk/src/data_groundblock.cpp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/src/data_groundblock.cpp (original)
+++ trunk/src/data_groundblock.cpp Sat Jan 10 23:55:30 2009
@@ -7,7 +7,10 @@
 =

 cGroundBlock::cGroundBlock				() : mpRawGroundBlock(0) {}
 =

-cGroundBlockLoader::cGroundBlockLoader	(const int iMapH) : miMapH(iMapH), =
miMapW(0)  {}
+int gNextGroundBlockLoaderID =3D 1;
+cGroundBlockLoader::cGroundBlockLoader	(const int iMapH) : miMapH(iMapH), =
miMapW(0),miLoaderID(0)  {
+	miLoaderID =3D gNextGroundBlockLoaderID++;
+}
 	=

 	=

 // ***** ***** ***** ***** ***** cGroundBlockLoader_Dummy

Modified: trunk/src/terrain_multitex.cpp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/src/terrain_multitex.cpp (original)
+++ trunk/src/terrain_multitex.cpp Sat Jan 10 23:55:30 2009
@@ -1,6 +1,7 @@
 #include "lugre_prefix.h"
 #include "terrain.h"
 #include "data.h"
+#include "lugre_shell.h"
 #include "lugre_ogrewrapper.h"
 #include "lugre_robrenderable.h"
 #include "lugre_meshshape.h" // for RayPick
@@ -8,6 +9,7 @@
 #include "data.h"
 #include <Ogre.h>
 #include <vector>
+#include <list>
 =

 #define XMIRROR
 =

@@ -27,6 +29,24 @@
 // note : by rotation and mirroring, 51 masks are enough to express all 2^=
8=3D256 neightborhood cases, see mask_rotmir.php
 =

 // uotypes : nodraw ? 0,2,431,432,433,434,435,436,437 =

+RawGroundBlock	gMultiTexTerrainVoidBlock;
+
+
+	class cMultiTexTerrainBlockCache { public:
+		int				miBX;
+		int				miBY;
+		RawGroundBlock	mBlock;
+		int				mZCache[(8+3)*(8+3)];
+		bool			mbZCacheValid;
+		cMultiTexTerrainBlockCache() {} // miLoaderID(o.miLoaderID),miBX(miBX),m=
iBY(miBY),mbZCacheValid(false)
+		void Set (cGroundBlockLoader& o,int miBX,int miBY) {
+			miBX =3D (miBX);
+			miBY =3D (miBY);
+			mbZCacheValid =3D (false);
+			cGroundBlock* pGroundBlock =3D o.GetGroundBlock(miBX,miBY);
+			memcpy(&mBlock,pGroundBlock ? pGroundBlock->mpRawGroundBlock : &gMultiT=
exTerrainVoidBlock,sizeof(RawGroundBlock));
+		}
+	};
 =

 template<int T> class cTiledMultiTexTerrain { public:
 	enum { kVertexSizeInFloats =3D (3+3+4*2) }; // p,n,uv*4
@@ -36,7 +56,39 @@
 	float			mfZUnit;
 	float			mfLookUpZUnit;
 	=

-	cTiledMultiTexTerrain() : mfAddX(0), mfAddY(0), mfZUnit(0.1), mfLookUpZUn=
it(0) {}
+
+	// BlockCache start
+	enum { kBlockCacheSize =3D 32 };
+	cMultiTexTerrainBlockCache	mBlockCache[kBlockCacheSize*kBlockCacheSize];
+	int				mBlockCacheLoaderID; // cGroundBlockLoader::miLoaderID (changes on=
 mapchange)
+	int				mBlockCacheBX0;
+	int				mBlockCacheBY0;
+	void	BlockCacheLoadArea	(cGroundBlockLoader& o,int bx,int by,int r) {
+		if (mBlockCacheLoaderID =3D=3D o.miLoaderID &&
+			mBlockCacheBX0					<=3D bx-r &&
+			mBlockCacheBY0					<=3D by-r &&
+			mBlockCacheBX0+kBlockCacheSize	 > bx+r &&
+			mBlockCacheBY0+kBlockCacheSize	 > by+r) return;
+		//~ printf("BlockCacheLoadArea : Cache MISS! old=3D(m%d,x%d,y%d) new=3D(=
m%d,x%d,y%d)\n",
+			//~ mBlockCacheLoaderID,mBlockCacheBX0,mBlockCacheBY0,
+			//~ o.miLoaderID,bx,by);
+		mBlockCacheLoaderID =3D o.miLoaderID;
+		mBlockCacheBX0 =3D bx-kBlockCacheSize/2;
+		mBlockCacheBY0 =3D by-kBlockCacheSize/2;
+		for (int y=3D0;y<kBlockCacheSize;++y)
+		for (int x=3D0;x<kBlockCacheSize;++x) mBlockCache[y*kBlockCacheSize+x].S=
et(o,mBlockCacheBX0+x,mBlockCacheBY0+y);
+	}
+	cMultiTexTerrainBlockCache&		GetBlockCache	(int miBX,int miBY) {
+		int x =3D miBX - mBlockCacheBX0;
+		int y =3D miBY - mBlockCacheBY0;
+		//~ if (x < 0 || x >=3D kBlockCacheSize) { printf("MultiTexTerrainBlockC=
ache : FATAL ERROR x\n"); return mBlockCache[0]; } // assert =

+		//~ if (y < 0 || y >=3D kBlockCacheSize) { printf("MultiTexTerrainBlockC=
ache : FATAL ERROR y\n"); return mBlockCache[0]; } // assert =

+		return mBlockCache[y*kBlockCacheSize+x];
+	}
+	// BlockCache end
+	=

+	=

+	cTiledMultiTexTerrain() : mfAddX(0), mfAddY(0), mfZUnit(0.1), mfLookUpZUn=
it(0), mBlockCacheBX0(-999),mBlockCacheBY0(-999) {}
 	=

 	enum { kMaxZDiff =3D 64 }; ///< mNormalLookup
 	enum { kGroundMatLookUpSize =3D 0x4000 };
@@ -51,7 +103,8 @@
 	int		mGroundMaterialTypeLookUp[kGroundMatLookUpSize]; ///< key=3Duo-groun=
dtype, value=3D in [0,16] or so (depends on tex-atlas)
 	float	mNormalLookup[kMaxZDiff*2+1][kMaxZDiff*2+1][3]; ///< y,x : 192kb wi=
th 64 maxdiff
 	float*	mNormals[(T+1)*(T+1)]; ///< internal cache
-	int		mZ[(T+3)*(T+3)]; ///< internal cache
+	int*	mZ;
+	int		mZOld[(T+3)*(T+3)]; ///< internal cache
 =

 	/// x,y must be in [-7,8+7]
 	/// returns GroundMaterialType from mGroundMaterialTypeLookUp
@@ -82,19 +135,24 @@
 	=

 	/// x,y must be in [-7,8+7]
 	inline RawGroundTile& GetTile (const int x,const int y) { =

-		if (x < 0) {
-				 if (y < 0)	return mpBlocks[0*3+0]->mTiles[y+8][x+8];
-			else if (y < 8)	return mpBlocks[1*3+0]->mTiles[y  ][x+8];
-			else			return mpBlocks[2*3+0]->mTiles[y-8][x+8];
-		}                                            =

-		if (x < 8) {                                 =

-				 if (y < 0)	return mpBlocks[0*3+1]->mTiles[y+8][x  ];
-			else if (y < 8)	return mpBlocks[1*3+1]->mTiles[y  ][x  ];
-			else			return mpBlocks[2*3+1]->mTiles[y-8][x  ];
-		}                                            =

-			 if (y < 0)		return mpBlocks[0*3+2]->mTiles[y+8][x-8];
-		else if (y < 8)		return mpBlocks[1*3+2]->mTiles[y  ][x-8];
-		else				return mpBlocks[2*3+2]->mTiles[y-8][x-8];
+		int dbx =3D (x+8)/8; // beware of int cast rounding towards zero if chan=
ging this
+		int dby =3D (y+8)/8;
+		=

+		return mpBlocks[dby*3+dbx]->mTiles[y-8*(dby-1)][x-8*(dbx-1)];
+		=

+		//~ if (x < 0) {
+				 //~ if (y < 0)	return mpBlocks[0*3+0]->mTiles[y+8][x+8];
+			//~ else if (y < 8)	return mpBlocks[1*3+0]->mTiles[y  ][x+8];
+			//~ else			return mpBlocks[2*3+0]->mTiles[y-8][x+8];
+		//~ }                                            =

+		//~ if (x < 8) {                                 =

+				 //~ if (y < 0)	return mpBlocks[0*3+1]->mTiles[y+8][x  ];
+			//~ else if (y < 8)	return mpBlocks[1*3+1]->mTiles[y  ][x  ];
+			//~ else			return mpBlocks[2*3+1]->mTiles[y-8][x  ];
+		//~ }                                            =

+			 //~ if (y < 0)		return mpBlocks[0*3+2]->mTiles[y+8][x-8];
+		//~ else if (y < 8)		return mpBlocks[1*3+2]->mTiles[y  ][x-8];
+		//~ else				return mpBlocks[2*3+2]->mTiles[y-8][x-8];
 	}
 =

 	/// returns true if the terraintype should not be drawn (=3DNoDraw types =
in uo)
@@ -220,12 +278,16 @@
 		bool bNothingFoundYet =3D true;
 		int x,y,k,ax,ay;
 		float myHitDist;
+	=

+		//~ int t0 =3D cShell::GetTicks();
+	=

 		for (ay=3D0;ay<iDY;++ay)
 		for (ax=3D0;ax<iDX;++ax) {
 			mfAddX =3D 8*ax;
 			mfAddY =3D 8*ay;
 			int bx =3D iBlockX + ax;
 			int by =3D iBlockY + ay;
+			=

 			=

 			// needed for GetZF() and GetVertexPos() to work...
 			LoadNearbyData(pGroundBlockLoader,bx,by);
@@ -245,6 +307,9 @@
 				}
 			}
 		}
+		=

+		//~ printf("multitexterrain:RayPick(bxy=3D%d,%d  iDXY=3D%d,%d T=3D%d  t=
=3D%d)\n",iBlockX,iBlockY,iDX,iDY,T,cShell::GetTicks()-t0);
+		=

 		return !bNothingFoundYet;
 	}
 	=

@@ -252,21 +317,22 @@
 		int x,y;
 		=

 		// initialize void block if neccessary: used "outside" the map, e.g. on =
the borders...
-		static RawGroundBlock	myVoidBlock;
+		static RawGroundBlock	gMultiTexTerrainVoidBlock;
 		static bool				myVoidBlockInit =3D true;
 		if (myVoidBlockInit) { =

 			myVoidBlockInit =3D false; // only once
 			cGroundBlock* pGroundBlock =3D pGroundBlockLoader->GetGroundBlock(0,0);
 			for (y=3D0;y<T;++y)
 			for (x=3D0;x<T;++x) { =

-				myVoidBlock.mTiles[y][x].miTileType	=3D pGroundBlock ? pGroundBlock->m=
pRawGroundBlock->mTiles[0][0].miTileType : 0;
-				myVoidBlock.mTiles[y][x].miZ		=3D pGroundBlock ? pGroundBlock->mpRawGr=
oundBlock->mTiles[0][0].miZ : 0;
+				gMultiTexTerrainVoidBlock.mTiles[y][x].miTileType	=3D pGroundBlock ? p=
GroundBlock->mpRawGroundBlock->mTiles[0][0].miTileType : 0;
+				gMultiTexTerrainVoidBlock.mTiles[y][x].miZ		=3D pGroundBlock ? pGround=
Block->mpRawGroundBlock->mTiles[0][0].miZ : 0;
 			}
 		}
 		=

 		// called once at startup
 		if (mfLookUpZUnit !=3D mfZUnit) { =

 			mfLookUpZUnit =3D mfZUnit; // only once per zunit
+			printf("multitexterrain:LoadNearbyData zunit switch\n");
 			for (int dz_y=3D-kMaxZDiff;dz_y<=3DkMaxZDiff;++dz_y)
 			for (int dz_x=3D-kMaxZDiff;dz_x<=3DkMaxZDiff;++dz_x) {
 				Ogre::Vector3 n =3D Ogre::Vector3(2,0,dz_x*mfZUnit).crossProduct(Ogre:=
:Vector3(0,2,dz_y*mfZUnit)).normalisedCopy();
@@ -277,29 +343,51 @@
 			}
 		}
 		=

-		// load nearby blocks
-		if (pGroundBlockLoader->PrepareGroupLoading(bx,by,1)) {
+		if (1) {
+			// new(10.01.2009) code including caching here (instead of in loader), =
better anyway for -1 .. T+2  Zarr
+			pGroundBlockLoader->PrepareGroupLoading(bx,by,1); // not really needed,=
 but might increase performance here a bit if someone implements it someday=
 *g*
+			BlockCacheLoadArea(*pGroundBlockLoader,bx,by,1);
 			for (y=3D0;y<3;++y)
 			for (x=3D0;x<3;++x) {
-				cGroundBlock* pGroundBlock =3D pGroundBlockLoader->GetGroundBlock(bx+x=
-1,by+y-1);
-				mpBlocks[y*3+x] =3D pGroundBlock ? pGroundBlock->mpRawGroundBlock : &m=
yVoidBlock;
+				mpBlocks[y*3+x] =3D &GetBlockCache(bx+x-1,by+y-1).mBlock;
+			}
+			// load z buffers to cache, each is used 4 times during vertex writing,=
 and 4 times during normal calc
+			cMultiTexTerrainBlockCache& b =3D GetBlockCache(bx,by);
+			mZ =3D b.mZCache;
+			if (sizeof(b.mZCache) !=3D sizeof(mZOld)) { mZ =3D mZOld; printf("multi=
tex terrain : blocksize mismatch (T !=3D 8?) !!!\n"); }
+			if (!b.mbZCacheValid) {
+				b.mbZCacheValid =3D true;
+				for (y=3D-1;y<=3DT+1;++y) =

+				for (x=3D-1;x<=3DT+1;++x) mZ[(y+1)*(T+3)+(x+1)] =3D GetZRaw(x,y); // i=
nit cache for use by GetZ
 			}
 		} else {
-			// group loading doesn't work, so we'll have to copy
-			static bool bPrintWarning =3D true; // only print the warning once
-			if (bPrintWarning) { printf("warning : terrain : groundblock loader doe=
sn't support group loading, falling back to copy, but it's a bit slower (gr=
oup loading not implemented yet)\n"); bPrintWarning =3D false; }
-			static RawGroundBlock myCopyBlocks[3*3];
-			for (y=3D0;y<3;++y)
-			for (x=3D0;x<3;++x) {
-				cGroundBlock* pGroundBlock =3D pGroundBlockLoader->GetGroundBlock(bx+x=
-1,by+y-1);
-				if (pGroundBlock) memcpy(&myCopyBlocks[y*3+x],pGroundBlock->mpRawGroun=
dBlock,sizeof(RawGroundBlock));
-				mpBlocks[y*3+x] =3D pGroundBlock ? &myCopyBlocks[y*3+x] : &myVoidBlock;
-			}
-		}
-		=

-		// load z buffers to cache, each is used 4 times during vertex writing, =
and 4 times during normal calc
-		for (y=3D-1;y<=3DT+1;++y) =

-		for (x=3D-1;x<=3DT+1;++x) mZ[(y+1)*(T+3)+(x+1)] =3D GetZRaw(x,y); // ini=
t cache for use by GetZ
+			// old, uncached code
+			=

+			// load nearby blocks
+			if (pGroundBlockLoader->PrepareGroupLoading(bx,by,1)) {
+				for (y=3D0;y<3;++y)
+				for (x=3D0;x<3;++x) {
+					cGroundBlock* pGroundBlock =3D pGroundBlockLoader->GetGroundBlock(bx+=
x-1,by+y-1);
+					mpBlocks[y*3+x] =3D pGroundBlock ? pGroundBlock->mpRawGroundBlock : &=
gMultiTexTerrainVoidBlock;
+				}
+			} else {
+				// group loading doesn't work, so we'll have to copy
+				static bool bPrintWarning =3D true; // only print the warning once
+				if (bPrintWarning) { printf("warning : terrain : groundblock loader do=
esn't support group loading, falling back to copy, but it's a bit slower (g=
roup loading not implemented yet)\n"); bPrintWarning =3D false; }
+				static RawGroundBlock myCopyBlocks[3*3];
+				for (y=3D0;y<3;++y)
+				for (x=3D0;x<3;++x) {
+					cGroundBlock* pGroundBlock =3D pGroundBlockLoader->GetGroundBlock(bx+=
x-1,by+y-1);
+					if (pGroundBlock) memcpy(&myCopyBlocks[y*3+x],pGroundBlock->mpRawGrou=
ndBlock,sizeof(RawGroundBlock));
+					mpBlocks[y*3+x] =3D pGroundBlock ? &myCopyBlocks[y*3+x] : &gMultiTexT=
errainVoidBlock;
+				}
+			}
+			=

+			// load z buffers to cache, each is used 4 times during vertex writing,=
 and 4 times during normal calc
+			mZ =3D mZOld;
+			for (y=3D-1;y<=3DT+1;++y) =

+			for (x=3D-1;x<=3DT+1;++x) mZ[(y+1)*(T+3)+(x+1)] =3D GetZRaw(x,y); // in=
it cache for use by GetZ
+		}
 	}
 	=

 	/// pWriter should point to a locked vertex buffer (vram)



From no-reply at zwischenwelt.org  Sun Jan 11 01:35:19 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 11 Jan 2009 00:35:19 -0000
Subject: [Iris-commit] [IRIS] r2855 - in /trunk: lua/lib.2d.mousepick.lua
 lua/lib.3d.mousepick.lua lua/lib.mapblock.2d.terrain.lua
 lua/lib.mapblock.base.lua src/terrain_multitex.cpp
Message-ID: <20090111003519.C35CF1C18808@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan 11 01:35:19 2009
New Revision: 2855

Log:
fixed parameter used for terrain mousepick that caused a far too large area=
 to be scanned, and removed a broken bbox check. added new, finer bbox chec=
ks in terrain mousepick code.  terrain mousepick is now several orders of m=
agnitude faster, 24 hours ago average dt : 70msec,  now: 1msec

Modified:
    trunk/lua/lib.2d.mousepick.lua
    trunk/lua/lib.3d.mousepick.lua
    trunk/lua/lib.mapblock.2d.terrain.lua
    trunk/lua/lib.mapblock.base.lua
    trunk/src/terrain_multitex.cpp

Modified: trunk/lua/lib.2d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.mousepick.lua (original)
+++ trunk/lua/lib.2d.mousepick.lua Sun Jan 11 01:35:19 2009
@@ -49,8 +49,7 @@
 	=

 	-- RayPickTerrain
 	--~ print("mousepick terrain")
-	local t0 =3D Client_GetTicks()
-	gProfiler_R2D_MousePick:Section("terrain",true) -- this eats most
+	gProfiler_R2D_MousePick:Section("terrain")
 	local dist,xloc,yloc =3D self:RayPickTerrain(rx,ry,rz, rvx,rvy,rvz)
 	if (dist and ((not founddist) or dist < founddist)) then =

 		founddist =3D dist =

@@ -62,14 +61,15 @@
 		gMousePickFoundHit.hit_zloc =3D ground.zloc
 		--~ print("RayPickTerrain",xloc,yloc)
 	end
-	local t1 =3D Client_GetTicks()
-	gTerrainMousePickProfileAvgSum =3D (gTerrainMousePickProfileAvgSum or 0) =
+ (t1-t0)
-	gTerrainMousePickProfileAvgC =3D (gTerrainMousePickProfileAvgC or 0) + 1
-	if (gTerrainMousePickProfileAvgC =3D=3D 10) then =

-		printf("mousepick terrain avg=3D%0.1f\n",gTerrainMousePickProfileAvgSum/=
gTerrainMousePickProfileAvgC)
-		gTerrainMousePickProfileAvgSum =3D 0
-		gTerrainMousePickProfileAvgC =3D 0
-	end
+	--~ local t0 =3D Client_GetTicks()
+	--~ local t1 =3D Client_GetTicks()
+	--~ gTerrainMousePickProfileAvgSum =3D (gTerrainMousePickProfileAvgSum or=
 0) + (t1-t0)
+	--~ gTerrainMousePickProfileAvgC =3D (gTerrainMousePickProfileAvgC or 0) =
+ 1
+	--~ if (gTerrainMousePickProfileAvgC =3D=3D 10) then =

+		--~ printf("mousepick terrain avg=3D%0.1f\n",gTerrainMousePickProfileAvg=
Sum/gTerrainMousePickProfileAvgC)
+		--~ gTerrainMousePickProfileAvgSum =3D 0
+		--~ gTerrainMousePickProfileAvgC =3D 0
+	--~ end
 	=

 	-- RayPickDynamics
 	gProfiler_R2D_MousePick:Section("dynamics")

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Sun Jan 11 01:35:19 2009
@@ -86,9 +86,11 @@
 				local iBlockUO_X,iBlockUO_Y =3D math.floor(x/8), math.floor(y/8)
 				local bx,by =3D iBlockUO_X,iBlockUO_Y
 				local tx,ty
-
-				if block:BBRayPick(rx, ry, rz, rvx, rvy, rvz) then
-					bHit,fHitDist,tx,ty =3D TerrainMultiTex_RayPick(gGroundBlockLoader,bx=
,by,w,h,0.1, rx-gfx.x,ry-gfx.y,rz-gfx.z, rvx,rvy,rvz)
+				local bs =3D 2
+
+				=

+				if true then -- don't bbox check here manually as TerrainMultiTex_RayP=
ick does internal bbox checks for blocks
+					bHit,fHitDist,tx,ty =3D TerrainMultiTex_RayPick(gGroundBlockLoader,bx=
,by,bs,bs,0.1, rx-gfx.x,ry-gfx.y,rz-gfx.z, rvx,rvy,rvz)
 =

 					if (bHit) then
 						if (tx >=3D 8) then bx =3D bx + 1   tx =3D tx - 8 end
@@ -133,7 +135,7 @@
 	local numcustomquads =3D 0
 	if self.map3d_spawners and self.map3d_spawners.statics then
 		self.map3d_spawners.statics:ForAllBlocks(function(block)
-			if block:BBRayPick(rx, ry, rz, rvx, rvy, rvz) then
+			if block:BBRayPick(rx, ry, rz, rvx, rvy, rvz) then -- if 3d static mous=
epicking is strange, look here, xmirror maybe.. no longer used for terrain,=
 only here
 				block:ForAllEntities(function(entity)
 					if (not entity.bLoaded) then return end
 					if (not entity.zloc) then print("mousepick warning, static entity has=
 no zloc",entity.serial,entity.artid) end

Modified: trunk/lua/lib.mapblock.2d.terrain.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.2d.terrain.lua (original)
+++ trunk/lua/lib.mapblock.2d.terrain.lua Sun Jan 11 01:35:19 2009
@@ -16,8 +16,7 @@
 function cMapBlock_2D_Terrain:RayPick (rx,ry,rz, rvx,rvy,rvz) =

 	local gfx =3D self.gfx_terrain =

 	if (not gfx) then return end
-	local bx,by,bs =3D self.bx * 2, self.by * 2, self.iBlockSize
-	if (not self:BBRayPick(rx, ry, rz, rvx, rvy, rvz)) then return end
+	local bx,by,bs =3D self.bx * 2, self.by * 2, 2
 	local bHit,fHitDist,tx,ty =3D TerrainMultiTex_RayPick(gGroundBlockLoader,=
bx,by,bs,bs,kRenderer2D_ZScale, rx-gfx.x,ry-gfx.y,rz-gfx.z, rvx,rvy,rvz)
 	if (not bHit) then return end
 	return fHitDist,bx * 8 + tx,by*8 + ty

Modified: trunk/lua/lib.mapblock.base.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.base.lua (original)
+++ trunk/lua/lib.mapblock.base.lua Sun Jan 11 01:35:19 2009
@@ -22,6 +22,7 @@
 -- returns hit and distance
 function cMapBlock:BBRayPick	(rx, ry, rz, rvx, rvy, rvz)
 	local x,y,w,h =3D self:GetAABB()
+	-- if 3d static mousepicking is strange, look here, xmirror maybe.. no lo=
nger used for terrain, only here
 	local hit,dist =3D RayAABBQuery( rx, ry, rz, rvx, rvy, rvz, -x,y,-10000, =
w, h, 10000 )
 	return hit,dist
 end

Modified: trunk/src/terrain_multitex.cpp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/src/terrain_multitex.cpp (original)
+++ trunk/src/terrain_multitex.cpp Sun Jan 11 01:35:19 2009
@@ -260,17 +260,24 @@
 		pRobRenderOp.End();
 	}
 	=

-	inline Ogre::Vector3 GetVertexPos	(const int x,const int y) {
+	inline Ogre::Vector3 GetVertexPosOverrideZ	(const int x,const int y,const=
 float z) {
 		#ifdef XMIRROR
-		return Ogre::Vector3(-(mfAddX+float(x)),mfAddY+float(y),GetZF(x,y));
+		return Ogre::Vector3(-(mfAddX+float(x)),mfAddY+float(y),z);
 		#else
-		return Ogre::Vector3(  mfAddX+float(x) ,mfAddY+float(y),GetZF(x,y));
+		return Ogre::Vector3(  mfAddX+float(x) ,mfAddY+float(y),z);
 		#endif
 	}
+	inline Ogre::Vector3 GetVertexPos	(const int x,const int y) { return GetV=
ertexPosOverrideZ(x,y,GetZF(x,y)); }
 	=

 	/// don't call before WriteToVertexBuffer has been called at least once t=
o set up lookup tables
 	bool	RayPick		(cGroundBlockLoader* pGroundBlockLoader,const int iBlockX,c=
onst int iBlockY,const int iDX,const int iDY,const float fZUnit,const Ogre:=
:Vector3& vRayPos,const Ogre::Vector3& vRayDir,float& pfHitDist,int& pTX,in=
t& pTY) {
 		mfZUnit =3D fZUnit;
+	=

+		//~ printf("TerrainMultiTexWrite iDX,iDY=3D%d,%d\n",iDX,iDY); // started=
 with 2 =

+		//~ int iVertexCountPerBlock	=3D T*T*4;
+		//~ int iVertexCount			=3D iDX*iDY*iVertexCountPerBlock;
+		//~ int iIndexCount				=3D iDX*iDY*T*T*6;
+	=

 	=

 		//~ printf("mulittex_terrain_raypick %p %d,%d,%d,%d\n",pGroundBlockLoade=
r,iBlockX,iBlockY,iDX,iDY);
 		=

@@ -288,6 +295,14 @@
 			int bx =3D iBlockX + ax;
 			int by =3D iBlockY + ay;
 			=

+			Ogre::Vector3 p1 =3D GetVertexPosOverrideZ(0,0,-1000);
+			Ogre::Vector3 p2 =3D GetVertexPosOverrideZ(T,T,+1000);
+			Ogre::Vector3 aabbsize =3D Ogre::Vector3(mymax(p1.x-p2.x,p2.x-p1.x),mym=
ax(p1.y-p2.y,p2.y-p1.y), 2000);
+			Ogre::AxisAlignedBox aabb(	Ogre::Vector3(mymin(p1.x,p2.x),mymin(p1.y,p2=
.y),-1000),aabbsize);
+			float fHitDist;
+			bool hit =3D cOgreWrapper::GetSingleton().RayAABBQuery(vRayPos, vRayDir=
, aabb, &fHitDist);
+			//~ printf("multitexterrain:RayPick(bxy=3D%d,%d iDXY=3D%d,%d T=3D%d aab=
bhit=3D%s)\n",bx,by,iDX,iDY,T,hit ? "hit" : "miss");
+			if (!hit) continue;
 			=

 			// needed for GetZF() and GetVertexPos() to work...
 			LoadNearbyData(pGroundBlockLoader,bx,by);
@@ -306,9 +321,12 @@
 					}
 				}
 			}
-		}
-		=

-		//~ printf("multitexterrain:RayPick(bxy=3D%d,%d  iDXY=3D%d,%d T=3D%d  t=
=3D%d)\n",iBlockX,iBlockY,iDX,iDY,T,cShell::GetTicks()-t0);
+			=

+			//~ Ogre::Vector3 v =3D GetVertexPos(0,0);
+			//~ printf("multitex terrain mousepick block %d,%d  xy=3D%0.0f,%0.0f iD=
X,iDY=3D%d,%d\n",bx,by,v.x,v.y,iDX,iDY);
+		}
+		=

+		//~ printf("multitexterrain:RayPick(bxy=3D%d,%d  iDXY=3D%d,%d T=3D%d)\n"=
,iBlockX,iBlockY,iDX,iDY,T);
 		=

 		return !bNothingFoundYet;
 	}
@@ -518,6 +536,7 @@
 =

 void	 TerrainMultiTexWrite	(cGroundBlockLoader* pGroundBlockLoader,const i=
nt iBlockX,const int iBlockY,const int iDX,const int iDY,const float fZUnit=
,cRobRenderOp& pRobRenderOp) {
 	gTiledMultiTexTerrain.WriteToRobRenderOp(pGroundBlockLoader,iBlockX,iBloc=
kY,iDX,iDY,fZUnit,pRobRenderOp);
+	//~ printf("TerrainMultiTexWrite iDX,iDY=3D%d,%d\n",iDX,iDY); // started =
with 2 =

 }
 =

 void	 TerrainMultiTex_SetZModTable	(const std::map<int,int>& myZModTable) {



From no-reply at zwischenwelt.org  Sun Jan 11 03:48:51 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 11 Jan 2009 02:48:51 -0000
Subject: [Iris-commit] [IRIS] r2856 - in /trunk/lua:
 lib.3d.dynamicspawner.lua lib.mapblock.3d.water.lua lib.tilefreewalk.lua
 lib.walking3.lua
Message-ID: <20090111024851.DC25C1C18808@zwischenwelt.org>

Author: hagish
Date: Sun Jan 11 03:48:50 2009
New Revision: 2856

Log:
greatly improved walking speed next to dynamics (ie. playercities)

Modified:
    trunk/lua/lib.3d.dynamicspawner.lua
    trunk/lua/lib.mapblock.3d.water.lua
    trunk/lua/lib.tilefreewalk.lua
    trunk/lua/lib.walking3.lua

Modified: trunk/lua/lib.3d.dynamicspawner.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamicspawner.lua (original)
+++ trunk/lua/lib.3d.dynamicspawner.lua Sun Jan 11 03:48:50 2009
@@ -14,10 +14,15 @@
 	local b =3D cMapBlockSpawner.CreateMapBlock(self, bx,by)
 	=

 	-- add already existing dynamics
-	for k,dynamic in pairs(GetDynamicList()) do =

-		if b:IsUOLocationInsideBlock(dynamic.xloc, dynamic.yloc) and (DynamicIsI=
nWorld(dynamic)) then =

-			b:AddDynamic(dynamic)
-		end =

+	local d =3D self.iBlockSize
+	local tbx =3D d * bx
+	local tby =3D d * by
+	for x =3D tbx,tbx+d-1 do
+	for y =3D tby,tby+d-1 do
+	for k,dynamic in pairs(GetDynamicsAtPosition(x,y)) do =

+		b:AddDynamic(dynamic)
+	end
+	end
 	end
 =

 	return b

Modified: trunk/lua/lib.mapblock.3d.water.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.3d.water.lua (original)
+++ trunk/lua/lib.mapblock.3d.water.lua Sun Jan 11 03:48:50 2009
@@ -259,12 +259,21 @@
 	self:Yield()
 	=

 	-- check dynamics
-	for k,dynamic in pairs(GetDynamicList()) do if (DynamicIsInWorld(dynamic)=
) then
-		if not gConfig:Get("gWaterAsGroundTiles") and dynamic.artid and FilterIs=
StaticWater(dynamic.artid) then
-			self:SetWaterZ(dynamic.xloc-basex,dynamic.yloc-basey,dynamic.zloc)					=

-		end
-	end end
-
+	if not gConfig:Get("gWaterAsGroundTiles") then
+		local d =3D self.iBlockSize
+		local tbx =3D d * self.bx
+		local tby =3D d * self.by
+		for x =3D tbx,tbx+d-1 do
+		for y =3D tby,tby+d-1 do
+		for k,dynamic in pairs(GetDynamicsAtPosition(x,y)) do =

+			if dynamic.artid and FilterIsStaticWater(dynamic.artid) then
+				self:SetWaterZ(dynamic.xloc-basex,dynamic.yloc-basey,dynamic.zloc)					=

+			end
+		end
+		end
+		end
+	end
+	=

 	-- WATER
 	local count =3D Array2DGetElementCount(self.mWaterZMap) -- might be slow
 	=


Modified: trunk/lua/lib.tilefreewalk.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.tilefreewalk.lua (original)
+++ trunk/lua/lib.tilefreewalk.lua Sun Jan 11 03:48:50 2009
@@ -383,7 +383,7 @@
 =

 =

 function gTileFreeWalk:UpdateGroundCache (xloc,yloc,zloc)
-	--~ print("##### gTileFreeWalk:UpdateGroundCache",xloc,yloc,zloc)
+	-- print("##### gTileFreeWalk:UpdateGroundCache",xloc,yloc,zloc)
 	if (not gGroundBlockLoader) then print("gTileFreeWalk:UpdateGroundCache :=
 warning, no maploader(yet)") return end
 	xloc =3D floor(xloc)
 	yloc =3D floor(yloc)
@@ -399,8 +399,12 @@
 -- triggers a rescan of the collision information around the given location
 function gTileFreeWalk:IvalidateCacheAround(xloc,yloc,radius)
 	radius =3D radius or 5
-	if self.lastscanxloc and self.lastscanyloc then
-		if dist2(xloc,yloc, self.lastscanxloc,self.lastscanyloc) < radius then
+	local lsx =3D self.lastscanxloc
+	local lsy =3D self.lastscanyloc
+	if lsx and lsy then
+		local d =3D dist2max(xloc,yloc,lsx,lsy)
+		if d < radius then
+			-- print("##### gTileFreeWalk:IvalidateCacheAround",lsx,lsy,":",xloc,yl=
oc,radius,":",d)
 			self.lastscanxloc =3D nil
 			self.lastscanyloc =3D nil
 		end
@@ -412,6 +416,7 @@
 	if (self.lastscanxloc ~=3D xloc or self.lastscanyloc ~=3D yloc) then
 		self.lastscanxloc =3D xloc
 		self.lastscanyloc =3D yloc
+	-- print("##### gTileFreeWalk:ScanGroundIfNeeded",xloc,yloc,zloc,rx,ry,rz)
 		-- read surrounding height info
 		if (self.groundcache) then
 			local myzloc =3D self.groundcache[xloc..","..yloc] =


Modified: trunk/lua/lib.walking3.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.walking3.lua (original)
+++ trunk/lua/lib.walking3.lua Sun Jan 11 03:48:50 2009
@@ -119,11 +119,9 @@
 function W3_ForAllItemsAtPos	(xloc,yloc,fun,param)
 	W3_ForAllMultiPartsAtPos(xloc,yloc,fun,param)
 	for k,static in pairs(MapGetStatics(xloc,yloc)) do fun(static,param) end
-	for k,dynamic in pairs(GetDynamicList()) do
-		if (DynamicIsInWorld(dynamic) and dynamic.artid) then
-			if (dynamic.xloc =3D=3D xloc and dynamic.yloc =3D=3D yloc and dynamic.a=
rtid < gMulti_ID) then -- non-multi
-				fun(dynamic,param)
-			end
+	for k,dynamic in pairs(GetDynamicsAtPosition(xloc,yloc)) do
+		if dynamic.artid and dynamic.artid < gMulti_ID then -- non-multi
+			fun(dynamic,param)
 		end
 	end
 end



From no-reply at zwischenwelt.org  Sun Jan 11 03:58:04 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 11 Jan 2009 02:58:04 -0000
Subject: [Iris-commit] [IRIS] r2857 - /trunk/premake.lua
Message-ID: <20090111025805.CC6851C18808@zwischenwelt.org>

Author: hagish
Date: Sun Jan 11 03:58:04 2009
New Revision: 2857

Log:
added jit to premake

Modified:
    trunk/premake.lua

Modified: trunk/premake.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/premake.lua (original)
+++ trunk/premake.lua Sun Jan 11 03:58:04 2009
@@ -11,6 +11,7 @@
 gbExtraWarnings =3D false
 gbOptimize =3D true
 gOisPlatform =3D "linux"
+gbUseLuaJit =3D false
 gbUseSystemOis =3D false -- static compile ois segfaultet at mKeyboard->se=
tTextTranslation, ois-headers in system incompatible ?
 gbNo64BitChecks =3D false
 gbDisableProfiling =3D true
@@ -31,19 +32,36 @@
 addoption("oisplatform","select OIS platform (linux,mac,SDL,win32, default=
:linux), only valid if lugre ois is used")
 addoption("noassert","don't use asserts")
 addoption("openalsoft","use openal-soft instead of openal")
-
-if (options["wall"]) then gbExtraWarnings =3D true print("extra warnings e=
nabled") end
-if (options["nooptimize"]) then gbOptimize =3D false print("optimization d=
isabled") end
-if (options["usesystemois"]) then gbUseSystemOis =3D true print("using sys=
temwide installed ois") end
-if (options["oisplatform"]) then gOisPlatform =3D options["oisplatform"] p=
rint("using oisplatform: "..gOisPlatform) end
-if (options["no64bitcheck"]) then gbNo64BitChecks =3D true print("disabled=
 64bit checks") end
-if (options["noassert"]) then gbDisableAssert =3D true print("disabled ass=
erts (NDEBUG)") end
-if (options["openalsoft"]) then gbUseSoundOpenAl =3D true gLugreUseOpenAlS=
oft =3D true print("enabled openal-soft") end
+addoption("useluajit","use luajit (just in time compiler)")
+
+if (options["wall"]) then gbExtraWarnings =3D true print(">>> extra warnin=
gs enabled") end
+if (options["nooptimize"]) then gbOptimize =3D false print(">>> optimizati=
on disabled") end
+if (options["usesystemois"]) then gbUseSystemOis =3D true print(">>> using=
 systemwide installed ois") end
+if (options["oisplatform"]) then gOisPlatform =3D options["oisplatform"] p=
rint(">>> using oisplatform: "..gOisPlatform) end
+if (options["no64bitcheck"]) then gbNo64BitChecks =3D true print(">>> disa=
bled 64bit checks") end
+if (options["noassert"]) then gbDisableAssert =3D true print(">>> disabled=
 asserts (NDEBUG)") end
+if (options["openalsoft"]) then gbUseSoundOpenAl =3D true gLugreUseOpenAlS=
oft =3D true print(">>> enabled openal-soft") end
+if (options["useluajit"]) then gbUseLuaJit =3D true print(">>> enabled lua=
jit") end
 =

 gLugreDir =3D "lugre"
-if (io.open("mylugre/lua/lugre.lua")) then print("using mylugre dir overri=
de") gLugreDir =3D "mylugre" end
-
-gLugreLuaSrcDir =3D "./"..gLugreDir.."/lib/lua-5.1.4/"
+if (io.open("mylugre/lua/lugre.lua")) then print(">>> using mylugre dir ov=
erride") gLugreDir =3D "mylugre" end
+
+if gbUseLuaJit then
+	gLugreLuaSrcDir =3D "./"..gLugreDir.."/lib/LuaJIT-1.1.5/"
+	if not os.fileexists(gLugreLuaSrcDir.."/jit/opt.lua") then
+		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
+		print("ERROR luajit is enabled but there is no jit directory next to you=
r executable")
+		print("perhaps you forgot to link it? perhaps enter: cd bin && ln -s ../=
"..gLugreLuaSrcDir.."/jit")
+		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
+	else
+		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
+		print("don't forget to add 'require(\"jit.opt\").start()' to the top of =
main.lua")
+		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
+	end
+else
+	gLugreLuaSrcDir =3D "./"..gLugreDir.."/lib/lua-5.1.4/"
+end
+
 gLugreOisDir =3D "./"..gLugreDir.."/baselib/ois/"
 gLugreOpenAlSoftDir =3D "./"..gLugreDir.."/baselib/openal-soft-1.6.372/"
 =

@@ -205,13 +223,13 @@
 package.language =3D "c++"
 package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbOp=
timize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil }
 package.buildoptions =3D {}
-package.includepaths =3D { gLugreLuaSrcDir.."/src" }
+package.includepaths =3D { gLugreLuaSrcDir.."/src", gLugreLuaSrcDir.."/dyn=
asm" } -- dynasm is used for luajit
 package.defines =3D { =

 	"LUA_USE_POSIX", -- execute shellcommands
 	gbDisableAssert and "NDEBUG" or nil,
 }	=

 package.files =3D {
-  matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c"),
+  matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c", gLu=
greLuaSrcDir.."/dynasm/*.h"),	-- dynasm is used for luajit
 }
 =

 -- ---------------------------------------------
@@ -251,9 +269,9 @@
 	package.language =3D "c++"
 	package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbO=
ptimize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil=
 }
 	package.buildoptions =3D {}
-	package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/=
", "include", glOisIncludeList and unpack(glOisIncludeList) or nil }
+	package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/=
", gLugreLuaSrcDir.."/dynasm", "include", glOisIncludeList and unpack(glOis=
IncludeList) or nil } -- dynasm is used for luajit =

 	package.files =3D {
-		matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c"),
+		matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c", gLu=
greLuaSrcDir.."/dynasm/*.h"), -- dynasm is used for luajit =

 	}
 	table.insert(package.files, matchrecursive(gLugreDir.."/lib/"..v.."/inclu=
de/*.h")) =

 	table.insert(package.files, matchrecursive(gLugreDir.."/lib/"..v.."/src/*=
.cpp")) =

@@ -273,7 +291,7 @@
 package.links =3D {  }
 package.buildflags =3D { bExtraWarnings and "extra-warnings" or nil, gbOpt=
imize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil }
 package.buildoptions =3D {}
-package.includepaths =3D { gLugreLuaSrcDir.."/src", gLugreDir.."/include",=
 glOisIncludeList and unpack(glOisIncludeList) or nil }
+package.includepaths =3D { gLugreLuaSrcDir.."/src", gLugreLuaSrcDir.."/dyn=
asm/*.h", gLugreDir.."/include", glOisIncludeList and unpack(glOisIncludeLi=
st) or nil } -- dynasm is used for luajit
 package.files =3D {
   matchrecursive(gLugreDir.."/include/*.h", gLugreDir.."/src/*.cpp"),
 }
@@ -291,7 +309,7 @@
 package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbOp=
timize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil }
 package.buildoptions =3D {}
 =

-package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/"=
, "include" }
+package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/"=
,gLugreLuaSrcDir.."/dynasm", "include" } -- dynasm is used for luajit
 -- add lib includes
 for k,v in pairs(gLugreLibList) do =

 	table.insert(package.includepaths, gLugreDir.."/lib/"..v.."/include/") =




From no-reply at zwischenwelt.org  Sun Jan 11 05:10:15 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 11 Jan 2009 04:10:15 -0000
Subject: [Iris-commit] [IRIS] r2858 - in /trunk/data/models:
 materials/textures.material models/to_008000/mdl_007888.mesh
 models/to_008000/mdl_007889.mesh models/to_008000/mdl_007890.mesh
 textures/tex_RedCommCrystal.png
Message-ID: <20090111041015.D6F141C18807@zwischenwelt.org>

Author: hagish
Date: Sun Jan 11 05:10:14 2009
New Revision: 2858

Log:
added new models, thx to cougar

Added:
    trunk/data/models/models/to_008000/mdl_007888.mesh   (with props)
    trunk/data/models/models/to_008000/mdl_007889.mesh   (with props)
    trunk/data/models/models/to_008000/mdl_007890.mesh   (with props)
    trunk/data/models/textures/tex_RedCommCrystal.png   (with props)
Modified:
    trunk/data/models/materials/textures.material

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Sun Jan 11 05:10:14 2009
@@ -6042,3 +6042,8 @@
 {
 	set_texture_alias MainTexture tex_powercrystal.png
 }
+
+material tex_CommCrystal : tex_base
+{
+	set_texture_alias MainTexture tex_RedCommCrystal.png
+}



From no-reply at zwischenwelt.org  Sun Jan 11 12:33:30 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 11 Jan 2009 11:33:30 -0000
Subject: [Iris-commit] [IRIS] r2859 - /trunk/bin/iris2.exe
Message-ID: <20090111113330.767EA1C1880C@zwischenwelt.org>

Author: sience
Date: Sun Jan 11 12:33:29 2009
New Revision: 2859

Log:
-new win32 binary

Modified:
    trunk/bin/iris2.exe

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sun Jan 11 16:58:31 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 11 Jan 2009 15:58:31 -0000
Subject: [Iris-commit] [IRIS] r2860 - in /trunk/lua: lib.2d.map.lua
 lib.2d.renderer.lua lib.blendout.lua lib.charcreate.lua main.lua
 net.walk.lua
Message-ID: <20090111155832.289AE1C1880C@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan 11 16:58:30 2009
New Revision: 2860

Log:
walk net code profiled, and multi-blendout-calc optimized

Modified:
    trunk/lua/lib.2d.map.lua
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.blendout.lua
    trunk/lua/lib.charcreate.lua
    trunk/lua/main.lua
    trunk/lua/net.walk.lua

Modified: trunk/lua/lib.2d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.map.lua (original)
+++ trunk/lua/lib.2d.map.lua Sun Jan 11 16:58:30 2009
@@ -65,6 +65,7 @@
 	--~ if (self:CamModeAllowsBlendout()) then ... end   -- don't blend out i=
n freecam ?
 	myLayer,bTerrainVisible =3D CalcBlendOutZ()
 	=

+	gProfiler_Walk:Section("BlendOutLayersAbovePlayer:setvis")
 	=

 	-- only update if changed
 	if (self.giBlendOutCurZ ~=3D myLayer or self.gbBlendOutTerrainVisible ~=
=3D bTerrainVisible) then

Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Sun Jan 11 16:58:30 2009
@@ -94,19 +94,18 @@
 	gProfiler_R2D_MainStep:Section("MobileAnimStep")
 	self:MobileAnimStep()
 	=

-	gProfiler_R2D_MainStep:Section("walk")
+	gProfiler_R2D_MainStep:Section("mouse")
 	local uodir,pixeldist =3D Get2DMouseDirAndDist()
 	=

 	local xloc,yloc,zloc =3D GetPlayerPos()
 	local bOfflineMode =3D xloc =3D=3D nil
-	local bMousePickBlockedByWalk =3D false
+	gProfiler_R2D_MainStep:Section("walk")
 	if (not bOfflineMode) then
 		if (gKeyPressed[key_mouse_right] and (not gLastMouseDownWidget)) then =

 			local bRunFlag =3D pixeldist > 200
 			if (gAlwaysRun) then bRunFlag =3D true end
 			--~ print("Get2DMouseDirAndDist",uodir,pixeldist)
 			WalkStep_WalkInDir(uodir,bRunFlag,true)
-			bMousePickBlockedByWalk =3D true
 		end
 		=

 		=


Modified: trunk/lua/lib.blendout.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.blendout.lua (original)
+++ trunk/lua/lib.blendout.lua Sun Jan 11 16:58:30 2009
@@ -1,8 +1,12 @@
 =

 kBlendOutPlayerHeight =3D 18	--eriminator: es galt grob, alles was 18z =C3=
=AF=C2=BF=C2=BDberm char war wurd ausgebledent
 =

+gProfiler_Blendout =3D CreateRoughProfiler("Blendout") -- gEnableProfiler_=
Blendout
+
 -- returns myLayer,bTerrainVisible
 function CalcBlendOutZ ()
+	gProfiler_Blendout:Start(gEnableProfiler_Blendout)
+	gProfiler_Blendout:Section("start")
 	local x,y,z =3D GetPlayerPos()
 	=

 	local myLayer =3D nil
@@ -13,10 +17,12 @@
 	local playerheadpos =3D z + kBlendOutPlayerHeight
 	=

 	-- check ground
+	gProfiler_Blendout:Section("ground")
 	local iPlayerGroundZLoc =3D GetGroundZAtAbsPos(x,y) =

 	if (iPlayerGroundZLoc and iPlayerGroundZLoc >=3D playerheadpos) then play=
erIsInside =3D true bTerrainVisible =3D false end
 	=

 	-- check statics
+	gProfiler_Blendout:Section("statics")
 	if (not playerIsInside) then
 		local l =3D MapGetStatics(x,y)
 		=

@@ -29,24 +35,26 @@
 	end
 =

 	-- check multis
+	gProfiler_Blendout:Section("multis")
 	if (not playerIsInside) then
-		local iTileTypeID,iX,iY,iZ,iHue
-		local multi
-		for k,v in pairs(gMultis) do
-			multi =3D k
-			if multi.lparts then
-				for k,v in pairs(multi.lparts) do
-					iTileTypeID,iX,iY,iZ,iHue =3D unpack(v)
-					if	iX =3D=3D x and iY =3D=3D y  and iZ >=3D playerheadpos then
-						playerIsInside =3D true
-						if ((not zloc_roof) or (zloc_roof > iZ)) then zloc_roof =3D iZ end
-					end
+		local xloc =3D x
+		local yloc =3D y
+		local n =3D xloc..","..yloc
+		for multi,v in pairs(gMultis) do =

+			local cache =3D multi.cache and multi.cache[n] -- see Multi_AddPartHelp=
er =

+			if (cache) then for k,item in pairs(cache) do =

+				-- item =3D {iZ=3Dzloc,iTileTypeID=3DiTileTypeID,xloc=3Dxloc,yloc=3Dyl=
oc,zloc=3Dzloc,artid=3DiTileTypeID,iHue=3DiHue}
+				local iZ =3D item.zloc
+				if iZ >=3D playerheadpos then
+					playerIsInside =3D true
+					if ((not zloc_roof) or (zloc_roof > iZ)) then zloc_roof =3D iZ end
 				end
-			end
+			end end
 		end
 	end
 =

 	-- check dynamics to detect dynamic houseroofs and other stuff above the =
head
+	gProfiler_Blendout:Section("dynamics")
 	if (not playerIsInside) then
 		local iZ
 		for k,dynamic in pairs(GetDynamicsAtPosition(x,y)) do
@@ -57,6 +65,7 @@
 			end
 		end
 	end
+	gProfiler_Blendout:End()
 =

 	-- blend out layers above player head if inside
 	--~ if (playerIsInside) then myLayer =3D zloc_roof or playerheadpos end

Modified: trunk/lua/lib.charcreate.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.charcreate.lua (original)
+++ trunk/lua/lib.charcreate.lua Sun Jan 11 16:58:30 2009
@@ -77,7 +77,7 @@
 	chardata.hairColor		=3D hex2num("0x044E") -- 0x044E(human) 0x0034(elf)
 	chardata.facialHair		=3D hex2num("0x0000")
 	chardata.facialHairColor=3D hex2num("0x0000")
-	chardata.location		=3D hex2num("0x0000") -- uogamers: 0=3Dyew,1=3Dminoc,2=
=3Dbrit,3=3Dmoonglow,4=3Dtrinsik,5=3DMagincia,6=3Djhelom,7=3Dscara,8=3Dvesp=
er,9=3Docclo,10=3D
+	chardata.location		=3D hex2num("0x0000") -- uogamers: 0=3Dyew,1=3Dminoc,2=
=3Dbrit,3=3Dmoonglow,4=3Dtrinsik,5=3DMagincia,6=3Djhelom,7=3Dscara,8=3Dvesp=
er,9=3Docclo
 	chardata.slot			=3D hex2num("0x0003")
 	chardata.shirtColor		=3D hex2num("0x036F") --hex2num("0x0083")
 	chardata.pantsColor		=3D hex2num("0x0111") --hex2num("0x01AC")

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Jan 11 16:58:30 2009
@@ -432,15 +432,19 @@
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop =3D=3D=3D")
 	if (not gEnableRoughProfileSum) then return end
 	local arr =3D {}
-	for k,profiler in pairs({gProfiler_MainStep,gProfiler_R2D_MainStep,gProfi=
ler_R2D_MousePick,gProfiler_R3D_MainStep}) do
+	for k,profiler in pairs({gProfiler_MainStep,
+							gProfiler_R2D_MainStep,
+							gProfiler_R2D_MousePick,
+							gProfiler_R3D_MainStep,
+							gProfiler_Walk,
+							gProfiler_Blendout,	=

+							}) do
 		for secname,tsum in pairs(profiler.sum) do table.insert(arr,{name=3Dprof=
iler.name..":"..secname,tsum=3Dtsum}) end
 		profiler.sum =3D {}
 	end =

 	table.sort(arr,function (a,b) return a.tsum > b.tsum end)
-	local totaltsum =3D 0
 	for k,o in pairs(arr) do =

-		if (k <=3D 5) then print(" #"..k,sprintf("%5dmsec (%3d%%)",o.tsum,floor(=
100*o.tsum/gMyProfilerTopCPUTSum)),o.name) end
-		totaltsum =3D totaltsum + o.tsum
+		if (k <=3D 10) then print(" #"..k,sprintf("%5dmsec (%3d%%)",o.tsum,floor=
(100*o.tsum/gMyProfilerTopCPUTSum)),o.name) end
 	end
 	print(sprintf(" total time=3D%dsec cpu=3D%d%% gpu=3D%d%% idle/maxfpswait=
=3D%d%%"	=

 															,	floor(gMyProfilerTopTenInterval/1000)

Modified: trunk/lua/net.walk.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net.walk.lua (original)
+++ trunk/lua/net.walk.lua Sun Jan 11 16:58:30 2009
@@ -93,6 +93,8 @@
 function GetPlayerDir () return gPlayerDir end
 =

 -- fulldir CAN include runflag
+
+
 function SetPlayerPos (xloc,yloc,zloc,fulldir) =

 	--~ WalkLog("SetPlayerPos",xloc,yloc,zloc,fulldir)
 	local dir =3D BitwiseAND(fulldir,hex2num("0x07"))
@@ -101,22 +103,29 @@
 	gPlayerYLoc =3D yloc
 	gPlayerZLoc =3D zloc
 	=

+	gProfiler_Walk:Section("SetPlayerPos:Hook_SetPlayerPos")
 	NotifyListener("Hook_SetPlayerPos")
+	gProfiler_Walk:Section("SetPlayerPos:GetPlayerMobile")
 	=

 	local mobile =3D GetPlayerMobile()
 	if (not mobile) then return end
 	=

 	-- update the mobile/char/body of the player
+	gProfiler_Walk:Section("SetPlayerPos:mob:Update")
 	mobile.xloc =3D xloc
 	mobile.yloc =3D yloc
 	mobile.zloc =3D zloc
 	mobile.dir =3D fulldir
 	mobile:Update()
+	gProfiler_Walk:Section("SetPlayerPos:PacketVideoLog")
 	PacketVideo_LogPlayerPos(xloc,yloc,zloc,fulldir)
 	=

 	-- handle position update
+	gProfiler_Walk:Section("SetPlayerPos:BlendOutLayersAbovePlayer")
 	gCurrentRenderer:BlendOutLayersAbovePlayer()
+	gProfiler_Walk:Section("SetPlayerPos:DestroyObjectsFarFromPlayer")
 	DestroyObjectsFarFromPlayer(gPlayerXLoc,gPlayerYLoc)
+	gProfiler_Walk:End() -- in case it this is called from outside walk
 end
 =

 =

@@ -129,16 +138,22 @@
 -- clientside collision check, returns true if passable
 function WalkStep_CanWalkInDir	(iDir) =

 	iDir =3D DirWrap(iDir)
-	return GetNearestGroundLevel(gPlayerXLoc,gPlayerYLoc,gPlayerZLoc,iDir) ~=
=3D nil
-end
+	return GetNearestGroundLevel(gPlayerXLoc,gPlayerYLoc,gPlayerZLoc,iDir)
+end
+
+
+gProfiler_Walk =3D CreateRoughProfiler("Walk") -- gEnableProfiler_Walk
 =

 -- does collision detection, tries neighboring dirs if direct walk is bloc=
ked
 function WalkStep_WalkInDir		(iDir,bRunFlag,bTrySides) =

 	if (not Walk_RequestTimeOk()) then return end
 	iDir =3D DirWrap(iDir)
-	if (						WalkStep_CanWalkInDir(iDir  )) then return ExecWalkRequestIfPos=
sible(iDir  ,bRunFlag) end
-	if (bTrySides and			WalkStep_CanWalkInDir(iDir-1)) then return ExecWalkRe=
questIfPossible(iDir-1,bRunFlag) end
-	if (bTrySides and			WalkStep_CanWalkInDir(iDir+1)) then return ExecWalkRe=
questIfPossible(iDir+1,bRunFlag) end
+	gProfiler_Walk:Start(gEnableProfiler_Walk)
+	gProfiler_Walk:Section("WalkInDir:CheckCanWalk")
+	local nextzloc =3D WalkStep_CanWalkInDir(iDir)	if (				nextzloc) then ret=
urn ExecWalkRequestIfPossible(iDir  ,bRunFlag,nextzloc) end
+	local nextzloc =3D WalkStep_CanWalkInDir(iDir-1)	if (bTrySides and	nextzl=
oc) then return ExecWalkRequestIfPossible(iDir-1,bRunFlag,nextzloc) end
+	local nextzloc =3D WalkStep_CanWalkInDir(iDir+1)	if (bTrySides and	nextzl=
oc) then return ExecWalkRequestIfPossible(iDir+1,bRunFlag,nextzloc) end
+	gProfiler_Walk:End()
 end
 =

 function WalkStep_WalkToPosSimple	(xloc,yloc,bRunFlag,bTrySides) =

@@ -174,44 +189,52 @@
 end
 	=

 -- internal, don't call directly, no check for walkable, only checks for t=
ime
-function ExecWalkRequestIfPossible	(iDir,bRunFlag)
+function ExecWalkRequestIfPossible	(iDir,bRunFlag,nextzloc)
 	if (not Walk_RequestTimeOk()) then return end
 	if (gResyncRequestActive and gMyTicks < gResyncRequestActive + 1000) then=
 return end
-	if (not FastWalk_Ok()) then return end
+	=

+	gProfiler_Walk:Start(gEnableProfiler_Walk)
+	gProfiler_Walk:Section("ExecWalk:FastWalkCheck")
+	=

+	if (not FastWalk_Ok()) then gProfiler_Walk:End() return end
 	if (not gFastWalkKeysUsed) then =

 		if (not WalkQueueOkForNextSend()) then
 			if (Client_GetTicks() > gWalkRequestAntiStuckTimeout) then
 				print("walk:walk-request-timeout,sending resync-request")
 				Send_Movement_Resync_Request()
 			else
+				gProfiler_Walk:End()
 				return =

 			end
 		end
 	end
+	gProfiler_Walk:Section("ExecWalk:TimeCalc")
 	gWalkRequestAntiStuckTimeout =3D Client_GetTicks() + 2000 -- might need r=
esync
 	iDir =3D DirWrap(iDir)
 	local iFullDir =3D BitwiseOR(iDir,bRunFlag and kWalkFlag_Run or 0) -- inc=
ludes runflag
 	=

 	local playermobile =3D GetPlayerMobile()
 	--~ WalkLog2("ExecWalkRequestIfPossible playermobile",playermobile)
-	if (not playermobile) then return end
+	if (not playermobile) then gProfiler_Walk:End() return end
 	=

 	-- init request
 	local xloc =3D gPlayerXLoc
 	local yloc =3D gPlayerYLoc
 	local zloc =3D gPlayerZLoc
 	=

+	gProfiler_Walk:Section("ExecWalk:WalkForward")
 	-- calculate wait time and success-pos
 	local iWaitTime =3D gWalkTimeout_DirectionChange -- just turn without wal=
king is quick
 	if (iDir =3D=3D gPlayerDir) then -- walk forward
 		iWaitTime =3D WalkGetInterval(bRunFlag)
-		zloc =3D GetNearestGroundLevel(xloc,yloc,zloc,gPlayerDir)
+		zloc =3D nextzloc or GetNearestGroundLevel(xloc,yloc,zloc,gPlayerDir)
 		assert(zloc)
 		=

 		xloc =3D xloc + GetDirX(gPlayerDir)
 		yloc =3D yloc + GetDirY(gPlayerDir)
 	end
 	=

+	gProfiler_Walk:Section("ExecWalk:SendRequest")
 	-- set next request time
 	gNextWalkRequestTime =3D math.max(gMyTicks,gNextWalkRequestTime + iWaitTi=
me) -- compensate slow fps a bit
 	=

@@ -232,9 +255,12 @@
 	gNextWalkSequenceNumber =3D gNextWalkSequenceNumber + 1
 	if (gNextWalkSequenceNumber > 255) then gNextWalkSequenceNumber =3D 1 end
 	=

+	gProfiler_Walk:Section("ExecWalk:SetPlayerPos")
 	-- set player pos
 	SetPlayerPos(xloc,yloc,zloc,iFullDir)
+	gProfiler_Walk:Section("ExecWalk:renderer:SetLastRequestedUOPos")
 	gCurrentRenderer:SetLastRequestedUOPos(xloc,yloc,zloc)
+	gProfiler_Walk:End()
 	return true
 end
 =




From no-reply at zwischenwelt.org  Mon Jan 12 22:49:05 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 12 Jan 2009 21:49:05 -0000
Subject: [Iris-commit] [IRIS] r2861 - in /trunk/lua: lib.2d.dynamic.lua
 lib.2d.renderer.lua lib.mapblock.base.lua lib.protocol.lua main.lua
 net/net.multi.lua
Message-ID: <20090112214905.4C55A1C1880E@zwischenwelt.org>

Author: ghoulsblade
Date: Mon Jan 12 22:49:04 2009
New Revision: 2861

Log:
more profile summary output : memory allocation (lua/ogre) and cpuspikes/de=
lays/lags, packet-profiling now also uses the roughprofiler,  removed a few=
 unneeded hex2num calls in customhouse packet and added customhouse packet =
detail profiler (spikes),  2dmode : multi-construction is threaded(coroutin=
e) now to avoid spikes

Modified:
    trunk/lua/lib.2d.dynamic.lua
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.mapblock.base.lua
    trunk/lua/lib.protocol.lua
    trunk/lua/main.lua
    trunk/lua/net/net.multi.lua

Modified: trunk/lua/lib.2d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.dynamic.lua (original)
+++ trunk/lua/lib.2d.dynamic.lua Mon Jan 12 22:49:04 2009
@@ -1,8 +1,10 @@
 -- dynamics (items,doors,...)
 Renderer2D.gDynamicBlocks =3D {}
 Renderer2D.gDynamicBlockDirtyList =3D {}
+Renderer2D.gUpdateMultiList =3D {}
 =

 function Renderer2D:AddDynamicItem					(item) =

+	item.r2d_removed =3D nil
 	if item.artid >=3D gMulti_ID then =

 		-- multi
 		self:UpdateMultiItemGfx(item)
@@ -25,6 +27,7 @@
 		self:DynamicBlockMarkAsDirty(block)
 	end
 	ArtAtlasUnLock(item)
+	item.r2d_removed =3D true
 end
 =

 =

@@ -178,50 +181,82 @@
 	end
 end
 =

-function Renderer2D:UpdateMultiItemGfx				(item) =

-	gDebugLastMultiItem =3D item
-	local multi =3D item.multi
-	if (not multi) then print("Renderer2D:AddMultiItem error:no multi data") =
return end
-	=

-	-- create spriteblock
-	local spriteblock =3D item.gfx2d
-	if (not spriteblock) then
-		spriteblock =3D cUOSpriteBlock:New()
-		item.gfx2d =3D spriteblock
-	else
-		spriteblock:Clear()
-	end
-	=

-	-- add multi parts
-	local totalpartnum =3D #multi.lparts
-	local itemxloc =3D item.xloc
-	local itemyloc =3D item.yloc
-	local itemzloc =3D item.zloc
-	=

-	local iBlendOutMinZ,iBlendOutMaxZ =3D self:BlendoutGetVisibleRange()
-		=

-	for k,part in pairs(multi.lparts) do
-		local iTileTypeID,xloc,yloc,zloc,iHue =3D unpack(part) -- see Multi_AddP=
artHelper
-		local tx =3D xloc-itemxloc
-		local ty =3D yloc-itemyloc
-		local tz =3D zloc-itemzloc
-		local sorttx =3D xloc-floor(xloc/8)*8
-		local sortty =3D yloc-floor(yloc/8)*8
-		local sorttz =3D zloc
-		local fIndexRel =3D k / totalpartnum
-		if (zloc >=3D iBlendOutMinZ and zloc <=3D iBlendOutMaxZ and =

-			((not gMulti_OnlyShowFloor) or tz <=3D 0 or (gOnlyShowFloorItemTypeList=
[iTileTypeID]))) then -- <=3D 7 for floor
-			local sprite =3D spriteblock:AddArtSprite(tx,ty,tz,iTileTypeID,iHue,Cal=
cSortBonus(iTileTypeID,sorttx,sortty,sorttz,fIndexRel,1),item)
-			if (sprite) then
-				sprite.xloc =3D xloc -- mousepicking
-				sprite.yloc =3D yloc
-				sprite.zloc =3D zloc
-			end
+function Renderer2D:UpdateMultiItemGfx				(item)
+	self.gUpdateMultiList[item] =3D true
+end
+
+function Renderer2D:Dynamics_MultiUpdateStep			(item) =

+	local job =3D self.pMultiUpdateJob
+	if (not job) then job =3D coroutine.create(self.UpdateMultiItemJobFun) se=
lf.pMultiUpdateJob =3D job end
+	local t =3D Client_GetTicks()
+	self.tUpdateMultiItemJobStepEnd =3D t + 10
+	local status,r =3D coroutine.resume(job,self)
+	if not status then
+		print("ERROR: 2D:Dynamics_MultiUpdateStep job terminated: ",r)
+		self.pMultiUpdateJob =3D nil -- destroy crashed job so new one can be st=
arted next round
+	end
+end
+
+
+-- meant to be executed inside a coroutine, see Dynamics_MultiUpdateStep
+function Renderer2D.UpdateMultiItemJobFun				() =

+	local self =3D Renderer2D
+	function YieldIfOverTime () if (Client_GetTicks() > self.tUpdateMultiItem=
JobStepEnd) then coroutine.yield() end end
+	repeat =

+		local item,v =3D next(self.gUpdateMultiList)
+		if (item) then =

+			gDebugLastMultiItem =3D item
+			local multi =3D item.multi
+			if (not multi) then print("Renderer2D:AddMultiItem error:no multi data"=
) return end
+			=

+			-- create spriteblock
+			local spriteblock =3D item.gfx2d
+			if (not spriteblock) then
+				spriteblock =3D cUOSpriteBlock:New()
+				item.gfx2d =3D spriteblock
+			else
+				spriteblock:Clear()
+			end
+			=

+			-- add multi parts
+			local totalpartnum =3D #multi.lparts
+			local itemxloc =3D item.xloc
+			local itemyloc =3D item.yloc
+			local itemzloc =3D item.zloc
+			=

+			local iBlendOutMinZ,iBlendOutMaxZ =3D self:BlendoutGetVisibleRange()
+			YieldIfOverTime()
+				=

+			for k,part in pairs(multi.lparts) do
+				local iTileTypeID,xloc,yloc,zloc,iHue =3D unpack(part) -- see Multi_Ad=
dPartHelper
+				local tx =3D xloc-itemxloc
+				local ty =3D yloc-itemyloc
+				local tz =3D zloc-itemzloc
+				local sorttx =3D xloc-floor(xloc/8)*8
+				local sortty =3D yloc-floor(yloc/8)*8
+				local sorttz =3D zloc
+				local fIndexRel =3D k / totalpartnum
+				if (zloc >=3D iBlendOutMinZ and zloc <=3D iBlendOutMaxZ and =

+					((not gMulti_OnlyShowFloor) or tz <=3D 0 or (gOnlyShowFloorItemTypeLi=
st[iTileTypeID]))) then -- <=3D 7 for floor
+					local sprite =3D spriteblock:AddArtSprite(tx,ty,tz,iTileTypeID,iHue,C=
alcSortBonus(iTileTypeID,sorttx,sortty,sorttz,fIndexRel,1),item)
+					if (sprite) then
+						sprite.xloc =3D xloc -- mousepicking
+						sprite.yloc =3D yloc
+						sprite.zloc =3D zloc
+					end
+					YieldIfOverTime()
+				end
+				if (item.r2d_removed) then break end -- multi has been destroyed while=
 still in construction
+			end
+			if (not item.r2d_removed) then
+				spriteblock:Build(Renderer2D.kSpriteBaseMaterial)
+				local x,y,z =3D gCurrentRenderer:UOPosToLocal(itemxloc,itemyloc,itemzl=
oc*kRenderer2D_ZScale)
+				spriteblock:SetPosition(x,y,z)
+			end
+			self.gUpdateMultiList[item] =3D nil
 		end
-	end
-	spriteblock:Build(Renderer2D.kSpriteBaseMaterial)
-	local x,y,z =3D gCurrentRenderer:UOPosToLocal(itemxloc,itemyloc,itemzloc*=
kRenderer2D_ZScale)
-	spriteblock:SetPosition(x,y,z)
+		coroutine.yield()
+	until false
 end
 =

 -- unused for 2d

Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Mon Jan 12 22:49:04 2009
@@ -147,11 +147,12 @@
 	end
 =

 	=

-	gProfiler_R2D_MainStep:Section("EffectAnimStep")		self:EffectAnimStep() -=
- should be after player pos is updated, for effects moving with player
-	gProfiler_R2D_MainStep:Section("MapStep")				self:MapStep()
-	gProfiler_R2D_MainStep:Section("HUDFX_MainStep")		self:HUDFX_MainStep()
-	gProfiler_R2D_MainStep:Section("Dynamics_MainStep")		self:Dynamics_MainSt=
ep()
-	gProfiler_R2D_MainStep:Section("MousePickStep",true)	self:MousePickStep()
+	gProfiler_R2D_MainStep:Section("EffectAnimStep")			self:EffectAnimStep() =
-- should be after player pos is updated, for effects moving with player
+	gProfiler_R2D_MainStep:Section("MapStep")					self:MapStep()
+	gProfiler_R2D_MainStep:Section("HUDFX_MainStep")			self:HUDFX_MainStep()
+	gProfiler_R2D_MainStep:Section("Dynamics_MainStep")			self:Dynamics_MainS=
tep()
+	gProfiler_R2D_MainStep:Section("Dynamics_MultiUpdateStep")	self:Dynamics_=
MultiUpdateStep()
+	gProfiler_R2D_MainStep:Section("MousePickStep",true)		self:MousePickStep()
 	gProfiler_R2D_MainStep:End()
 end
 =


Modified: trunk/lua/lib.mapblock.base.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.base.lua (original)
+++ trunk/lua/lib.mapblock.base.lua Mon Jan 12 22:49:04 2009
@@ -39,7 +39,7 @@
 =

 function cMapBlock:SetPriority		(prio)	self.prio =3D prio end
 function cMapBlock:Yield			()		=

-	self.last_yield_stack =3D _TRACEBACK()
+	--~ self.last_yield_stack =3D _TRACEBACK() -- used nowhere ? waste of per=
formance
 	coroutine.yield() =

 end
 function cMapBlock:YieldIfOverTime	()		if (Client_GetTicks() > self.t_end)=
 then self:Yield() end end

Modified: trunk/lua/lib.protocol.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.protocol.lua (original)
+++ trunk/lua/lib.protocol.lua Mon Jan 12 22:49:04 2009
@@ -42,12 +42,15 @@
 	for k,v in pairs(gPacketType) do gPacketTypeId2Name[v.id] =3D k end
 	for k,v in pairs(gPacketType) do _G[k] =3D v.id end -- make names availab=
le as global constants, like kPacket_Account_Login_Request, needed for send=
ing
 	=

+
+gProfiler_Packets =3D CreateRoughProfiler("Packets")
+
 -- check if packets are complete and handle them
 function HandlePackets ()
 	if (not gNoLogPackets_ByPacket) then gNoLogPackets_ByPacket =3D {} for k,=
v in pairs(gNoLogPackets) do gNoLogPackets_ByPacket[v] =3D true end end
 	local input =3D GetRecvFIFO()
 	=

-	local profile =3D gEnableProfiler_Packets and MakeProfiler("HandlePackets=
",nil,true)
+	gProfiler_Packets:Start(gEnableProfiler_Packets)
 	=

 	while (input:Size() >=3D 1) do
 		local iId =3D input:PeekNetUint8(0)
@@ -70,11 +73,11 @@
 			--~ Crash()
 		end
 		=

-		if (profile) then profile:StartSection(gPacketTypeId2Name[iId]) end
+		gProfiler_Packets:Section(gPacketTypeId2Name[iId])
 		HandlePacket(input,iId,iPacketSize)
 	end
 	=

-	if (profile) then profile:FinishAndPrintSectionIfOverDefault() end
+	gProfiler_Packets:End()
 end
 =

 function HandlePacket (input,iId,iPacketSize)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Mon Jan 12 22:49:04 2009
@@ -416,8 +416,8 @@
 =

 	-- mainloop
 	if (gEnableGlobalProfiler) then StartGlobalProfiler2() end -- old and too=
 slow, don't use
-	gMyProfilerTopTenInterval =3D 1000*30
-	RegisterIntervalStepper(gMyProfilerTopTenInterval,MyProfilerTop)
+	gMyProfilerTopInterval =3D 1000*30
+	RegisterIntervalStepper(gMyProfilerTopInterval,MyProfilerTop)
 	while (Client_IsAlive()) do =

 		MainStep() =

 	end
@@ -429,29 +429,60 @@
 gMyProfilerTopCPUTSum =3D 0
 gMyProfilerTopGPUTSum =3D 0
 function MyProfilerTop ()
-	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop =3D=3D=3D")
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop cpu time =3D=3D=3D")
 	if (not gEnableRoughProfileSum) then return end
-	local arr =3D {}
-	for k,profiler in pairs({gProfiler_MainStep,
-							gProfiler_R2D_MainStep,
-							gProfiler_R2D_MousePick,
-							gProfiler_R3D_MainStep,
-							gProfiler_Walk,
-							gProfiler_Blendout,	=

-							}) do
-		for secname,tsum in pairs(profiler.sum) do table.insert(arr,{name=3Dprof=
iler.name..":"..secname,tsum=3Dtsum}) end
-		profiler.sum =3D {}
+	local arr_t =3D {}
+	local arr_memL =3D {}
+	local arr_memO =3D {}
+	local arr_tspike =3D {}
+	local arr_tspikeframe =3D {}
+	for k,profiler in pairs(gAllRoughProfilers) do
+		for secname,v in pairs(profiler.sum			) do table.insert(arr_t			,{name=
=3Dprofiler.name..":"..secname,v=3Dv}) end
+		for secname,v in pairs(profiler.sum_memL	) do table.insert(arr_memL		,{n=
ame=3Dprofiler.name..":"..secname,v=3Dv}) end
+		for secname,v in pairs(profiler.sum_memO	) do table.insert(arr_memO		,{n=
ame=3Dprofiler.name..":"..secname,v=3Dv}) end
+		for secname,v in pairs(profiler.sum_tspike	) do table.insert(arr_tspike	=
,{name=3Dprofiler.name..":"..secname,v=3Dv}) end
+		for secname,v in pairs(profiler.sum_tspikeframe_total	) do table.insert(=
arr_tspikeframe	,{name=3Dprofiler.name..":"..secname,v=3Dv}) end
+		profiler.sum		=3D {}
+		profiler.sum_memL	=3D {}
+		profiler.sum_memO	=3D {}
+		profiler.sum_tspike	=3D {}
+		profiler.sum_tspikeframe_total	=3D {}
 	end =

-	table.sort(arr,function (a,b) return a.tsum > b.tsum end)
-	for k,o in pairs(arr) do =

-		if (k <=3D 10) then print(" #"..k,sprintf("%5dmsec (%3d%%)",o.tsum,floor=
(100*o.tsum/gMyProfilerTopCPUTSum)),o.name) end
+	table.sort(arr_t			,function (a,b) return a.v > b.v end)
+	table.sort(arr_memL			,function (a,b) return a.v > b.v end)
+	table.sort(arr_memO			,function (a,b) return a.v > b.v end)
+	table.sort(arr_tspike		,function (a,b) return a.v > b.v end)
+	table.sort(arr_tspike		,function (a,b) return a.v > b.v end)
+	table.sort(arr_tspikeframe	,function (a,b) return a.v > b.v end)
+	local topx =3D 10
+	for k,o in pairs(arr_t) do =

+		if (k <=3D topx) then print(" #"..k,sprintf("%5dmsec (%3d%%)",o.v,floor(=
100*o.v/gMyProfilerTopCPUTSum)),o.name) end =

 	end
 	print(sprintf(" total time=3D%dsec cpu=3D%d%% gpu=3D%d%% idle/maxfpswait=
=3D%d%%"	=

-															,	floor(gMyProfilerTopTenInterval/1000)
-															,	floor(100*gMyProfilerTopCPUTSum/gMyProfilerTopTenInterval)
-															,	floor(100*gMyProfilerTopGPUTSum/gMyProfilerTopTenInterval)
-															,	floor(100*(gMyProfilerTopTenInterval-(gMyProfilerTopCPUTS=
um+gMyProfilerTopGPUTSum))/gMyProfilerTopTenInterval)
+															,	floor(gMyProfilerTopInterval/1000)
+															,	floor(100*gMyProfilerTopCPUTSum/gMyProfilerTopInterval)
+															,	floor(100*gMyProfilerTopGPUTSum/gMyProfilerTopInterval)
+															,	floor(100*(gMyProfilerTopInterval-(gMyProfilerTopCPUTSum+=
gMyProfilerTopGPUTSum))/gMyProfilerTopInterval)
 															))
+															=

+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop tspike (single sections =
causing delays/lags) =3D=3D=3D")
+	for k,o in pairs(arr_tspike) do =

+		if (k <=3D topx) then print(" #"..k,sprintf("%5dmsec",o.v),o.name) end =

+	end
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop tspikeframe (the summed =
cpu usage of all things during delay/lag-frames) =3D=3D=3D")
+	for k,o in pairs(arr_tspikeframe) do =

+		if (k <=3D topx) then print(" #"..k,sprintf("%5dmsec",o.v),o.name) end =

+	end
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memLua =3D=3D=3D")
+	for k,o in pairs(arr_memL) do =

+		if (k <=3D topx) then print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.n=
ame) end =

+	end
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memOgre =3D=3D=3D")
+	for k,o in pairs(arr_memO) do =

+		if (k <=3D topx) then print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.n=
ame) end =

+	end
+	print(Client_GetTicks()," . . . . . ")
+	=

 	gMyProfilerTopCPUTSum =3D 0
 	gMyProfilerTopGPUTSum =3D 0
 end
@@ -575,15 +606,19 @@
 	gFrameTimeCPUFraction =3D dt_cpu / ( dt_cpu + dt_gpu )
 	=

 	=

+	local t =3D Client_GetTicks()
+	local iTimeSinceLastFrame =3D gLastFrameTime and (t - gLastFrameTime)
+	=

+	RoughProfileEndFrame(iTimeSinceLastFrame)
+	=

 	if (gMaxFPS) then =

-		local t =3D Client_GetTicks()
 		local iMinTimeBetweenFrames =3D 1000/gMaxFPS
-		local iTimeSinceLastFrame =3D gLastFrameTime and (t - gLastFrameTime) or=
 iMinTimeBetweenFrames
+		iTimeSinceLastFrame =3D iTimeSinceLastFrame or iMinTimeBetweenFrames
 		Client_USleep(max(1,iMinTimeBetweenFrames - iTimeSinceLastFrame))
-		gLastFrameTime =3D Client_GetTicks()
 	else
 		Client_USleep(1) -- just 1 millisecond, but gives other processes a chan=
ce to do something
 	end
+	gLastFrameTime =3D Client_GetTicks()
 end
 =

 -- exports data if some commandline parameters are set

Modified: trunk/lua/net/net.multi.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.multi.lua (original)
+++ trunk/lua/net/net.multi.lua Mon Jan 12 22:49:04 2009
@@ -13,7 +13,7 @@
 		local unknown4 =3D input:PopNetUint32()	--(all 0)
 		local unknown5 =3D input:PopNetUint16()	--(all 0)
 	=

-	if (request =3D=3D hex2num("0x01")) then
+	if (request =3D=3D 0x01) then
 		StartTargetMode()
 	end
 end
@@ -22,7 +22,7 @@
 function Send_CustomHouseRevision(customhouseserial)
 	local out =3D GetSendFIFO()
 	out:PushNetUint8(kPacket_Generic_Command)
-	out:PushNetUint16(hex2num("0x0009"))
+	out:PushNetUint16(0x0009)
 	out:PushNetUint16(kPacket_Generic_SubCommand_HouseSerial)	--SubID
 	out:PushNetUint32(customhouseserial)
 	out:SendPacket()
@@ -44,7 +44,10 @@
 -- TODO : this packet handling is so stupid... ea/osi please think before =
you are writing sourcecode !!
 -- this code is based on the packet format runuo uses
 gCustomHouseMultiTileCache =3D {}
+gProfiler_CustomHousePacket =3D CreateRoughProfiler("CustomHousePacket")
 function gPacketHandler.kPacket_Custom_House()	--0xD8
+	gProfiler_CustomHousePacket:Start(gEnableProfiler_CustomHousePacket)
+	gProfiler_CustomHousePacket:Section("PopHeader")
 	local input =3D GetRecvFIFO()
 	local startsize =3D input:Size()
 	local id =3D input:PopNetUint8()
@@ -60,6 +63,7 @@
 	printdebug("net",sprintf("NET: Custom_House: iPacketSize=3D%d compresstyp=
e=3D0x%02x unknown1=3D0x%02x customhouseserial=3D%d customhouserevision=3D0=
x%08x tilecount=3D%d bufferlen=3D%d planecount=3D%d\n",
 			iPacketSize, compresstype, unknown1, customhouseserial, customhouserevi=
sion, tilecount, bufferlen, planecount))
 =

+	gProfiler_CustomHousePacket:Section("GetDynamic")
 	local dyn =3D GetDynamic(customhouseserial)
 =

 	-- if dynamic-customhouse-multi alreay exists
@@ -78,6 +82,7 @@
 	=

 	local lTile
 	=

+	gProfiler_CustomHousePacket:Section("CacheCheck")
 	if gCustomHouseMultiTileCache[customhouserevision] then
 		local left =3D iPacketSize - (startsize - input:Size())
 		input:PopRaw(left)
@@ -85,15 +90,16 @@
 	else
 		lTile =3D {}
 		--------------- if compressed ----------------------
-		if (compresstype =3D=3D hex2num("0x03")) then
+		if (compresstype =3D=3D 0x03) then
 			local lPlaneLayer =3D {}
 			=

+			gProfiler_CustomHousePacket:Section("comp:Planes")
 			for i =3D 0, planecount - 1 do
 				local planeid =3D input:PopNetUint8()
-				local planetype =3D BitwiseAND(planeid,hex2num("0x20"))
+				local planetype =3D BitwiseAND(planeid,0x20)
 				=

 				-- calculate planeid
-				if planetype =3D=3D hex2num("0x20") then planeid =3D BitwiseXOR(planei=
d,hex2num("0x20")) =

+				if planetype =3D=3D 0x20 then planeid =3D BitwiseXOR(planeid,0x20) =

 				else planeid =3D planeid - 9 end
 							=

 				local uncompressedsize =3D input:PopNetUint8()
@@ -101,14 +107,14 @@
 				local compressedsize =3D input:PopNetUint8()
 				local bothsizes =3D input:PopNetUint8()		--? Write( (byte)(((size >> 4=
) & 0xF0) | ((deflatedLength >> 8) & 0xF)) );
 				=

-				uncompressedsize =3D uncompressedsize + BitwiseSHL(BitwiseAND(bothsize=
s,hex2num("0xF0")),4)
-				compressedsize =3D compressedsize + BitwiseSHL(BitwiseAND(bothsizes,he=
x2num("0xF")),8)
+				uncompressedsize =3D uncompressedsize + BitwiseSHL(BitwiseAND(bothsize=
s,0xF0),4)
+				compressedsize =3D compressedsize + BitwiseSHL(BitwiseAND(bothsizes,0x=
F),8)
 			=

 				printdebug("net",sprintf("NET: Custom_House2: planeid=3D%d planetype=
=3D0x%02x uncompressedsize=3D0x%02x compressedsize=3D0x%02x bothsizes=3D0x%=
02x\n",
 						planeid,planetype,uncompressedsize,compressedsize,bothsizes))
 			=

 				-- switch between stair and plane buffers
-				if planetype =3D=3D hex2num("0x20") then
+				if planetype =3D=3D 0x20 then
 					-- ------------------------------------------------------------------=
--------
 					-- planelayers
 					-- ------------------------------------------------------------------=
--------
@@ -156,6 +162,7 @@
 				input:PopRaw(compressedsize)
 			end
 =

+			gProfiler_CustomHousePacket:Section("comp:MidCalcAndValidity")
 			-- calculate w,h from sizes
 			local a =3D -1
 			local b =3D s0 + 2 - (s1 or 0)
@@ -185,6 +192,7 @@
 			-- --------------------------------------------------------------------=
------
 			-- Parse remaining unparsed planelayers -----------------
 			-- --------------------------------------------------------------------=
------
+			gProfiler_CustomHousePacket:Section("comp:ParseRemaining")
 			for i =3D 0, 9 - 1 do
 				local fifo =3D lPlaneLayer[i]
 				-- is valid plane layer?
@@ -251,7 +259,8 @@
 				end
 			end
 		--------------- if uncompressed ----------------------
-		elseif (compresstype =3D=3D hex2num("0x00")) then
+		elseif (compresstype =3D=3D 0x00) then
+			gProfiler_CustomHousePacket:Section("uncomp:tiles")
 			for i=3D1, i <=3D tilecount do
 				local tile =3D {}
 				tile.artid =3D decompressed:PopNetUint16()
@@ -261,13 +270,13 @@
 =

 				if (tile.artid > 0) then =

 					if (tile.x < 0) then
-						tile.x =3D hex2num("0xFF") + (tile.x + 1);
+						tile.x =3D 0xFF + (tile.x + 1);
 					end
 					if(tile.y < 0) then
-						tile.y =3D hex2num("0xFF") + (tile.y + 1);
+						tile.y =3D 0xFF + (tile.y + 1);
 					end
 					if(tile.z < 0) then
-						tile.z =3D hex2num("0xFF") + (tile.z + 1);
+						tile.z =3D 0xFF + (tile.z + 1);
 					end
 =

 					printdebug("net",sprintf("NET: Custom_House Plane: artid=3D0x%04x x=
=3D%i y=3D%i z=3D%i\n",
@@ -298,12 +307,16 @@
 			dyn.customhouserevision =3D customhouserevision
 			=

 			-- update house visuals
+			gProfiler_CustomHousePacket:Section("RemoveDynamicItem")
 			gCurrentRenderer:RemoveDynamicItem( dyn )
 			dyn.lTile=3DlTile
+			gProfiler_CustomHousePacket:Section("UpdateMultiData")
 			UpdateMultiData(dyn)
+			gProfiler_CustomHousePacket:Section("AddDynamicItem")
 			gCurrentRenderer:AddDynamicItem( dyn )
 		end
 	end
+	gProfiler_CustomHousePacket:End()
 end
 =

 function UpdateMultiData (item)



From no-reply at zwischenwelt.org  Mon Jan 12 23:06:10 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 12 Jan 2009 22:06:10 -0000
Subject: [Iris-commit] [IRIS] r2862 - in /trunk/lua: lib.2d.dynamic.lua
	main.lua
Message-ID: <20090112220611.1796F1C1880F@zwischenwelt.org>

Author: ghoulsblade
Date: Mon Jan 12 23:06:10 2009
New Revision: 2862

Log:
2D:Dynamics_MainStep : only one rebuild block per frame to reduce spikes

Modified:
    trunk/lua/lib.2d.dynamic.lua
    trunk/lua/main.lua

Modified: trunk/lua/lib.2d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.dynamic.lua (original)
+++ trunk/lua/lib.2d.dynamic.lua Mon Jan 12 23:06:10 2009
@@ -32,9 +32,11 @@
 =

 =

 function Renderer2D:Dynamics_MainStep			() =

-	local bHadDirty =3D false
-	for block,v in pairs(self.gDynamicBlockDirtyList) do bHadDirty =3D true s=
elf:DynamicBlockRebuild(block) end
-	if (bHadDirty) then self.gDynamicBlockDirtyList =3D {} end
+	for block,v in pairs(self.gDynamicBlockDirtyList) do =

+		self.gDynamicBlockDirtyList[block] =3D nil =

+		self:DynamicBlockRebuild(block) =

+		break
+	end
 end
 =

 =


Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Mon Jan 12 23:06:10 2009
@@ -475,11 +475,11 @@
 	end
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memLua =3D=3D=3D")
 	for k,o in pairs(arr_memL) do =

-		if (k <=3D topx) then print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.n=
ame) end =

+		if (k <=3D topx and o.v > 0) then print(" #"..k,sprintf("%5dkb",floor(o.=
v/1024)),o.name) end =

 	end
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memOgre =3D=3D=3D")
 	for k,o in pairs(arr_memO) do =

-		if (k <=3D topx) then print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.n=
ame) end =

+		if (k <=3D topx and o.v > 0) then print(" #"..k,sprintf("%5dkb",floor(o.=
v/1024)),o.name) end =

 	end
 	print(Client_GetTicks()," . . . . . ")
 	=




From no-reply at zwischenwelt.org  Tue Jan 13 04:51:48 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 13 Jan 2009 03:51:48 -0000
Subject: [Iris-commit] [IRIS] r2863 - in /trunk/lua: lib.2d.mobile.lua
 lib.2d.spriteblock.lua main.lua net/net.text.lua
Message-ID: <20090113035150.00F251C18775@zwischenwelt.org>

Author: ghoulsblade
Date: Tue Jan 13 04:51:46 2009
New Revision: 2863

Log:
2d reduced memory allocation during mobile anim by reusing sprite structs f=
or mainbody and equip items, added detail profiling to mobanim and localize=
d text packet

Modified:
    trunk/lua/lib.2d.mobile.lua
    trunk/lua/lib.2d.spriteblock.lua
    trunk/lua/main.lua
    trunk/lua/net/net.text.lua

Modified: trunk/lua/lib.2d.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.mobile.lua (original)
+++ trunk/lua/lib.2d.mobile.lua Tue Jan 13 04:51:46 2009
@@ -33,7 +33,9 @@
 		mobile.r2d_bSmoothWalk =3D bSmoothWalk
 		self.gStepMobilesSmoothWalk[mobile] =3D bSmoothWalk or nil
 	end
+	gProfiler_R2D_MobileStep:Start(gEnableProfiler_R2D_MobileStep)
 	self:UpdateMobileGfx(mobile)
+	gProfiler_R2D_MobileStep:End()
 end
 =

 =

@@ -115,8 +117,10 @@
 function Renderer2D:UpdateMobileGfx				(mobile) =

 	local spriteblock =3D mobile.gfx2d
 	if (not spriteblock) then return end
+	gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:Clear")
 	spriteblock:Clear()
 	=

+	gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:prep")
 	local mount	=3D mobile:GetEquipmentAtLayer(kLayer_Mount)
 	--~ if (mount) then mount.artid =3D 0x3e90 print("mount:chimera test") en=
d  -- =

 	=

@@ -136,10 +140,13 @@
 	--~ table.insert(parts,{self:GetMobileMountModelAndHue(mobile)}) -- kLaye=
r_Mount
 	if (mount) then table.insert(parts,{gMountTranslate2D[mount.artid],mount.=
hue,gStandardHorse}) end
 	=

+	local main_spritearr =3D mobile.r2d_main_spritearr
+	if (not main_spritearr) then main_spritearr =3D {} mobile.r2d_main_sprite=
arr =3D main_spritearr end
 	if (mobile.artid ~=3D 402 and
-		mobile.artid ~=3D 403) then table.insert(parts,{mobile.artid,mobile.hue,=
13}) end -- fallback=3D13=3Devortex  402=3Dghost
+		mobile.artid ~=3D 403) then table.insert(parts,{mobile.artid,mobile.hue,=
13,main_spritearr}) end -- fallback=3D13=3Devortex  402=3Dghost
 		=

 	--~ print("######### mobart",mobile.artid)
+	gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:human")
 	if (self:MobileHasVisibleEquip(mobile.artid)) then -- only humans have eq=
uip
 		for index,layer in pairs(gLayerOrderByDir[DirWrap(mobile.dir)]) do =

 			local item =3D GetMobileEquipmentItem(mobile,layer)
@@ -148,20 +155,26 @@
 				local t =3D GetStaticTileType(item.artid)
 				local iFallBackModel
 				if (layer =3D=3D kLayer_TorsoOuter) then iFallBackModel =3D 469 end --=
 standard robe
-				if (t and t.miAnimID and t.miAnimID > 0) then table.insert(parts,{t.mi=
AnimID,item.hue,iFallBackModel}) end
+				if (t and t.miAnimID and t.miAnimID > 0) then =

+					local item_spritearr =3D item.r2d_spritearr
+					if (not item_spritearr) then item_spritearr =3D {} item.r2d_spritearr=
 =3D item_spritearr end
+					table.insert(parts,{t.miAnimID,item.hue,iFallBackModel,item_spritearr=
}) =

+				end
 			end
 		end
 	end
 	=

 	for k,v in pairs(parts) do =

-		local iModelID,iHue,iFallBackModel =3D unpack(v)
+		local iModelID,iHue,iFallBackModel,spritearr =3D unpack(v)
 		if iModelID then =

+			gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:UOAnimTranslateBodyID=
")
 			local iLoaderIndex =3D 1
 			local iOldModelID =3D iModelID
 			iModelID,iHue,iLoaderIndex =3D UOAnimTranslateBodyID(iModelID,iHue)
 			=

 			if (mobile.flag_hidden) then iHue =3D kHiddenMobileHue end
 			=

+			gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:Anim_Get.Anim")
 			--~ if (iOldModelID =3D=3D 309) then print("UOAnimTranslateBodyID trans=
lated to ",iOldModelID,iModelID,iHue,iLoaderIndex) end
 			iIndex =3D iIndex + 1 =

 			fIndexRel =3D 200 * (1 - 1/iIndex) -- dirty hack to avoid zbuffer flick=
er
@@ -178,17 +191,22 @@
 			if (gMy2DMobileDebugAnim) then iAnimID =3D gMy2DMobileDebugAnim end
 			=

 			=

+			gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:Anim2D_GetFrameCount")
 			local iFrameCount =3D		Anim2D_GetFrameCount(Anim_GetRealID(iModelID,iAn=
imID,iLoaderIndex),iLoaderIndex) or
 									(iFallBackModel and Anim2D_GetFrameCount(Anim_GetRealID(iFallBack=
Model,iFallBackAnim,1),1)) or =

 									1
 			if (iFrameCount < 1) then iFrameCount =3D 1 end
 			--~ local iFrame =3D floor((gMy2DDebugFrame or 0) / 15) % iFrameCount
 			local iFrame =3D (floor(gMyTicks/100)) % iFrameCount
-			spriteblock:AddAnimModel(tx,ty,tz,iModelID,iHue,iLoaderIndex,iFallBackM=
odel,iFallBackAnim,iAnimID,iFrame,bMirrorX,CalcSortBonus(nil,sorttx,sortty,=
sorttz,fIndexRel,4),mobile) =

+			gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:AddAnimModel (start:L=
oadAtlasPiece)")
+			spriteblock:AddAnimModel(tx,ty,tz,iModelID,iHue,iLoaderIndex,iFallBackM=
odel,iFallBackAnim,iAnimID,iFrame,bMirrorX,CalcSortBonus(nil,sorttx,sortty,=
sorttz,fIndexRel,4),mobile,	spritearr) =

 		end
 	end
+	gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:Build")
 	spriteblock:Build(Renderer2D.kSpriteBaseMaterial,false)
+	gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:UpdateMobilePos")
 	self:UpdateMobilePos(mobile)
+	gProfiler_R2D_MobileStep:Section("UpdateMobileGfx:End")
 end
 =

 function Renderer2D:DestroyMobileGfx			(mobile) =

@@ -205,12 +223,17 @@
 function Renderer2D:MobileStartServerSideAnim	(animdata) end
 =

 =

+gProfiler_R2D_MobileStep =3D CreateRoughProfiler("2D:MobileStep")
+
 function Renderer2D:MobileStep()
+	gProfiler_R2D_MobileStep:Start(gEnableProfiler_R2D_MobileStep)
 	local curt =3D gMyTicks
 	for mobile,t in pairs(self.gStepMobiles) do =

 		if (curt >=3D t) then self:MobileStepOne(mobile) end
 	end
+	gProfiler_R2D_MobileStep:Section("UpdateMobilePos")
 	for mobile,v in pairs(self.gStepMobilesSmoothWalk) do self:UpdateMobilePo=
s(mobile) end
+	gProfiler_R2D_MobileStep:End()
 	=

 	--~ local playermobile =3D GetPlayerMobile()
 	--~ print("playermobile.dir",playermobile and DirWrap(playermobile.dir)) =


Modified: trunk/lua/lib.2d.spriteblock.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.spriteblock.lua (original)
+++ trunk/lua/lib.2d.spriteblock.lua Tue Jan 13 04:51:46 2009
@@ -158,7 +158,7 @@
 	end
 end
 =

-function cUOSpriteBlock:AddAnimModel (tx,ty,tz,iTranslatedModelID,iHue,iLo=
aderIndex,iFallBackModel,iFallBackAnim,iAnimID,iFrame,bMirrorX,sortbonus,da=
ta)
+function cUOSpriteBlock:AddAnimModel (tx,ty,tz,iTranslatedModelID,iHue,iLo=
aderIndex,iFallBackModel,iFallBackAnim,iAnimID,iFrame,bMirrorX,sortbonus,da=
ta,	spritearr)
 	iHue =3D BitwiseAND(iHue or 0,0x7fff) -- 0x03F4 : human skin hue (0x83F4=
=3D33780, but 0x8* is partial hue and turned out all gray here)
 	local pAtlasPiece =3D Anim2DAtlas_LoadAtlasPiece(iTranslatedModelID,iAnim=
ID,iFrame,iHue,iLoaderIndex)
 	if (not pAtlasPiece) then
@@ -174,8 +174,9 @@
 			pAtlasPiece			=3D Anim2DAtlas_LoadAtlasPiece(iTranslatedModelID,iAnimID=
,iFrame,iHue,iLoaderIndex)
 		end
 	end
+	gProfiler_R2D_MobileStep:SectionIfActive("UpdateMobileGfx:AddAnimModel:Ad=
dSpriteEx")
 	if (pAtlasPiece) then
-		local sprite =3D self:AddSpriteEx(tx,ty,tz,sortbonus,data,pAtlasPiece,bM=
irrorX)
+		local sprite =3D self:AddSpriteEx(tx,ty,tz,sortbonus,data,pAtlasPiece,bM=
irrorX,	spritearr)
 		sprite.bMirrorX =3D bMirrorX
 		sprite.uoanim_ModelID		=3D iTranslatedModelID
 		sprite.uoanim_AnimID		=3D iAnimID
@@ -212,8 +213,8 @@
 	return sprite
 end
 	=

--- pAtlasPiece=3D{atlas=3D?,origw=3D?,origh=3D?,u0=3D?,v0=3D?,u1=3D?,v1=3D=
?}
-function cUOSpriteBlock:AddSpriteEx (tx,ty,zloc,sortbonus,data,pAtlasPiece=
,bMirrorX)
+-- pAtlasPiece=3D{atlas=3D?,origw=3D?,origh=3D?,u0=3D?,v0=3D?,u1=3D?,v1=3D=
?}      sprite:usually nil, can be set to old table for overwriting (mobile=
 anim)
+function cUOSpriteBlock:AddSpriteEx (tx,ty,zloc,sortbonus,data,pAtlasPiece=
,bMirrorX,	sprite)
 	local atlas =3D pAtlasPiece.atlas
 	local group =3D self.pSpritesByAtlas[atlas]
 	if (not group) then group =3D {} self.pSpritesByAtlas[atlas] =3D group end
@@ -258,20 +259,35 @@
 		z =3D z + yo
 	end
 	=

-	local sprite =3D {
-		x =3D x,
-		y =3D y,
-		z =3D z,
-		xa =3D xa,
-		za =3D za,
-		u0 =3D pAtlasPiece.u0,
-		v0 =3D pAtlasPiece.v0,
-		u1 =3D pAtlasPiece.u1,
-		v1 =3D pAtlasPiece.v1,
-		pw =3D pw, -- in pixels
-		ph =3D ph, -- in pixels
-		data =3D data
-	}
+	if (sprite) then =

+		sprite.x =3D x
+		sprite.y =3D y
+		sprite.z =3D z
+		sprite.xa =3D xa
+		sprite.za =3D za
+		sprite.u0 =3D pAtlasPiece.u0
+		sprite.v0 =3D pAtlasPiece.v0
+		sprite.u1 =3D pAtlasPiece.u1
+		sprite.v1 =3D pAtlasPiece.v1
+		sprite.pw =3D pw -- in pixels
+		sprite.ph =3D ph -- in pixels
+		sprite.data =3D data
+	else =

+		sprite =3D {
+			x =3D x,
+			y =3D y,
+			z =3D z,
+			xa =3D xa,
+			za =3D za,
+			u0 =3D pAtlasPiece.u0,
+			v0 =3D pAtlasPiece.v0,
+			u1 =3D pAtlasPiece.u1,
+			v1 =3D pAtlasPiece.v1,
+			pw =3D pw, -- in pixels
+			ph =3D ph, -- in pixels
+			data =3D data
+		}
+	end
 	table.insert(group,sprite)
 	return sprite
 end

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Tue Jan 13 04:51:46 2009
@@ -456,7 +456,7 @@
 	table.sort(arr_tspikeframe	,function (a,b) return a.v > b.v end)
 	local topx =3D 10
 	for k,o in pairs(arr_t) do =

-		if (k <=3D topx) then print(" #"..k,sprintf("%5dmsec (%3d%%)",o.v,floor(=
100*o.v/gMyProfilerTopCPUTSum)),o.name) end =

+		if (k <=3D topx and (not gEnableRoughProfileSum_SkipCPU)) then print(" #=
"..k,sprintf("%5dmsec (%3d%%)",o.v,floor(100*o.v/gMyProfilerTopCPUTSum)),o.=
name) end =

 	end
 	print(sprintf(" total time=3D%dsec cpu=3D%d%% gpu=3D%d%% idle/maxfpswait=
=3D%d%%"	=

 															,	floor(gMyProfilerTopInterval/1000)
@@ -467,19 +467,19 @@
 															=

 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop tspike (single sections =
causing delays/lags) =3D=3D=3D")
 	for k,o in pairs(arr_tspike) do =

-		if (k <=3D topx) then print(" #"..k,sprintf("%5dmsec",o.v),o.name) end =

+		if (k <=3D topx and (not gEnableRoughProfileSum_SkipSpike)) then print("=
 #"..k,sprintf("%5dmsec",o.v),o.name) end =

 	end
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop tspikeframe (the summed =
cpu usage of all things during delay/lag-frames) =3D=3D=3D")
 	for k,o in pairs(arr_tspikeframe) do =

-		if (k <=3D topx) then print(" #"..k,sprintf("%5dmsec",o.v),o.name) end =

+		if (k <=3D topx and (not gEnableRoughProfileSum_SkipSpikeFrame)) then pr=
int(" #"..k,sprintf("%5dmsec",o.v),o.name) end =

 	end
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memLua =3D=3D=3D")
 	for k,o in pairs(arr_memL) do =

-		if (k <=3D topx and o.v > 0) then print(" #"..k,sprintf("%5dkb",floor(o.=
v/1024)),o.name) end =

+		if (k <=3D topx and o.v > 0 and (not gEnableRoughProfileSum_SkipMemL)) t=
hen print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.name) end =

 	end
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memOgre =3D=3D=3D")
 	for k,o in pairs(arr_memO) do =

-		if (k <=3D topx and o.v > 0) then print(" #"..k,sprintf("%5dkb",floor(o.=
v/1024)),o.name) end =

+		if (k <=3D topx and o.v > 0 and (not gEnableRoughProfileSum_SkipMemO)) t=
hen print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.name) end =

 	end
 	print(Client_GetTicks()," . . . . . ")
 	=


Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Tue Jan 13 04:51:46 2009
@@ -255,9 +255,12 @@
 	HandleUOText(data)
 end
 =

+gProfiler_Packet_Localized_Text =3D CreateRoughProfiler("Packet_Localized_=
Text")
 =

 -- Predefined Message (localized Message) 0xC1
 function gPacketHandler.kPacket_Localized_Text ()
+	gProfiler_Packet_Localized_Text:Start(gEnableProfiler_Packet_Localized_Te=
xt)
+	gProfiler_Packet_Localized_Text:Section("Pop")
 	local input		=3D GetRecvFIFO()
 	local id		=3D input:PopNetUint8()
 	local size		=3D input:PopNetUint16()
@@ -270,13 +273,18 @@
 	data.clilocid	=3D input:PopNetUint32()
 	data.name		=3D input:PopFilledString(30)
 	=

+	gProfiler_Packet_Localized_Text:Section("strsplit")
 	data.params		=3D strsplit("\t",input:PopUnicodeLEString((size - 48 - 2)/2=
))	--little-endian_ unicode string, tabs ('\t') seperate the arguments. Nul=
l Terminated 0x0000
 	local terminator =3D input:PopNetUint16() -- probably the seperator unico=
de char for text_params, "\t" is hardcoded below, string.char(math.floor(te=
rminator)/256)
 	=

+	gProfiler_Packet_Localized_Text:Section("ParameterizedClilocText")
 	data.text 		=3D ParameterizedClilocText(data.clilocid,data.params)
 	=

+	gProfiler_Packet_Localized_Text:Section("HandleUOText")
 	HandleUOText(data)
+	gProfiler_Packet_Localized_Text:Section("Hook_Packet_Localized_Text")
 	NotifyListener("Hook_Packet_Localized_Text",data.serial,data.text,data.cl=
ilocid,data.type,data)
+	gProfiler_Packet_Localized_Text:End()
 end
 =

 --server response packet for kPacket_Speech_Unicode (0xAD)



From no-reply at zwischenwelt.org  Wed Jan 14 02:03:52 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 14 Jan 2009 01:03:52 -0000
Subject: [Iris-commit] [IRIS] r2864 - in /trunk: lua/gui/gui.chat.lua
 lua/lib.2d.mousepick.lua lua/lib.macrolist.lua lua/lib.unifont.lua
 lua/main.lua lua/net/net.text.lua plugins/lib.spellbar.lua
Message-ID: <20090114010353.1188D1C18775@zwischenwelt.org>

Author: ghoulsblade
Date: Wed Jan 14 02:03:51 2009
New Revision: 2864

Log:
equip-item : bytype supported,  chattabbar-profiling,   2d-mousepick-bugfix=
 : terrain was used when blended out (caves),   uofont:glyphinfo caching (r=
educed memory allocations a lot),   profiling:HandleUOText

Modified:
    trunk/lua/gui/gui.chat.lua
    trunk/lua/lib.2d.mousepick.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/lib.unifont.lua
    trunk/lua/main.lua
    trunk/lua/net/net.text.lua
    trunk/plugins/lib.spellbar.lua

Modified: trunk/lua/gui/gui.chat.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.chat.lua (original)
+++ trunk/lua/gui/gui.chat.lua Wed Jan 14 02:03:51 2009
@@ -47,11 +47,15 @@
 	end
 end
 =

+gProfiler_ChatTabPane =3D CreateRoughProfiler("ChatTabPane")
 =

 function GuiChatAddLineToChannel	(channel, line)
+	gProfiler_ChatTabPane:Start(gEnableProfiler_ChatTabPane)
+	gProfiler_ChatTabPane:Section("GuiChatPrepareChannel")
 	GuiChatPrepareChannel(channel)
 	=

 	-- add line to channel content table
+	gProfiler_ChatTabPane:Section("insertline")
 	if not gGuiChatChannelContent[channel] then
 		-- new one
 		gGuiChatChannelContent[channel] =3D {line}
@@ -65,12 +69,17 @@
 	end
 	=

 	-- display channel content
+	gProfiler_ChatTabPane:Section("gsub")
 	local s =3D ""
 	for k,v in pairs(gGuiChatChannelContent[channel]) do
 		s =3D s .. string.gsub(v, "\n", "") .. "\n"
 	end
 	=

-	gGuiChatTabpane:GetTabContentPane(channel):GetChild(1):SetText(gGuiChatFo=
nt,nil,s,gGuiChatFontTextParam)
+	gProfiler_ChatTabPane:Section("GetChild")
+	local child =3D gGuiChatTabpane:GetTabContentPane(channel):GetChild(1)
+	gProfiler_ChatTabPane:Section("SetText")
+	child:SetText(gGuiChatFont,nil,s,gGuiChatFontTextParam)
+	gProfiler_ChatTabPane:End()
 end
 =

 function GuiChatPrepareChannel	(channel)

Modified: trunk/lua/lib.2d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.mousepick.lua (original)
+++ trunk/lua/lib.2d.mousepick.lua Wed Jan 14 02:03:51 2009
@@ -50,16 +50,18 @@
 	-- RayPickTerrain
 	--~ print("mousepick terrain")
 	gProfiler_R2D_MousePick:Section("terrain")
-	local dist,xloc,yloc =3D self:RayPickTerrain(rx,ry,rz, rvx,rvy,rvz)
-	if (dist and ((not founddist) or dist < founddist)) then =

-		founddist =3D dist =

-		gMousePickFoundHit =3D {}
-		gMousePickFoundHit.hittype =3D kMousePickHitType_Terrain
-		local ground =3D MapGetGround(xloc,yloc) -- {iTileType=3D?,zloc=3D?,bIgn=
oredByWalk=3D?,flags=3D?}
-		gMousePickFoundHit.hit_xloc =3D xloc
-		gMousePickFoundHit.hit_yloc =3D yloc
-		gMousePickFoundHit.hit_zloc =3D ground.zloc
-		--~ print("RayPickTerrain",xloc,yloc)
+	if (self.gbBlendOutTerrainVisible) then =

+		local dist,xloc,yloc =3D self:RayPickTerrain(rx,ry,rz, rvx,rvy,rvz)
+		if (dist and ((not founddist) or dist < founddist)) then =

+			founddist =3D dist =

+			gMousePickFoundHit =3D {}
+			gMousePickFoundHit.hittype =3D kMousePickHitType_Terrain
+			local ground =3D MapGetGround(xloc,yloc) -- {iTileType=3D?,zloc=3D?,bIg=
noredByWalk=3D?,flags=3D?}
+			gMousePickFoundHit.hit_xloc =3D xloc
+			gMousePickFoundHit.hit_yloc =3D yloc
+			gMousePickFoundHit.hit_zloc =3D ground.zloc
+			--~ print("RayPickTerrain",xloc,yloc)
+		end
 	end
 	--~ local t0 =3D Client_GetTicks()
 	--~ local t1 =3D Client_GetTicks()

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Wed Jan 14 02:03:51 2009
@@ -413,7 +413,13 @@
 end
 =

 function MacroCmd_EquipItem (serial)
+	if (type(serial) =3D=3D "table") then =

+		local cmd,param =3D unpack(serial)
+		if (cmd =3D=3D "use") then Send_DoubleClick(param) end =

+		return
+	end
 	local item =3D GetDynamic(serial)
+	if (not item) then item =3D MacroCmd_Item_FindFirstByArtID(serial) end
 	if (not item) then return end
 	if (item.iContainerSerial =3D=3D GetPlayerSerial()) then return end -- al=
ready equipped
 	local layer =3D GetPaperdollLayerFromTileType(item.artid)

Modified: trunk/lua/lib.unifont.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.unifont.lua (original)
+++ trunk/lua/lib.unifont.lua Wed Jan 14 02:03:51 2009
@@ -124,6 +124,8 @@
 	local myfont =3D {}
 	if (bOutlined) then loader.font_outlined =3D myfont else loader.font =3D =
myfont end
 	local matname,u0,v0,u1,v1,xoff,yoff,w,h =3D GetUniFontGlyph(loader,kCharC=
ode_SpaceWidthChar,bOutlined)
+	myfont.sFontType	=3D "UOFont"
+	myfont.glyphInfoCache =3D {}
 	myfont.bOutlined =3D bOutlined
 	myfont.spacewidth =3D w
 	--~ myfont.defaultlineh =3D 1.5 * math.max(1,h)
@@ -138,8 +140,12 @@
 		UniFont_AtlasUpdate()
 	end
 	myfont.GetGlyphInfo			=3D function (self,iCharCode,fontsize) =

+		local cachebysize =3D myfont.glyphInfoCache[fontsize]
+		if (not cachebysize) then cachebysize =3D {} myfont.glyphInfoCache[fonts=
ize] =3D cachebysize end
+		local cache =3D cachebysize[iCharCode]
+		if (cache ~=3D nil) then return cache end
 		local matname,u0,v0,u1,v1,xoff,yoff,w,h =3D GetUniFontGlyph(loader,iChar=
Code,self.bOutlined)
-		if (not matname) then return end
+		if (not matname) then cachebysize[iCharCode] =3D false return end
 		=

 		--~ local s =3D math.max(1,round(fontsize / myfont.defaultlineh)) -- pix=
elart is not freely scalable, but this would allow integer-multiples of the=
 original size
 		local s =3D 1
@@ -162,6 +168,7 @@
 		res.vx	=3D 0
 		res.uy	=3D 0
 		res.vy	=3D floor(uvh*gUniFontTexAtlasSize) / gUniFontTexAtlasSize
+		cachebysize[iCharCode] =3D res
 		return res
 	end
 	return myfont

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Wed Jan 14 02:03:51 2009
@@ -454,7 +454,7 @@
 	table.sort(arr_tspike		,function (a,b) return a.v > b.v end)
 	table.sort(arr_tspike		,function (a,b) return a.v > b.v end)
 	table.sort(arr_tspikeframe	,function (a,b) return a.v > b.v end)
-	local topx =3D 10
+	local topx =3D gRoughProfileSumHowMany or 10
 	for k,o in pairs(arr_t) do =

 		if (k <=3D topx and (not gEnableRoughProfileSum_SkipCPU)) then print(" #=
"..k,sprintf("%5dmsec (%3d%%)",o.v,floor(100*o.v/gMyProfilerTopCPUTSum)),o.=
name) end =

 	end

Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Wed Jan 14 02:03:51 2009
@@ -101,7 +101,10 @@
 =

 -- ***** ***** ***** ***** ***** incoming text
 =

+gProfiler_Text =3D CreateRoughProfiler("Text")
 function HandleUOText (data)
+	gProfiler_Text:Start(gEnableProfiler_Text)
+	gProfiler_Text:Section("PreCalc")
 	local mobile =3D GetMobile(data.serial) =

 	local serial =3D data.serial
 	--~ if (data.type =3D=3D kTextType_Label) then ItemLabel(data.serial,text=
_charname,text_message) end
@@ -114,7 +117,9 @@
 	if data.type =3D=3D kTextType_Emote then	r,g,b =3D 0,1,0 end
 	if data.type =3D=3D kTextType_Label then =

 		bIsLabel =3D true
+		gProfiler_Text:Section("Mobile_NameHint")
 		if mobile then Mobile_NameHint(data.serial,data.artid,data.name,data.tex=
t) end
+		gProfiler_Text:Section("PreCalc2")
 		r,g,b =3D 1,1,1 =

 	end	-- 0x06 - System/Lower Corner, label?
 	if data.type =3D=3D kTextType_Corner			 then r,g,b =3D 1,0,0 end	=

@@ -125,15 +130,18 @@
 	if data.type =3D=3D kTextType_Alliance			 then r,g,b =3D 0,1,0 end	=

 	if data.type =3D=3D kTextType_CommandPrompt		 then r,g,b =3D 1,0,1 end		=

 	=

+	gProfiler_Text:Section("GetHueColor")
 	if data.hue then r,g,b =3D GetHueColor(data.hue-1) end
 	=

 	=

 	-- update label
 	=

+	gProfiler_Text:Section("GetOrCreateLabelCache")
 	local labelcache =3D GetOrCreateLabelCache(serial)
 	local bLabelUpdate =3D false
 	local bIsPetLabel =3D false
 	if (data.clilocid =3D=3D 502006 or data.clilocid =3D=3D 1049608) then bIs=
Label =3D true bIsPetLabel =3D true end -- (tame) (bonded)
+	gProfiler_Text:Section("labelcache insert")
 	if (data.type =3D=3D kTextType_Label or bIsPetLabel) then
 		labelcache.name =3D data.name
 		if (labelcache.bClearOnNextLabel) then =

@@ -152,8 +160,10 @@
 		gItemGuildLabelCache[serial] =3D data.text =

 		bLabelUpdate =3D true
 	end -- guild tag
+	gProfiler_Text:Section("UpdateLabelCache")
 	if (bLabelUpdate) then UpdateLabelCache(serial) end
 	=

+	gProfiler_Text:Section("IsOrWasMobile")
 	local bIsOrWasMobile =3D IsOrWasMobile(serial)
 	local bIsAutoGenerated =3D gAutoGeneratedSingleClicks[serial]
 	data.bIsAutoGenerated =3D bIsAutoGenerated and bIsLabel
@@ -170,8 +180,10 @@
 	=

 	--~ Mobile_NameHint(data.serial,data.artid,data.name,data.text)  -- name =
alone ??
 	=

+	gProfiler_Text:Section("UnicodeFix")
 	local plaintext =3D UnicodeFix(string.gsub(data.text,"<br>","\n"))
 	=

+	gProfiler_Text:Section("GuiAddChatLine")
 	if show_below then
 		if string.len(data.name) > 0 then =

 			GuiAddChatLine(sprintf("%s: %s",data.name,plaintext),{r,g,b,1})
@@ -180,15 +192,19 @@
 		end
 	end
 	=

+	gProfiler_Text:Section("JournalAddText")
 	if show_journal or show_below then print("HandleUOText",plaintext,data.cl=
ilocid) end
 	if show_journal then
 		JournalAddText(data.name,plaintext)
 	end
 =

+	gProfiler_Text:Section("Hook_Text")
 	NotifyListener("Hook_Text",data.name,plaintext,data.serial,data)
 	=

+	gProfiler_Text:Section("DisplayTextOverHead")
 	if (mobile and (not bIsLabel)) then mobile:DisplayTextOverHead(plaintext,=
r,g,b) end
 	=

+	gProfiler_Text:Section("Hook_MobName")
 	NotifyListener("Hook_MobName",data.serial,data.name)
 	=

 	if (gDebugUOTextMessages and (not data.bIsGuildTagLabel) and (data.type ~=
=3D kTextType_Label)) then =

@@ -196,6 +212,7 @@
 	end
 	--~ print("HandleUOText",sprintf("0x%02x",data.packet or 0),data.type,bIs=
Label,data.name,plaintext)
 	--~ if (data.serial =3D=3D 0xffffffff and data.artid =3D=3D 0xffff) then =
sysmessage ?? decide by type
+	gProfiler_Text:End()
 end
 =

 -- ***** ***** ***** ***** ***** incoming text packets

Modified: trunk/plugins/lib.spellbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/lib.spellbar.lua (original)
+++ trunk/plugins/lib.spellbar.lua Wed Jan 14 02:03:51 2009
@@ -143,7 +143,10 @@
 gSpellbarEffectShortMessages[0x37B9 ] =3D {r=3D1,g=3D0,b=3D0,txt=3D"reflec=
t" } -- Magic Reflection (preaos) or parrying
 	=

 gSpellbarAnimationShortMessages =3D {}
-gSpellbarAnimationShortMessages[11 ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"s=
wing" } -- melee combat : swing weapon
+gSpellbarAnimationShortMessages[4  ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"s=
wing3" } -- melee combat : swing weapon  (monster) or get hit ?
+gSpellbarAnimationShortMessages[10 ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"s=
wing" } -- melee combat : swing weapon  (monster)
+gSpellbarAnimationShortMessages[11 ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"s=
wing3" } -- melee combat : swing weapon
+gSpellbarAnimationShortMessages[29 ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"s=
wing4" } -- melee combat : swing weapon
 gSpellbarAnimationShortMessages[20 ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"g=
ethit" } -- melee combat : take damage
 gSpellbarAnimationShortMessages[34 ] =3D {r=3D0.5,g=3D0.5,b=3D0.5,txt=3D"d=
rinkpot" }
 gSpellbarAnimationShortMessages[92 ] =3D {r=3D0.8,g=3D0.5,b=3D0.5,txt=3D"f=
izzle" } -- spellfail
@@ -255,7 +258,7 @@
 RegisterListener("Hook_Packet_Animation",	function (animdata)
 	local short =3D gSpellbarAnimationShortMessages[animdata.m_animation] =

 	if (short) then SpellBarRiseTextOnMob(animdata.mobileserial,short.r,short=
.g,short.b,short.txt) end
-	--~ if ((not short) and gDebugSpellbarAnim) then SpellBarRiseTextOnMob(an=
imdata.mobileserial,0.5,0.5,0.5,"Anim:"..animdata.m_animation) print("spell=
bar:anim:",animdata.m_animation) end
+	if ((not short) and gDebugSpellbarAnim) then SpellBarRiseTextOnMob(animda=
ta.mobileserial,0.5,0.5,0.5,"Anim:"..animdata.m_animation) print("spellbar:=
anim:",animdata.m_animation) end
 end)
 =

 RegisterListener("Hook_Packet_Sound",	function (sounddata)



From no-reply at zwischenwelt.org  Wed Jan 14 17:48:51 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 14 Jan 2009 16:48:51 -0000
Subject: [Iris-commit] [IRIS] r2865 - in /trunk:
 data/models/materials/textures.material lua/lib.3d.map.lua
 lua/lib.debugmenu.lua lua/lib.iris_atlasgroup.lua premake.lua
 premakelinux.sh
Message-ID: <20090114164851.315801C1880D@zwischenwelt.org>

Author: hagish
Date: Wed Jan 14 17:48:50 2009
New Revision: 2865

Log:
synced lugre and iris premake.lua

Modified:
    trunk/data/models/materials/textures.material
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.debugmenu.lua
    trunk/lua/lib.iris_atlasgroup.lua
    trunk/premake.lua
    trunk/premakelinux.sh

Modified: trunk/data/models/materials/textures.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/materials/textures.material (original)
+++ trunk/data/models/materials/textures.material Wed Jan 14 17:48:50 2009
@@ -6047,3 +6047,8 @@
 {
 	set_texture_alias MainTexture tex_RedCommCrystal.png
 }
+
+material tex_PurplePotion : tex_base
+{
+	set_texture_alias MainTexture tex_PurplePotion.png
+}

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Wed Jan 14 17:48:50 2009
@@ -53,6 +53,7 @@
 	self.map3d_scheduler:Destroy()
 	self.map3d_scheduler =3D nil
 	self.bMapLoadSystemInitialized =3D false
+	self:StopSpawner()
 end
 =

 function Renderer3D:InitMap	()
@@ -67,12 +68,38 @@
 		self.map3d_spawners.dynamics	=3D CreateDynamicSpawner(scheduler)
 		self.map3d_spawners.multis		=3D CreateMultiSpawner(scheduler)
 	end
+	self:StartSpawner()
+end
+
+function Renderer3D:StartSpawner		()
+	if self.mbSpawnerRunning then return end
+	if self.mbSpawnerStopping then return end
+	=

+	self.mbSpawnerRunning =3D true
+	=

+	job.create(function()
+		while(self.mbSpawnerRunning and self.map3d_spawners) do
+			local l =3D self.map3d_spawners
+			for k,spawner in pairs(l) do
+				local t =3D Client_GetTicks()
+				local xloc,yloc,zloc =3D self:GetCamPos()
+				spawner:Step(t,xloc,yloc,zloc) =

+				job.wait(10)
+			end
+		end
+		self.mbSpawnerStopping =3D false
+	end)
+end
+
+function Renderer3D:StopSpawner		()
+	self.mbSpawnerRunning =3D false
+	self.mbSpawnerStopping =3D true
 end
 =

 function Renderer3D:MapStep		()
+	-- block spawner runs in an extra thread -> StartSpawner
 	local t =3D Client_GetTicks()
 	local xloc,yloc,zloc =3D self:GetCamPos()
-	for k,spawner in pairs(self.map3d_spawners) do spawner:Step(t,xloc,yloc,z=
loc) end
 	self.map3d_scheduler:Step(xloc,yloc,zloc)
 end
 =


Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Wed Jan 14 17:48:50 2009
@@ -1002,7 +1002,7 @@
 	-- try to rotate and adjust blender like, only possible if meshmagick is =
installed (unix)
 	os.execute("cp '"..mdl.."' '"..expmdl.."'")
 	os.execute("meshmagick transform -rotate=3D90/1/0/0 '"..expmdl.."'")
-	os.execute("meshmagick transform -scale=3D1/-1/1 '"..expmdl.."'")
+	--~ os.execute("meshmagick transform -scale=3D1/-1/1 '"..expmdl.."'")
 	os.execute("meshmagick transform -rotate=3D90/0/1/0 '"..expmdl.."'")
 =

 	-- create xml file

Modified: trunk/lua/lib.iris_atlasgroup.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.iris_atlasgroup.lua (original)
+++ trunk/lua/lib.iris_atlasgroup.lua Wed Jan 14 17:48:50 2009
@@ -3,7 +3,7 @@
 -- TODO : longterm . releasing parts of the atlas, keep a log which one be=
longs where... last recently/frequently used ?
 -- TODO : longterm . bulk loading ?   lib.artalas.lua
 =

-kIrisAtlasGroupSize =3D 512
+kIrisAtlasGroupSize =3D 512*2
 =

 gAtlasGroup_Gump	=3D CreateAtlasGroup(kIrisAtlasGroupSize,kIrisAtlasGroupS=
ize)
 gAtlasGroup_Art		=3D CreateAtlasGroup(kIrisAtlasGroupSize,kIrisAtlasGroupS=
ize)

Modified: trunk/premake.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/premake.lua (original)
+++ trunk/premake.lua Wed Jan 14 17:48:50 2009
@@ -52,10 +52,6 @@
 		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
 		print("ERROR luajit is enabled but there is no jit directory next to you=
r executable")
 		print("perhaps you forgot to link it? perhaps enter: cd bin && ln -s ../=
"..gLugreLuaSrcDir.."/jit")
-		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
-	else
-		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
-		print("don't forget to add 'require(\"jit.opt\").start()' to the top of =
main.lua")
 		print("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D")
 	end
 else

Modified: trunk/premakelinux.sh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/premakelinux.sh (original)
+++ trunk/premakelinux.sh Wed Jan 14 17:48:50 2009
@@ -1,5 +1,5 @@
 #!/bin/bash
-./premake --clean
-./premake --noassert --target gnu && make CXX=3D"ccache gcc" CONFIG=3DRele=
ase
+#./premake --clean
+./premake --useluajit --noassert --target gnu && make CXX=3D"ccache gcc" C=
ONFIG=3DRelease
 #~ ./premake --target gnu && make CONFIG=3DRelease
 # tipp : try "make -j 2" : start 2 jobs in parallel, to avoid wait-for-io =
and use multi-cpu processors efficiently during compile



From no-reply at zwischenwelt.org  Wed Jan 14 17:51:27 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 14 Jan 2009 16:51:27 -0000
Subject: [Iris-commit] [IRIS] r2866 - in /trunk/data/models:
 models/to_004000/mdl_003853.mesh textures/tex_PurplePotion.png
Message-ID: <20090114165129.979561C1880D@zwischenwelt.org>

Author: hagish
Date: Wed Jan 14 17:51:24 2009
New Revision: 2866

Log:
whatever :)

Added:
    trunk/data/models/models/to_004000/mdl_003853.mesh   (with props)
    trunk/data/models/textures/tex_PurplePotion.png   (with props)



From no-reply at zwischenwelt.org  Wed Jan 14 19:41:12 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 14 Jan 2009 18:41:12 -0000
Subject: [Iris-commit] [IRIS] r2867 - in /trunk: lua/lib.compass.lua
 lua/lib.macrolist.lua lua/net/net.text.lua src/terrain_multitex.cpp
Message-ID: <20090114184112.BFC921C18775@zwischenwelt.org>

Author: ghoulsblade
Date: Wed Jan 14 19:41:12 2009
New Revision: 2867

Log:
compass : broken md5 workaround, MacroCmd_UseRuneBookPreAOS supports charge=
-use now, multitex.cpp : mousepick earlyout bbox made more tolerant

Modified:
    trunk/lua/lib.compass.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/net/net.text.lua
    trunk/src/terrain_multitex.cpp

Modified: trunk/lua/lib.compass.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.compass.lua (original)
+++ trunk/lua/lib.compass.lua Wed Jan 14 19:41:12 2009
@@ -358,6 +358,8 @@
 				CorrectPath( Addfilepath(gMaps[iMapIndex].staidxfilename) ),
 				CorrectPath( Addfilepath(gMaps[iMapIndex].staticfilename) ),
 			})
+			=

+	if (not md5) then print("WARNING, md5 checks for tmp/compass* files not p=
ossible (maps)") md5 =3D "md5dummy" end =

 	=

 	=

 	gMapImagePath_Small	=3D datapath.."tmp/compass_"..md5.."_small_s.png"

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Wed Jan 14 19:41:12 2009
@@ -263,14 +263,17 @@
 end
 =

 =

-function MacroCmd_UseRuneBookPreAOS (runebookid,runeidx,bGate,timeout) -- =
for pre-aos (uogamers)   runeidx:0-15      =

+-- method:  nil=3Drecall "gate"=3Dgate  "use"=3Drunebookcharge
+function MacroCmd_UseRuneBookPreAOS (runebookid,runeidx,method,timeout) --=
 for pre-aos (uogamers)   runeidx:0-15      =

 	Send_DoubleClick(runebookid)
 	MacroCmd_NextGumpContaining("Charges",timeout or 1000,function (dialog) =

 			if (dialog) then =

 				dialog:ShowPage(floor(runeidx/2)+2)
 				local side =3D (runeidx%2)
-				if (bGate) then
-					dialog:SendClick((side =3D=3D 0) and 230 or 390,160) =

+				if (method =3D=3D "gate") then
+					dialog:SendClick((side =3D=3D 0) and 230 or 390,160) -- gate travel
+				elseif (method =3D=3D "use") then
+					dialog:SendClick((side =3D=3D 0) and 135 or 295,70) -- runebook charge
 				else	=

 					dialog:SendClick((side =3D=3D 0) and 160 or 320,160) -- recall
 				end

Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Wed Jan 14 19:41:12 2009
@@ -31,11 +31,11 @@
 		text =3D string.gsub(text,"Fortification","Fortification(4/5:ar+20)")
 		text =3D string.gsub(text,"Invulnerability","Invulnerability(5/5:ar+25)")
 		=

-		text =3D string.gsub(text,"^Accurate","Accurate(1/5:skill+5)")
-		text =3D string.gsub(text,"Surpassingly Accurate","Surpassingly Accurate=
(2/5:skill+10)")
-		text =3D string.gsub(text,"Eminently Accurate","Eminently Accurate(3/5:s=
kill+15)")
-		text =3D string.gsub(text,"Exceedingly Accurate","Exceedingly Accurate(4=
/5:skill+20)")
-		text =3D string.gsub(text,"Supremely Accurate","Supremely Accurate(5/5:s=
kill+25)")
+		text =3D string.gsub(text,"^Accurate","Accurate(1/5:tac/arch+5)")
+		text =3D string.gsub(text,"Surpassingly Accurate","Surpassingly Accurate=
(2/5:tac/arch+10)")
+		text =3D string.gsub(text,"Eminently Accurate","Eminently Accurate(3/5:t=
ac/arch+15)")
+		text =3D string.gsub(text,"Exceedingly Accurate","Exceedingly Accurate(4=
/5:tac/arch+20)")
+		text =3D string.gsub(text,"Supremely Accurate","Supremely Accurate(5/5:t=
ac/arch+25)")
 		=

 		GuiAddChatLine(text,{1,1,1,1})
 		lines[k] =3D text

Modified: trunk/src/terrain_multitex.cpp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/src/terrain_multitex.cpp (original)
+++ trunk/src/terrain_multitex.cpp Wed Jan 14 19:41:12 2009
@@ -295,10 +295,10 @@
 			int bx =3D iBlockX + ax;
 			int by =3D iBlockY + ay;
 			=

-			Ogre::Vector3 p1 =3D GetVertexPosOverrideZ(0,0,-1000);
-			Ogre::Vector3 p2 =3D GetVertexPosOverrideZ(T,T,+1000);
-			Ogre::Vector3 aabbsize =3D Ogre::Vector3(mymax(p1.x-p2.x,p2.x-p1.x),mym=
ax(p1.y-p2.y,p2.y-p1.y), 2000);
-			Ogre::AxisAlignedBox aabb(	Ogre::Vector3(mymin(p1.x,p2.x),mymin(p1.y,p2=
.y),-1000),aabbsize);
+			Ogre::Vector3 p1 =3D GetVertexPosOverrideZ(0-1,0-1,-200);
+			Ogre::Vector3 p2 =3D GetVertexPosOverrideZ(T+1,T+1,+200); // added a bi=
t of tolerance
+			Ogre::Vector3 aabbsize =3D Ogre::Vector3(mymax(p1.x-p2.x,p2.x-p1.x),mym=
ax(p1.y-p2.y,p2.y-p1.y), 400);
+			Ogre::AxisAlignedBox aabb(	Ogre::Vector3(mymin(p1.x,p2.x),mymin(p1.y,p2=
.y),-200),aabbsize);
 			float fHitDist;
 			bool hit =3D cOgreWrapper::GetSingleton().RayAABBQuery(vRayPos, vRayDir=
, aabb, &fHitDist);
 			//~ printf("multitexterrain:RayPick(bxy=3D%d,%d iDXY=3D%d,%d T=3D%d aab=
bhit=3D%s)\n",bx,by,iDX,iDY,T,hit ? "hit" : "miss");



From no-reply at zwischenwelt.org  Wed Jan 14 23:00:15 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Wed, 14 Jan 2009 22:00:15 -0000
Subject: [Iris-commit] [IRIS] r2868 - in /trunk/lua: filter/filter.art.lua
 lib.loading.lua lib.mainmenu.lua
Message-ID: <20090114220015.F29B31C1880E@zwischenwelt.org>

Author: ghoulsblade
Date: Wed Jan 14 23:00:14 2009
New Revision: 2868

Log:
fixed missing rooftiles 0x593d

Modified:
    trunk/lua/filter/filter.art.lua
    trunk/lua/lib.loading.lua
    trunk/lua/lib.mainmenu.lua

Modified: trunk/lua/filter/filter.art.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.art.lua (original)
+++ trunk/lua/filter/filter.art.lua Wed Jan 14 23:00:14 2009
@@ -396,9 +396,18 @@
 --wall
 gArtFilter[670]=3D{maptoid=3D671,rotation=3D"x:0,y:0,z:90",xadd=3D0,yadd=
=3D1.85,zadd=3D0}
 =

---zaun
+--zaun / fence
 gArtFilter[2187]=3D{maptoid=3D2186,rotation=3D"x:0,y:0,z:90",xadd=3D0,yadd=
=3D1,zadd=3D0}
 =

+
+-- stone roof
+gArtFilter[0x193c]=3D{maptoid=3D0x5a3}
+gArtFilter[0x193a]=3D{maptoid=3D0x5a2}
+gArtFilter[0x193b]=3D{maptoid=3D0x597}
+gArtFilter[0x1939]=3D{maptoid=3D0x596}
+gArtFilter[0x193d]=3D{maptoid=3D0x5a1}
+gArtFilter[0x193e]=3D{maptoid=3D0x595}
+                =

 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 -- generated from remove_duplicate_models.php script

Modified: trunk/lua/lib.loading.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.loading.lua (original)
+++ trunk/lua/lib.loading.lua Wed Jan 14 23:00:14 2009
@@ -399,7 +399,7 @@
 	end
 	=

 	if (not gInitialMapLoaded) then LoadingProfile("load MapInfo") end
-	if (gMaps[index] =3D=3D nil) then print("Map"..index..".mul not found. Pl=
ease look into your UO directory to verify this.") Crash() end
+	if (gMaps[index] =3D=3D nil) then print("gMaps["..index.."] not defined."=
) Crash() end
 =

 	local name				=3D gMaps[index].name
 	local mapheight			=3D gMaps[index].mapheight

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Wed Jan 14 23:00:14 2009
@@ -89,6 +89,15 @@
 =

 -- postxt is a string for the position, e.g. 5260,1333  , can be nil
 local function StartOfflineMode (postxt)
+	if (gCommandLineSwitches["-som"]) then =

+		local confname =3D gCommandLineArguments[gCommandLineSwitches["-som"]+1]
+		print("StartOfflineMode config",confname)
+		gMaps =3D gMaps or {}
+		for k,v in pairs((gShardList[confname] or {}).gMaps or {}) do print("gMa=
ps["..k.."] override") gMaps[k] =3D v end
+	end
+	if (gCommandLineSwitches["-so"]) then =

+		gOfflineModeMapIndex =3D tonumber(gCommandLineArguments[gCommandLineSwit=
ches["-so"]+2]) or gOfflineModeMapIndex
+	end
 	if (gOfflineModeMapIndex) then MapChangeRequest(gOfflineModeMapIndex) end
 	=

 	if (gDialog_IrisLogo) then gDialog_IrisLogo:SetVisible(false) end



From no-reply at zwischenwelt.org  Thu Jan 15 17:15:32 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Thu, 15 Jan 2009 16:15:32 -0000
Subject: [Iris-commit] [IRIS] r2869 - in /trunk/data/models/models:
 to_004000/mdl_003853.mesh to_008000/mdl_007888.mesh
 to_008000/mdl_007889.mesh to_008000/mdl_007890.mesh
Message-ID: <20090115161532.F2EC01C18775@zwischenwelt.org>

Author: hagish
Date: Thu Jan 15 17:15:32 2009
New Revision: 2869

Log:
fixed normals

Modified:
    trunk/data/models/models/to_004000/mdl_003853.mesh
    trunk/data/models/models/to_008000/mdl_007888.mesh
    trunk/data/models/models/to_008000/mdl_007889.mesh
    trunk/data/models/models/to_008000/mdl_007890.mesh

Modified: trunk/data/models/models/to_004000/mdl_003853.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_008000/mdl_007888.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_008000/mdl_007889.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_008000/mdl_007890.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Thu Jan 15 21:26:55 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Thu, 15 Jan 2009 20:26:55 -0000
Subject: [Iris-commit] [IRIS] r2870 - /trunk/bin/iris2.exe
Message-ID: <20090115202655.7963C1C1880F@zwischenwelt.org>

Author: sience
Date: Thu Jan 15 21:26:54 2009
New Revision: 2870

Log:
-new win32 binary

Modified:
    trunk/bin/iris2.exe

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan 17 00:29:40 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 16 Jan 2009 23:29:40 -0000
Subject: [Iris-commit] [IRIS] r2871 - in /trunk: lua/ lua/gui/ lua/net/
 lua/obj/ lua/widgets/ plugins/
Message-ID: <20090116232941.626FB1C1880D@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 17 00:29:40 2009
New Revision: 2871

Log:
mainmenu : 3d/2d login buttons, new macro commands : MacroCmd_FindNearbyTre=
es,MacroCmd_FindNearbyStatics, MacroCmd_DragDropToGround,   added option to=
 disable chat-tab-pain (huge memory consumption, should be replaced or rewr=
itten) : gDisableChatTabPane,   desktop icon positions : now ignores corpse=
 containers, swamped memory+filesize during autolooting at champs, added pr=
ofiling for opencontainer and container contents change,   added CompleteTa=
rgetModeWithTargetStatic ,   spellbar:lumberjacking notices

Modified:
    trunk/lua/gui/gui.chat.lua
    trunk/lua/lib.2d.hudfx.lua
    trunk/lua/lib.2d.mobile.lua
    trunk/lua/lib.2d.mousepick.lua
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.blendout.lua
    trunk/lua/lib.cursor.lua
    trunk/lua/lib.desktop.lua
    trunk/lua/lib.loading.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/lib.mainmenu.lua
    trunk/lua/main.lua
    trunk/lua/net.walk.lua
    trunk/lua/net/net.dynamic.lua
    trunk/lua/net/net.multi.lua
    trunk/lua/net/net.text.lua
    trunk/lua/obj/obj.container.lua
    trunk/lua/widgets/widget.uocontainer.lua
    trunk/plugins/itemcounter.lua
    trunk/plugins/lib.spellbar.lua

Modified: trunk/lua/gui/gui.chat.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/gui/gui.chat.lua (original)
+++ trunk/lua/gui/gui.chat.lua Sat Jan 17 00:29:40 2009
@@ -30,7 +30,7 @@
 =

 =

 function GuiAddChatLine	(line, color)
-	if gGuiChatTabpane then
+	if gGuiChatTabpane and (not gDisableChatTabPane) then
 		GuiChatDistributeLineToChannels(line)
 	end
 	=

@@ -47,7 +47,7 @@
 	end
 end
 =

-gProfiler_ChatTabPane =3D CreateRoughProfiler("ChatTabPane")
+gProfiler_ChatTabPane =3D CreateRoughProfiler("  ChatTabPane")
 =

 function GuiChatAddLineToChannel	(channel, line)
 	gProfiler_ChatTabPane:Start(gEnableProfiler_ChatTabPane)

Modified: trunk/lua/lib.2d.hudfx.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.hudfx.lua (original)
+++ trunk/lua/lib.2d.hudfx.lua Sat Jan 17 00:29:40 2009
@@ -84,7 +84,7 @@
 		local seriesmana =3D mana - gLastDamageSeriesManaStart
 		local seriesdt =3D t - gLastDamageSeriesTimeStart
 		local seriesdt0 =3D t - gLastDamageSeriesTimeStart0
-		printf("### damage t=3D%d dt=3D%8d dmg=3D%3d dmana=3D%3d mana=3D%4d seri=
es=3D%d seriesmana=3D%3d seriesdmg=3D%4d seriesdt=3D%d seriesdt0=3D%d\n",t,=
dt,damage,dmana,mana,gLastDamageSeries,seriesmana,gLastDamageSeriesDmgSum,s=
eriesdt,seriesdt0)
+		--~ printf("### damage t=3D%d dt=3D%8d dmg=3D%3d dmana=3D%3d mana=3D%4d =
series=3D%d seriesmana=3D%3d seriesdmg=3D%4d seriesdt=3D%d seriesdt0=3D%d\n=
",t,dt,damage,dmana,mana,gLastDamageSeries,seriesmana,gLastDamageSeriesDmgS=
um,seriesdt,seriesdt0)
 	end
 end
 =


Modified: trunk/lua/lib.2d.mobile.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.mobile.lua (original)
+++ trunk/lua/lib.2d.mobile.lua Sat Jan 17 00:29:40 2009
@@ -223,7 +223,7 @@
 function Renderer2D:MobileStartServerSideAnim	(animdata) end
 =

 =

-gProfiler_R2D_MobileStep =3D CreateRoughProfiler("2D:MobileStep")
+gProfiler_R2D_MobileStep =3D CreateRoughProfiler("  2D:MobileStep")
 =

 function Renderer2D:MobileStep()
 	gProfiler_R2D_MobileStep:Start(gEnableProfiler_R2D_MobileStep)

Modified: trunk/lua/lib.2d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.mousepick.lua (original)
+++ trunk/lua/lib.2d.mousepick.lua Sat Jan 17 00:29:40 2009
@@ -3,7 +3,7 @@
 Renderer2D.gMousePickStepInterval =3D 400
 Renderer2D.gUOToolTipOverride =3D true
 =

-gProfiler_R2D_MousePick =3D CreateRoughProfiler("2D:MousePick")
+gProfiler_R2D_MousePick =3D CreateRoughProfiler("  2D:MousePick")
 =

 -- not every frame, but regularly
 function Renderer2D:MousePickStep		()

Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Sat Jan 17 00:29:40 2009
@@ -84,7 +84,7 @@
 	return DirWrap( floor(1.5+math.atan2(my-cy,mx-cx) * 8 / (2*kPi)) ),dist2(=
mx,my,cx,cy)
 end
 =

-gProfiler_R2D_MainStep =3D CreateRoughProfiler("2D:MainStep")
+gProfiler_R2D_MainStep =3D CreateRoughProfiler(" 2D:MainStep")
 =

 -- called from mainstep while ingame
 function Renderer2D:MainStep ()
@@ -152,7 +152,7 @@
 	gProfiler_R2D_MainStep:Section("HUDFX_MainStep")			self:HUDFX_MainStep()
 	gProfiler_R2D_MainStep:Section("Dynamics_MainStep")			self:Dynamics_MainS=
tep()
 	gProfiler_R2D_MainStep:Section("Dynamics_MultiUpdateStep")	self:Dynamics_=
MultiUpdateStep()
-	gProfiler_R2D_MainStep:Section("MousePickStep",true)		self:MousePickStep()
+	gProfiler_R2D_MainStep:Section("MousePickStep")				self:MousePickStep()
 	gProfiler_R2D_MainStep:End()
 end
 =


Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sat Jan 17 00:29:40 2009
@@ -116,7 +116,7 @@
 	gTileFreeWalk:SetPos_All(self:LocalToUOPos(x+0.5,y+0.5,z)) -- + for both =
might be wrong..
 end
 =

-gProfiler_R3D_MainStep =3D CreateRoughProfiler("3D:MainStep")
+gProfiler_R3D_MainStep =3D CreateRoughProfiler(" 3D:MainStep")
 =

 function Renderer3D:MainStep	()
 	gProfiler_R3D_MainStep:Start(gEnableProfiler_R3D_MainStep)

Modified: trunk/lua/lib.blendout.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.blendout.lua (original)
+++ trunk/lua/lib.blendout.lua Sat Jan 17 00:29:40 2009
@@ -1,7 +1,7 @@
 =

 kBlendOutPlayerHeight =3D 18	--eriminator: es galt grob, alles was 18z =C3=
=AF=C2=BF=C2=BDberm char war wurd ausgebledent
 =

-gProfiler_Blendout =3D CreateRoughProfiler("Blendout") -- gEnableProfiler_=
Blendout
+gProfiler_Blendout =3D CreateRoughProfiler("  Blendout") -- gEnableProfile=
r_Blendout
 =

 -- returns myLayer,bTerrainVisible
 function CalcBlendOutZ ()

Modified: trunk/lua/lib.cursor.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.cursor.lua (original)
+++ trunk/lua/lib.cursor.lua Sat Jan 17 00:29:40 2009
@@ -125,6 +125,10 @@
 	CompleteTargetMode(hit)
 end
 =

+function CompleteTargetModeWithTargetStatic (item)
+	CompleteTargetMode({ hittype =3D kMousePickHitType_Static, hit_xloc=3Dite=
m.xloc, hit_yloc=3Ditem.yloc, hit_zloc=3Ditem.zloc, entity =3D item })
+end
+
 function CompleteTargetMode (hitobject,maxrange) -- maxrange=3Dnil
 	if (not hitobject) then
 		MainMousePick()

Modified: trunk/lua/lib.desktop.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.desktop.lua (original)
+++ trunk/lua/lib.desktop.lua Sat Jan 17 00:29:40 2009
@@ -134,7 +134,7 @@
 end)
 RegisterListener("Hook_OpenContainer",function(widget) =

 	local serial =3D widget.uoContainer.serial
-	if widget and serial then
+	if widget and serial and widget.uoContainer.gumpid ~=3D kCorpseContainerG=
umpID then -- ignore corpses here (massive with autoloot)
 		local x,y =3D widget:GetPos()
 		ReplaceDesktopElement("container",x,y,serial) 	=

 		SaveDesktop()

Modified: trunk/lua/lib.loading.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.loading.lua (original)
+++ trunk/lua/lib.loading.lua Sat Jan 17 00:29:40 2009
@@ -245,6 +245,10 @@
 		LoadingProfile("init GrannyLoader")
 		gGrannyLoader =3D CreateGrannyLoader(gGrannyLoaderType)
 	end
+end
+
+function PreLoadAfterManualRenderSwitch ()
+	if (gCurrentRenderer =3D=3D Renderer3D and (not gGrannyLoader)) then Load=
_Granny() end
 end
 =

 -- ------------------------------------------------------------------

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Sat Jan 17 00:29:40 2009
@@ -467,6 +467,30 @@
 function MacroCmd_DragDrop (takeserial,amount,dropcontainerserial) =

 	Send_Take_Object(takeserial,amount)
 	Send_Drop_Object_AutoStack(takeserial,dropcontainerserial or GetPlayerBac=
kPackSerial())
+end
+function MacroCmd_DragDropToGround (takeserial,amount,xloc,yloc,zloc) =

+	Send_Take_Object(takeserial,amount)
+	xloc =3D xloc or gPlayerXLoc
+	yloc =3D yloc or gPlayerYLoc
+	zloc =3D zloc or gPlayerZLoc
+	Send_Drop_Object(takeserial,xloc,yloc,zloc,0xFFFFFFFF)
+end
+
+function MacroCmd_FindNearbyTrees (r) return MacroCmd_FindNearbyStatics(r,=
"tree",{0x0c9e}) end -- ohii tree not hackable
+function MacroCmd_FindNearbyStatics (r,namepart,skipartidlist)
+	local res =3D {}
+	r =3D r or 2
+	for ax =3D -r,r do
+	for ay =3D -r,r do
+		for k,item in pairs(MapGetStatics(gPlayerXLoc+ax,gPlayerYLoc+ay)) do
+			if (StringContains(string.lower(GetStaticTileTypeName(item.artid)),name=
part) and
+				((not skipartidlist) or (not in_array(item.artid,skipartidlist)))) the=
n =

+				table.insert(res,item) =

+			end
+		end =

+	end
+	end
+	return res
 end
 =

 -- doesn't sum stack-amount

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Sat Jan 17 00:29:40 2009
@@ -272,7 +272,9 @@
 	--check first, if the choose slot is available!
 	=

 	=

-	local MySelectChar =3D function(iCharNum) =

+	local MySelectChar =3D function(iCharNum,myrenderer) =

+		gCurrentRenderer =3D myrenderer or gCurrentRenderer
+		PreLoadAfterManualRenderSwitch()
 		Send_Character_Select(iCharNum,gGameServerAccount)
 	end
 	local MyCreateCharTemplatePicker =3D function(widget) =

@@ -297,7 +299,9 @@
 		end
 		gNextFreeCharSlot =3D gNextFreeCharSlot + 1
 		table.insert(rows,{
-			{type=3D"Button",onLeftClick=3Dfunction(widget) MySelectChar(widget.iCh=
arNum) widget.dialog:Destroy() gSelectedCharName =3D v.name end ,iCharNum=
=3Dk,text=3D"Login as "..v.name}
+			{type=3D"Button",onLeftClick=3Dfunction(widget) MySelectChar(widget.iCh=
arNum) widget.dialog:Destroy() gSelectedCharName =3D v.name end ,iCharNum=
=3Dk,text=3D"Login as "..v.name},
+			{type=3D"Button",onLeftClick=3Dfunction(widget) MySelectChar(widget.iCh=
arNum,Renderer3D) widget.dialog:Destroy() gSelectedCharName =3D v.name end =
,iCharNum=3Dk,text=3D"3D"},
+			{type=3D"Button",onLeftClick=3Dfunction(widget) MySelectChar(widget.iCh=
arNum,Renderer2D) widget.dialog:Destroy() gSelectedCharName =3D v.name end =
,iCharNum=3Dk,text=3D"2D"},
 		})
 	end end
 	-- char creation (TODO)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sat Jan 17 00:29:40 2009
@@ -473,11 +473,11 @@
 	for k,o in pairs(arr_tspikeframe) do =

 		if (k <=3D topx and (not gEnableRoughProfileSum_SkipSpikeFrame)) then pr=
int(" #"..k,sprintf("%5dmsec",o.v),o.name) end =

 	end
-	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memLua =3D=3D=3D")
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memLua allocations =3D=
=3D=3D")
 	for k,o in pairs(arr_memL) do =

 		if (k <=3D topx and o.v > 0 and (not gEnableRoughProfileSum_SkipMemL)) t=
hen print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.name) end =

 	end
-	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memOgre =3D=3D=3D")
+	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop memOgre allocations =3D=
=3D=3D")
 	for k,o in pairs(arr_memO) do =

 		if (k <=3D topx and o.v > 0 and (not gEnableRoughProfileSum_SkipMemO)) t=
hen print(" #"..k,sprintf("%5dkb",floor(o.v/1024)),o.name) end =

 	end
@@ -540,7 +540,7 @@
 	=

 	gProfiler_MainStep:Section("NetStep")
 	NetStep()
-	gProfiler_MainStep:Section("HandlePackets",true) -- anaylsed inside
+	gProfiler_MainStep:Section("HandlePackets",true) -- analysed inside
 	HandlePackets()
 	=

 	gProfiler_MainStep:Section("SoundStep")

Modified: trunk/lua/net.walk.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net.walk.lua (original)
+++ trunk/lua/net.walk.lua Sat Jan 17 00:29:40 2009
@@ -142,7 +142,7 @@
 end
 =

 =

-gProfiler_Walk =3D CreateRoughProfiler("Walk") -- gEnableProfiler_Walk
+gProfiler_Walk =3D CreateRoughProfiler("  Walk") -- gEnableProfiler_Walk
 =

 -- does collision detection, tries neighboring dirs if direct walk is bloc=
ked
 function WalkStep_WalkInDir		(iDir,bRunFlag,bTrySides) =


Modified: trunk/lua/net/net.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.dynamic.lua (original)
+++ trunk/lua/net/net.dynamic.lua Sat Jan 17 00:29:40 2009
@@ -92,9 +92,13 @@
 	CreateOrUpdateDynamic(dynamicdata)
 end
 =

+gProfiler_Container_Contents =3D CreateRoughProfiler(" Container_Contents")
+
 -- AddItemToContainer (0x3C)
 -- pol sends this after kPacket_Open_Container, runuo before, see also kPa=
cket_Object_to_Object
 function gPacketHandler.kPacket_Container_Contents() -- 0x3c
+	gProfiler_Container_Contents:Start(gEnableProfiler_Container_Contents)
+	gProfiler_Container_Contents:Section("head")
 	local input =3D GetRecvFIFO()
 	local id		=3D input:PopNetUint8()
 	local size		=3D input:PopNetUint16()
@@ -102,6 +106,7 @@
 	local iLastSerial
 =

 	local oldcount =

+	gProfiler_Container_Contents:Section("items")
 	for i=3D1,itemcount do
 		local dynamicdata =3D {}
 		dynamicdata.container_content_order =3D i
@@ -127,8 +132,11 @@
 	--~ print("######### kPacket_Container_Contents",iLastSerial,oldcount,ite=
mcount)
 	=

 	=

+	gProfiler_Container_Contents:Section("spellbook")
 	if (iLastSerial) then Update_Spellbook(iLastSerial) end
+	gProfiler_Container_Contents:Section("Hook_Container_Contents")
 	NotifyListener("Hook_Container_Contents",iLastSerial)
+	gProfiler_Container_Contents:End()
 end
 =

 -- This is sent by the server to add/update a single item to a container. =
(response to player dragdrop)

Modified: trunk/lua/net/net.multi.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.multi.lua (original)
+++ trunk/lua/net/net.multi.lua Sat Jan 17 00:29:40 2009
@@ -44,7 +44,7 @@
 -- TODO : this packet handling is so stupid... ea/osi please think before =
you are writing sourcecode !!
 -- this code is based on the packet format runuo uses
 gCustomHouseMultiTileCache =3D {}
-gProfiler_CustomHousePacket =3D CreateRoughProfiler("CustomHousePacket")
+gProfiler_CustomHousePacket =3D CreateRoughProfiler("  CustomHousePacket")
 function gPacketHandler.kPacket_Custom_House()	--0xD8
 	gProfiler_CustomHousePacket:Start(gEnableProfiler_CustomHousePacket)
 	gProfiler_CustomHousePacket:Section("PopHeader")

Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Sat Jan 17 00:29:40 2009
@@ -101,7 +101,7 @@
 =

 -- ***** ***** ***** ***** ***** incoming text
 =

-gProfiler_Text =3D CreateRoughProfiler("Text")
+gProfiler_Text =3D CreateRoughProfiler("  Text")
 function HandleUOText (data)
 	gProfiler_Text:Start(gEnableProfiler_Text)
 	gProfiler_Text:Section("PreCalc")
@@ -272,7 +272,7 @@
 	HandleUOText(data)
 end
 =

-gProfiler_Packet_Localized_Text =3D CreateRoughProfiler("Packet_Localized_=
Text")
+gProfiler_Packet_Localized_Text =3D CreateRoughProfiler("  Packet_Localize=
d_Text")
 =

 -- Predefined Message (localized Message) 0xC1
 function gPacketHandler.kPacket_Localized_Text ()

Modified: trunk/lua/obj/obj.container.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/obj/obj.container.lua (original)
+++ trunk/lua/obj/obj.container.lua Sat Jan 17 00:29:40 2009
@@ -71,6 +71,8 @@
 	if (container.dialog) then container.dialog:RefreshItems() end
 end
 =

+gProfiler_OpenContainer =3D CreateRoughProfiler("OpenContainer")
+
 -- called from kPacket_Open_Container
 function HandleOpenContainer	(containerdata)
 	if (not gGumpLoader) then return end
@@ -81,6 +83,9 @@
 		--AddFadeLines(sprintf("Open_ShopContainer id=3D0x%08x",containerdata.se=
rial))
 		return =

 	end
+	=

+	gProfiler_OpenContainer:Start(gEnableProfiler_OpenContainer)
+	gProfiler_OpenContainer:Section("spellbook")
 	=

 	--Old_Spellbook Container (Pol,Sphere,Lonewolf,RunUO1 etc.)
 	if ((containerdata.gumpid =3D=3D kGumpIDSpellbookContainer) and (not IsCo=
ntainerAlreadyOpen(containerdata.serial))) then
@@ -91,19 +96,26 @@
 		-- container with spell is already created (invisible)
 		printf("NET: Old_Spellbook: serial=3D0x%08x itemId=3D0x%04x offset=3D0x%=
04x\n",spellbook.serial or 0, spellbook.itemid or 0, spellbook.scrolloffset=
 or 0)
 		Open_Spellbook(spellbook)
+		=

+		gProfiler_OpenContainer:End()
 		return =

 	end
 	=

 	-- normal container
+	gProfiler_OpenContainer:Section("GetOrCreateContainer")
 	local container =3D GetOrCreateContainer(containerdata.serial)
 	container.gumpid =3D containerdata.gumpid
 	=

 	-- 0x003c =3D backpack
 	-- 0x0030 =3D shopcontainer
+	gProfiler_OpenContainer:Section("CreateUOContainerDialog")
 	if (not container.dialog) then container.dialog =3D CreateUOContainerDial=
og(container) end
 	gLastDebugContainer =3D container
+	gProfiler_OpenContainer:Section("RefreshContainerItemWidgets")
 	RefreshContainerItemWidgets(container)
+	gProfiler_OpenContainer:Section("Hook_OpenContainer")
 	NotifyListener("Hook_OpenContainer",container.dialog,container.serial,con=
tainerdata.gumpid)
+	gProfiler_OpenContainer:End()
 end
 =

 -- packet handlers for containers (chests, drawers, inventory..)

Modified: trunk/lua/widgets/widget.uocontainer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/widgets/widget.uocontainer.lua (original)
+++ trunk/lua/widgets/widget.uocontainer.lua Sat Jan 17 00:29:40 2009
@@ -7,24 +7,38 @@
 function CreateUOContainerDialog(container) return GetDesktopWidget():Crea=
teChild("UOContainerDialog",{container=3Dcontainer}) end
 =

 =

+gProfiler_UOContainerDialog =3D CreateRoughProfiler(" UOContainerDialog")
 function gWidgetPrototype.UOContainerDialog:Init (parentwidget, params)
+	gProfiler_UOContainerDialog:Start(gEnableProfiler_UOContainerDialog)
+	gProfiler_UOContainerDialog:Section("CreateRenderGroup2D")
 	self.rendergroup2d =3D CreateRenderGroup2D(parentwidget:CastToRenderGroup=
2D())
+	gProfiler_UOContainerDialog:Section("SetRenderGroup2D")
 	self:SetRenderGroup2D(self.rendergroup2d)
+	gProfiler_UOContainerDialog:Section("AddToDestroyList")
 	self:AddToDestroyList(self.rendergroup2d)
+	gProfiler_UOContainerDialog:Section("SetIgnoreBBoxHit")
 	self:SetIgnoreBBoxHit(true)
 	=

 	local container		=3D params.container
 	self.params			=3D params
 	self.uoContainer	=3D container
+	gProfiler_UOContainerDialog:Section("UOImage")
 	self.backpane		=3D self:CreateChild("UOImage",{x=3D0,y=3D0,gump_id=3Dcont=
ainer.gumpid})
 	self.backpane.uoContainer =3D container
+	gProfiler_UOContainerDialog:Section("Group")
 	self.items 			=3D self:CreateChild("Group") -- for sub-widgets
 	=

-	local x,y =3D GetDesktopElementPosition("container",container.serial)
+	gProfiler_UOContainerDialog:Section("GetDesktopElementPosition")
+	local x,y
+	if (container.gumpid ~=3D kCorpseContainerGumpID) then x,y =3D GetDesktop=
ElementPosition("container",container.serial) end -- not for corpses... mas=
ses
+	gProfiler_UOContainerDialog:Section("SetPos")
 	self:SetPos(x or 200,y or 100)
+	gProfiler_UOContainerDialog:Section("RefreshItems")
 	self:RefreshItems()
 	=

+	gProfiler_UOContainerDialog:Section("Hook_OpenContainer")
 	NotifyListener("Hook_OpenContainer",self)
+	gProfiler_UOContainerDialog:End()
 end
 =

 --~ function gWidgetPrototype.UOContainerDialog:on_destroy ()

Modified: trunk/plugins/itemcounter.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/itemcounter.lua (original)
+++ trunk/plugins/itemcounter.lua Sat Jan 17 00:29:40 2009
@@ -38,7 +38,11 @@
 		{name=3D"dexpot"		,artid=3D0xF08,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
 		{name=3D"strpot"		,artid=3D0xF09,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
 	},
-	{ -- crafter
+	{ -- tailor
+		{name=3D"board"			,artid=3D0x1bd7},
+		{name=3D"log"				,artid=3D0x1bdd},
+	},
+	{ -- tailor
 		{name=3D"cloth"			,artid=3D0x1766},
 		{name=3D"spoolofthread"	,artid=3D0xfa0},
 		{name=3D"boltofcloth"		,artid=3D0xf95},

Modified: trunk/plugins/lib.spellbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/lib.spellbar.lua (original)
+++ trunk/plugins/lib.spellbar.lua Sat Jan 17 00:29:40 2009
@@ -171,7 +171,7 @@
 gSpellbarShortMessages[1005385 ] =3D {r=3D1,g=3D0,b=3D0,txt=3D"will not ad=
here"	,bInterrupt=3Dtrue} -- The spell will not adhere to you at this time.=
 (preaos,reactive armor or spellresist still active)
 gSpellbarShortMessages[1005559 ] =3D {r=3D1,g=3D0,b=3D0,txt=3D"already"			=
,bInterrupt=3Dtrue} -- This spell is already in effect.
 gSpellbarShortMessages[1005561 ] =3D {r=3D1,g=3D0,b=3D0,txt=3D"crime"				,=
bInterrupt=3Dtrue} -- Thou'rt a criminal and cannot escape so easily...
-gSpellbarShortMessages[1005564 ] =3D {r=3D1,g=3D0,b=3D0,txt=3D"crime"				,=
bInterrupt=3Dtrue} -- Wouldst thou flee during the heat of battle??
+gSpellbarShortMessages[1005564 ] =3D {r=3D1,g=3D0,b=3D0,txt=3D"crimeB"			,=
bInterrupt=3Dtrue} -- Wouldst thou flee during the heat of battle??
 =

 =

 =

@@ -204,6 +204,13 @@
 gSpellbarShortMessages[1060167] =3D {r=3D0.0,g=3D0.5,b=3D0.0,txt=3D"bleeds=
top" 		} -- The bleeding wounds have healed, you are no longer bleeding!
 gSpellbarShortMessages[1042809] =3D {r=3D1,g=3D0.5,b=3D0.0,txt=3D"EscortDo=
ne"			} -- We have arrived! I thank thee, CHARNAME! I have no further need =
of thy services. Here is thy pay.
 gSpellbarShortMessages[500969] =3D {r=3D0,g=3D1,b=3D0.0,txt=3D"BandaDone"	=
			} -- You finish applying the bandages.
+
+
+gSpellbarShortMessages[500498] =3D {r=3D0,g=3D1,b=3D0.0,txt=3D"log"				} -=
- You put some logs into your backpack.   =

+gSpellbarShortMessages[500493] =3D {r=3D1,g=3D0,b=3D0.0,txt=3D"empty"				}=
 -- There's not enough wood here to harvest.        =

+gSpellbarShortMessages[500495] =3D {r=3D1,g=3D1,b=3D0.0,txt=3D"fail"				} =
-- You hack at the tree for a while, but fail to produce any useable wood. =

+--~ gSpellbarShortMessages[] =3D {r=3D0,g=3D1,b=3D0.0,txt=3D""				} -- =

+
 =

 =

 --[[
@@ -258,7 +265,7 @@
 RegisterListener("Hook_Packet_Animation",	function (animdata)
 	local short =3D gSpellbarAnimationShortMessages[animdata.m_animation] =

 	if (short) then SpellBarRiseTextOnMob(animdata.mobileserial,short.r,short=
.g,short.b,short.txt) end
-	if ((not short) and gDebugSpellbarAnim) then SpellBarRiseTextOnMob(animda=
ta.mobileserial,0.5,0.5,0.5,"Anim:"..animdata.m_animation) print("spellbar:=
anim:",animdata.m_animation) end
+	if ((not short) and gDebugSpellbarAnim) then SpellBarRiseTextOnMob(animda=
ta.mobileserial,0.5,0.5,0.5,"Anim:"..animdata.m_animation) end
 end)
 =

 RegisterListener("Hook_Packet_Sound",	function (sounddata)



From no-reply at zwischenwelt.org  Sat Jan 17 04:15:08 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 03:15:08 -0000
Subject: [Iris-commit] [IRIS] r2872 - in /trunk: lua/lib.3d.mousepick.lua
 lua/lib.macrolist.lua lua/lib.mapblock.3d.statics.lua
 plugins/itemcounter.lua plugins/lib.spellbar.lua
Message-ID: <20090117031508.C25021C1880D@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 17 04:15:07 2009
New Revision: 2872

Log:
3d tree mousepick fix, transmitted wrong position (filter add) to server, a=
lways needs to be the exact tileposition of the item used in the map for th=
ings like lumberjacking and mining to work,   mapblock.3d.statics small opt=
 : calling config:getglobal once at startup instead of once per tile,   spe=
llbar : added mining messages , itemcounter : ore and ingots

Modified:
    trunk/lua/lib.3d.mousepick.lua
    trunk/lua/lib.macrolist.lua
    trunk/lua/lib.mapblock.3d.statics.lua
    trunk/plugins/itemcounter.lua
    trunk/plugins/lib.spellbar.lua

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Sat Jan 17 04:15:07 2009
@@ -174,6 +174,11 @@
 							gMousePickFoundHit =3D {}
 							gMousePickFoundHit.hittype =3D kMousePickHitType_Static
 							gMousePickFoundHit.entity =3D entity
+							local iTileTypeID,iX,iY,iZ,iHue =3D unpack(entity.rawdata)
+							gMousePickFoundHit.hit_xloc =3D iX -- (iX is already absolute in th=
is case), do NOT use entity.xloc here, it contains filter position add =

+							gMousePickFoundHit.hit_yloc =3D iY -- (iY is already absolute in th=
is case), do NOT use entity.xloc here, it contains filter position add =

+							gMousePickFoundHit.hit_zloc =3D iZ
+							print("static mousepick",iX,iY)
 							--entity has to have the following properties: hue, x, y, z, iTileT=
ypeID
 						end
 					end

Modified: trunk/lua/lib.macrolist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.macrolist.lua (original)
+++ trunk/lua/lib.macrolist.lua Sat Jan 17 04:15:07 2009
@@ -483,6 +483,7 @@
 	for ax =3D -r,r do
 	for ay =3D -r,r do
 		for k,item in pairs(MapGetStatics(gPlayerXLoc+ax,gPlayerYLoc+ay)) do
+			--~ print("MacroCmd_FindNearbyStatics",GetStaticTileTypeName(item.artid=
))
 			if (StringContains(string.lower(GetStaticTileTypeName(item.artid)),name=
part) and
 				((not skipartidlist) or (not in_array(item.artid,skipartidlist)))) the=
n =

 				table.insert(res,item) =


Modified: trunk/lua/lib.mapblock.3d.statics.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mapblock.3d.statics.lua (original)
+++ trunk/lua/lib.mapblock.3d.statics.lua Sat Jan 17 04:15:07 2009
@@ -55,6 +55,7 @@
 =

 	local blocks =3D math.floor((self.iBlockSize-1) / 8)+1
 =

+	local mygWaterAsGroundTiles =3D gConfig:Get("gWaterAsGroundTiles")
 	for x =3D 0,blocks-1 do
 		for y =3D 0,blocks-1 do
 			local l =3D MapGetBlockStatics(iBlockUO_X+x,iBlockUO_Y+y)
@@ -63,7 +64,7 @@
 			for k,s in pairs(l) do =

 				iTileTypeID,iX,iY,iZ,iHue =3D s.artid, s.tx, s.ty, s.zloc, s.hue
 				=

-				if (gConfig:Get("gWaterAsGroundTiles") or not FilterIsStaticWater(iTil=
eTypeID)) and iTileTypeID and iX and iY and iZ and (not FilterSkipStatic(iT=
ileTypeID)) then =

+				if (mygWaterAsGroundTiles or not FilterIsStaticWater(iTileTypeID)) and=
 iTileTypeID and iX and iY and iZ and (not FilterSkipStatic(iTileTypeID)) t=
hen =

 					-- uo tile pos
 					local xloc,yloc =3D (iBlockUO_X+x)*8+iX,(iBlockUO_Y+y)*8+iY
 					if =


Modified: trunk/plugins/itemcounter.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/itemcounter.lua (original)
+++ trunk/plugins/itemcounter.lua Sat Jan 17 04:15:07 2009
@@ -38,10 +38,11 @@
 		{name=3D"dexpot"		,artid=3D0xF08,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
 		{name=3D"strpot"		,artid=3D0xF09,	usagetype=3DkItemCounterUsageType_UseI=
nHand},
 	},
-	{ -- tailor
-		{name=3D"board"			,artid=3D0x1bd7},
-		{name=3D"log"				,artid=3D0x1bdd},
-	},
+	-- individual
+	{{name=3D"board"			,artid=3D0x1bd7}},
+	{{name=3D"log"			,artid=3D0x1bdd}},
+	{{name=3D"ore"			,artid=3D0x19b9}},
+	{{name=3D"ingot"			,artid=3D0x1bf2}},
 	{ -- tailor
 		{name=3D"cloth"			,artid=3D0x1766},
 		{name=3D"spoolofthread"	,artid=3D0xfa0},

Modified: trunk/plugins/lib.spellbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/lib.spellbar.lua (original)
+++ trunk/plugins/lib.spellbar.lua Sat Jan 17 04:15:07 2009
@@ -210,6 +210,20 @@
 gSpellbarShortMessages[500493] =3D {r=3D1,g=3D0,b=3D0.0,txt=3D"empty"				}=
 -- There's not enough wood here to harvest.        =

 gSpellbarShortMessages[500495] =3D {r=3D1,g=3D1,b=3D0.0,txt=3D"fail"				} =
-- You hack at the tree for a while, but fail to produce any useable wood. =

 --~ gSpellbarShortMessages[] =3D {r=3D0,g=3D1,b=3D0.0,txt=3D""				} -- =

+
+gSpellbarShortMessages[501863]	=3D {r=3D1,g=3D0,b=3D0.0,txt=3D"can't mine =
that"	} -- You can't mine that.
+gSpellbarShortMessages[503040]	=3D {r=3D1,g=3D0,b=3D0.0,txt=3D"empty"			} =
-- There is no metal here to mine.
+gSpellbarShortMessages[503043]	=3D {r=3D1,g=3D1,b=3D0.0,txt=3D"fail"				} =
-- You loosen some rocks but fail to find any useable ore.
+gSpellbarShortMessages[1007072]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"1:iron"			=
} -- You dig some iron ore and put it in your backpack.
+gSpellbarShortMessages[1007073]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"2:dullcopp=
er"		} -- You dig some dull copper ore and put it in your backpack.
+gSpellbarShortMessages[1007074]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"3:shadow i=
ron"	} -- You dig some shadow iron ore and put it in your backpack.
+gSpellbarShortMessages[1007075]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"4:copper"	=
		} -- You dig some copper ore and put it in your backpack.
+gSpellbarShortMessages[1007076]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"5:bronze"	=
		} -- You dig some bronze ore and put it in your backpack.
+gSpellbarShortMessages[1007077]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"6:golden"	=
		} -- You dig some golden ore and put it in your backpack.
+gSpellbarShortMessages[1007078]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"7:agapite"=
		} -- You dig some agapite ore and put it in your backpack.
+
+
+
 =

 =

 =




From no-reply at zwischenwelt.org  Sat Jan 17 12:10:47 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 11:10:47 -0000
Subject: [Iris-commit] [IRIS] r2873 - /trunk/obsolete/
Message-ID: <20090117111048.127031C18775@zwischenwelt.org>

Author: sience
Date: Sat Jan 17 12:10:47 2009
New Revision: 2873

Log:
-obsolete folder removed for new release (can be accessed via earlier revis=
ion)

Removed:
    trunk/obsolete/



From no-reply at zwischenwelt.org  Sat Jan 17 12:59:09 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 11:59:09 -0000
Subject: [Iris-commit] [IRIS] r2874 - in /trunk/vc8: iris_luajit.sln
	iris_luajit.vcproj
Message-ID: <20090117115909.5B6681C1880E@zwischenwelt.org>

Author: sience
Date: Sat Jan 17 12:59:08 2009
New Revision: 2874

Log:
-luajit buildfiles for Visual Studio 2005 (express)

Added:
    trunk/vc8/iris_luajit.sln
    trunk/vc8/iris_luajit.vcproj



From no-reply at zwischenwelt.org  Sat Jan 17 13:31:02 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 12:31:02 -0000
Subject: [Iris-commit] [IRIS] r2875 - /trunk/bin/iris2.exe
Message-ID: <20090117123102.97D0A1C1880D@zwischenwelt.org>

Author: sience
Date: Sat Jan 17 13:31:02 2009
New Revision: 2875

Log:
-new win32 binary using luajit (should be faster)

Modified:
    trunk/bin/iris2.exe

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Sat Jan 17 15:41:01 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 14:41:01 -0000
Subject: [Iris-commit] [IRIS] r2876 -
	/trunk/data/grannys/programs/hardwareSkinning.program
Message-ID: <20090117144101.938CD1C18775@zwischenwelt.org>

Author: sience
Date: Sat Jan 17 15:41:00 2009
New Revision: 2876

Log:
-fix

Modified:
    trunk/data/grannys/programs/hardwareSkinning.program

Modified: trunk/data/grannys/programs/hardwareSkinning.program
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/grannys/programs/hardwareSkinning.program (original)
+++ trunk/data/grannys/programs/hardwareSkinning.program Sat Jan 17 15:41:0=
0 2009
@@ -56,6 +56,6 @@
 		param_named_auto lightPos[1] light_position 1
 		param_named_auto lightDiffuseColour[0] light_diffuse_colour 0
 		param_named_auto lightDiffuseColour[1] light_diffuse_colour 1
-		param_named_auto ambient ambient_light_colour
+//		param_named_auto ambient ambient_light_colour
 	}
 }



From no-reply at zwischenwelt.org  Sat Jan 17 15:41:41 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 14:41:41 -0000
Subject: [Iris-commit] [IRIS] r2877 -
	/trunk/data/models/programs/Example_Basic.hlsl
Message-ID: <20090117144141.B6E7C1C18775@zwischenwelt.org>

Author: sience
Date: Sat Jan 17 15:41:41 2009
New Revision: 2877

Log:
-missing script added (from ogre)

Added:
    trunk/data/models/programs/Example_Basic.hlsl



From no-reply at zwischenwelt.org  Sat Jan 17 15:55:59 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 14:55:59 -0000
Subject: [Iris-commit] [IRIS] r2878 - in /trunk: data/profiles/gfx_high.lua
 data/profiles/gfx_med.lua data/profiles/gfx_ultrahigh.lua
 lua/config_declarations.lua
Message-ID: <20090117145602.35ECF1C1880D@zwischenwelt.org>

Author: sience
Date: Sat Jan 17 15:55:57 2009
New Revision: 2878

Log:
-tuned preloadmeshes off (standard)
-gfx_high.lua has now preloadmeshes=3Don and Textureatlas=3Dhigh
-gfx_ultrahigh.lua has now preloadmeshes=3Don and Textureatals=3Dnone (uses=
 no Atlas at all)

Modified:
    trunk/data/profiles/gfx_high.lua
    trunk/data/profiles/gfx_med.lua
    trunk/data/profiles/gfx_ultrahigh.lua
    trunk/lua/config_declarations.lua

Modified: trunk/data/profiles/gfx_high.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_high.lua (original)
+++ trunk/data/profiles/gfx_high.lua Sat Jan 17 15:55:57 2009
@@ -1,8 +1,10 @@
 -- high gfx-profile has medium settings with fixed function shadow techniq=
ue
 =

-gConfig:Set("gAtlasRes","med")
+gConfig:Set("gAtlasRes","high")
 =

 gConfig:Set("gShadowTechnique","texture_additive")
 gConfig:Set("gStaticsCastShadows",true)
 gConfig:Set("gDynamicsCastShadows",true)
 gConfig:Set("gMobileCastShadows",true)
+
+gConfig:Set("gPreloadStaticMesh",true)

Modified: trunk/data/profiles/gfx_med.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_med.lua (original)
+++ trunk/data/profiles/gfx_med.lua Sat Jan 17 15:55:57 2009
@@ -3,7 +3,6 @@
 gConfig:Set("gAtlasRes","med")
 =

 gConfig:Set("gShadowTechnique","none")
-gConfig:Set("gTerrainCastShadows",false)
 gConfig:Set("gStaticsCastShadows",false)
 gConfig:Set("gDynamicsCastShadows",false)
 gConfig:Set("gMobileCastShadows",false)

Modified: trunk/data/profiles/gfx_ultrahigh.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_ultrahigh.lua (original)
+++ trunk/data/profiles/gfx_ultrahigh.lua Sat Jan 17 15:55:57 2009
@@ -7,17 +7,9 @@
 gConfig:Set("gDynamicsCastShadows",true)
 gConfig:Set("gMobileCastShadows",true)
 =

+gConfig:Set("gPreloadStaticMesh",true)
+
 --~ gConfig:Set("gUseCaelumSkysystem",true)  19.10 : deactivated, as this =
seems to trigger crash when recalling into/outside a cave : =

 	-- http://www.vetus-mundus.de/phpbb2/viewtopic.php?p=3D107468#107468
 =

 gConfig:Set("gArtMapLoaderType","FullFile")
-
--- currently doesn't work
---gUseHumanSkinShader",true
-
--- currently doesn't work
---gEnableLowDetailTerrainFarSight",true
---gEnableLowDetailTerrainFarSightRangeAdd",2
-
--- currently doesn't work because of gUseStaticFallbacks
---gPreloadStaticMesh",true

Modified: trunk/lua/config_declarations.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/config_declarations.lua (original)
+++ trunk/lua/config_declarations.lua Sat Jan 17 15:55:57 2009
@@ -279,7 +279,7 @@
 =

 gConfig:DeclareBoolean("gLogPackets", "client", "log packets", 'TODO', fal=
se)
 =

-gConfig:DeclareBoolean("gPreloadStaticMesh", "loader", "preload all static=
 meshes", 'WARNING !!! this takes some seconds 25sec. first time and approx=
. 100MB RAM needed', true)
+gConfig:DeclareBoolean("gPreloadStaticMesh", "loader", "preload all static=
 meshes", 'WARNING !!! this takes some seconds 25sec. first time and approx=
. 100MB RAM needed', false)
 =

 -- incorrect fallbacks can be added to the skiplist using the fallbacktool=
 (f11)
 gConfig:DeclareBoolean("gEnableFallBackBillboards_Statics", "client", "bil=
lboard static fallback", 'TODO', false)



From no-reply at zwischenwelt.org  Sun Jan 18 00:08:52 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 23:08:52 -0000
Subject: [Iris-commit] [IRIS] r2879 - in /trunk: lua/ lua/net/ plugins/
Message-ID: <20090117230853.402E91C1880F@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan 18 00:08:52 2009
New Revision: 2879

Log:
disable lua static block bbox check (might be unreliable, and the per mesh =
check uses boundingspheres as early out, so no big harm to performance this=
 way),  added staticmousepick.hit_artid to ensure the target packet can sen=
d the unmodified artid. SetPlayerPos : added bTeleported param, DestroyObje=
ctsFarFromPlayer now only called on teleport and on walk-confirm from serve=
r, this should solve a few of the ghost/zombie mobile problems.  added prea=
os label hints, e.g. what ruin/vanq means, how many potions in keg...  spel=
lbar : added mining ores,  new plugin : minergrid, shows 8x8 blocks (experi=
mental, only tested in 2d, still ugly)

Added:
    trunk/plugins/minergrid.lua
Modified:
    trunk/lua/lib.2d.renderer.lua
    trunk/lua/lib.3d.mousepick.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.cursor.lua
    trunk/lua/lib.packetvideo.lua
    trunk/lua/main.lua
    trunk/lua/net.walk.lua
    trunk/lua/net/net.cursor.lua
    trunk/lua/net/net.text.lua
    trunk/plugins/lib.spellbar.lua

Modified: trunk/lua/lib.2d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.renderer.lua (original)
+++ trunk/lua/lib.2d.renderer.lua Sun Jan 18 00:08:52 2009
@@ -193,6 +193,9 @@
 			 (z or 0)
 end
 =

+
+function Renderer2D:UOPosToLocal2 (xloc,yloc,zloc) return self:UOPosToLoca=
l(xloc,yloc,zloc*kRenderer2D_ZScale) end
+
 -- returns px,py,bIsInFront
 function Renderer2D:UOPosToPixelPos (xloc,yloc,zloc)
 	return self:LocalPosToPixelPos(self:UOPosToLocal(xloc,yloc,zloc*kRenderer=
2D_ZScale))

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Sun Jan 18 00:08:52 2009
@@ -135,7 +135,9 @@
 	local numcustomquads =3D 0
 	if self.map3d_spawners and self.map3d_spawners.statics then
 		self.map3d_spawners.statics:ForAllBlocks(function(block)
-			if block:BBRayPick(rx, ry, rz, rvx, rvy, rvz) then -- if 3d static mous=
epicking is strange, look here, xmirror maybe.. no longer used for terrain,=
 only here
+			-- bbox raypick disabled, as it seems broken. model raypick contains bo=
unding sphere precheck already.
+			-- block:BBRayPick(rx, ry, rz, rvx, rvy, rvz) -- if 3d static mousepick=
ing is strange, look here, xmirror maybe.. no longer used for terrain, only=
 here
+			if true then
 				block:ForAllEntities(function(entity)
 					if (not entity.bLoaded) then return end
 					if (not entity.zloc) then print("mousepick warning, static entity has=
 no zloc",entity.serial,entity.artid) end
@@ -178,6 +180,7 @@
 							gMousePickFoundHit.hit_xloc =3D iX -- (iX is already absolute in th=
is case), do NOT use entity.xloc here, it contains filter position add =

 							gMousePickFoundHit.hit_yloc =3D iY -- (iY is already absolute in th=
is case), do NOT use entity.xloc here, it contains filter position add =

 							gMousePickFoundHit.hit_zloc =3D iZ
+							gMousePickFoundHit.hit_artid =3D iTileTypeID
 							print("static mousepick",iX,iY)
 							--entity has to have the following properties: hue, x, y, z, iTileT=
ypeID
 						end

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sun Jan 18 00:08:52 2009
@@ -179,6 +179,8 @@
 			yloc - 8*self.giMapOriginY * self.ROBMAP_CHUNK_SIZE,
 			(z or 0) + self.gZ_Factor
 end
+
+function Renderer3D:UOPosToLocal2 (xloc,yloc,zloc) return self:UOPosToLoca=
l(xloc,yloc,zloc*0.1) end
 =

 -- warning ! you still have to do 0.1 z factor seperately
 function Renderer3D:LocalToUOPos (xlocal,ylocal,zlocal) =


Modified: trunk/lua/lib.cursor.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.cursor.lua (original)
+++ trunk/lua/lib.cursor.lua Sun Jan 18 00:08:52 2009
@@ -173,7 +173,7 @@
 	if (hitobject.hittype =3D=3D kMousePickHitType_Static) then =

 		bSendPos =3D false =

 		local x,y,z =3D GetMouseHitTileCoords()
-		Send_Target_Static(hitobject.hit_xloc or x,hitobject.hit_yloc or y,hitob=
ject.hit_zloc or z,hitobject.entity)
+		Send_Target_Static(hitobject.hit_xloc or x,hitobject.hit_yloc or y,hitob=
ject.hit_zloc or z,hitobject.entity,hitobject.hit_artid)
 	end
 	=

 	-- ground hit

Modified: trunk/lua/lib.packetvideo.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.packetvideo.lua (original)
+++ trunk/lua/lib.packetvideo.lua Sun Jan 18 00:08:52 2009
@@ -99,7 +99,7 @@
 			elseif (chunk.chunktype =3D=3D kPacketVideoChunkType_Send) then
 			elseif (chunk.chunktype =3D=3D kPacketVideoChunkType_Pos) then
 				local xloc,yloc,zloc,fulldir =3D unpack(chunk.data)
-				SetPlayerPos(xloc,yloc,zloc,fulldir) =

+				SetPlayerPos(xloc,yloc,zloc,fulldir,true) =

 				if (gCurrentRenderer =3D=3D Renderer3D) then =

 					gCurrentRenderer:NotifyPlayerTeleported() =

 					gTileFreeWalk:SetPosFromPacketVideo(xloc,yloc,zloc,fulldir)
@@ -116,7 +116,8 @@
 		print("### packetvideo playback end")
 		gPlayerBodySerial =3D oldserial
 		MapChangeRequest(oldfacet)
-		SetPlayerPos(unpack(oldpos)) =

+		local xloc,yloc,zloc,fulldir =3D unpack(oldpos)
+		SetPlayerPos(xloc,yloc,zloc,fulldir,true) =

 		Send_Movement_Resync_Request()
 		Send_ClientQuery(gRequest_States,GetPlayerSerial())
 	end)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Jan 18 00:08:52 2009
@@ -429,8 +429,8 @@
 gMyProfilerTopCPUTSum =3D 0
 gMyProfilerTopGPUTSum =3D 0
 function MyProfilerTop ()
+	if (not gEnableRoughProfileSum) then return end
 	print(Client_GetTicks(),"=3D=3D=3D MyProfilerTop cpu time =3D=3D=3D")
-	if (not gEnableRoughProfileSum) then return end
 	local arr_t =3D {}
 	local arr_memL =3D {}
 	local arr_memO =3D {}

Modified: trunk/lua/net.walk.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net.walk.lua (original)
+++ trunk/lua/net.walk.lua Sun Jan 18 00:08:52 2009
@@ -95,7 +95,7 @@
 -- fulldir CAN include runflag
 =

 =

-function SetPlayerPos (xloc,yloc,zloc,fulldir) =

+function SetPlayerPos (xloc,yloc,zloc,fulldir,bTeleported) =

 	--~ WalkLog("SetPlayerPos",xloc,yloc,zloc,fulldir)
 	local dir =3D BitwiseAND(fulldir,hex2num("0x07"))
 	gPlayerDir =3D dir -- change of view dir does require one move packet, th=
e players stays on the same tile
@@ -104,7 +104,7 @@
 	gPlayerZLoc =3D zloc
 	=

 	gProfiler_Walk:Section("SetPlayerPos:Hook_SetPlayerPos")
-	NotifyListener("Hook_SetPlayerPos")
+	NotifyListener("Hook_SetPlayerPos",xloc,yloc,zloc)
 	gProfiler_Walk:Section("SetPlayerPos:GetPlayerMobile")
 	=

 	local mobile =3D GetPlayerMobile()
@@ -123,8 +123,9 @@
 	-- handle position update
 	gProfiler_Walk:Section("SetPlayerPos:BlendOutLayersAbovePlayer")
 	gCurrentRenderer:BlendOutLayersAbovePlayer()
-	gProfiler_Walk:Section("SetPlayerPos:DestroyObjectsFarFromPlayer")
-	DestroyObjectsFarFromPlayer(gPlayerXLoc,gPlayerYLoc)
+	=

+	gProfiler_Walk:Section("SetPlayerPos:DestroyObjectsFarFromPlayer") -- her=
e only on teleport, see confirmed position / moveack =

+	if (bTeleported) then DestroyObjectsFarFromPlayer(gPlayerXLoc,gPlayerYLoc=
) end
 	gProfiler_Walk:End() -- in case it this is called from outside walk
 end
 =

@@ -292,6 +293,7 @@
 		gWalkRequests[iSeqNum] =3D nil -- request has been handled, remove from =
queue
 		gCurrentRenderer:SetLastConfirmedUOPos(request.xloc,request.yloc,request=
.zloc)
 	=

+		DestroyObjectsFarFromPlayer(request.xloc,request.yloc)
 		-- todo : tilefree : set last confirmed pos
 		--~ WalkLog("kPacket_Accept_Movement ok")
 	else
@@ -340,7 +342,7 @@
 			end
 		end
 		ResetWalkQueue()
-		SetPlayerPos(xloc,yloc,zloc,dir)
+		SetPlayerPos(xloc,yloc,zloc,dir,true)
 		gCurrentRenderer:NotifyPlayerTeleported()
 	end
 end
@@ -394,10 +396,10 @@
 		yloc =3D yloc + GetDirY(fulldir)
 	end
 	=

-	SetPlayerPos(xloc,yloc,zloc,fulldir) =

+	SetPlayerPos(xloc,yloc,zloc,fulldir,true) =

 	if (gCurrentRenderer =3D=3D Renderer3D) then =

 		gCurrentRenderer:NotifyPlayerTeleported() =

-		gTileFreeWalk:SetPosFromPacketVideo(xloc,yloc,zloc,fulldir)
+		gTileFreeWalk:SetPosFromPacketVideo(xloc,yloc,zloc,fulldir,true)
 	end
 end
 =

@@ -425,7 +427,7 @@
 	=

 	ResetWalkQueue()
 	WalkClearDoomList()
-	SetPlayerPos(mobiledata.xloc,mobiledata.yloc,mobiledata.zloc,mobiledata.d=
ir) -- always call this, affects gPlayerPos
+	SetPlayerPos(mobiledata.xloc,mobiledata.yloc,mobiledata.zloc,mobiledata.d=
ir,true) -- always call this, affects gPlayerPos
 	gCurrentRenderer:NotifyPlayerTeleported()
 	MultiTexTerrain_NotifyTeleport()
 	WalkLog("NotifyTeleport end")

Modified: trunk/lua/net/net.cursor.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.cursor.lua (original)
+++ trunk/lua/net/net.cursor.lua Sun Jan 18 00:08:52 2009
@@ -81,9 +81,9 @@
 end
 =

 -- Target Statics (TODO: is this correct?; sends entitiy tile zloc instead=
 of click pos; seems to expect the position at the ground
-function Send_Target_Static (x,y,z,entity) =

+function Send_Target_Static (x,y,z,entity,artid) =

 	NotifyListener("Hook_TargetMode_Static",x,y,z,entity)
-	Send_Target(true,0,hex2num("0x00000000"),x,y,entity.zloc,entity.artid or =
entity.iTileTypeID) =

+	Send_Target(true,0,hex2num("0x00000000"),x,y,z or entity.zloc,artid or en=
tity.artid or entity.iTileTypeID) =

 end
 =

 -- Target Item (Backpack, Paperdoll)

Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Sun Jan 18 00:08:52 2009
@@ -10,33 +10,80 @@
 	return labelcache and labelcache.final
 end
 =

+function PreAOSAttributeAddHints (text)
+	function MyReplace (subject,search,add,bAtStart) return string.gsub(subje=
ct,(bAtStart and "^" or "")..search,search.." "..add) end
+	text =3D MyReplace(text,"Ruin"			,"(1/5:dmg+1 <gm)")
+	text =3D MyReplace(text,"Might"			,"(2/5:dmg+3 =3Dgm)")
+	text =3D MyReplace(text,"Force"			,"(3/5:dmg+5)")
+	text =3D MyReplace(text,"Power"			,"(4/5:dmg+6)")
+	text =3D MyReplace(text,"Vanquishing"		,"(5/5:dmg+7)")
+	=

+	text =3D MyReplace(text,"Durable"			,"(1/5:dur+5)")    -- (might be doubl=
e instead?)
+	text =3D MyReplace(text,"Substantial"		,"(2/5:dur+10)")
+	text =3D MyReplace(text,"Massive"			,"(3/5:dur+15)")
+	text =3D MyReplace(text,"Fortified"		,"(4/5:dur+20)")
+	text =3D MyReplace(text,"Indestructible"	,"(5/5:dur+25)")
+ =

+	text =3D MyReplace(text,"Defense"			,"(1/5:ar+5)")
+	text =3D MyReplace(text,"Guarding"		,"(2/5:ar+10)")
+	text =3D MyReplace(text,"Hardening"		,"(3/5:ar+15)")
+	text =3D MyReplace(text,"Fortification"	,"(4/5:ar+20)")
+	text =3D MyReplace(text,"Invulnerability"	,"(5/5:ar+25)")
+	=

+	text =3D MyReplace(text,"Accurate"				,"(1/5:tac/arch+5)",true)
+	text =3D MyReplace(text,"Surpassingly Accurate"	,"(2/5:tac/arch+10)")
+	text =3D MyReplace(text,"Eminently Accurate"		,"(3/5:tac/arch+15)")
+	text =3D MyReplace(text,"Exceedingly Accurate"	,"(4/5:tac/arch+20)")
+	text =3D MyReplace(text,"Supremely Accurate"		,"(5/5:tac/arch+25)")
+	=

+	text =3D MyReplace(text,"Brand new"									,"100%")
+	text =3D MyReplace(text,"Almost new"									,"90%") =

+	text =3D MyReplace(text,"Barely used, with a few nicks and scrapes"	,"80%=
") 								=

+	text =3D MyReplace(text,"Fairly good condition"						,"70%") 			=

+	text =3D MyReplace(text,"Suffered some wear and tear"					,"60%") 				=

+	text =3D MyReplace(text,"Well used"									,"50%") =

+	text =3D MyReplace(text,"Rather Battered"								,"40%") 	=

+	text =3D MyReplace(text,"Somewhat badly damaged"						,"30%") 			=

+	text =3D MyReplace(text,"Flimsy and not trustworthy"					,"20%") 				=

+	text =3D MyReplace(text,"Falling Apart"								,"10%")
+	=

+	text =3D MyReplace(text,"Is superbly crafted to provide maximum protectio=
n"	,"31+") 	=

+	text =3D MyReplace(text,"Offers excellent protection"							,"26-30")	=

+	text =3D MyReplace(text,"Is a superior defense against attack"				,"21-25=
") 	=

+	text =3D MyReplace(text,"Serves as sturdy protection"							,"16-20") 	=

+	text =3D MyReplace(text,"Offers some protection against blows"				,"11-15=
") 	=

+	text =3D MyReplace(text,"Provides very little protection"						,"6-10") 	=

+	text =3D MyReplace(text,"Provides almost no protection"						,"1-5") 	=

+	text =3D MyReplace(text,"Offers no defense against attackers"					,"0") 		=

+	=

+	text =3D MyReplace(text,"Would be extraordinarily deadly"				,"26+") 	=

+	text =3D MyReplace(text,"Would be a superior weapon"					,"21-25") 	=

+	text =3D MyReplace(text,"Would inflict serious damage and pain"		,"16-20"=
) 	=

+	text =3D MyReplace(text,"Likely hurt opponent a fair amount"			,"11-15") 	=

+	text =3D MyReplace(text,"Would do some damage"						,"6-10") 	=

+	text =3D MyReplace(text,"Would do minimal damage"						,"3-5") 	=

+	text =3D MyReplace(text,"Might scratch their opponent slightly"		,"0-2") 	=

+	=

+	text =3D MyReplace(text,"The keg is empty"								,"0") =

+	text =3D MyReplace(text,"The keg is nearly empty"							,"1-4") =

+	text =3D MyReplace(text,"The keg is not very full"						,"5-19") =

+	text =3D MyReplace(text,"The keg is about one quarter full"				,"20-29") =

+	text =3D MyReplace(text,"The keg is about one third full"					,"30-39") =

+	text =3D MyReplace(text,"The keg is almost half full"						,"40-46") =

+	text =3D MyReplace(text,"The keg is approximately half full"				,"47-53") =

+	text =3D MyReplace(text,"The keg is more than half full"					,"54-69") =

+	text =3D MyReplace(text,"The keg is about three quarters full"			,"70-79"=
) =

+	text =3D MyReplace(text,"The keg is very full"							,"80-95") =

+	text =3D MyReplace(text,"The liquid is almost to the top of the keg"		,"9=
6-99") =

+	text =3D MyReplace(text,"The keg is completely full"						,"100") =

+	return text
+end
+
+-- used by kPacket_Generic_SubCommand_AOSTooltip (misnamed, also used by p=
reaos)
 function SetPreAOSAttributes (serial,lines) =

 	local labelcache =3D GetOrCreateLabelCache(serial)
 	for k,text in pairs(lines) do
-		text =3D string.gsub(text,"Ruin","Ruin(1/5:dmg+1 <gm)")
-		text =3D string.gsub(text,"Might","Might(2/5:dmg+3 =3Dgm)")
-		text =3D string.gsub(text,"Force","Force(3/5:dmg+5)")
-		text =3D string.gsub(text,"Power","Power(4/5:dmg+6)")
-		text =3D string.gsub(text,"Vanquishing","Vanquishing(5/5:dmg+7)")
-		=

-		text =3D string.gsub(text,"Durable","Durable(1/5:dur+5)")    -- (might b=
e double instead?)
-		text =3D string.gsub(text,"Substantial","Substantial(2/5:dur+10)")
-		text =3D string.gsub(text,"Massive","Massive(3/5:dur+15)")
-		text =3D string.gsub(text,"Fortified","Fortified(4/5:dur+20)")
-		text =3D string.gsub(text,"Indestructible","Indestructible(5/5:dur+25)")
-	 =

-		text =3D string.gsub(text,"Defense","Defense(1/5:ar+5)")
-		text =3D string.gsub(text,"Guarding","Guarding(2/5:ar+10)")
-		text =3D string.gsub(text,"Hardening","Hardening(3/5:ar+15)")
-		text =3D string.gsub(text,"Fortification","Fortification(4/5:ar+20)")
-		text =3D string.gsub(text,"Invulnerability","Invulnerability(5/5:ar+25)")
-		=

-		text =3D string.gsub(text,"^Accurate","Accurate(1/5:tac/arch+5)")
-		text =3D string.gsub(text,"Surpassingly Accurate","Surpassingly Accurate=
(2/5:tac/arch+10)")
-		text =3D string.gsub(text,"Eminently Accurate","Eminently Accurate(3/5:t=
ac/arch+15)")
-		text =3D string.gsub(text,"Exceedingly Accurate","Exceedingly Accurate(4=
/5:tac/arch+20)")
-		text =3D string.gsub(text,"Supremely Accurate","Supremely Accurate(5/5:t=
ac/arch+25)")
-		=

+		text =3D PreAOSAttributeAddHints(text)
 		GuiAddChatLine(text,{1,1,1,1})
 		lines[k] =3D text
 	end
@@ -116,6 +163,7 @@
 	if data.type =3D=3D kTextType_System then	r,g,b =3D 0,0,1 end
 	if data.type =3D=3D kTextType_Emote then	r,g,b =3D 0,1,0 end
 	if data.type =3D=3D kTextType_Label then =

+		data.text =3D PreAOSAttributeAddHints(data.text)
 		bIsLabel =3D true
 		gProfiler_Text:Section("Mobile_NameHint")
 		if mobile then Mobile_NameHint(data.serial,data.artid,data.name,data.tex=
t) end
@@ -193,7 +241,7 @@
 	end
 	=

 	gProfiler_Text:Section("JournalAddText")
-	if show_journal or show_below then print("HandleUOText",plaintext,data.cl=
ilocid) end
+	if show_journal or show_below then print("HandleUOText",plaintext,data.cl=
ilocid,data.type) end
 	if show_journal then
 		JournalAddText(data.name,plaintext)
 	end

Modified: trunk/plugins/lib.spellbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/lib.spellbar.lua (original)
+++ trunk/plugins/lib.spellbar.lua Sun Jan 18 00:08:52 2009
@@ -221,6 +221,8 @@
 gSpellbarShortMessages[1007076]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"5:bronze"	=
		} -- You dig some bronze ore and put it in your backpack.
 gSpellbarShortMessages[1007077]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"6:golden"	=
		} -- You dig some golden ore and put it in your backpack.
 gSpellbarShortMessages[1007078]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"7:agapite"=
		} -- You dig some agapite ore and put it in your backpack.
+gSpellbarShortMessages[1007080]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"9:valorite=
"		} -- You dig some valorite ore and put it in your backpack.
+
 =

 =

 =




From no-reply at zwischenwelt.org  Sun Jan 18 00:39:41 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 17 Jan 2009 23:39:41 -0000
Subject: [Iris-commit] [IRIS] r2880 - /trunk/lua/net/net.text.lua
Message-ID: <20090117233941.4FB5A1C1880D@zwischenwelt.org>

Author: ghoulsblade
Date: Sun Jan 18 00:39:41 2009
New Revision: 2880

Log:
small preaos hint fixes

Modified:
    trunk/lua/net/net.text.lua

Modified: trunk/lua/net/net.text.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.text.lua (original)
+++ trunk/lua/net/net.text.lua Sun Jan 18 00:39:41 2009
@@ -47,22 +47,22 @@
 	text =3D MyReplace(text,"Flimsy and not trustworthy"					,"20%") 				=

 	text =3D MyReplace(text,"Falling Apart"								,"10%")
 	=

-	text =3D MyReplace(text,"Is superbly crafted to provide maximum protectio=
n"	,"31+") 	=

-	text =3D MyReplace(text,"Offers excellent protection"							,"26-30")	=

-	text =3D MyReplace(text,"Is a superior defense against attack"				,"21-25=
") 	=

-	text =3D MyReplace(text,"Serves as sturdy protection"							,"16-20") 	=

-	text =3D MyReplace(text,"Offers some protection against blows"				,"11-15=
") 	=

-	text =3D MyReplace(text,"Provides very little protection"						,"6-10") 	=

-	text =3D MyReplace(text,"Provides almost no protection"						,"1-5") 	=

-	text =3D MyReplace(text,"Offers no defense against attackers"					,"0") 		=

-	=

-	text =3D MyReplace(text,"Would be extraordinarily deadly"				,"26+") 	=

-	text =3D MyReplace(text,"Would be a superior weapon"					,"21-25") 	=

-	text =3D MyReplace(text,"Would inflict serious damage and pain"		,"16-20"=
) 	=

-	text =3D MyReplace(text,"Likely hurt opponent a fair amount"			,"11-15") 	=

-	text =3D MyReplace(text,"Would do some damage"						,"6-10") 	=

-	text =3D MyReplace(text,"Would do minimal damage"						,"3-5") 	=

-	text =3D MyReplace(text,"Might scratch their opponent slightly"		,"0-2") 	=

+	text =3D MyReplace(text,"is superbly crafted to provide maximum protectio=
n"	,"8/8:31+") 	=

+	text =3D MyReplace(text,"offers excellent protection"							,"7/8:26-30")	=

+	text =3D MyReplace(text,"is a superior defense against attack"				,"6/8:2=
1-25") 	=

+	text =3D MyReplace(text,"serves as sturdy protection"							,"5/8:16-20")=
 	=

+	text =3D MyReplace(text,"offers some protection against blows"				,"4/8:1=
1-15") 	=

+	text =3D MyReplace(text,"provides very little protection"						,"3/8:6-10=
") 	=

+	text =3D MyReplace(text,"provides almost no protection"						,"2/8:1-5") 	=

+	text =3D MyReplace(text,"offers no defense against attackers"					,"1/8:0=
") 		=

+	=

+	text =3D MyReplace(text,"Would be extraordinarily deadly"				,"7/7:26+") 	=

+	text =3D MyReplace(text,"Would be a superior weapon"					,"6/7:21-25") 	=

+	text =3D MyReplace(text,"Would inflict serious damage and pain"		,"5/7:16=
-20") 	=

+	text =3D MyReplace(text,"Likely hurt opponent a fair amount"			,"4/7:11-1=
5") 	=

+	text =3D MyReplace(text,"Would do some damage"						,"3/7:6-10") 	=

+	text =3D MyReplace(text,"Would do minimal damage"						,"2/7:3-5") 	=

+	text =3D MyReplace(text,"Might scratch their opponent slightly"		,"1/7:0-=
2") 	=

 	=

 	text =3D MyReplace(text,"The keg is empty"								,"0") =

 	text =3D MyReplace(text,"The keg is nearly empty"							,"1-4") =




From no-reply at zwischenwelt.org  Sun Jan 18 14:20:00 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sun, 18 Jan 2009 13:20:00 -0000
Subject: [Iris-commit] [IRIS] r2881 - /trunk/lua/lib.data.lua
Message-ID: <20090118132000.C232C1C1880F@zwischenwelt.org>

Author: sience
Date: Sun Jan 18 14:20:00 2009
New Revision: 2881

Log:
-minor changes to mesh rtt generation

Modified:
    trunk/lua/lib.data.lua

Modified: trunk/lua/lib.data.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.data.lua (original)
+++ trunk/lua/lib.data.lua Sun Jan 18 14:20:00 2009
@@ -111,22 +111,19 @@
 		-- check if RTT generated Art Tiles is enabled and try to generate a RTT=
 Tile out of an *.mesh
 		if (gEnableRTTModelImages) then
 			printdebug("static","try to create RTT from MeshID (static iArtID - 0x4=
000): " .. iArtID - 0x4000)
-			local meshname =3D GetModelName(FilterMesh(iArtID - 0x4000))
-
-			if (OgreMeshAvailable(meshname)) then
+			local meshname =3D GetMeshName(iArtID-0x4000,true)
+
+			if (meshname) then
 				local iMaxW=3D64	--48
 				local iMaxH=3D64	--32
-
-				--local texname,rtt =3D GetMeshPreviewX (meshname, iMaxW, 0, 1.5, PF_A=
8R8G8B8, 1.0, 1.0, 1.0, 0.0)
-				--res.material =3D texname and CloneMaterial("rtt_base")
-				--SetTexture(res.material,texname)
 				=

-				local angh =3D (45)*gfDeg2Rad
-				local angv =3D (-120)*gfDeg2Rad
+				local angh =3D (135)*gfDeg2Rad
+				local angv =3D (-45)*gfDeg2Rad
 				local qw,qx,qy,qz =3D Quaternion.fromAngleAxis(angv,1,0,0)
 				qw,qx,qy,qz =3D Quaternion.Mul(qw,qx,qy,qz,Quaternion.fromAngleAxis(an=
gh,0,0,1))
+				local vCustomScale =3D {-1,1,1}
 				local qCustomRotation =3D {qw,qx,qy,qz}
-				local matname,rtt,name_texture =3D GetMeshPreview(meshname,iMaxW,nil,n=
il,PF_A8R8G8B8,qCustomRotation,{2,2,2}) -- (meshname,res,angh,angv,pixelfor=
mat,qCustomRotation,vCustomScale) =

+				local matname,rtt,name_texture =3D GetMeshPreview(meshname,iMaxW,nil,n=
il,nil,qCustomRotation,vCustomScale) -- (meshname,res,angh,angv,pixelformat)
 				res.material =3D matname and CloneMaterial("rtt_base")
 				SetTexture(res.material,matname)
 =

@@ -285,58 +282,3 @@
 	gTexMapLoader:Load(iTexMapID)
 	return gTexMapLoader:GetSize()
 end
-
------------------------------------------- the following parts are copied =
from lugre and modified, should be merged into lugre ----------------------=
---------------------
--- this is normally in lugre - just a bit modified - should be removed som=
etimes
-function GetMeshPreviewX (meshname, res, angh, angv, pixelformat, r, g, b,=
 a) =

-	res =3D res or 16
-	angh =3D angh or 45*gfDeg2Rad
-	angv =3D angv or 30*gfDeg2Rad
-
- 	local x1,y1,z1,x2,y2,z2 =3D MeshReadOutExactBounds(meshname)
-	local boundrad =3D math.max(Vector.len(x1,y1,z1),Vector.len(x2,y2,z2))
- 	MeshSetBounds(meshname,x1,y1,z1,x2,y2,z2)
- 	MeshSetBoundRad(meshname,boundrad)
-
-	local boundrad =3D MeshGetBoundRad(meshname)
-	=

-	local name_scenemanager		=3D GetUniqueName()
-	local name_texture			=3D GetUniqueName()
-	=

-	-- prepare rtt
-	CreateSceneManager(name_scenemanager)
-	local cam =3D CreateCamera(name_scenemanager)
-	local tex =3D CreateRenderTexture(name_texture,res,res,pixelformat or PF_=
A8R8G8B8)
-
-	if (not tex:IsAlive()) then return end
-	tex:SetAutoUpdated(false)
-
-	local vp =3D CreateRTTViewport(tex,cam)
-	vp:SetOverlaysEnabled(false)
-	vp:SetBackCol(r, g, b, a)
-
-	--local dist =3D GetRenderingDistanceForPixelSize(boundrad,res*0.25,vp,ca=
m)
-	local visrad_pixels =3D res*0.5
-	local vw,vh =3D res,res
-	local dist =3D 1.0 * math.max( boundrad/(visrad_pixels/vw), boundrad/(vis=
rad_pixels/vh) ) -- dirty hack, TODO : analyse projection matrix
-	=

-	Client_AddDirectionalLight(-0.3,-0.5,-0.1,name_scenemanager)
-
-	cam:SetAspectRatio(vp:GetActualWidth()/vp:GetActualHeight())
-	cam:SetNearClipDistance(1)
-	cam:SetFarClipDistance(dist*2 + boundrad)
-	=

-	local gfx =3D CreateRootGfx3D(name_scenemanager)
-	gfx:SetMesh(meshname)
-	gfx:SetPosition(0.5,-1,-dist);
-	gfx:SetCastShadows(false)
-	local qw,qx,qy,qz =3D Quaternion.fromAngleAxis(angv,1,0,0)
-	gfx:SetOrientation(Quaternion.Mul(qw,qx,qy,qz,Quaternion.fromAngleAxis(an=
gh + 180*gfDeg2Rad,0,1,0)))
-	tex:Update()
-	cam:Destroy()
-	vp:Destroy()
-
-	-- TODO : DestroySceneManager(name_scenemanager)
-	return name_texture,tex
-end
------------------------------------------- the former parts are copied fro=
m lugre and modified, should be merged into lugre -------------------------=
------------------



From no-reply at zwischenwelt.org  Mon Jan 19 15:46:41 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Mon, 19 Jan 2009 14:46:41 -0000
Subject: [Iris-commit] [IRIS] r2882 - in
 /trunk/data/models/models/to_003000: mdl_002637.mesh mdl_002639.mesh
Message-ID: <20090119144642.5472B1C1880F@zwischenwelt.org>

Author: hagish
Date: Mon Jan 19 15:46:40 2009
New Revision: 2882

Log:
wrong normals

Modified:
    trunk/data/models/models/to_003000/mdl_002637.mesh
    trunk/data/models/models/to_003000/mdl_002639.mesh

Modified: trunk/data/models/models/to_003000/mdl_002637.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/models/models/to_003000/mdl_002639.mesh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.



From no-reply at zwischenwelt.org  Thu Jan 22 14:54:30 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Thu, 22 Jan 2009 13:54:30 -0000
Subject: [Iris-commit] [IRIS] r2883 - in /trunk:
 lua/filter/filter.granny.lua plugins/lib.spellbar.lua
Message-ID: <20090122135430.BCD011C18812@zwischenwelt.org>

Author: ghoulsblade
Date: Thu Jan 22 14:54:29 2009
New Revision: 2883

Log:
spellbar : disco+peace notifications, dreadhorn fix

Modified:
    trunk/lua/filter/filter.granny.lua
    trunk/plugins/lib.spellbar.lua

Modified: trunk/lua/filter/filter.granny.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/filter/filter.granny.lua (original)
+++ trunk/lua/filter/filter.granny.lua Thu Jan 22 14:54:29 2009
@@ -33,6 +33,7 @@
 --gGrannyFilter[577] =3D {meshname=3D"shield.mesh"}
 =

 --gGrannyFilter[987]	=3D{grannyid=3D400}
+gGrannyFilter[257]	=3D{grannyid=3D0xC8} -- dreadhorn ? replaced by standar=
d horse
 gGrannyFilter[1987]	=3D{grannyid=3D401}
 gGrannyFilter[778]	=3D{grannyid=3D16}
 gGrannyFilter[292]	=3D{grannyid=3D220}

Modified: trunk/plugins/lib.spellbar.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/lib.spellbar.lua (original)
+++ trunk/plugins/lib.spellbar.lua Thu Jan 22 14:54:29 2009
@@ -175,6 +175,7 @@
 =

 =

 =

+
 for k,v in pairs(gSpellbarShortMessages) do if (v.bInterrupt) then gSpellI=
nterruptMessages[k] =3D true end end
 =

 -- weapon specials
@@ -222,6 +223,15 @@
 gSpellbarShortMessages[1007077]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"6:golden"	=
		} -- You dig some golden ore and put it in your backpack.
 gSpellbarShortMessages[1007078]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"7:agapite"=
		} -- You dig some agapite ore and put it in your backpack.
 gSpellbarShortMessages[1007080]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"9:valorite=
"		} -- You dig some valorite ore and put it in your backpack.
+
+gSpellbarShortMessages[1049527]	=3D {r=3D1,g=3D0.5,b=3D0.0,txt=3D"peace:al=
ready"	} -- That creature is already being calmed.
+gSpellbarShortMessages[1049537]	=3D {r=3D1,g=3D0.5,b=3D0.0,txt=3D"disco:al=
ready"	} -- That creature is already in discord.
+gSpellbarShortMessages[500612]	=3D {r=3D1,g=3D1,b=3D0.0,txt=3D"musi:fail"	=
	} -- You play poorly, and there is no effect. =

+gSpellbarShortMessages[1049540]	=3D {r=3D1,g=3D1,b=3D0.0,txt=3D"disco:fail=
"		} -- You attempt to disrupt your target, but fail.
+gSpellbarShortMessages[1049539]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"disco:succ=
ess"	} -- You play jarring music, suppressing your target's strength.
+gSpellbarShortMessages[1049532]	=3D {r=3D0,g=3D1,b=3D0.0,txt=3D"peace:succ=
ess"	} -- You play hypnotic music, calming your target.
+-- todo : peace fail
+
 =

 =

 =




From no-reply at zwischenwelt.org  Fri Jan 23 02:04:47 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 23 Jan 2009 01:04:47 -0000
Subject: [Iris-commit] [IRIS] r2884 - in /trunk: bin/OgreMain.dll
 bin/Plugin_CgProgramManager.dll bin/Plugin_ParticleFX.dll
 bin/RenderSystem_Direct3D9.dll bin/RenderSystem_GL.dll bin/iris2.exe
 cb/iris2.cbp vc8/iris_luajit.vcproj
Message-ID: <20090123010447.5DD301C18810@zwischenwelt.org>

Author: sience
Date: Fri Jan 23 02:04:45 2009
New Revision: 2884

Log:
-new win32
-updated to Ogre 1.61 (shadow jitter fixes)
-projects updated
-caleum Skysystem updated

Modified:
    trunk/bin/OgreMain.dll
    trunk/bin/Plugin_CgProgramManager.dll
    trunk/bin/Plugin_ParticleFX.dll
    trunk/bin/RenderSystem_Direct3D9.dll
    trunk/bin/RenderSystem_GL.dll
    trunk/bin/iris2.exe
    trunk/cb/iris2.cbp
    trunk/vc8/iris_luajit.vcproj

Modified: trunk/bin/OgreMain.dll
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/bin/Plugin_CgProgramManager.dll
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/bin/Plugin_ParticleFX.dll
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/bin/RenderSystem_Direct3D9.dll
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/bin/RenderSystem_GL.dll
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/cb/iris2.cbp
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/cb/iris2.cbp (original)
+++ trunk/cb/iris2.cbp Fri Jan 23 02:04:45 2009
@@ -88,7 +88,8 @@
 			<Add directory=3D"..\include\fmodx" />
 			<Add directory=3D"..\include\zlib" />
 			<Add directory=3D"..\lugre\include" />
-			<Add directory=3D"..\lugre\lib\lua-5.1.3\src" />
+			<Add directory=3D"..\lugre\lib\LuaJIT-1.1.5\src" />
+			<Add directory=3D"..\lugre\lib\LuaJIT-1.1.5\dynasm" />
 			<Add directory=3D"..\lugre\lib\md5\include" />
 		</Compiler>
 		<Linker>
@@ -158,6 +159,7 @@
 		<Unit filename=3D"..\lugre\include\lugre_input.h" />
 		<Unit filename=3D"..\lugre\include\lugre_listener.h" />
 		<Unit filename=3D"..\lugre\include\lugre_luabind.h" />
+		<Unit filename=3D"..\lugre\include\lugre_luacallback.h" />
 		<Unit filename=3D"..\lugre\include\lugre_luaxml.h" />
 		<Unit filename=3D"..\lugre\include\lugre_main.h" />
 		<Unit filename=3D"..\lugre\include\lugre_md5.h" />
@@ -169,6 +171,7 @@
 		<Unit filename=3D"..\lugre\include\lugre_ogrefonthelper.h" />
 		<Unit filename=3D"..\lugre\include\lugre_ogrewrapper.h" />
 		<Unit filename=3D"..\lugre\include\lugre_paged_geometry.h" />
+		<Unit filename=3D"..\lugre\include\lugre_platform.h" />
 		<Unit filename=3D"..\lugre\include\lugre_prefix.h" />
 		<Unit filename=3D"..\lugre\include\lugre_profile.h" />
 		<Unit filename=3D"..\lugre\include\lugre_random.h" />
@@ -187,117 +190,147 @@
 		<Unit filename=3D"..\lugre\include\lugre_widget.h" />
 		<Unit filename=3D"..\lugre\include\tinystr.h" />
 		<Unit filename=3D"..\lugre\include\tinyxml.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lapi.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lapi.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lauxlib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lauxlib.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lbaselib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lcode.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lcode.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ldblib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ldebug.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ldebug.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ldo.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ldo.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ldump.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lfunc.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lfunc.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lgc.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lgc.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\linit.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\liolib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\llex.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\llex.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\llimits.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lmathlib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lmem.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lmem.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\loadlib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lobject.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lobject.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lopcodes.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lopcodes.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\loslib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lparser.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lparser.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lstate.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lstate.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lstring.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lstring.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lstrlib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ltable.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ltable.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ltablib.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ltm.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\ltm.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lua.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\luaconf.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lualib.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lundump.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lundump.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lvm.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lvm.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lzio.c">
-			<Option compilerVar=3D"CC" />
-		</Unit>
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\lzio.h" />
-		<Unit filename=3D"..\lugre\lib\lua-5.1.3\src\print.c">
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lapi.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lapi.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lauxlib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lauxlib.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lbaselib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lcoco.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lcoco.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lcode.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lcode.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ldblib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ldebug.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ldebug.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ldo.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ldo.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ldump.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lfunc.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lfunc.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lgc.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lgc.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\linit.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\liolib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_backend.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_core.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_dasm.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_dasm.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_hints.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_mem.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljit_x86.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ljitlib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\llex.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\llex.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\llimits.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lmathlib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lmem.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lmem.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\loadlib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lobject.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lobject.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lopcodes.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lopcodes.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\loslib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lparser.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lparser.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lstate.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lstate.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lstring.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lstring.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lstrlib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ltable.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ltable.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ltablib.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ltm.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\ltm.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lua.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lua.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\luac.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\luaconf.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\luajit.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lualib.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lundump.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lundump.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lvm.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lvm.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lzio.c">
+			<Option compilerVar=3D"CC" />
+		</Unit>
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\lzio.h" />
+		<Unit filename=3D"..\lugre\lib\LuaJIT-1.1.5\src\print.c">
 			<Option compilerVar=3D"CC" />
 		</Unit>
 		<Unit filename=3D"..\lugre\lib\md5\include\md5.h" />
@@ -317,6 +350,7 @@
 		<Unit filename=3D"..\lugre\src\lugre_cadune_L.cpp" />
 		<Unit filename=3D"..\lugre\src\lugre_caelum_L.cpp" />
 		<Unit filename=3D"..\lugre\src\lugre_camera_L.cpp" />
+		<Unit filename=3D"..\lugre\src\lugre_commondialog.cpp" />
 		<Unit filename=3D"..\lugre\src\lugre_fastbatch.cpp" />
 		<Unit filename=3D"..\lugre\src\lugre_fifo_L.cpp" />
 		<Unit filename=3D"..\lugre\src\lugre_game.cpp" />

Modified: trunk/vc8/iris_luajit.vcproj
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/vc8/iris_luajit.vcproj (original)
+++ trunk/vc8/iris_luajit.vcproj Fri Jan 23 02:04:45 2009
@@ -1038,10 +1038,22 @@
 						>
 					</File>
 					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\CaelumDefaultTypeDescriptorD=
ata.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\CaelumPlugin.cpp"
+						>
+					</File>
+					<File
 						RelativePath=3D"..\lugre\lib\caelum\src\CaelumPrecompiled.cpp"
 						>
 					</File>
 					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\CaelumScriptTranslator.cpp"
+						>
+					</File>
+					<File
 						RelativePath=3D"..\lugre\lib\caelum\src\CaelumSystem.cpp"
 						>
 					</File>
@@ -1099,6 +1111,10 @@
 					</File>
 					<File
 						RelativePath=3D"..\lugre\lib\caelum\src\Sun.cpp"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\src\TypeDescriptor.cpp"
 						>
 					</File>
 					<File
@@ -1122,6 +1138,10 @@
 						>
 					</File>
 					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumPlugin.h"
+						>
+					</File>
+					<File
 						RelativePath=3D"..\lugre\lib\caelum\include\CaelumPrecompiled.h"
 						>
 					</File>
@@ -1130,6 +1150,10 @@
 						>
 					</File>
 					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\CaelumScriptTranslator.h"
+						>
+					</File>
+					<File
 						RelativePath=3D"..\lugre\lib\caelum\include\CaelumSystem.h"
 						>
 					</File>
@@ -1170,6 +1194,10 @@
 						>
 					</File>
 					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\OwnedPtr.h"
+						>
+					</File>
+					<File
 						RelativePath=3D"..\lugre\lib\caelum\include\PointStarfield.h"
 						>
 					</File>
@@ -1187,6 +1215,10 @@
 					</File>
 					<File
 						RelativePath=3D"..\lugre\lib\caelum\include\Sun.h"
+						>
+					</File>
+					<File
+						RelativePath=3D"..\lugre\lib\caelum\include\TypeDescriptor.h"
 						>
 					</File>
 					<File



From no-reply at zwischenwelt.org  Fri Jan 23 02:08:01 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Fri, 23 Jan 2009 01:08:01 -0000
Subject: [Iris-commit] [IRIS] r2885 - /trunk/data/profiles/gfx_high.lua
Message-ID: <20090123010801.6A7E71C18810@zwischenwelt.org>

Author: sience
Date: Fri Jan 23 02:08:01 2009
New Revision: 2885

Log:
-small fix

Modified:
    trunk/data/profiles/gfx_high.lua

Modified: trunk/data/profiles/gfx_high.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/profiles/gfx_high.lua (original)
+++ trunk/data/profiles/gfx_high.lua Fri Jan 23 02:08:01 2009
@@ -1,6 +1,6 @@
 -- high gfx-profile has medium settings with fixed function shadow techniq=
ue
 =

-gConfig:Set("gAtlasRes","high")
+gConfig:Set("gAtlasRes","med")
 =

 gConfig:Set("gShadowTechnique","texture_additive")
 gConfig:Set("gStaticsCastShadows",true)



From no-reply at zwischenwelt.org  Sat Jan 24 15:13:11 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 24 Jan 2009 14:13:11 -0000
Subject: [Iris-commit] [IRIS] r2886 - in /trunk/lua: lib.3d.light.lua
	lib.3d.renderer.lua
Message-ID: <20090124141311.A8D561C18847@zwischenwelt.org>

Author: hagish
Date: Sat Jan 24 15:13:11 2009
New Revision: 2886

Log:
increased non caelum sun brightness

Modified:
    trunk/lua/lib.3d.light.lua
    trunk/lua/lib.3d.renderer.lua

Modified: trunk/lua/lib.3d.light.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.light.lua (original)
+++ trunk/lua/lib.3d.light.lua Sat Jan 24 15:13:11 2009
@@ -1,6 +1,6 @@
 =

 gMergePointLights =3D true
-gMergePointLightBlockSize =3D 64
+gMergePointLightBlockSize =3D 32
 gLightBlocks =3D {}
 -- returns the block for the given x,y,z location
 function GetMergePointLightBlock(x,y,z)
@@ -34,12 +34,14 @@
 	=

 	if c =3D=3D 0 and self.mLightName then
 		-- destroy
+		--~ print("REMOVE LIGHT",self)
 		Client_RemoveLight(self.mLightName)
 		self.mLightName =3D nil
 	end
 	=

 	if c > 0 and not self.mLightName then
 		-- create
+		--~ print("ADD LIGHT",self)
 		self.mLightName =3D Client_AddPointLight(0,0,0, 1,1,1, 1,1,1, 1.0,0.5,0.=
5,0.0)
 	end
 	=

@@ -51,6 +53,7 @@
 		Client_SetLightSpecularColor(self.mLightName, p,p,p)
 		=

 		if self.mDirty then
+			--~ print("UPDATE LIGHT",self,self.mLightName,c,p)
 			-- recalc
 			for k,v in pairs(self.mlLight) do
 				minx =3D minx and math.min(minx,v.x) or v.x
@@ -65,7 +68,7 @@
 			self.mCY =3D (maxy + miny) / 2
 			self.mCZ =3D (maxz + minz) / 2
 			self.mR =3D math.max(maxx-minx,maxy-miny,maxz-minz)
-			--~ print("cPointLightBlock:UpdateLight",self.mCX,self.mCY,self.mCZ,sel=
f.mR,c)
+			--~ print("cPointLightBlock:UpdateLight",self.mLightName,self.mCX,self.=
mCY,self.mCZ,self.mR,c)
 			Client_SetLightPosition(self.mLightName, self.mCX, self.mCY, self.mCZ)	=

 			Client_SetLightAttenuation(self.mLightName, Renderer3D.CalculatePointLi=
ghtAttenuation(self.mR))
 			Light_SetCastShadows(self.mLightName, gLightsCastShadows)

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sat Jan 24 15:13:11 2009
@@ -316,8 +316,10 @@
 function Renderer3D.CalculatePointLightAttenuation (radius)
 	local r =3D radius
 	local c =3D 1
-	local l =3D 2/radius
+	local l
+	if r =3D=3D 0 then l =3D 0 else l =3D 2/radius end
 	local q =3D 0.0025
+	--~ print("ATT",r*4, c, l, q)
 	return r*4, c, l, q
 end
 =

@@ -393,6 +395,7 @@
 -- Specular sr,sg,sb
 -- Attenuation ar,ag,ab,aa
 function Renderer3D:AddPointLight	(x,y,z, dr,dg,db, sr,sg,sb, ar,ag,ab,aa)
+	--~ print("AddPointLight",x,y,z, dr,dg,db, sr,sg,sb, ar,ag,ab,aa)
 	local name
 	if gMergePointLights then
 		name =3D x.."_"..y.."_"..z
@@ -785,7 +788,7 @@
 =

 	--~ print("LIGHT1","a",a,"p",p)
 	-- calc light values
-	a =3D Clamp(a,0,1) * 0.6
+	a =3D Clamp(a,0,1)
 	p =3D self:CalcPointLightValueDependingOnSun(p)
 	--~ print("LIGHT2","a",a,"p",p)
 =




From no-reply at zwischenwelt.org  Sat Jan 24 15:40:10 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 24 Jan 2009 14:40:10 -0000
Subject: [Iris-commit] [IRIS] r2887 - in /trunk/lua: config_declarations.lua
	net/net.world.lua
Message-ID: <20090124144010.264D11C18847@zwischenwelt.org>

Author: sience
Date: Sat Jan 24 15:40:09 2009
New Revision: 2887

Log:
-ambientlight decreased to 0.8->0.4

Modified:
    trunk/lua/config_declarations.lua
    trunk/lua/net/net.world.lua

Modified: trunk/lua/config_declarations.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/config_declarations.lua (original)
+++ trunk/lua/config_declarations.lua Sat Jan 24 15:40:09 2009
@@ -126,7 +126,7 @@
 gSunLightSpecular =3D {r=3D1.0,g=3D1.0,b=3D1.0}
 =

 -- Ambient Light
-gAmbientLight =3D {r=3D0.8,g=3D0.8,b=3D0.8}
+gAmbientLight =3D {r=3D0.4,g=3D0.4,b=3D0.4}
 =

 -- Soundeffects & Music
 -- gUseSoundSystem =3D "openal"

Modified: trunk/lua/net/net.world.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.world.lua (original)
+++ trunk/lua/net/net.world.lua Sat Jan 24 15:40:09 2009
@@ -25,7 +25,7 @@
 	local id =3D input:PopNetUint8()
 	local creature_id =3D input:PopNetUint32()
 	local creature_light =3D input:PopNetUint8()
-	printdebug("net",sprintf("NET (todo): Light_Change id: %i creature_id: %i=
 creature_light: %i\n",id,creature_id,creature_light))
+	printdebug("net",sprintf("NET: Light_Change id: %i creature_id: %i creatu=
re_light: %i\n",id,creature_id,creature_light))
 	=

 	local f =3D gIgnoreGlobalLightLevel and 1 or (creature_light/0x1F)
 	=

@@ -45,7 +45,7 @@
 	local input =3D GetRecvFIFO()
 	local id =3D input:PopNetUint8()
 	local sunlight =3D input:PopNetUint8()
-	printdebug("net",sprintf("NET (todo): Sunlight id: %i sunlight: %i\n",id,=
sunlight))
+	printdebug("net",sprintf("NET: Sunlight id: %i sunlight: %i\n",id,sunligh=
t))
 =

 	local f =3D gIgnoreGlobalLightLevel and 1 or (1 - (sunlight/0x1F))
 =




From no-reply at zwischenwelt.org  Sat Jan 24 17:22:08 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 24 Jan 2009 16:22:08 -0000
Subject: [Iris-commit] [IRIS] r2888 - /branches/stable_release/
Message-ID: <20090124162208.6D9C21C18847@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 24 17:22:07 2009
New Revision: 2888

Log:
removing stable for trunk -> stable update

Removed:
    branches/stable_release/



From no-reply at zwischenwelt.org  Sat Jan 24 17:22:08 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 24 Jan 2009 16:22:08 -0000
Subject: [Iris-commit] [IRIS] r2889 - /branches/stable_release/
Message-ID: <20090124162208.D775D1C18849@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 24 17:22:08 2009
New Revision: 2889

Log:
copying trunk to stable

Added:
    branches/stable_release/
      - copied from r2888, trunk/



From no-reply at zwischenwelt.org  Sat Jan 24 17:22:09 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 24 Jan 2009 16:22:09 -0000
Subject: [Iris-commit] [IRIS] r2890 - /branches/stable_release/
Message-ID: <20090124162209.684C51C1884B@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 24 17:22:09 2009
New Revision: 2890

Log:
lugre -r673 svn://zwischenwelt.org/lugre/trunk/lugre

Modified:
    branches/stable_release/   (props changed)



From no-reply at zwischenwelt.org  Tue Jan 27 02:03:46 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Tue, 27 Jan 2009 01:03:46 -0000
Subject: [Iris-commit] [IRIS] r2891 - in /trunk: lua/net/net.partysystem.lua
	plugins/moblist.lua
Message-ID: <20090127010346.40EA51C18846@zwischenwelt.org>

Author: ghoulsblade
Date: Tue Jan 27 02:03:44 2009
New Revision: 2891

Log:
moblist : fixed party member display (green mark, even for red players), an=
d updating

Modified:
    trunk/lua/net/net.partysystem.lua
    trunk/plugins/moblist.lua

Modified: trunk/lua/net/net.partysystem.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/net/net.partysystem.lua (original)
+++ trunk/lua/net/net.partysystem.lua Tue Jan 27 02:03:44 2009
@@ -43,7 +43,13 @@
 function PartySystem_UpdateMemberList (memberlist)
 	gPartySystemMemberList =3D memberlist
 	gPartySystemMemberListByID =3D {}
-	for k,serial in pairs(gPartySystemMemberList) do AosToolTip_GetText(seria=
l) Send_SingleClick(serial) gPartySystemMemberListByID[serial] =3D true end
+	print("PartySystem_UpdateMemberList")
+	for k,serial in pairs(gPartySystemMemberList) do =

+		--~ print(" ",k,serial,AosToolTip_GetText(serial) )
+		AosToolTip_GetText(serial) =

+		Send_SingleClick(serial) =

+		gPartySystemMemberListByID[serial] =3D true =

+	end
 	PartyListDialog_Rebuild()
 	NotifyListener("Hook_UpdatePartyMemberList")
 end

Modified: trunk/plugins/moblist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/plugins/moblist.lua (original)
+++ trunk/plugins/moblist.lua Tue Jan 27 02:03:44 2009
@@ -47,7 +47,7 @@
 	RegisterListener("Hook_LabelUpdate",			function (serial)	self:ToolTipUpda=
te(serial) self:UpdatePartyNameTooltip(serial) end)
 	RegisterListener("Hook_Object_CreateMobile",	function (mobile)	self:AddMo=
b(mobile) end)
 	RegisterListener("Hook_Object_DestroyMobile",	function (mobile)	self:Remo=
veMob(mobile) end)
-	RegisterListener("Hook_UpdatePartyMemberList",	function ()			self:RecalcC=
at() self:UpdatePartyMemberList() end)
+	RegisterListener("Hook_UpdatePartyMemberList",	function ()			print("mobli=
st:Hook_UpdatePartyMemberList") self:RecalcCat() self:UpdatePartyMemberList=
() self:UpdateAllNameGfx() end)
 	RegisterListener("Hook_UOAM_PosUpdate",			function () 		self:UOAMUpdate()=
 end)
 end
 =

@@ -210,6 +210,10 @@
 	end
 end
 =

+function gWidgetPrototype.UOMobList:UpdateAllNameGfx ()
+	for item,v in pairs(self.items) do item:UpdateNameGfx() end
+end
+
 function gWidgetPrototype.UOMobList:Step ()
 	if (self.bNeedsReGroup) then
 		self.bNeedsReGroup =3D false
@@ -348,15 +352,18 @@
 =

 function gWidgetPrototype.UOMobListItem:UpdateNameGfx()
 	local mobile =3D self.mobile
+	local serial =3D self.serial
 	local r,g,b =3D GetNotorietyColor(mobile.notoriety)
-	local labelhue =3D GetItemLabelHue(mobile.serial)
+	local labelhue =3D GetItemLabelHue(serial)
 	if (labelhue =3D=3D kPlayerVendorLabelHue) then r,g,b =3D 0,1,1 end
 	self.text.params.col =3D {r=3Dr,g=3Dg,b=3Db}
 	local text =3D self.old_text
+	--~ print("moblist:UpdateNameGfx",serial,IsMobileInParty(serial),text)
 	if (labelhue) then =

 		local r,g,b =3D GetHueColor(labelhue-1)
 		text =3D sprintf("<BASEFONT COLOR=3D#%02X%02X%02X>",floor(r*255),floor(g=
*255),floor(b*255)).."+".."</BASEFONT>"..text
 	end
+	if (IsMobileInParty(serial)) then text =3D "<BASEFONT COLOR=3D#00FF00>#</=
BASEFONT>"..text end
 	self.text:SetUOHtml(text,true) -- .." "..self.cat
 end
 =

@@ -393,6 +400,7 @@
 	local notoriety =3D mobile.notoriety
 	--~ kNotoriety_Friend =3D 2 -- friend (necro familiar,pets)
 	--~ kNotoriety_Red =3D 6 -- murderer (summons,evortex)
+	--~ print("moblist:RecalcCat",serial,"party:",IsMobileInParty(serial),sel=
f.old_text)
 	if (self.bNameUnknown) then 								return self:SetCat(kMobListCat_Rest) =
end
 	if (GetPlayerSerial() =3D=3D serial) then						return self:SetCat(kMobLis=
tCat_Self) end
 	if (IsMobileInParty(serial) or self.bIsFriendlyGuild) then	return self:Se=
tCat(kMobListCat_Friends) end



From no-reply at zwischenwelt.org  Sat Jan 31 19:11:56 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 31 Jan 2009 18:11:56 -0000
Subject: [Iris-commit] [IRIS] r2892 - /trunk/premakelinux.sh
Message-ID: <20090131181156.EE5CD1C1884E@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 31 19:11:55 2009
New Revision: 2892

Log:
premakelinux.sh : added clean to avoid confusion for endusers on linux, dev=
s should use premakelinux_noclean.sh

Modified:
    trunk/premakelinux.sh

Modified: trunk/premakelinux.sh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/premakelinux.sh (original)
+++ trunk/premakelinux.sh Sat Jan 31 19:11:55 2009
@@ -1,5 +1,5 @@
 #!/bin/bash
-#./premake --clean
+./premake --clean
 ./premake --useluajit --noassert --target gnu && make CXX=3D"ccache gcc" C=
ONFIG=3DRelease
 #~ ./premake --target gnu && make CONFIG=3DRelease
 # tipp : try "make -j 2" : start 2 jobs in parallel, to avoid wait-for-io =
and use multi-cpu processors efficiently during compile



From no-reply at zwischenwelt.org  Sat Jan 31 19:24:16 2009
From: no-reply at zwischenwelt.org (no-reply at zwischenwelt.org)
Date: Sat, 31 Jan 2009 18:24:16 -0000
Subject: [Iris-commit] [IRIS] r2893 - /trunk/premake.lua
Message-ID: <20090131182416.1EBA41C1884E@zwischenwelt.org>

Author: ghoulsblade
Date: Sat Jan 31 19:24:15 2009
New Revision: 2893

Log:
bugfix in premake.lua : setting options to false resulted in all options af=
ter them being disabled as well, due to the behavior of ipairs iterator whe=
n encountering a nil entry

Modified:
    trunk/premake.lua

Modified: trunk/premake.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/premake.lua (original)
+++ trunk/premake.lua Sat Jan 31 19:24:15 2009
@@ -24,6 +24,15 @@
 -- ------------------------------------------------------------------
 -- ------------------------------------------------------------------
 =

+-- removes the nil entries from tables like {nil,nil,a,b,c}, that were cre=
ated using (bBlaEnabled and "Bla" or nil)
+function RemoveNilsFromArray (arr) =

+	local res =3D {}
+	for k,v in pairs(arr) do -- pairs lists all non-nil entries, whereas ipai=
rs only lists the first n numerical ones until a nil is encountered
+		table.insert(res,v) =

+	end
+	return res
+end
+
 -- build options
 addoption("wall","very verbose report, most warnings enabled")
 addoption("nooptimize","don't use optmize compile flags")
@@ -84,7 +93,7 @@
 =

 -- lugre dependencies, ie. ogre
 function AddLugreDeps(package)
-	package.defines =3D { =

+	package.defines =3D RemoveNilsFromArray({ =

 		gbUseSoundOpenAl and "USE_OPENAL" or nil,
 		gbUseSoundFmod and "USE_FMOD" or nil,
 		"MAIN_WORKING_DIR=3D\\\"..\\\"",
@@ -95,7 +104,7 @@
 		gbDisableProfiling and "DISABLE_PROFILING" or nil,
 		gbDisableAssert and "NDEBUG" or nil,
 		"LUA_USE_POSIX", -- execute shellcommands
-	}	=

+	})
 =

 	addpkgconfiglib(package, "OGRE")
 	if gbUseSystemOis then addpkgconfiglib(package, "OIS") end
@@ -144,10 +153,10 @@
 =

 function AddLugreLibDeps(package)
 	addpkgconfiglib(package, "OGRE")
-	package.defines =3D { =

+	package.defines =3D RemoveNilsFromArray({ =

 		gbDisableProfiling and "DISABLE_PROFILING" or nil,
 		gbDisableAssert and "NDEBUG" or nil,
-	}	=

+	})
 end
 =

 -- add libs the linux way
@@ -217,13 +226,13 @@
 package.name =3D "lugrelua"
 package.kind =3D "lib"
 package.language =3D "c++"
-package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbOp=
timize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil }
+package.buildflags =3D RemoveNilsFromArray({ gbExtraWarnings and "extra-wa=
rnings" or nil, gbOptimize and "optimize" or nil, gbNo64BitChecks and "no-6=
4bit-checks" or nil })
 package.buildoptions =3D {}
 package.includepaths =3D { gLugreLuaSrcDir.."/src", gLugreLuaSrcDir.."/dyn=
asm" } -- dynasm is used for luajit
-package.defines =3D { =

+package.defines =3D RemoveNilsFromArray({ =

 	"LUA_USE_POSIX", -- execute shellcommands
 	gbDisableAssert and "NDEBUG" or nil,
-}	=

+})
 package.files =3D {
   matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c", gLu=
greLuaSrcDir.."/dynasm/*.h"),	-- dynasm is used for luajit
 }
@@ -239,13 +248,13 @@
 	package.name =3D "lugreois"
 	package.kind =3D "lib"
 	package.language =3D "c++"
-	package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbO=
ptimize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil=
 }
+	package.buildflags =3D RemoveNilsFromArray({ gbExtraWarnings and "extra-w=
arnings" or nil, gbOptimize and "optimize" or nil, gbNo64BitChecks and "no-=
64bit-checks" or nil })
 	package.buildoptions =3D {}
 	package.includepaths =3D { unpack(glOisIncludeList) }
-	package.defines =3D { =

+	package.defines =3D RemoveNilsFromArray({ =

 		"LUA_USE_POSIX", -- execute shellcommands
 		gbDisableAssert and "NDEBUG" or nil,
-	}	=

+	})
 	package.files =3D {
 	  matchfiles(gLugreOisDir.."/src/*.h", gLugreOisDir.."/src/*.cpp"),
 	  matchfiles(gLugreOisDir.."/src/"..gOisPlatform.."/*.h", gLugreOisDir.."=
/src/"..gOisPlatform.."/*.cpp"),
@@ -263,9 +272,9 @@
 	package.name =3D v.."lib"
 	package.kind =3D "lib"
 	package.language =3D "c++"
-	package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbO=
ptimize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil=
 }
+	package.buildflags =3D RemoveNilsFromArray({ gbExtraWarnings and "extra-w=
arnings" or nil, gbOptimize and "optimize" or nil, gbNo64BitChecks and "no-=
64bit-checks" or nil })
 	package.buildoptions =3D {}
-	package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/=
", gLugreLuaSrcDir.."/dynasm", "include", glOisIncludeList and unpack(glOis=
IncludeList) or nil } -- dynasm is used for luajit =

+	package.includepaths =3D RemoveNilsFromArray({ gLugreDir.."/include", gLu=
greLuaSrcDir.."/src/", gLugreLuaSrcDir.."/dynasm", "include", glOisIncludeL=
ist and unpack(glOisIncludeList) or nil }) -- dynasm is used for luajit =

 	package.files =3D {
 		matchfiles(gLugreLuaSrcDir.."/src/*.h", gLugreLuaSrcDir.."/src/*.c", gLu=
greLuaSrcDir.."/dynasm/*.h"), -- dynasm is used for luajit =

 	}
@@ -285,9 +294,9 @@
 package.kind =3D "lib"
 package.language =3D "c++"
 package.links =3D {  }
-package.buildflags =3D { bExtraWarnings and "extra-warnings" or nil, gbOpt=
imize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil }
+package.buildflags =3D RemoveNilsFromArray({ bExtraWarnings and "extra-war=
nings" or nil, gbOptimize and "optimize" or nil, gbNo64BitChecks and "no-64=
bit-checks" or nil })
 package.buildoptions =3D {}
-package.includepaths =3D { gLugreLuaSrcDir.."/src", gLugreLuaSrcDir.."/dyn=
asm/*.h", gLugreDir.."/include", glOisIncludeList and unpack(glOisIncludeLi=
st) or nil } -- dynasm is used for luajit
+package.includepaths =3D RemoveNilsFromArray({ gLugreLuaSrcDir.."/src", gL=
ugreLuaSrcDir.."/dynasm/*.h", gLugreDir.."/include", glOisIncludeList and u=
npack(glOisIncludeList) or nil }) -- dynasm is used for luajit
 package.files =3D {
   matchrecursive(gLugreDir.."/include/*.h", gLugreDir.."/src/*.cpp"),
 }
@@ -302,7 +311,7 @@
 package.kind =3D "exe"
 package.language =3D "c++"
 package.bindir =3D "bin"
-package.buildflags =3D { gbExtraWarnings and "extra-warnings" or nil, gbOp=
timize and "optimize" or nil, gbNo64BitChecks and "no-64bit-checks" or nil }
+package.buildflags =3D RemoveNilsFromArray({ gbExtraWarnings and "extra-wa=
rnings" or nil, gbOptimize and "optimize" or nil, gbNo64BitChecks and "no-6=
4bit-checks" or nil })
 package.buildoptions =3D {}
 =

 package.includepaths =3D { gLugreDir.."/include", gLugreLuaSrcDir.."/src/"=
,gLugreLuaSrcDir.."/dynasm", "include" } -- dynasm is used for luajit
@@ -312,7 +321,7 @@
 end
 =

 package.linkoptions =3D {}
-package.links =3D { "lugrelib", "lugrelua", not gbUseSystemOis and "lugreo=
is" or nil  }
+package.links =3D RemoveNilsFromArray({ "lugrelib", "lugrelua", not gbUseS=
ystemOis and "lugreois" or nil  })
 AddLugreDeps(package)
 =

 package.files =3D {



