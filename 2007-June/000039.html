<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r1223 - in /trunk: bin/ data/ data/lua/ data/terrain/materials/ data/terrain/textures/
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2007-June/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1223%20-%20in%20/trunk%3A%20bin/%20data/%20data/lua/%0A%20data/terrain/materials/%20data/terrain/textures/&In-Reply-To=%3C20070620230952.23065B1466D%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000038.html">
   <LINK REL="Next"  HREF="000040.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r1223 - in /trunk: bin/ data/ data/lua/ data/terrain/materials/ data/terrain/textures/</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1223%20-%20in%20/trunk%3A%20bin/%20data/%20data/lua/%0A%20data/terrain/materials/%20data/terrain/textures/&In-Reply-To=%3C20070620230952.23065B1466D%40localhost.localdomain%3E"
       TITLE="[Iris-commit] [IRIS] r1223 - in /trunk: bin/ data/ data/lua/ data/terrain/materials/ data/terrain/textures/">no-reply at zwischenwelt.org
       </A><BR>
    <I>Thu Jun 21 01:09:51 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000038.html">[Iris-commit] [IRIS] r1222 - /trunk/bin/iris2.exe
</A></li>
        <LI>Next message: <A HREF="000040.html">[Iris-commit] [IRIS] r1224 - /trunk/src/scripting.cpp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39">[ date ]</a>
              <a href="thread.html#39">[ thread ]</a>
              <a href="subject.html#39">[ subject ]</a>
              <a href="author.html#39">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sience
Date: Thu Jun 21 01:09:50 2007
New Revision: 1223

Log:
-directx redist file deleted ...eula
-new binary
-checks added
-sand+cobblestone added for terrainshaders
-particle option added to config.lua.dist

Added:
    trunk/data/terrain/textures/Sand_large_pattern_512.dds   (with props)
    trunk/data/terrain/textures/cobblestone_large_pattern_512.dds   (with p=
rops)
Removed:
    trunk/bin/d3dx9_33.dll
Modified:
    trunk/bin/iris2.exe
    trunk/data/config.lua.dist
    trunk/data/lua/lib.gumpparser.lua
    trunk/data/lua/lib.walking2.lua
    trunk/data/lua/main.lua
    trunk/data/lua/net.objects.lua
    trunk/data/skippedfallbacks.lua
    trunk/data/terrain/materials/terrain.material

Modified: trunk/bin/iris2.exe
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
Binary files - no diff available.

Modified: trunk/data/config.lua.dist
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/config.lua.dist (original)
+++ trunk/data/config.lua.dist Thu Jun 21 01:09:50 2007
@@ -233,5 +233,8 @@
 -- activate Shader 2.0 for Terrainengine (true/false)
 gTerrainShader =3D false
 =

+-- huedfx
+gParticleEffects =3D true
+
 gDisableSmoothWalk =3D false
 gDisableHumanClientSideAnim =3D false

Modified: trunk/data/lua/lib.gumpparser.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/lua/lib.gumpparser.lua (original)
+++ trunk/data/lua/lib.gumpparser.lua Thu Jun 21 01:09:50 2007
@@ -189,10 +189,7 @@
 					local huenumber=3DbToken[6] or 0
 					local widget =3D MakeBorderGumpPart( curparent, bToken[4], bToken[2],=
 bToken[3], 0, 0, 0, tonumber(huenumber) )
 					widget.mbIgnoreMouseOver =3D false
-					if (bToken[8]) then
-						print(&quot;gumppic class=3D&quot;..bToken[8])
-						--B1, 0F 00 gPlayerBodySerial, 00 00 01 CD, 00 00 00 70
-					end
+					if (bToken[8]) then print(&quot;gumppic class=3D&quot;..bToken[8]) end
 				--gumppictiled &lt;x&gt; &lt;y&gt; &lt;width&gt; &lt;height&gt; &lt;gumpid&gt;
 				--Description:  Similar to GumpPic, but the gumppic is tiled to the gi=
ven &lt;height&gt; and &lt;width&gt;.
 				elseif ((command =3D=3D &quot;gumppictiled&quot;) and (table.getn(bToken)&gt;=3D 6)=
) then

Modified: trunk/data/lua/lib.walking2.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/lua/lib.walking2.lua (original)
+++ trunk/data/lua/lib.walking2.lua Thu Jun 21 01:09:50 2007
@@ -1,10 +1,10 @@
 -- Walking Implementation for PC
 -- thx for helping to Arahil
 =

-gDebugWalkingDetailed =3D true =

+gDebugWalkingDetailed =3D true =

 =

 function printwalkdebug (...) if (gDebugWalkingDetailed) then printdebug(&quot;=
walking&quot;,unpack(arg)) end end =

-
+
 -- returns tiletype,zloc
 function GetAbsTile (xloc,yloc) =

 	return gGroundBlockLoader:GetTile(	math.floor(xloc/8), =

@@ -82,7 +82,7 @@
 			end
 			=

 			flaglist[zloc].bSurface =3D flaglist[zloc].bSurface or isSurface(t.miFl=
ags)
-			flaglist[zloc].bBridge =3D flaglist[zloc].bBridge or isBridge (t.miFlag=
s)
+			flaglist[zloc].bBridge =3D flaglist[zloc].bBridge or isBridge (t.miFlag=
s)
 			=

 			if (iHeight &gt; 0) then
 				flaglist[zloc].bImpassable =3D flaglist[zloc].bImpassable or isImpassa=
ble(t.miFlags)
@@ -91,14 +91,14 @@
 						flaglist[zloc + j] =3D { }
 					end
 					flaglist[zloc + j].bImpassable =3D flaglist[zloc + j].bImpassable or =
isImpassable(t.miFlags)
-					flaglist[zloc + j].bSurface =3D flaglist[zloc + j].bSurface or isSurf=
ace(t.miFlags)
+					flaglist[zloc + j].bSurface =3D flaglist[zloc + j].bSurface or isSurf=
ace(t.miFlags)
 					flaglist[zloc + j].bBridge =3D flaglist[zloc + j].bBridge or isBridge=
 (t.miFlags) =

 				end
 				=

 				if (flaglist[zloc + iHeight] =3D=3D nil) then
 					flaglist[zloc + iHeight] =3D { }
 				end
-				flaglist[zloc + iHeight].bSurface =3D flaglist[zloc + iHeight].bSurfac=
e or isSurface(t.miFlags)
+				flaglist[zloc + iHeight].bSurface =3D flaglist[zloc + iHeight].bSurfac=
e or isSurface(t.miFlags)
 				flaglist[zloc + iHeight].bBridge =3D flaglist[zloc + iHeight].bBridge =
or isBridge(t.miFlags) =

 			end
 			=

@@ -109,7 +109,7 @@
 =

 -- returns an array of flags (impassable, surface, maptile)
 -- array might contain empty entries (meaning on the specific z level is n=
either something blocking nor a surface/maptile)
-function GetWalkingBlockFlags(bx, by, tx, ty)
+function GetWalkingBlockFlags(bx, by, tx, ty)
 	printwalkdebug(&quot;--GetWalkingBlockFlags() for bx=3D&quot;..bx..&quot;  by=3D&quot;..by..&quot;=
  tx=3D&quot;..tx..&quot;  ty=3D&quot;..ty..&quot;  (&quot;..(bx*8 + tx)..&quot;/&quot;..(by*8+ty)..&quot;)&quot;) =

 	=

 	if ( not(gTileTypeLoader) ) then return {} end
@@ -161,30 +161,35 @@
 	local yloc=3Dby*8+ty
 	for k,dynamic in pairs(gDynamics) do =

 		-- is this a multi?
-		if(dynamic.artid &lt; gMulti_ID + 100) then
-			-- no mulit just a normal tile
-			if (dynamic.xloc =3D=3D xloc and dynamic.yloc =3D=3D yloc) then
-				printwalkdebug(&quot;----new dynamic ID=3D&quot; .. dynamic.artid)
-				GetWalkingBlockFlagsHelper(dynamic.zloc,dynamic.artid,flaglist)
-			end
-		else
-			-- multi found, special collision handling
-			local id =3D dynamic.artid - gMulti_ID
-			local parts =3D gMultiLoader:CountMultiParts(id)
-			printwalkdebug(&quot;---Dynamics multi id=3D&quot; .. id .. &quot; parts=3D&quot; .. parts)
-			for p =3D 0, parts-1 do
-				local blocknum,x,y,z,flags
-				blocknum,x,y,z,flags =3D gMultiLoader:GetMultiParts(id,p)
-				=

-				local pxloc,pyloc,pzloc
-				pxloc =3D dynamic.xloc + x
-				pyloc =3D dynamic.yloc + y
-				pzloc =3D dynamic.zloc + z
-				=

-				if (flags =3D=3D 1 and pxloc =3D=3D xloc and pyloc =3D=3D yloc) then
-					printwalkdebug(&quot;----new dynamic ID=3D&quot; .. blocknum)
-					GetWalkingBlockFlagsHelper(pzloc,blocknum,flaglist)
-				end						=

+		if(dynamic.artid) then
+			if(dynamic.artid &lt; gMulti_ID + 100) then
+				-- no mulit just a normal tile
+				if (dynamic.xloc =3D=3D xloc and dynamic.yloc =3D=3D yloc) then
+					printwalkdebug(&quot;----new dynamic ID=3D&quot; .. dynamic.artid)
+					GetWalkingBlockFlagsHelper(dynamic.zloc,dynamic.artid,flaglist)
+				end
+			else
+
+				-- multi found, special collision handling
+				if (gMultiLoader) then
+					local id =3D dynamic.artid - gMulti_ID
+					local parts =3D gMultiLoader:CountMultiParts(id)
+					printwalkdebug(&quot;---Dynamics multi id=3D&quot; .. id .. &quot; parts=3D&quot; .. part=
s)
+					for p =3D 0, parts-1 do
+						local blocknum,x,y,z,flags
+						blocknum,x,y,z,flags =3D gMultiLoader:GetMultiParts(id,p)
+						=

+						local pxloc,pyloc,pzloc
+						pxloc =3D dynamic.xloc + x
+						pyloc =3D dynamic.yloc + y
+						pzloc =3D dynamic.zloc + z
+						=

+						if (flags =3D=3D 1 and pxloc =3D=3D xloc and pyloc =3D=3D yloc) then
+							printwalkdebug(&quot;----new dynamic ID=3D&quot; .. blocknum)
+							GetWalkingBlockFlagsHelper(pzloc,blocknum,flaglist)
+						end						=

+					end
+				end
 			end
 		end
 	end
@@ -194,112 +199,112 @@
 end
 =

 =

--- check for free space (!impassable), char is 15 zlevels tall
+-- check for free space (!impassable), char is 15 zlevels tall
 -- if diagonalCheck is true land tiles above zloc+gMaxZ_Climb (resp. +5 fo=
r maptiles) are blocking, underneath they are ignored
--- returns true or false
-function CheckZSpace(flaglist, zloc, diagonalCheck, height)  =

+-- returns true or false
+function CheckZSpace(flaglist, zloc, diagonalCheck, height)  =

 	diagonalCheck =3D diagonalCheck or false =

 	height =3D height or 15
 	for i=3D1, height, 1 do
-		if (flaglist[zloc+i] ~=3D nil) then
-			if (diagonalCheck) then
-				if (flaglist[zloc+i].bImpassable
-					or (flaglist[zloc+i].bMaptile and (i &gt; gMaxZ_Climb + 5)) =

-					or (flaglist[zloc+i].bSurface and (i &gt; gMaxZ_Climb))
-				) then
-					return false =

-				end
-			elseif (flaglist[zloc+i].bImpassable or flaglist[zloc+i].bSurface) then =

-				return false
+		if (flaglist[zloc+i] ~=3D nil) then
+			if (diagonalCheck) then
+				if (flaglist[zloc+i].bImpassable
+					or (flaglist[zloc+i].bMaptile and (i &gt; gMaxZ_Climb + 5)) =

+					or (flaglist[zloc+i].bSurface and (i &gt; gMaxZ_Climb))
+				) then
+					return false =

+				end
+			elseif (flaglist[zloc+i].bImpassable or flaglist[zloc+i].bSurface) then =

+				return false
 			end
 		end
 	end
 	=

 	return true
 end
-
-
--- check adjacent coordinates when walking diagonally
--- OSI is not looking for a surface on those tiles, it only checks that th=
ere is nothing blocking
--- OSI takes the current z level to check for that, not the z level of the=
 target tile
--- returns true or false
-function CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
-	local bDiagonal
-	local diagonalFlagList1, diagonalFlagList2
-	printwalkdebug(&quot;------direction: &quot;..iDir)
-	if (iDir =3D=3D 1) then --northeast (right)
-		bDiagonal =3D true
-		if (tx =3D=3D 0) then
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx-1, by, 7, ty)
-		else
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx-1, ty)
-		end
-		=

-		if (ty =3D=3D 7) then
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by+1, tx, 0)
-		else
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty+1)
-		end
-							=

-	elseif (iDir =3D=3D 3) then --southeast (down)
-		bDiagonal =3D true
-		if (tx =3D=3D 0) then
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx-1, by, 7, ty)
-		else
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx-1, ty)
-		end
-		=

-		if (ty =3D=3D 0) then
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by-1, tx, 7)
-		else
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty-1)
-		end
-		=

-	elseif (iDir =3D=3D 5) then --southwest (left)
-		bDiagonal =3D true
-		if (tx =3D=3D 7) then
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx+1, by, 0, ty)
-		else
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx+1, ty)
-		end
-		=

-		if (ty =3D=3D 0) then
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by-1, tx, 7)
-		else
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty-1)
-		end
-		=

-	elseif (iDir =3D=3D 7) then --northwest (up)
-		bDiagonal =3D true
-		if (tx =3D=3D 7) then
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx+1, by, 0, ty)
-		else
-			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx+1, ty)
-		end
-		=

-		if (ty =3D=3D 7) then
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by+1, tx, 0)
-		else
-			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty+1)
-		end
-	end
-			=

-	if (bDiagonal) then
-		printwalkdebug(&quot;------walking diagonally&quot;)
-				=

-		if (CheckZSpace(diagonalFlagList1, iStartZ, true) and CheckZSpace(diagon=
alFlagList2, iStartZ, true)) then
-			printwalkdebug(&quot;-------no obstacles on adjacent coordinates&quot;)
-			return true
-		else
-			printwalkdebug(&quot;-------adjacent tiles are not free to walk, blocking&quot;)
-			return false
-		end
-	else
-		return true
-	end
-end
-
-
+
+
+-- check adjacent coordinates when walking diagonally
+-- OSI is not looking for a surface on those tiles, it only checks that th=
ere is nothing blocking
+-- OSI takes the current z level to check for that, not the z level of the=
 target tile
+-- returns true or false
+function CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
+	local bDiagonal
+	local diagonalFlagList1, diagonalFlagList2
+	printwalkdebug(&quot;------direction: &quot;..iDir)
+	if (iDir =3D=3D 1) then --northeast (right)
+		bDiagonal =3D true
+		if (tx =3D=3D 0) then
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx-1, by, 7, ty)
+		else
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx-1, ty)
+		end
+		=

+		if (ty =3D=3D 7) then
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by+1, tx, 0)
+		else
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty+1)
+		end
+							=

+	elseif (iDir =3D=3D 3) then --southeast (down)
+		bDiagonal =3D true
+		if (tx =3D=3D 0) then
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx-1, by, 7, ty)
+		else
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx-1, ty)
+		end
+		=

+		if (ty =3D=3D 0) then
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by-1, tx, 7)
+		else
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty-1)
+		end
+		=

+	elseif (iDir =3D=3D 5) then --southwest (left)
+		bDiagonal =3D true
+		if (tx =3D=3D 7) then
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx+1, by, 0, ty)
+		else
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx+1, ty)
+		end
+		=

+		if (ty =3D=3D 0) then
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by-1, tx, 7)
+		else
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty-1)
+		end
+		=

+	elseif (iDir =3D=3D 7) then --northwest (up)
+		bDiagonal =3D true
+		if (tx =3D=3D 7) then
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx+1, by, 0, ty)
+		else
+			diagonalFlagList1 =3D GetWalkingBlockFlags(bx, by, tx+1, ty)
+		end
+		=

+		if (ty =3D=3D 7) then
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by+1, tx, 0)
+		else
+			diagonalFlagList2 =3D GetWalkingBlockFlags(bx, by, tx, ty+1)
+		end
+	end
+			=

+	if (bDiagonal) then
+		printwalkdebug(&quot;------walking diagonally&quot;)
+				=

+		if (CheckZSpace(diagonalFlagList1, iStartZ, true) and CheckZSpace(diagon=
alFlagList2, iStartZ, true)) then
+			printwalkdebug(&quot;-------no obstacles on adjacent coordinates&quot;)
+			return true
+		else
+			printwalkdebug(&quot;-------adjacent tiles are not free to walk, blocking&quot;)
+			return false
+		end
+	else
+		return true
+	end
+end
+
+
 =

 -- Can walk the tile, the tile's height and if the tile's a stair
 -- (about 30 in int, or 3.0 in float (*0.1) is the height of a door)
@@ -336,20 +341,20 @@
 			printwalkdebug(&quot;-----iCur=3D&quot; .. iCur)
 			if (i &lt; gMaxZ_Climb or (i &lt; (gMaxZ_Climb + 5) and (flaglist[iCur].bMapt=
ile or flaglist[iCur].bBridge))) then
 				if ((not flaglist[iCur].bImpassable) and flaglist[iCur].bSurface) then
-					printwalkdebug(&quot;------found Surface&quot;);
-					if (CheckZSpace(flaglist, iCur)) then
+					printwalkdebug(&quot;------found Surface&quot;);
+					if (CheckZSpace(flaglist, iCur)) then
 						printwalkdebug(&quot;------checkSpace successful&quot;)
-						=

-						local bAdjacent =3D CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
+						=

+						local bAdjacent =3D CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
 						=

 						printwalkdebug(&quot;End GetNearestGroundLevel()&quot;)
 						printwalkdebug(&quot;----------------------------&quot;)
 						printwalkdebug()
-						printdebug(&quot;walking&quot;,sprintf( &quot;Walking calculations took %d msec.\n&quot;=
, Client_GetTicks() - Walking_Start ))
-						if (bAdjacent) then
-							return true, iCur
-						else
-							return false, 255
+						printdebug(&quot;walking&quot;,sprintf( &quot;Walking calculations took %d msec.\n&quot;=
, Client_GetTicks() - Walking_Start ))
+						if (bAdjacent) then
+							return true, iCur
+						else
+							return false, 255
 						end
 					end
 				end
@@ -364,18 +369,18 @@
 				if ((not flaglist[iCur].bImpassable) and flaglist[iCur].bSurface) then
 					printwalkdebug(&quot;------found Surface&quot;);
 					if (CheckZSpace(flaglist, iCur)) then
-						printwalkdebug(&quot;------ checkSpace successful&quot;)
-						=

-						local bAdjacent =3D CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
+						printwalkdebug(&quot;------ checkSpace successful&quot;)
+						=

+						local bAdjacent =3D CheckAdjacentTiles(bx, by, tx, ty, iDir, iStartZ)
 						=

 						printwalkdebug(&quot;End GetNearestGroundLevel()&quot;)
 						printwalkdebug(&quot;----------------------------&quot;)
 						printwalkdebug()
-						printdebug(&quot;walking&quot;,sprintf( &quot;Walking calculations took %d msec.\n&quot;=
, Client_GetTicks() - Walking_Start ))
-						if (bAdjacent) then
-							return true, iCur
-						else
-							return false, 255
+						printdebug(&quot;walking&quot;,sprintf( &quot;Walking calculations took %d msec.\n&quot;=
, Client_GetTicks() - Walking_Start ))
+						if (bAdjacent) then
+							return true, iCur
+						else
+							return false, 255
 						end
 					end
 				end

Modified: trunk/data/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/lua/main.lua (original)
+++ trunk/data/lua/main.lua Thu Jun 21 01:09:50 2007
@@ -179,6 +179,7 @@
 =

 	MainMenuFinishedPreLoading()
 	StartMainMenu()
+
 	if (gStartInDebugMode) then StopMainMenu() StartDebugMenu() end
 =

 	-- mainloop

Modified: trunk/data/lua/net.objects.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/lua/net.objects.lua (original)
+++ trunk/data/lua/net.objects.lua Thu Jun 21 01:09:50 2007
@@ -217,5 +217,5 @@
 			effect.itemid, effect.source_locx, effect.source_locy, effect.source_lo=
cz,
 			effect.target_locx, effect.target_locy, effect.target_locz, gEffectType=
s[effect.effect_type] or &quot;&quot;)
 	=

-	gCurrentRenderer:AddEffect( effect )
-end
+	if (gParticleEffects) then gCurrentRenderer:AddEffect( effect ) end
+end

Modified: trunk/data/skippedfallbacks.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/skippedfallbacks.lua (original)
+++ trunk/data/skippedfallbacks.lua Thu Jun 21 01:09:50 2007
@@ -311,3 +311,4 @@
 RegisterSkippedArtBillboardFallBack(6795) -- 0x1a8b name=3Dore cart
 RegisterSkippedArtBillboardFallBack(6790) -- 0x1a86 name=3Dore cart
 RegisterSkippedArtBillboardFallBack(8611) -- 0x21a3 name=3Dnodraw
+RegisterSkippedArtBillboardFallBack(3698) -- 0x0e72 name=3Dcannon

Modified: trunk/data/terrain/materials/terrain.material
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/terrain/materials/terrain.material (original)
+++ trunk/data/terrain/materials/terrain.material Thu Jun 21 01:09:50 2007
@@ -154,6 +154,43 @@
 		}
 	}
 }
+//sand tiles
+material base_sand : terrain_base
+{
+	technique
+	{
+		pass base
+		{
+			vertex_program_ref terrainBase_vs
+			{
+				param_named materialDiffuse float3 1.0 1.0 1.0
+				param_named materialSpecular float4 0.10 0.10 0 35.0
+				param_named worldScale float 15
+			}
+			fragment_program_ref terrainBase_ps
+			{
+			}
+			texture_unit
+			{
+				texture Sand_large_pattern_512.dds
+			}
+		}
+	}
+}
+//cobblestone tiles
+material base_cobblestone : terrain_base
+{
+	technique
+	{
+		pass base
+		{
+			texture_unit
+			{
+				texture cobblestone_large_pattern_512.dds
+			}
+		}
+	}
+}
 =

 //###########################################
 // TRANSITION TILES
@@ -359,6 +396,118 @@
 //material tileid_3254 : base_forest
 //{
 //}
+//__________________________________________________________
+//Sand
+material tileid_22 : base_sand
+{
+}
+material tileid_23 : base_sand
+{
+}
+material tileid_24 : base_sand
+{
+}
+material tileid_25 : base_sand
+{
+}
+material tileid_26 : base_sand
+{
+}
+material tileid_27 : base_sand
+{
+}
+material tileid_28 : base_sand
+{
+}
+material tileid_441 : base_sand
+{
+}
+material tileid_442 : base_sand
+{
+}
+material tileid_443 : base_sand
+{
+}
+material tileid_444 : base_sand
+{
+}
+material tileid_445 : base_sand
+{
+}
+material tileid_446 : base_sand
+{
+}
+material tileid_447 : base_sand
+{
+}
+material tileid_448 : base_sand
+{
+}
+material tileid_449 : base_sand
+{
+}
+material tileid_450 : base_sand
+{
+}
+material tileid_451 : base_sand
+{
+}
+material tileid_452 : base_sand
+{
+}
+material tileid_453 : base_sand
+{
+}
+material tileid_454 : base_sand
+{
+}
+material tileid_455 : base_sand
+{
+}
+material tileid_456 : base_sand
+{
+}
+material tileid_457 : base_sand
+{
+}
+material tileid_458 : base_sand
+{
+}
+material tileid_459 : base_sand
+{
+}
+material tileid_460 : base_sand
+{
+}
+material tileid_461 : base_sand
+{
+}
+material tileid_462 : base_sand
+{
+}
+material tileid_463 : base_sand
+{
+}
+material tileid_464 : base_sand
+{
+}
+material tileid_465 : base_sand
+{
+}
+//__________________________________________________________
+//cobblestone
+material tileid_1001 : base_cobblestone
+{
+}
+material tileid_1002 : base_cobblestone
+{
+}
+material tileid_1003 : base_cobblestone
+{
+}
+material tileid_1004 : base_cobblestone
+{
+}
 =

 // Transitions:
 //__________________________________________________________


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000038.html">[Iris-commit] [IRIS] r1222 - /trunk/bin/iris2.exe
</A></li>
	<LI>Next message: <A HREF="000040.html">[Iris-commit] [IRIS] r1224 - /trunk/src/scripting.cpp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39">[ date ]</a>
              <a href="thread.html#39">[ thread ]</a>
              <a href="subject.html#39">[ subject ]</a>
              <a href="author.html#39">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
