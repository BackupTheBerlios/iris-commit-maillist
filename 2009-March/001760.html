<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r2959 - in /trunk/lua: lib.2d.effect.lua lib.3d.cam.lua lib.3d.dynamic.lua lib.3d.map.lua lib.3d.mousepick.lua lib.bodygfx.lua lib.mainmenu.background.lua lib.mainmenu.lua lib.shardlist.lua
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r2959%20-%20in%20/trunk/lua%3A%20lib.2d.effect.lua%0A%20lib.3d.cam.lua%20lib.3d.dynamic.lua%20lib.3d.map.lua%20lib.3d.mousepick.lua%0A%20lib.bodygfx.lua%20lib.mainmenu.background.lua%20lib.mainmenu.lua%0A%20lib.shardlist.lua&In-Reply-To=%3C20090314033541.A9F1A1524032%40zwischenwelt.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001759.html">
   <LINK REL="Next"  HREF="001761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r2959 - in /trunk/lua: lib.2d.effect.lua lib.3d.cam.lua lib.3d.dynamic.lua lib.3d.map.lua lib.3d.mousepick.lua lib.bodygfx.lua lib.mainmenu.background.lua lib.mainmenu.lua lib.shardlist.lua</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r2959%20-%20in%20/trunk/lua%3A%20lib.2d.effect.lua%0A%20lib.3d.cam.lua%20lib.3d.dynamic.lua%20lib.3d.map.lua%20lib.3d.mousepick.lua%0A%20lib.bodygfx.lua%20lib.mainmenu.background.lua%20lib.mainmenu.lua%0A%20lib.shardlist.lua&In-Reply-To=%3C20090314033541.A9F1A1524032%40zwischenwelt.org%3E"
       TITLE="[Iris-commit] [IRIS] r2959 - in /trunk/lua: lib.2d.effect.lua lib.3d.cam.lua lib.3d.dynamic.lua lib.3d.map.lua lib.3d.mousepick.lua lib.bodygfx.lua lib.mainmenu.background.lua lib.mainmenu.lua lib.shardlist.lua">no-reply at zwischenwelt.org
       </A><BR>
    <I>Sat Mar 14 04:35:41 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001759.html">[Iris-commit] [IRIS] r2958 - /tools/archiv/lib.mainmenu.old.lua
</A></li>
        <LI>Next message: <A HREF="001761.html">[Iris-commit] [IRIS] r2961 - /tools/installer/Iris_Setup.iss
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1760">[ date ]</a>
              <a href="thread.html#1760">[ thread ]</a>
              <a href="subject.html#1760">[ subject ]</a>
              <a href="author.html#1760">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ghoulsblade
Date: Sat Mar 14 04:35:40 2009
New Revision: 2959

Log:
restored some comments that were deleted by r2955

Modified:
    trunk/lua/lib.2d.effect.lua
    trunk/lua/lib.3d.cam.lua
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.3d.mousepick.lua
    trunk/lua/lib.bodygfx.lua
    trunk/lua/lib.mainmenu.background.lua
    trunk/lua/lib.mainmenu.lua
    trunk/lua/lib.shardlist.lua

Modified: trunk/lua/lib.2d.effect.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.2d.effect.lua (original)
+++ trunk/lua/lib.2d.effect.lua Sat Mar 14 04:35:40 2009
@@ -3,6 +3,11 @@
 Renderer2D.kMovingEffectZAdd =3D 15
 =

     --[[
+	kEffectType_FromSourceToDest =3D 0
+	kEffectType_LightningStrikeAtSource =3D 1
+	kEffectType_StayAtCurrentPosition =3D 2
+	kEffectType_FollowSource =3D 3
+
     see also Renderer3D:AddLightningEffect -- effect.effect_type =3D=3D kE=
ffectType_LightningStrikeAtSource
     see also Renderer3D:AddParticleEffect
     see also Renderer3D:AddHuedMeshEffect  effect.huedeffect  effect.itemi=
d effect.hue
@@ -97,6 +102,12 @@
     local xloc2,yloc2,zloc2 =3D effectdata.target_locx,effectdata.target_l=
ocy,effectdata.target_locz
     local iTileTypeID       =3D effectdata.itemid
     local iHue              =3D effectdata.hue
+	--~ local arttype =3D GetStaticTileType(iTileTypeID)
+	--~ print(&quot;Renderer2D:UpdateEffectGfx A&quot;,iTileTypeID,arttype and SmartDum=
p(arttype))
+	--~ if (not arttype) then return end
+	--~ print(&quot;Renderer2D:UpdateEffectGfx B&quot;,xloc,yloc,zloc,effectdata.itemid=
,arttype,arttype and arttype.miAnimID)
+	--~ if (not arttype) then return end
+	--~ local iModelID		=3D arttype.miAnimID
 =

     if (iTileTypeID =3D=3D 0 and effectdata.effect_type =3D=3D kEffectType=
_LightningStrikeAtSource) then
         iTileTypeID =3D 0x3967 -- couldn't find out how lightning effect i=
s supposed to work, so we use paralyse field for now
@@ -111,6 +122,11 @@
         effect.nextstept =3D effect.startt + iFrameInterval * (iFrame + 1)
         iFrame =3D iFrame % o.miCount
         iTileTypeID =3D iTileTypeBaseID + (o.miFrames[iFrame] or 0)
+		-- o.miFrames,o.miUnknown,o.miCount,o.miFrameInterval,o.miFrameStart
+		--~ print(&quot;Renderer2D:UpdateEffectGfx info&quot;,o.miUnknown,o.miCount,o.miFr=
ameInterval,o.miFrameStart)
+		--~ flamestrike =3D Renderer2D:UpdateEffectGfx info 0       30      1   =
    0
+
+		--~ for k,v in pairs(o.miFrames) do print(&quot;&gt;&quot;,k,v) end
     end
 =

     local spriteblock =3D effect.gfx2d
@@ -121,6 +137,7 @@
         spriteblock:Clear()
     end
 =

+	--~ if ((not arttype) or arttype.miAnimID =3D=3D 0) then
     local tx,ty,tz,fIndexRel =3D 0,0,0,0
     local sorttx =3D xloc-floor(xloc/8)*8
     local sortty =3D yloc-floor(yloc/8)*8
@@ -139,6 +156,11 @@
     end
     =

     spriteblock:SetPosition(x,y,z)
+	--~ end
+	=

+	=

+	=

+	=

 =

     --[[
     local tx,ty,tz,iIndex,fIndexRel =3D 0,0,0,0
@@ -167,6 +189,7 @@
 =

 -- kPacket_Hued_FX 0xC0
 function Renderer2D:AddEffect (effectdata) =

+	--~ print(&quot;Renderer2D:AddEffect&quot;,SmartDump(effectdata))
     local t =3D Client_GetTicks()
     if (effectdata.effect_type =3D=3D kEffectType_FromSourceToDest and eff=
ectdata.duration =3D=3D 0) then
         effectdata.duration =3D 10

Modified: trunk/lua/lib.3d.cam.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.cam.lua (original)
+++ trunk/lua/lib.3d.cam.lua Sat Mar 14 04:35:40 2009
@@ -355,3 +355,12 @@
     =

     return ax, -iCamOverLocX, iCamOverLocY
 end
+
+--[[
+	GetMainCam():SetPos(x,y,z)
+	GetMainCam():SetRot(w,x,y,z)
+		q(angle,axis)	Quaternion.fromAngleAxis(ang,x,y,z)    =

+		q*v				Quaternion.ApplyToVector (x,y,z,qw,qx,qy,qz)
+		q*q				Quaternion.Mul (aw,ax,ay,az,bw,bx,by,bz) =

+]]--
+

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sat Mar 14 04:35:40 2009
@@ -201,6 +201,28 @@
     if self.map3d_spawners and self.map3d_spawners.water then =

         self.map3d_spawners.water:AddDynamic(dynamic)
     end
+
+	--~ -- block position
+	--~ local bx =3D math.floor(dynamic.xloc / Renderer3D.gFastBatchDynamicsB=
lockSize)
+	--~ local by =3D math.floor(dynamic.yloc / Renderer3D.gFastBatchDynamicsB=
lockSize)
+	--~ =

+	--~ -- block empty? create a new entry
+	--~ if not Array2DGet(Renderer3D.gFastBatchDynamicsMap, bx,by) then
+		--~ Array2DSet(Renderer3D.gFastBatchDynamicsMap, bx,by, {mbUpdateNeeded=
=3Dtrue, miCount=3D0,mlDynamic=3D{}})
+	--~ end
+	--~ =

+	--~ local e =3D Array2DGet(Renderer3D.gFastBatchDynamicsMap, bx,by)
+	--~ -- add dynamic if not available
+	--~ if not e.mlDynamic[dynamic.serial] then
+		--~ -- print(&quot;ADD&quot;,bx,by,dynamic.serial)
+		--~ e.miCount =3D e.miCount + 1
+		--~ e.mlDynamic[dynamic.serial] =3D dynamic
+	--~ end
+--~ =

+	--~ e.mbUpdateNeeded =3D true
+	--~ Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
+	--~ =

+	--~ -- Renderer3D:ShowDynamicMapStats()
 end
 =

 function Renderer3D:RemoveDynamicFromMap    (dynamic)
@@ -210,6 +232,23 @@
     if self.map3d_spawners and self.map3d_spawners.water then =

         self.map3d_spawners.water:RemoveDynamic(dynamic)
     end
+
+	--~ Array2DForAll(Renderer3D.gFastBatchDynamicsMap, function(e,bx,by)
+		--~ -- remove dynamic if available
+		--~ if e.mlDynamic[dynamic.serial] then
+			--~ -- print(&quot;REMOVE&quot;,bx,by,dynamic.serial)
+			--~ e.mbUpdateNeeded =3D true
+			--~ e.miCount =3D e.miCount - 1
+			--~ e.mlDynamic[dynamic.serial] =3D nil
+			--~ Renderer3D.gFastBatchDynamicsUpdateNeeded =3D true
+		--~ end
+		--~ =

+		--~ -- remove block entry
+		--~ if e.miCount =3D=3D 0 then
+			--~ if e.mFastBatch then e.mFastBatch:Destroy() end
+			--~ Array2DSet(Renderer3D.gFastBatchDynamicsMap, bx,by, nil)
+		--~ end
+	--~ end)
 end
 =

 -- rebuilds the graphic of the dynamics
@@ -240,6 +279,15 @@
     if self.map3d_spawners and self.map3d_spawners.multis then =

         self.map3d_spawners.multis:RemoveMulti(multi)
     end
+
+	--[[
+	if multi.mbBuildRunning then
+		multi.mbCancelBuildAndDestroy =3D true
+	elseif multi.staticGeometry then =

+		multi.staticGeometry:Destroy() =

+		multi.staticGeometry =3D nil
+	end
+	]]--
 end
 =

 -- multi / house =

@@ -326,7 +374,8 @@
             item.gfx =3D CreateRootGfx3D()
             item.gfx:SetMesh(item.meshname)
             item.gfx:SetOrientation(GetStaticMeshOrientation(item.artid))
---            item.gfx:SetNormaliseNormals(true)
+			--~ mirroring now baked into meshes for shader compatibility -- item.gf=
x:SetScale(-1,1,1)		-- (-1) thats because xmirror bug and wrong mirrored me=
shes
+			item.gfx:SetNormaliseNormals(true)
             item.gfx:SetCastShadows(gDynamicsCastShadows)
             -- primary color hueing
             if gHueLoader and item.hue &gt; 0 then
@@ -585,4 +634,10 @@
     end
 =

     -- RemoveDynamicFromMap(dynamic) is handled by on destroy listener ( R=
egisterListener(&quot;Dynamic_Destroy&quot; )
-end
+
+	--[[ handled by on destroy listener
+	if gFastBatchDynamics then =

+		Renderer3D:RemoveDynamicFromMap	(dynamic)
+	end
+	]]--
+end

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sat Mar 14 04:35:40 2009
@@ -184,6 +184,11 @@
             end
         end
         =

+		-- update dynamics =

+		--~ for k,dynamic in pairs(GetDynamicList()) do if (DynamicIsInWorld(dyn=
amic)) then self:UpdateDynamicVisibility(dynamic) end end
+		=

+		--~ self:UpdateDynamicDisplayRange()
+		=

         -- update mobiles
         for k,mobile in pairs(GetMobileList()) do self:UpdateMobileVisibil=
ity(mobile) end
     end
@@ -204,3 +209,12 @@
 end
 =

 function Renderer3D:ClearMapCache () end
+
+
+--[[
+function Renderer3D:UpdateStaticVisibility	(entity) =

+	if (entity and entity.gfx and entity.gfx.billboard) then
+		entity.gfx.billboard:SetVisible(self:IsZLayerVisible(entity.zloc))
+	end
+end
+]]--

Modified: trunk/lua/lib.3d.mousepick.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.mousepick.lua (original)
+++ trunk/lua/lib.3d.mousepick.lua Sat Mar 14 04:35:40 2009
@@ -204,6 +204,69 @@
         gCustomQuadInfoWritten =3D true
         print(&quot;mousepick info numgfx=3D&quot;,numgfx,&quot;numcustomquads=3D&quot;,numcus=
tomquads,&quot; (each has its own scenenode)&quot;)
     end
+	--[[
+	for chunky,row in pairs(self.gMapChunks) do
+		for chunkx,chunk in pairs(row) do
+			if (not chunk.bIsDead) then
+				-- terrain
+				if (gGroundBlockLoader and self.gbBlendOutTerrainVisible) then
+					local iBlockUO_X =3D chunk.miX * self.ROBMAP_CHUNK_SIZE
+					local iBlockUO_Y =3D chunk.miY * self.ROBMAP_CHUNK_SIZE
+													=

+					if (chunk.pStaticGeometryTerrain) then -- old terrain : static-geom
+						local x,y =3D self:UOPosToLocal(iBlockUO_X*8,iBlockUO_Y*8)
+						bHit,fHitDist =3D chunk.pTerrainEntity:RayPick(rx,ry,rz,rvx,rvy,rvz,=
x,y,0)
+					elseif (chunk.terrain_multitex_gfx) then -- new terrain multitex
+						local gfx =3D chunk.terrain_multitex_gfx
+						local d =3D kMultiTexTerrainChunkSize
+						local bx,by =3D gfx.bx,gfx.by
+						local tx,ty
+
+						bHit,fHitDist,tx,ty =3D TerrainMultiTex_RayPick(gGroundBlockLoader,g=
fx.bx,gfx.by,d,d,0.1, rx-gfx.x,ry-gfx.y,rz-gfx.z, rvx,rvy,rvz)
+						if (bHit) then
+							if (tx &gt;=3D 8) then bx =3D bx + 1   tx =3D tx - 8 end
+							if (ty &gt;=3D 8) then by =3D by + 1   ty =3D ty - 8 end
+						end
+					else
+						if (chunk.terraingfx) then -- old terrain : meshentities
+							bHit,fHitDist =3D chunk.terraingfx:RayPick(rx,ry,rz,rvx,rvy,rvz)
+						else
+							bHit =3D false
+						end
+					end
+					=

+					if (bHit and ((not gMousePickFoundHit) or fHitDist &lt; self.gMousePickF=
oundDist)) then
+						self.gMousePickFoundDist =3D fHitDist
+						gMousePickFoundHit =3D {}
+						gMousePickFoundHit.hittype =3D kMousePickHitType_Terrain
+						gMousePickFoundHit.chunk =3D chunk
+						=

+						local x,y =3D Renderer3D:LocalToUOPos(rx + fHitDist * rvx, ry + fHit=
Dist * rvy)
+						x,y =3D math.floor(x),math.floor(y)
+						local iTileType,iZLoc =3D GetAbsTile(x,y) =

+						local bx =3D math.floor((x - iBlockUO_X)/8)
+						local by =3D math.floor((y - iBlockUO_Y)/8)
+						local origin_abs_x =3D self.giMapOriginX * self.ROBMAP_CHUNK_SIZE
+						local origin_abs_y =3D self.giMapOriginY * self.ROBMAP_CHUNK_SIZE
+						local originoffx =3D 8.0*(iBlockUO_X-origin_abs_x)
+						local originoffy =3D 8.0*(iBlockUO_Y-origin_abs_y)
+						=

+						gMousePickFoundHit.tiletype =3D iTileType
+						gMousePickFoundHit.minz =3D iZLoc*0.1 =

+						gMousePickFoundHit.maxz =3D iZLoc*0.1
+						gMousePickFoundHit.x =3D x
+						gMousePickFoundHit.y =3D y
+						gMousePickFoundHit.tx =3D math.mod(x,8)
+						gMousePickFoundHit.ty =3D math.mod(y,8)
+						gMousePickFoundHit.iBlockX =3D iBlockUO_X+bx
+						gMousePickFoundHit.iBlockY =3D iBlockUO_Y+by
+						gMousePickFoundHit.blockorigin_x =3D originoffx+bx*8
+						gMousePickFoundHit.blockorigin_y =3D originoffy+by*8
+					end
+				end
+			end
+	end end
+	]]--
     =

     -- dynamics
     for k,dynamic in pairs(GetDynamicList()) do

Modified: trunk/lua/lib.bodygfx.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.bodygfx.lua (original)
+++ trunk/lua/lib.bodygfx.lua Sat Mar 14 04:35:40 2009
@@ -273,7 +273,7 @@
 		local myscalez =3D forcescalez or modelinfo.scalez * gGrannyScaleFactor
 		if (myscalex ~=3D 1 or myscaley ~=3D 1 or myscalez ~=3D 1) then
 			partgfx:SetScale(myscalex,myscaley,myscalez)
---			partgfx:SetNormaliseNormals(true)
+			partgfx:SetNormaliseNormals(true)
 		end
 	end
 	return partgfx

Modified: trunk/lua/lib.mainmenu.background.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.background.lua (original)
+++ trunk/lua/lib.mainmenu.background.lua Sat Mar 14 04:35:40 2009
@@ -21,3 +21,21 @@
     DestroyIfAlive(gMenuBgImage)
     gMenuBgImage =3D nil
 end
+
+--[[
+-- old, wasn't used anymore
+local function SetMainMenuCam (roth,rotv)
+	local cam =3D GetMainCam()
+	cam:SetFOVy(gfDeg2Rad*45)
+	cam:SetNearClipDistance(0.5) -- old : 1
+	cam:SetFarClipDistance(2000) -- ogre defaul : 100000
+	cam:SetProjectionType(kCamera_PT_PERSPECTIVE) -- perspective
+	local w1,x1,y1,z1 =3D Quaternion.fromAngleAxis(gfDeg2Rad * 90.0,1,0,0)
+	local w2,x2,y2,z2 =3D Quaternion.fromAngleAxis(roth,0,1,0)	=

+	local w3,x3,y3,z3 =3D Quaternion.fromAngleAxis(rotv,1,0,0)
+	local w4,x4,y4,z4 =3D Quaternion.Mul(w1,x1,y1,z1, w2,x2,y2,z2)
+	=

+	local w,x,y,z =3D Quaternion.Mul(w4,x4,y4,z4, w3,x3,y3,z3)
+	GetMainCam():SetRot(w,x,y,z)	=

+end
+]]--

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Sat Mar 14 04:35:40 2009
@@ -65,7 +65,7 @@
                             gAutoLoginCharName =3D charlist[i]
                             gLoginname =3D charlist.gLoginname
                             gPassword =3D MainMenu_GetStoredPassword(shard=
.gLoginServerIP,shard.gLoginServerPort,gLoginname)
---                          print(&quot;found&quot;,gAutoLoginCharName,gLoginname)
+                          	print(&quot;found&quot;,gAutoLoginCharName,gLoginname)
                         end
                     end
                 end

Modified: trunk/lua/lib.shardlist.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.shardlist.lua (original)
+++ trunk/lua/lib.shardlist.lua Sat Mar 14 04:35:40 2009
@@ -134,3 +134,16 @@
 function SetStoredPassword          (host,port,username,password) gStoredP=
asswords[host..&quot;:&quot;..port..&quot;:&quot;..username] =3D password SaveStoredPasswords()=
 end
 function ClearStoredPassword        (host,port,username) gStoredPasswords[=
host..&quot;:&quot;..port..&quot;:&quot;..username] =3D nil SaveStoredPasswords() end
 function ClearAllStoredPasswords    () gStoredPasswords =3D {} SaveStoredP=
asswords() end
+
+function TestStoredPasswords ()
+	local host,port =3D &quot;example.org&quot;,2593
+	local user1 =3D &quot;weirdguy&quot;
+	local user2 =3D &quot;somedude&quot;
+	LoadStoredPasswords()
+	--~ SetStoredPassword(host,port,user1,&quot;secret1234&quot;)
+	--~ SetStoredPassword(host,port,user2,&quot;secret5555&quot;)
+	print(user1,GetStoredPassword(host,port,user1)) --~ weirdguy        secre=
t1234
+	print(user2,GetStoredPassword(host,port,user2)) --~ somedude        secre=
t5555
+	os.exit(0)
+end
+


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001759.html">[Iris-commit] [IRIS] r2958 - /tools/archiv/lib.mainmenu.old.lua
</A></li>
	<LI>Next message: <A HREF="001761.html">[Iris-commit] [IRIS] r2961 - /tools/installer/Iris_Setup.iss
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1760">[ date ]</a>
              <a href="thread.html#1760">[ thread ]</a>
              <a href="subject.html#1760">[ subject ]</a>
              <a href="author.html#1760">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
