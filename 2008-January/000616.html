<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Iris-commit] [IRIS] r1801 - in /trunk: data/models/atlas/	data/models/models/ lua/
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/iris-commit/2008-January/index.html" >
   <LINK REL="made" HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1801%20-%20in%20/trunk%3A%20data/models/atlas/%0A%09data/models/models/%20lua/&In-Reply-To=%3C20080120000013.1DD331C181B1%40zwischenwelt.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000614.html">
   <LINK REL="Next"  HREF="000617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Iris-commit] [IRIS] r1801 - in /trunk: data/models/atlas/	data/models/models/ lua/</H1>
    <B>no-reply at zwischenwelt.org</B> 
    <A HREF="mailto:iris-commit%40lists.berlios.de?Subject=Re%3A%20%5BIris-commit%5D%20%5BIRIS%5D%20r1801%20-%20in%20/trunk%3A%20data/models/atlas/%0A%09data/models/models/%20lua/&In-Reply-To=%3C20080120000013.1DD331C181B1%40zwischenwelt.org%3E"
       TITLE="[Iris-commit] [IRIS] r1801 - in /trunk: data/models/atlas/	data/models/models/ lua/">no-reply at zwischenwelt.org
       </A><BR>
    <I>Sun Jan 20 00:25:56 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000614.html">[Iris-commit] [IRIS] r1800 - in /rawdata/sd_pd: tex_grass.png	topf.blend
</A></li>
        <LI>Next message: <A HREF="000617.html">[Iris-commit] [IRIS] r1802 - /trunk/README
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#616">[ date ]</a>
              <a href="thread.html#616">[ thread ]</a>
              <a href="subject.html#616">[ subject ]</a>
              <a href="author.html#616">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: hagish
Date: Sun Jan 20 00:25:56 2008
New Revision: 1801

Log:
rename GetStaticMeshName to GetMeshName

Added:
    trunk/data/models/atlas/tex_atlas_2048_2048.lua
    trunk/data/models/atlas/tex_atlas_2048_2048.material
    trunk/data/models/atlas/tex_atlas_2048_20480.png   (with props)
    trunk/data/models/atlas/tex_atlas_2048_20481.png   (with props)
    trunk/data/models/atlas/tex_atlas_2048_20482.png   (with props)
    trunk/data/models/atlas/tex_atlas_2048_64.lua
    trunk/data/models/atlas/tex_atlas_2048_64.material
    trunk/data/models/atlas/tex_atlas_2048_640.png   (with props)
    trunk/data/models/atlas/tex_atlas_alpha_2048_2048.lua
    trunk/data/models/atlas/tex_atlas_alpha_2048_2048.material
    trunk/data/models/atlas/tex_atlas_alpha_2048_20480.png   (with props)
    trunk/data/models/atlas/tex_atlas_alpha_2048_20481.png   (with props)
    trunk/data/models/atlas/tex_atlas_alpha_2048_64.lua
    trunk/data/models/atlas/tex_atlas_alpha_2048_64.material
    trunk/data/models/atlas/tex_atlas_alpha_2048_640.png   (with props)
Removed:
    trunk/data/models/atlas/tex_atlas_2048_128.lua
    trunk/data/models/atlas/tex_atlas_2048_128.material
    trunk/data/models/atlas/tex_atlas_2048_1280.png
    trunk/data/models/atlas/tex_atlas_4096_4096.lua
    trunk/data/models/atlas/tex_atlas_4096_4096.material
    trunk/data/models/atlas/tex_atlas_4096_40960.png
    trunk/data/models/atlas/tex_atlas_alpha_2048_128.lua
    trunk/data/models/atlas/tex_atlas_alpha_2048_128.material
    trunk/data/models/atlas/tex_atlas_alpha_2048_1280.png
    trunk/data/models/atlas/tex_atlas_alpha_4096_4096.lua
    trunk/data/models/atlas/tex_atlas_alpha_4096_4096.material
    trunk/data/models/atlas/tex_atlas_alpha_4096_40960.png
Modified:
    trunk/data/models/models/generate_all.sh
    trunk/lua/lib.3d.dynamic.lua
    trunk/lua/lib.3d.map.lua
    trunk/lua/lib.3d.renderer.lua
    trunk/lua/lib.debugmenu.lua
    trunk/lua/lib.mainmenu.lua
    trunk/lua/lib.test.lua
    trunk/lua/main.lua

Modified: trunk/data/models/models/generate_all.sh
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/data/models/models/generate_all.sh (original)
+++ trunk/data/models/models/generate_all.sh Sun Jan 20 00:25:56 2008
@@ -11,12 +11,17 @@
 php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_alpha_${A=
TLASSIZE}_${TEXSIZE} tex_base_alpha alpha
 # ###################################################
 ATLASSIZE=3D2048
-TEXSIZE=3D128
+TEXSIZE=3D64
 php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_${ATLASSI=
ZE}_${TEXSIZE} tex_base
 php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_alpha_${A=
TLASSIZE}_${TEXSIZE} tex_base_alpha alpha
 # ###################################################
-ATLASSIZE=3D4096
-TEXSIZE=3D4096
+ATLASSIZE=3D2048
+TEXSIZE=3D2048
+php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_${ATLASSI=
ZE}_${TEXSIZE} tex_base
+php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_alpha_${A=
TLASSIZE}_${TEXSIZE} tex_base_alpha alpha
+# ###################################################
+ATLASSIZE=3D256
+TEXSIZE=3D8
 php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_${ATLASSI=
ZE}_${TEXSIZE} tex_base
 php generate_tex_atlas.php xml.txt $ATLASSIZE $TEXSIZE tex_atlas_alpha_${A=
TLASSIZE}_${TEXSIZE} tex_base_alpha alpha
 # ###################################################

Modified: trunk/lua/lib.3d.dynamic.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.dynamic.lua (original)
+++ trunk/lua/lib.3d.dynamic.lua Sun Jan 20 00:25:56 2008
@@ -152,7 +152,7 @@
 		end
 	else
 		-- normal 1 part object
-		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetStatic=
MeshName(item.artid) -- ,item.hue)
+		local meshname =3D (not gForceFallBackBillboards_Dynamics) and GetMeshNa=
me(item.artid) -- ,item.hue)
 		item.meshname =3D meshname
 		item.meshname =3D meshname
 		-- print(&quot;DEBUG&quot;,&quot;meshname&quot;,item.meshname)

Modified: trunk/lua/lib.3d.map.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.map.lua (original)
+++ trunk/lua/lib.3d.map.lua Sun Jan 20 00:25:56 2008
@@ -214,7 +214,7 @@
 		staticwatertile =3D not gEnableMultiTexTerrain		--on multitexturing filt=
er static water
 	end
 =

-	local meshname =3D (not gForceFallBackBillboards_Statics) and staticwater=
tile and GetStaticMeshName(iTileTypeID,entity.iHue)
+	local meshname =3D (not gForceFallBackBillboards_Statics) and staticwater=
tile and GetMeshName(iTileTypeID,entity.iHue)
 =

 	-- create Mesh
 	if (meshname and meshname ~=3D false) then 	--and (not MeshIsPseudoBillBo=
ard(iTileTypeID))) then	--currently disabled

Modified: trunk/lua/lib.3d.renderer.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.3d.renderer.lua (original)
+++ trunk/lua/lib.3d.renderer.lua Sun Jan 20 00:25:56 2008
@@ -205,7 +205,7 @@
 =

 -- Hued Effect : to display Meshes as instant Effects
 function Renderer3D:AddHuedEffect( effect, relx, rely, relz )
-	local meshname =3D GetStaticMeshName(effect.itemid,effect.hue)
+	local meshname =3D GetMeshName(effect.itemid,effect.hue)
 	if (meshname and meshname ~=3D false) then
 		effect.gfx =3D CreateRootGfx3D()
 		effect.gfx:SetMesh(meshname)

Modified: trunk/lua/lib.debugmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.debugmenu.lua (original)
+++ trunk/lua/lib.debugmenu.lua Sun Jan 20 00:25:56 2008
@@ -567,7 +567,7 @@
 		local iTileType =3D gDebugMenuModelIndex
 		local iHue =3D gDebugMenuAnimIndex
 		local info =3D GetStaticTileType(iTileType)
-		local meshname =3D GetStaticMeshName(iTileType,iHue)
+		local meshname =3D GetMeshName(iTileType,iHue)
 		local tricount =3D meshname and CountMeshTriangles(meshname) or 0
 		AddFadeLines(sprintf(&quot;static %04x(=3D%d) hue=3D%d tricount=3D%d %s&quot;,iTil=
eType,iTileType,iHue,tricount,GetStaticTileTypeName(iTileType) or &quot;&quot;))
 		if (meshname and meshname ~=3D false) then
@@ -602,10 +602,10 @@
 			local tries =3D 400
 			local add =3D (delta &gt; 0) and 1 or -1
 			newval =3D newval + add
-			local meshname =3D GetStaticMeshName(newval,0)
+			local meshname =3D GetMeshName(newval,0)
 			while (tries &gt; 0 and ((not meshname) or (CountMeshTriangles(meshname) &gt;=
 6))) do
 				newval =3D newval + add
-				meshname =3D GetStaticMeshName(newval,0)
+				meshname =3D GetMeshName(newval,0)
 				tries =3D tries - 1
 			end =

 		end
@@ -616,6 +616,13 @@
 end
 =

 function StartDebugMenu ()
+	-- parse command line args
+	if gCommandLineSwitches[&quot;-artid&quot;] then
+		local id =3D gCommandLineArguments[gCommandLineSwitches[&quot;-artid&quot;]+1]
+		gCurDebugMode =3D kDebugMode_Static
+		gDebugMenuModelIndex =3D id
+	end
+
 	--CrashSegFault() -- testing =3DD
 	gStartInDebugMode =3D true
 	gDebugMenuRunning =3D true

Modified: trunk/lua/lib.mainmenu.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.mainmenu.lua (original)
+++ trunk/lua/lib.mainmenu.lua Sun Jan 20 00:25:56 2008
@@ -278,6 +278,7 @@
 	if (gCommandLineSwitches[&quot;-jt&quot;]) then ToggleJournal() return end -- journ=
altest
 	if (gCommandLineSwitches[&quot;-mt&quot;]) then ToggleMacroList() return end -- mac=
rolist-test
 	if (gCommandLineSwitches[&quot;-so&quot;]) then StartOfflineMode() return end -- st=
art in offline mode
+	if (gCommandLineSwitches[&quot;-sd&quot;]) then StartDebugMenu() return end -- star=
t in debug mode
 =

 	-- start menu sound
 	SoundPlayMusicById(8)

Modified: trunk/lua/lib.test.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/lib.test.lua (original)
+++ trunk/lua/lib.test.lua Sun Jan 20 00:25:56 2008
@@ -121,7 +121,7 @@
 		--polycount =3D gLegacyModelAndTextureLoader:GetMeshPolyCount(obj.typeid)
 =

 --		print(&quot;obj.typeid: &quot;..obj.typeid)
---		local meshname =3D GetStaticMeshName(obj.typeid,0)
+--		local meshname =3D GetMeshName(obj.typeid,0)
 --		if (meshname and meshname ~=3D false) then polycount =3D CountMeshTria=
ngles(meshname) end
 		if (polycount &lt; 1) then =

 			print(obj.amount,sprintf(&quot;0x%04x&quot;,obj.typeid),obj.typeid,obj.typeobj.ms=
Name,polycount)

Modified: trunk/lua/main.lua
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
--- trunk/lua/main.lua (original)
+++ trunk/lua/main.lua Sun Jan 20 00:25:56 2008
@@ -175,6 +175,7 @@
 	OgreAddResLoc(mydatapath..gModelPath_Tex				,&quot;FileSystem&quot;,&quot;General&quot;)
 	OgreAddResLoc(mydatapath..&quot;models/programs&quot;				,&quot;FileSystem&quot;,&quot;General&quot;)
 	OgreAddResLoc(mydatapath..&quot;models/atlas&quot;				,&quot;FileSystem&quot;,&quot;General&quot;)
+	OgreAddResLoc(mydatapath..&quot;models/&quot;						,&quot;FileSystem&quot;,&quot;General&quot;)
 	--~ OgreAddResLoc(mydatapath..&quot;models/models&quot;				,&quot;FileSystem&quot;,&quot;General&quot;)
 	OgreAddResLoc(mydatapath..gModelPath_Mesh				,&quot;FileSystem&quot;,&quot;General&quot;)
 =

@@ -182,6 +183,7 @@
 	OgreAddResLoc(mydatapath..&quot;custom/materials&quot;			,&quot;FileSystem&quot;,&quot;General&quot;)
 	OgreAddResLoc(mydatapath..&quot;custom/meta&quot;					,&quot;FileSystem&quot;,&quot;General&quot;)
 	for i=3D1,20 do OgreAddResLoc(mydatapath..sprintf(&quot;custom/models/to_%03d0=
00&quot;,i)	,&quot;FileSystem&quot;,&quot;General&quot;) end
+	OgreAddResLoc(mydatapath..&quot;custom/models&quot;				,&quot;FileSystem&quot;,&quot;General&quot;)
 	OgreAddResLoc(mydatapath..&quot;custom/programs&quot;				,&quot;FileSystem&quot;,&quot;General&quot;)
 	OgreAddResLoc(mydatapath..&quot;custom/textures&quot;				,&quot;FileSystem&quot;,&quot;General&quot;)
 =

@@ -283,19 +285,13 @@
 	-- set global shadow settings
 	if (gShadowTechnique ~=3D &quot;none&quot;) then
 		OgreShadowTechnique(gShadowTechnique)
-		OgreSetShadowFarDistance(gSightRange*18.0)
-
 		if ((gShadowTechnique =3D=3D &quot;texture_modulative&quot;) or (gShadowTechnique =
=3D=3D &quot;texture_additive&quot;)) then
 			OgreSetShadowTextureSize(2048)
 			OgreSetShadowTextureSelfShadow(false)
-		end
-
-		if (gShadowTechnique =3D=3D &quot;texture_additive_integrated&quot;) then
-			OgreSetShadowCasterRenderBackFaces(false)
-			OgreSetShadowTextureCasterMaterial(&quot;Ogre/DepthShadowmap/Caster/Float&quot;)
-			--OgreSetShadowTextureReceiverMaterial(&quot;Ogre/DepthShadowmap/BasicTempla=
teMaterial&quot;)
-			OgreSetShadowTextureSettings(2048, 3, PF_FLOAT32_R)
-			OgreSetShadowTextureSelfShadow(false)
+			--OgreSetShadowTextureCasterMaterial(matname)
+			--OgreSetShadowTextureReceiverMaterial(matname)
+			--OgreSetShadowTexturePixelFormat(PF_FLOAT32_R) --only for accuracy
+			OgreSetShadowFarDistance(gSightRange*18.0)
 		end
 	end
 =

@@ -312,12 +308,12 @@
 	-- TODO move to config or automatic best choosing
 	if gAtlasRes =3D=3D &quot;high&quot; then
 		---- high res
-		dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_4096_4096.lua&quot;)
-		dofile(datapath .. &quot;models/atlas/tex_atlas_4096_4096.lua&quot;)
+		dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_2048_2048.lua&quot;)
+		dofile(datapath .. &quot;models/atlas/tex_atlas_2048_2048.lua&quot;)
 	elseif gAtlasRes =3D=3D &quot;med&quot; then
 		---- med res
-		dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_2048_128.lua&quot;)
-		dofile(datapath .. &quot;models/atlas/tex_atlas_2048_128.lua&quot;)
+		dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_2048_64.lua&quot;)
+		dofile(datapath .. &quot;models/atlas/tex_atlas_2048_64.lua&quot;)
 	elseif gAtlasRes =3D=3D &quot;low&quot; then
 		---- low res
 		dofile(datapath .. &quot;models/atlas/tex_atlas_alpha_512_32.lua&quot;)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000614.html">[Iris-commit] [IRIS] r1800 - in /rawdata/sd_pd: tex_grass.png	topf.blend
</A></li>
	<LI>Next message: <A HREF="000617.html">[Iris-commit] [IRIS] r1802 - /trunk/README
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#616">[ date ]</a>
              <a href="thread.html#616">[ thread ]</a>
              <a href="subject.html#616">[ subject ]</a>
              <a href="author.html#616">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/iris-commit">More information about the Iris-commit
mailing list</a><br>
</body></html>
